(window.webpackJsonp=window.webpackJsonp||[]).push([[555,55,58],{"+wu9":function(e,t){e.exports='<div class="typeahead-selected-options" ng-class="{\'empty\': selectedOptions.length === 0}" bb-load-bundle="components/directives/typeahead">\n  <ul bb-translate-attrs="{ \'aria-label\': selectedOptionsListLabel }">\n    <li ng-repeat="option in selectedOptions">\n      <span>{{::option.displayName}}</span>\n      <button class="button button--text"\n              ng-click="typeaheadSelectedOptions.removeOption(option)"\n              bb-translate-attrs="{ \'aria-label\': \'typeahead.typeahead-options.remove\' }"\n              translate-attrs-values="{ displayName: option.displayName }"\n              analytics-id="components.directives.typeaheadSelectedOptions.removeOption.button">\n        <bb-svg-icon size="small" icon="clear" />\n      </button>\n    </li>\n  </ul>\n</div>'},"/9iQ":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-documents",use:"icon-small-documents-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-documents"><path d="M1 4h7.0084L11 7v8H1V4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8.0005 4v3h3.0015M4 8h1M4 11h3.9722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 1h11v12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"/BCe":function(e,t){e.exports='<ng-switch on="targetContent.contentHandler.toString()">\n  <a ng-switch-when="resource/x-bb-forumlink" class="content-title"\n     bb-peek-sref="discussion.view.with-grading({contentId:\'{{targetContent.id}}\'})"\n     bb-prevent-click-if="targetContent.isConditionalReleaseLocked()"\n     aria-describedby="{{ariaDescribedBy}}"\n     analytics-id="course.link.item.forumLink.link"\n     aria-hidden="{{ aria }}"\n     tabindex="{{ tabbable ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n  <div ng-switch-default class="content-title">{{ content.title }}</div>\n</ng-switch>\n'},"/R3n":function(e,t){e.exports='<div class="content-item-course-outline">\n  <div class="name">\n    <ng-switch on="::content.getContentDisplay().linkAction()" ng-class="{\'has-indicator\': content.ui.hasIndicator}">\n      <div ng-switch-when="resource/x-bb-folder">\n        <bb-content-item-folder></bb-content-item-folder>\n      </div>\n      <div ng-switch-when="contenturl">\n        \x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n        <a bb-prevent-click-if="content.isConditionalReleaseLocked()"\n            ng-click="contentItemBase.onExternalLinkClick()"\n            ng-href="{{content.getContentDisplay().contentUrl()}}" target="_blank" rel="noopener noreferrer" class="content-title"\n            ng-class="{\'name-middle\': contentItemCourseOutline.shouldAlignMiddle()}"\n            aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n            analytics-id="content.item.course.outline.courseContent.link"\n            analytics-context="{{::content.getContentDisplay().contentUrl()}}"\n            aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n            tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n          <span>{{ content.title }}</span>\n        </a>\n      </div>\n      <div ng-switch-when="ltilaunch">\n        <bb-content-item-ltilaunch></bb-content-item-ltilaunch>\n      </div>\n      <div ng-switch-when="scormlaunch">\n        <bb-content-item-scormlaunch></bb-content-item-scormlaunch>\n      </div>\n      <div ng-switch-when="resource/x-bb-asmt-agn-link">\n        \x3c!-- open  edit page when an instructor(=entitledToDesignAssessment) is accessing an assignment in a complete course. page will become read only based on canEdit() --\x3e\n        <a ng-if="contentItemBase.entitledToDesignAssessment"\n           class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           bb-peek-sref="gradebook-item.assignment({\n                                 courseId: content.courseId,\n                                 contentId: content.id,\n                                 gradeitemView: \'details\' })"\n           analytics-id="content.item.course.outline.gradebook.item.assignment.link"><span>{{ content.title }}</span></a>\n        \x3c!-- user cannot modify --\x3e\n        <a ng-if="!contentItemBase.entitledToDesignAssessment"\n           bb-peek-sref="assignment.view({assignmentId:content.id})" bb-prevent-click-if="content.isConditionalReleaseLocked()"\n           ng-class="{\'is-late\': contentItemBase.isLate, \'is-restricted\': content.isRestricted()}"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           class="content-title"\n           analytics-id="content.item.course.outline.gradebook.item.assignment.readOnly.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-assignment">\n        <a bb-peek-sref="assignment.view({assignmentId:content.id})" class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           ng-class="{\'is-late\': contentItemBase.isLate}"\n           analytics-id="content.item.coures.outline.assignment.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-document">\n        <a bb-peek-sref="content-manage.edit.document({id:content.id})" class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           ng-class="{\'is-late\': contentItemBase.isLate}"\n           analytics-id="content.item.coures.outline.document.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-page">\n        <bb-content-item-page></bb-content-item-page>\n      </div>\n      <div ng-switch-when="resource/x-bb-asmt-test-link">\n        \x3c!-- open edit page when an instructor(=entitledToDesignAssessment) is accessing content. In a complete course, page will become read only based on canEdit() --\x3e\n        <a ng-if="contentItemBase.entitledToDesignAssessment" class="content-title"\n           bb-peek-sref="gradebook-item.assessment({\n                                 courseId: content.courseId,\n                                 contentId: content.id,\n                                 gradeitemView: \'details\',\n                                 assessmentType: \'test\'})"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           analytics-id="content.item.courses.outline.gradebook.item.assessment.link"><span>{{ content.title }}</span></a>\n        \x3c!-- user cannot modify --\x3e\n        <a ng-if="!contentItemBase.entitledToDesignAssessment" href="javascript:void(0);"\n           ng-click="contentItemBase.openAssessmentItem()" bb-prevent-click-if="content.isConditionalReleaseLocked()"\n           ng-class="{\'is-late\': contentItemBase.isLate, \'is-restricted\': content.isRestricted()}"\n           class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           analytics-id="content.item.courses.outline.gradebook.item.assessment.readOnly.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <a ng-switch-when="resource/x-bb-forumlink" bb-peek-sref="discussion.view.with-grading({contentId:content.id})"\n         bb-prevent-click-if="content.isConditionalReleaseLocked()"\n         class="content-title" aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n         analytics-id="content.item.courses.outline.gradebook.item.forum.link"\n         aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n         tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      <div ng-switch-when="resource/x-bb-courselink">\n        <bb-course-link-item content="content" target-content="contentItemBase.targetContent" prefix="\'course.outline\'"/>\n      </div>\n      <div ng-switch-when="resource/x-bb-journallink">\n        <a bb-peek-sref="journal.view.with-participation({contentId:content.id})"\n          bb-prevent-click-if="content.isConditionalReleaseLocked()"\n          class="content-title" aria-describedby="activity-indicator-{{::content.id}}"\n          analytics-id="content.item.courses.outline.journal.link"\n          aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n          tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-default class="content-title">{{ content.title }}</div>\n      <bb-svg-icon role="img" aria-hidden="false" bb-translate-attrs="::{\'aria-label\':\'components.directives.content-item-base.aria-label.indicator\'}" ng-if="content.ui.hasIndicator" id="activity-indicator-{{::content.id}}" class="indicator" size="small" icon="activity-indicator"></bb-svg-icon>\n    </ng-switch>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date">\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-if="!dueDate" class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-if="dueDate && !gradeDetail" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-if="dueDate && !gradeDetail" class="content-due-date"></bb-datetime>\n    <span ng-if="content.getTimedTestDetail().hasTimeLimit" class="time-limit ellipse">\n      <span class="vertical-bar"></span>\n      <span bb-translate>components.directives.content-item-base.time-limit</span>\n      <span ng-bind-html="content.getTimedTestDetail().displayedTimeLimitSeconds | timeSpan: \'m\': this "></span>\n    </span>\n    <span class="content-item-course-outline__proctored-tag" ng-if="contentItemCourseOutline.displayProctoredTag()">\n      <span class="vertical-bar"></span>\n      <bb-ui-icon-small-proctor-shield\n        class="content-item-course-outline__proctored-icon"\n        class-name="content-item-course-outline__proctored-icon-svg"\n      >\n      </bb-ui-icon-small-proctor-shield>\n      <span bb-translate>components.services.proctoring.outline.proctored</span>\n    </span>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date"\n       ng-class="{\'is-late\': contentItemBase.isLate}" ng-switch="dueDate != null">\n    \x3c!-- submission card --\x3e\n    \x3c!--  TODO: submissionCard is disabled until LRN-101279 is fixed --\x3e\n    \x3c!-- <bb-submission-card ng-if="gradeDetail"  grade-detail="gradeDetail" inline="true"></bb-submission-card>\n    <bb-submission-card ng-if="!gradeDetail" grading-column="gradingColumn" inline="true"></bb-submission-card> --\x3e\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-switch-default class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-switch-when="true"\n          class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-switch-when="true" class="content-due-date"></bb-datetime>\n    <span ng-if="content.getTimedTestDetail().hasTimeLimit" class="time-limit ellipse">\n      <span class="vertical-bar"></span>\n      <span bb-translate>components.directives.content-item-base.time-limit</span>\n      <span ng-bind-html="content.getTimedTestDetail().displayedTimeLimitSeconds | timeSpan: \'m\': this "></span>\n    </span>\n    <span class="content-item-course-outline__proctored-tag" ng-if="contentItemCourseOutline.displayProctoredTag()">\n      <span class="vertical-bar"></span>\n      <bb-ui-icon-small-proctor-shield\n        class="content-item-course-outline__proctored-icon"\n        class-name="content-item-course-outline__proctored-icon-svg"\n      >\n      </bb-ui-icon-small-proctor-shield>\n      <span bb-translate>components.services.proctoring.outline.proctored</span>\n    </span>\n  </div>\n  <bb-content-item-peer-assessment ng-if="content.id" content="content"></bb-content-item-peer-assessment>\n  <div ng-if="contentItemBase.isModifyPermissionLoaded && content.canHaveAttempts() && content.isGroupContent" class="group-info">\n    <div class="guidance-wrapper">\n      <div class="group-name">\n        <span><bb-svg-icon size="small" icon="groups"></bb-svg-icon></span>\n        <span class="group-target-guided" bb-guidance-target component-key="contentGroupInfo"\n              ng-if="!contentItemBase.contextCourse.course.isComplete()">\n        </span>\n        <a ng-if="contentItemBase.hasViewGroupsAsAdmin"\n           class="js-groups-link"\n           href="javascript:void(0);"\n           ng-click="contentItemBase.editGroups()"\n           analytics-id="content.item.course.outline.contentItemBase.editGroups.link">\n          <bb-group-count content="content"></bb-group-count>\n        </a>\n        <span ng-if="contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin" class="js-groups-link">\n          <bb-group-count content="content"></bb-group-count>\n        </span>\n        <div ng-if="!(contentItemBase.canViewGroups || contentItemBase.hasViewGroupsAsAdmin)" class="student-group-enrollment">\n          <bb-group-student-enrollment content="content"></bb-group-student-enrollment>\n        </div>\n        \x3c!-- For complete course, will not show this guidance: LRN-107718 --\x3e\n        <span>\n          <bb-guidance ng-if="!contentItemBase.contextCourse.course.isComplete() && !contentItemBase.entitledToDesignAssessment" component-key="contentGroupInfo"\n                       class="guidance-element-group guidance-is-empty-student guidance-element-overlay push-left">\n            <span bb-translate="{{::contentItemCourseOutline.groupAssessmentFtueKey}}" translate-values="{title: contentItemCourseOutline.customCategory}"></span>\n          </bb-guidance>\n        </span>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.isConditionalReleaseLocked()"\n    role="tooltip"\n    aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n    tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"\n    class="lock-info"\n    bb-complex-tooltip\n    enhanced-tooltip="true"\n    tooltip-position="bottom"\n    tooltip-open-on-activation="true"\n    tooltip-disable-on-mouse-over="false"\n    tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n    tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n    <span bb-translate="components.directives.content-item-base.conditionalRelease.lock-info"></span>\n    <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n  </div>\n  <div class="name-controls stop-click-propagation"\n    ng-class="{\n      \'name-conditional-release\': !content.canViewAsInstructor() && content.isConditionalReleaseLocked(),\n      \'selector-disabled\': content.isInForcedSequenceModule()\n    }"\n    ng-if="contentItemBase.showVisibility()">\n    <bb-content-visibility-selector content="content"\n                                    link-content="contentItemBase.targetContent"\n                                    onchange-func="contentItemBase.updateContentVisibility()"\n                                    open-panel-on-restricted="true"\n                                    enable-conditional-release="content.canAccessAdaptiveRelease()"\n                                    disable-restricted="contentItemBase.disableRestricted"\n                                    verbose-restricted-label="true"></bb-content-visibility-selector>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.isConditionalRelease()" class="conditional-release-control"\n       ng-class="{\'conditional-release-control-for-complete-course\': contentItemCourseOutline.isCourseCompletedAndInInstructorView()}">\n    <div class="rules">\n      <a href="javascript:void(0);"\n        ng-click="contentItemCourseOutline.canOpenConditionalRelease && contentItemCourseOutline.openConditionalRelease()"\n        bb-complex-tooltip\n        enhanced-tooltip="true"\n        tooltip-position="bottom"\n        tooltip-disable-on-mouse-over="{{!contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-enable-on-mouse-leave-for-all-breakpoints="{{contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-enable-on-mouse-over-for-all-breakpoints="{{contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-open-on-activation="{{!contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-auto-update="true"\n        tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n        tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n        analytics-id="components.directives.content-item-base.conditionalRelease.link">\n        <span>{{contentItemBase.conditionalRelease.getConditionDescription()}}</span>\n        <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},"/hmo":function(e,t){e.exports='<ng-switch on="targetContent.contentHandler.toString()">\n  <a ng-switch-when="resource/x-bb-blti-link" \n     bb-component-sref="{{prefix}}.engagement.edit({contentId:\'{{targetContent.id}}\'})"\n     class="content-title"\n     analytics-id="course.content.lti.link"><span>{{ content.title }}</span></a>\n</ng-switch>\n'},"/z4E":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var s=n("Llzl"),i=n("Oyr+"),o=n("0JpG"),a=n("Vsv2"),r=n("zXZW"),c=n("pjml"),l=n("12mu"),d=n("lEL+"),u=n("DMV0"),h=n("ol3u");const p="ultra.directives.bbCloudStorageIntegration";class m{constructor(e,t,n,s,i,o,a,r){this.scope=e,this.$q=t,this.$exceptionHandler=n,this.bbLocalize=s,this.$modal=i,this.CloudDriveModel=o,this.CloudDriveTaskModel=a,this.timeout=r,this.bbLocalize.loadBundle("components/directives/cloudStorageIntegration")}getFileId(e){return e.account+"|"+e.id}onFileSelect(e){this.scope.$emit(i.d,e,this.scope.primaryKey&&this.scope.primaryKey()),this.scope.onFilesSelected&&this.scope.onFilesSelected(e)}getDownloadFileInfo(e){const t=this.getFileId(e);return this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(t).$fetch({accessToken:this.accessToken}).$asPromise()}downloadFiles(e,t,n,s){const o={accessToken:this.accessToken,expand:"mimeType,isMedia"};this.scope.fileLocation&&(o.fileLocation=this.scope.fileLocation),this.scope.webLocation&&(o.webLocation=this.scope.webLocation),(n?this.CloudDriveTaskModel.$new(s||e.id):this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(s||e.id).download).$fetch(o).$then(n=>{if("COMPLETE"===n.status){const s=this.scope.$on(i.e,(o,a,r)=>{r!==i.c.UploadProgressComplete||e.ui.fileId&&a!==e.ui.fileId||(this.attachHandler(n,e,t),s())})}else this.timeout(()=>{this.downloadFiles(e,t,!0,n.taskId)},this.scope,2e3);(n.completePercentage<100||"COMPLETE"===n.status)&&this.scope.$root.$broadcast(i.e,e.ui.index,n.completePercentage,null,i.c.UpdateProgress,e.inProgressFileId,e.ui.targetDiv,e.ui.fileId)},t=>{this.displayUploadError(),this.scope.$root.$broadcast(i.e,e.ui.fileId,e,i.c.Error,e.ui.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),this.$exceptionHandler(t,"source")})}attachHandler(e,t,n){const s=this.$q.defer(),i={fileName:null,fileLocation:null};return e&&(i.fileName=e.fileName,i.fileLocation=e.fileLocation,i.webLocation=e.webLocation,i.mimeType=e.mimeType,i.isMedia=e.isMedia),this.scope.attachHandler(i,t,this.scope.isUploadMultipleFiles,void 0,n).then(e=>{s.resolve(e)},e=>{s.reject(e)}),s.promise}displayUploadError(){this.$modal.open({template:u,scope:this.scope})}}m.$inject=["scope","$q","$exceptionHandler",o.serviceName,l.b,c.h.serviceName,c.i.serviceName,d.b];class b{constructor(e,t,n,i){this.$injector=e,this.$q=t,this.$modal=n,this.CloudDriveService=i,this.scope={attachHandler:"=",isFlatten:"=?",primaryKey:"&?",primaryKeyValue:"@?",fileLocation:"@?",webLocation:"@?",disableClick:"&?",allowMultiple:"=?",onFilesSelected:"=?",onCancelFocus:"=?"},this.restrict="A",this.link=(e,t,n)=>{const i=this;e.cloudStorageIntegration=this.$injector.instantiate(m,{scope:e}),e.folderBranchCounts=0,e.isInitialized=!!i.CloudDriveService.cloudDriveStorage,e.isInitialized||i.CloudDriveService.initializeCloudDrive();const o=function(t){const n=[];if(t&&t.length>0){for(let s=0;s<t.length;s++)n.push(e.cloudStorageIntegration.getDownloadFileInfo(t[s]));i.$q.all(n).then(t=>{i.CloudDriveService.isGettingFilesInfo=!1,e.cloudStorageIntegration.onFileSelect(t),t.length>1&&(e.isUploadMultipleFiles=!0)},()=>{i.CloudDriveService.isGettingFilesInfo=!1})}};t.on("click",()=>{e.disableClick&&e.disableClick()||!e.isInitialized||(i.CloudDriveService.cloudDriveStorage.openFilePicker(e,e.allowMultiple).then(n=>{if((n||[]).length>0){if(!n[0]||!n[0].bearer_token||!n[0].bearer_token.key)return void this.$modal.open({template:h,scope:e});e.cloudStorageIntegration.accessToken=n[0].bearer_token.key,i.CloudDriveService.isGettingFilesInfo=!0,s.isDefined(e.allowMultiple)&&!1===e.allowMultiple&&n.length>1?o([n[0]]):o(n)}else e.onCancelFocus?e.onCancelFocus():t.focus()}),e.$on("$destroy",()=>{i.CloudDriveService.isGettingFilesInfo=!1,t.off("click")}))}),e.$on("downloadFile",(t,n,s)=>{n.ui.primaryKey===(e.primaryKey&&e.primaryKey())&&n.file.$url().indexOf("CloudStorageIntegration")>=0&&e.cloudStorageIntegration.downloadFiles(n,s)})}}}b.$inject=["$injector","$q","$modal",a.b],s.module(p,[o.moduleName,a.a,r.a,l.a,d.a]).directive("bbCloudStorageIntegration",["$injector",e=>e.instantiate(b)])},"0/Nk":function(e,t){e.exports='<div class="group-student-self-enroll-directive" bb-load-bundle="components/directives/group/group-student-enrollment">\n  <div ng-if="$ctrl.content.assignedGroups.length > 0">\n    <span ng-if="!$ctrl.isOpenEnrollment()" class="ellipse title">\n      {{$ctrl.content.assignedGroups[0].groupTitle}}\n    </span>\n    <a ng-if="$ctrl.isSelfEnrollment && $ctrl.isOpenEnrollment()" class="self-enroll-link js-self-enroll-link"\n       href="javascript:void(0);" ng-click="$ctrl.openContentEnrollPanel()"\n       analytics-id="components.directives.group-student-enrollment.groupTitle.link">\n      {{$ctrl.content.assignedGroups[0].groupTitle}}\n    </a>\n  </div>\n  <span ng-if="!($ctrl.content.assignedGroups.length > 0) && !$ctrl.isSelfEnrollment" class="ellipse title" bb-translate\n        translate-values="{title: components.directives.group-student-enrollment.unknown}">\n    components.directives.group-student-enrollment.unknown\n  </span>\n  <div ng-if="!($ctrl.content.assignedGroups.length > 0) && $ctrl.isSelfEnrollment">\n    <div ng-if="$ctrl.isOpenEnrollment()">\n      <a href="javascript:void(0);" ng-click="$ctrl.openContentEnrollPanel()" class="self-enroll-link js-self-enroll-link"\n         bb-translate analytics-id="components.directives.group-student-enrollment.self-enroll-to-participate">components.directives.group-student-enrollment.self-enroll-to-participate</a>\n    </div>\n    <div ng-if="$ctrl.isBeforeEnrollment()" class="self-enroll-date" translate-values="{time: $ctrl.selfEnrollGroupInfo.relativeDate}"\n         bb-translate>components.directives.group-student-enrollment.enrollment-starts</div>\n    <div ng-if="$ctrl.isOpenEnrollmentWithEnding()" class="self-enroll-date"\n         ng-class="{\'is-important\': $ctrl.selfEnrollGroupInfo.isEnrollmentDateImportant}"\n         translate-values="{time: $ctrl.selfEnrollGroupInfo.relativeDate}"\n         bb-translate>components.directives.group-student-enrollment.enrollment-closes</div>\n    <div ng-if="$ctrl.isAfterEnrollment()" class="self-enroll-date"\n         bb-translate>components.directives.group-student-enrollment.enrollment-closed</div>\n  </div>\n</div>\n'},"01PJ":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-post",use:"icon-small-post-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-post"><path d="M9 15L1 9l14-8-6 14zM5 12L15 1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 12v3l1.5-1.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"07HN":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    class="button-add-content"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.grades.button"\n  >\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>'},"0BVo":function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.failedToUpload.title\'}" \n          modal-title-key="course.grades.grades-upload-settings.failedToUpload.title" aria-describedby="failed-to-upload"\n          analytics-id-tag-prefix="course.grades.gradesUploadSettingsFailed">\n<div name="modal-contents">\n    <p id="failed-to-upload" translate-values="{ count: failedItemsCount, errorItems: failedItems }"\n       bb-translate="course.grades.grades-upload-settings.failedToUpload.content.plural"></p>\n</div>\n  <button name="modal-footer-button-primary" \n          class="button js-discard-changes js-primary-button failed-to-upload-button" \n          ng-click="$dismiss()"\n          analytics-id="course.grades.gradesUploadSettingsFailed.closeButton.button">\n      <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n  </button>\n</bb-modal>'},"0lMW":function(e,t,n){},"0rzL":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var s=n("D57K"),i=(n("eWdw"),n("Llzl")),o=n("nbDY"),a=n.n(o),r=n("ckcj"),c=n("dJ97"),l=n("aHpC"),d=n("Bu0u"),u=n("UODz"),h=n("zGdY");const p="ultra.components.directives.submissionCard";class m extends a.a{}m.ATTEMPT=new m("ATTEMPT"),m.GRADE=new m("GRADE"),m.INFO=new m("INFO");let b=class{constructor(e){if(this.scope=e,!e.gradingColumn&&!e.gradeDetail)throw new d.a({message:"gradingColumn or gradeDetail must be provided."});if(this.scope.gradeDetail&&!this.scope.gradeDetail.column)throw new d.a({message:"gradeDetail.column must be provided to display attempt mode."});let t,n;switch(this.scope.gradeDetail&&(this.scope.gradeDetail.ui.groupAttempt||this.scope.gradeDetail.ui.attempt)&&(this.attempt=this.scope.gradeDetail.ui.groupAttempt||this.scope.gradeDetail.ui.attempt,this.currentGradeStatus=this.scope.gradeDetail.ui.attempt.status),(!e.gradeDetail||e.gradeDetail&&!this.attempt)&&e.gradingColumn?this.scope.mode=m.INFO:e.gradeDetail&&this.attempt&&(this.scope.mode=m.ATTEMPT,this.scope.gradingColumn=this.scope.gradeDetail.column),this.showLate=!e.showLate||e.showLate(),e.mode){case m.INFO:n=e.gradingColumn.dueDate?"DUE":"NO_DUE_DATE",t=this.showLate?"UNOPENED_LATE":"UNOPENED";break;case m.ATTEMPT:n=this.attempt.status.toString(),e.hasAttempt=!0,t=h.AttemptStatus.InProgress===this.attempt.status&&this.showLate?"SUBMISSION_LATE":"SUBMISSION";break;case m.GRADE:}e.status="components.directives.submission-card.attemptStatus."+n,e.title="components.directives.submission-card.title."+t}shouldExpandForRubricIcon(){return(this.scope.showRubricButton&&this.scope.showRubricButton()||this.scope.showRubricDiv&&this.scope.showRubricDiv())&&this.scope.gradingColumn.hasRubricAssociation&&this.scope.gradingColumn.hasRubricAssociation()}get showLateIcon(){return this.showLate&&(!this.scope.gradeDetail||!this.attempt||this.attempt.isInProgress())}};b=Object(s.__decorate)([Object(s.__param)(0,Object(l.b)("scope"))],b);let g=class{constructor(e){this.$injector=e,this.restrict="AE",this.template=u,this.scope={gradeDetail:"=?",gradingColumn:"=?",inline:"@?",clickable:"=?",showLate:"&?",showRubricButton:"&?",showRubricDiv:"&?"},this.link=e=>{e.submissionCard=this.$injector.instantiate(b,{scope:e})}}};g=Object(s.__decorate)([Object(s.__param)(0,Object(l.b)("$injector"))],g),i.module(p,[r.a,c.a]).directive("bbSubmissionCard",["$injector",e=>e.instantiate(g)])},"1/hr":function(e,t,n){},"10QP":function(e,t,n){},"1Niw":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    class="button-add-content js-show-add-options"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.editor.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="::addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>\n\x3c!--\n  The elements are kept around to trigger download actions.\n  The \'ng-hide\' class is added to prevent the buttons from interfering with AX (tab order, screen readers)\n--\x3e\n<ul class="element-list-add-menu angular-animate ng-hide">\n  <li>\n    <button type="button"\n            class="js-add-text-block"\n            ng-click="addContentButton.addTextBlock()"\n            analytics-id="components.directives.add-content-button.editor.addText.button">\n      <div>\n        <i class="icon-doc-pencil-2"></i>\n        <span bb-translate>components.directives.add-content-button.addContent</span>\n      </div>\n    </button>\n  </li>\n  <li ng-if="addContentButton.canEditUnsafeHtml">\n    <button type="button"\n            ng-click="addContentButton.addHtmlBlock()"\n            analytics-id="components.directives.add-content-button.editor.addHtml.button">\n      <div>\n        <bb-svg-icon size="small" icon="code"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.addHtml</span>\n      </div>\n    </button>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      click-enabled="true"\n      disable-drag="false"\n      class="js-file-upload"\n      web-location="{{webLocation}}"\n      file-location="{{fileLocation}}"\n      target-div="{{\'#\' + fileListViewId}}"\n      disallow-folder-uploads="true"\n      is-third-party-upload="false"\n      ignored-states="::ignoredStates()">\n        <button\n          type="button"\n          class="file-upload-button"\n          ng-click="addContentButton.assignPosition()"\n          aria-label="{{addContentButton.uploadAriaLabel}}"\n          analytics-id="components.directives.add-content-button.editor.fileUpload.button">\n          <div ng-if="!addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromComputer</span>\n          </div>\n          <div ng-if="addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromDevice</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="false"\n      monitor-leave="true"\n      target-div="{{\'#\' + fileListViewId}}"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      disable-drag="true"\n      is-third-party-upload="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      ignored-states="::ignoredStates()">\n      <button\n        type="button"\n        class="js-upload-from-cloud-storage-integration"\n        ng-click="addContentButton.assignPosition()"\n        bb-cloud-storage-integration\n        primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n        attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="false"\n        on-cancel-focus="!initialUpload ? addContentButton.focusAddButton : null"\n        analytics-id="components.directives.add-content-button.editor.uploadFromCloudStorage.button">\n          <div>\n            <i class="icon-cloud"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromCloudStorage</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n</ul>\n'},"2E9T":function(e,t){e.exports='<bb-svg-icon size="small" icon="add" class="js-add-plus add-circle-default"></bb-svg-icon>\n<bb-svg-icon size="small" icon="add" status="active" class="js-add-plus add-circle-active"></bb-svg-icon>'},"2a+M":function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var s=n("nsO7"),i=n("Llzl"),o=n("nbDY"),a=n.n(o),r=n("0JpG");const c="ultra.services.dragDrop",l="dragDropService";class d extends a.a{}d.TOP=new d("TOP"),d.BOTTOM=new d("BOTTOM"),d.FOLDER=new d("FOLDER"),d.SELF=new d("SELF");class u{constructor(e,t){this.$timeout=e,this.bbLocalize=t,this.dragHoverClass="dz-drag-hover",this.dragElementSelector=".drag-element",this.onFolderClass="on-folder",this.onNestedFolderClass="on-nested-folder",this.originalElementClass="drag-element-original",this.movableElementClass="drag-element-movable",this.queuedScreenReaderMessages="",this.bbLocalize.loadBundle("components/services/drag-drop").then(()=>{this.folderDepthMessageKey="components.services.drag-drop.folderDepthMessage"})}createDropPlaceholderElement(t){this.dropPlaceholderElement=e('<div class="dragdropplaceholder js-no-file-drop" style="height: '+t.height()+"px; width: "+t.width()+'px"></div>')}setDropTarget(e){this.lastDropTargetId=this.currentDropTargetId,this.currentDropTargetId=e}clearDropTarget(){this.setDropTarget(void 0)}isCurrentDropTarget(e){return this.currentDropTargetId===e}isNotSameDropTarget(){return this.currentDropTargetId!==this.lastDropTargetId}scrollDragDropItemsContainer(e,t){const n=this._getScrollingContainerElement();if(n){const s=e<u.SCROLLING_CONSTANTS.scrollZoneHeight,i=e>n.height()-u.SCROLLING_CONSTANTS.scrollZoneHeight,o=n.scrollTop();s?n.scrollTop(o-t):i&&n.scrollTop(o+t)}}_getScrollingContainerElement(){const e=u.SCROLL_CONTAINERS_SELECTORS.map(e=>this.originalElement.closest(e));return s.find(e,e=>this._elementHasScrollbar(e))}_elementHasScrollbar(e){return e.get(0).scrollHeight>e.innerHeight()}}u.SCROLLING_CONSTANTS={scrollZoneHeight:200,mouseInteractionDistanceToScroll:30,keyboardInteractionDistanceToScroll:200},u.SCROLL_CONTAINERS_SELECTORS=[".panel-wrap",".panel-content"],u.$inject=["$timeout",r.serviceName];class h extends u{}i.module(c,[r.moduleName]).service(l,u)}).call(this,n("5iHu"))},"2bSy":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var s=n("Llzl"),i=n("LN5R"),o=n("dF44"),a=n("qH3X"),r=n("KeOq");const c="ultra.components.directives.gradeGridColumnHeaderStudentReborn";class l{constructor(e,t,n,s){this.scope=e,this.element=t,this.attrs=n,this.gradeGridRebornController=s,e.studentsTotal=s.getRowCount(),e.$on(o.b.CELL_FOCUSED,()=>{t.find(".content").focus()}),[a.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,a.a.ADVANCED_FILTERS_ROWS,o.b.ROW].forEach(t=>{e.$on(t,()=>{this.scope.studentsTotal=s.getRowCount()})}),e.$on(a.a.GRADEBOOK_USER_SELECTED,()=>{this.scope.studentsTotal=1})}}l.$inject=["scope","element","attrs","gradeGridRebornController"];class d{constructor(e){this.$injector=e,this.restrict="E",this.template=r,this.scope=!0,this.require=`^${i.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnHeaderStudentReborn=this.$injector.instantiate(l,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}d.$inject=["$injector"],s.module(c,[]).directive("bbGradeGridColumnHeaderStudentReborn",["$injector",e=>e.instantiate(d)])},"2i58":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-content-market",use:"icon-small-content-market-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-market"><path d="M2 2h13l-1 8H4" stroke-width="2" stroke-linejoin="round" /><circle cx="13" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="4" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 6h11.5M7 2v8M11 2v8M1 1h1l2 12h9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"2tKw":function(e,t){e.exports='<div class="rubric-list" bb-load-bundle="components/directives/rubric/rubric-list">\n  <div class="association-header" ng-if="::$ctrl.enableRubricAssociation">\n    <div class="header-title-container row">\n      <div class="header-title" bb-translate>\n        components.directives.rubric.list.heading\n      </div>\n      <span aria-hidden="true" ng-if="$ctrl.shouldShowNewBadge">\n        <bb-new-feature-badge custom-badge-class="js-rubric-list-new-badge"></bb-new-feature-badge>\n      </span>\n    </div>\n    <div class="header-first-description" bb-translate>\n      components.directives.rubric.list.firstParagraphDescription\n    </div>\n    <div class="header-second-description-holder" ng-if="$ctrl.showCompleteDescription">\n      <div class="header-second-description" bb-translate>\n        components.directives.rubric.list.secondParagraphDescription\n      </div>\n      <a bb-translate-attrs="{\'href\': \'components.directives.rubric.list.linkHref\'}"\n         target="_blank"\n         rel="help"\n         analytics-id="components.directives.rubric.list.learnMoreLink"\n         bb-translate>\n         components.directives.rubric.list.learnMoreLink\n      </a>\n    </div>\n    <div class="toggleDescription">\n      <button class="button--text"\n              type="button"\n              ng-if="!$ctrl.showCompleteDescription"\n              aria-labelledby="rubric-list-show-description"\n              ng-click="$ctrl.toggleDescription()"\n              analytics-id="components.directives.rubric.list.showDescription.button">\n        <span id="rubric-list-show-description" bb-translate>components.directives.rubric.list.showMore</span>\n      </button>\n      <button class="button--text"\n              type="button"\n              ng-if="$ctrl.showCompleteDescription"\n              aria-labelledby="rubric-list-hide-description"\n              ng-click="$ctrl.toggleDescription()"\n              analytics-id="components.directives.rubric.list.hideDescription.button">\n        <span id="rubric-list-hide-description" bb-translate>components.directives.rubric.list.showLess</span>\n      </button>\n    </div>\n  </div>\n  <div class="row collapse js-rubric-create-button-wrapper hide-for-small-only" ng-if="$ctrl.editable">\n    <div class="columns medium-12 large-12">\n      <button class="button button--dashed -full-width rubric-create-button"\n              aria-labelledby="rubric-create-rubric-button"\n              bb-peek-sref="rubric.mode({mode: \'create\'})"\n              type="button"\n              bb-translate\n              analytics-id="components.directives.rubric.list.create.button"\n              ng-class="::$ctrl.enableRubricAssociation ? \'rubric-create-button-association\' : \'rubric-create-button-gradebook\'">\n        <span id="rubric-create-rubric-button" bb-translate>components.directives.rubric.list.create</span>\n      </button>\n    </div>\n  </div>\n\n  <div class="rubric-create-disabled-message" ng-show="!$ctrl.rubrics.length" bb-translate>\n    components.directives.rubric.list.createDisabled\n  </div>\n\n  <div class="rubric-view-message" ng-if="!$ctrl.hasViewAccess" bb-translate>\n    components.directives.rubric.settings.unavailable.view\n  </div>\n\n  <div ng-show="$ctrl.rubrics.length > 0">\n    <div ng-if="::!$ctrl.enableRubricAssociation" class="rubric-list-heading row" bb-translate>\n      components.directives.rubric.list.heading\n    </div>\n\n    <div class="list-container">\n      \x3c!-- Rubric Association --\x3e\n      <div ng-if="::$ctrl.enableRubricAssociation" ng-repeat="rubric in $ctrl.rubrics"\n           class="row element-list-row js-rubric-id-{{rubric.id}} association-enabled">\n        <div class="rubric-list-association-item">\n          <div class="item-left-side">\n            <div ng-if="$ctrl._rubricService.isPointsOrPointsRangeRubric(rubric)">\n              <span class="item-rubric-title"\n                    id="name-rubric-{{::rubric.id}}"\n                    title="{{ rubric.title }}"\n                    aria-hidden="true">\n                {{ rubric.title }}\n              </span>\n              <span class="item-rubric-type"\n                    id="possible-points-{{::rubric.id}}"\n                    aria-hidden="true"\n                    translate-values="{ points: {{$ctrl.getPointsRubricMaxScore(rubric)}} }"\n                    bb-translate>\n                    components.directives.rubric.list.pointsType\n              </span>\n              <div class="item-rubric-checkbox">\n                <input type="checkbox"\n                       id="rubric-list-checkbox-{{::rubric.id}}"\n                       name="rubric-list-checkbox-{{::rubric.id}}"\n                       aria-labelledby="name-rubric-{{::rubric.id}}"\n                       aria-describedby="possible-points-{{::rubric.id}} use-rubric-{{::rubric.id}}"\n                       ng-change="$ctrl.pointsCheckboxTrigger(rubric.id, checked)"\n                       ng-model="checked"\n                       analytics-id="components.directives.rubric.list.input.checkbox"/>\n                <label class="inline-form-label"\n                       id="use-rubric-{{::rubric.id}}"\n                       aria-hidden="true"\n                       for="rubric-list-checkbox-{{::rubric.id}}">\n                  <bb-translate>components.directives.rubric.list.pointsCheckbox</bb-translate>\n                </label>\n              </div>\n            </div>\n            <div ng-if="$ctrl._rubricService.isPercentageOrPercentageRangeRubric(rubric)">\n              <span class="item-rubric-title" title="{{ rubric.title }}" aria-hidden="true">\n                {{ rubric.title }}\n              </span>\n              <span class="item-rubric-type"\n                    aria-hidden="true"\n                    bb-translate>\n                    components.directives.rubric.list.percentageType\n              </span>\n            </div>\n          </div>\n          <div class="item-right-side">\n            <button class="button rubric-item-view-button button--text"\n                    bb-peek-sref="rubric.mode({rubricId: rubric.id, mode: \'edit\'})"\n                    type="button"\n                    aria-labelledby="rubric-add-button-{{rubric.id}}"\n                    analytics-id="components.directives.rubric.list.useRubric.button">\n              <span bb-translate>global.view</span>\n              <span class="sr-only"\n                    id="rubric-add-button-{{rubric.id}}"\n                    bb-translate\n                    translate-values="{title: rubric.title}">\n                    components.directives.rubric.list.viewRubric\n              </span>\n            </button>\n            <button class="button rubric-item-add-button button--text"\n                    type="button"\n                    ng-click="$ctrl.associateRubric(rubric)"\n                    aria-labelledby="rubric-view-button-{{rubric.id}}"\n                    analytics-id="components.directives.rubric.list.viewRubric.button">\n              <span bb-translate>components.directives.rubric.list.add</span>\n              <span class="sr-only"\n                    id="rubric-view-button-{{rubric.id}}"\n                    bb-translate\n                    translate-values="{title: rubric.title}">\n                    components.directives.rubric.list.useRubric\n              </span>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Gradebook Settings --\x3e\n      <div ng-if="::!$ctrl.enableRubricAssociation" ng-repeat="rubric in $ctrl.rubrics"\n           class="rubric-list-item row element-list-row js-rubric-id-{{rubric.id}}">\n\n        <button class="rubric-info-button button-anchor super-clear" bb-peek-sref="rubric.mode({rubricId: rubric.id, mode: \'edit\'})"\n                type="button" aria-labelledby="rubric-title-button-{{rubric.id}}" analytics-id="components.directives.rubric.list.viewRubric.button">\n          <div class="rubric-info">\n            <span class="rubric-icon" aria-hidden="true"\n                  bb-translate-attrs="{\'title\': \'components.directives.rubric.list.tooltip.edit\'}">\n              <bb-ui-icon-large-rubric color="primary"></bb-ui-icon-large-rubric>\n            </span>\n            <span class="rubric-title ellipsis" title="{{ rubric.title }}" aria-hidden="true">\n              {{ rubric.title }}\n            </span>\n            <span class="sr-only" id="rubric-title-button-{{rubric.id}}" bb-translate translate-values="{title: rubric.title}">components.directives.rubric.list.viewRubric</span>\n          </div>\n        </button>\n\n        <div bb-foundation-defer>\n          <bb-overflow-menu element-id="{{\'rubric-overflow-\' + rubric.id}}"\n                            menu-items="$ctrl.getOverflowMenuItems(rubric)"\n                            delete-options="$ctrl.getDeleteMenuOption(rubric)"\n                            ng-if="!$ctrl.course.isComplete()"\n                            analytics-id-tag-prefix="components.directives.rubric.list.overflowMenu">\n          </bb-overflow-menu>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},"367g":function(e,t,n){},"3Lzw":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-upload",use:"icon-medium-upload-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-upload"><path d="M12 1v14M1 7v16h22V7h-4M1 7h4-4zM8 5l4-4 4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"3l3z":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("nsO7"),o=n("lEL+"),a=n("5HCE");const r="ultra.components.directives.gradeGridMessageReborn";class c{constructor(e,t,n,s,o){this.window=e,this.scope=t,this.element=n,this.attrs=s,this.timeout=o,o(()=>{i.isUndefined(t.adjustPosition)||t.adjustPosition(n)},t)}mousedown(){e(this.window).trigger("click")}}c.$inject=["$window","scope","element","attrs",o.b];class l{constructor(e){this.$injector=e,this.restrict="A",this.template=a,this.link=(e,t,n)=>{e.gradeGridMessageReborn=this.$injector.instantiate(c,{scope:e,element:t,attrs:n})}}}l.$inject=["$injector"],s.module(r,[]).directive("bbGradeGridMessageReborn",["$injector",e=>e.instantiate(l)])}).call(this,n("5iHu"))},"3mUc":function(e,t){e.exports="<div\n  ng-class=\"{'validation-error' : showError()}\"\n  ng-transclude>\n</div>\n"},"5HCE":function(e,t){e.exports='<div role="alertdialog" aria-live="assertive">\n  <div class="validation-message-wrapper" tabindex="0">\n    <span bb-ax-alert="2000" class="validation-message" id="sr-message" bb-translate >components.directives.grade.validation.default</span>\n  </div>\n</div>'},"5Tom":function(e,t,n){"use strict";var s=n("D57K"),i=n("nYZ0"),o=n("fYJU"),a=n("0JpG"),r=n("TnpK"),c=n("0/Nk"),l=n("OI4n"),d=n("yC9S"),u=n("aHpC");n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return p}));const h="ultra.directives.group.group-student-enrollment";let p=class{constructor(e,t,n,s,i){this.scope=e,this.contentService=t,this.currentUserService=n,this.localize=s,this.ultraState=i,this.isSelfEnrollment=!1}$onInit(){this.render()}async render(){if(this.content.selfEnrollmentGroups&&this.content.selfEnrollmentGroups.length>0){const{locale:e,babelfishFormatter:t}=this.localize.getReactBabelfishParams(this.scope),n=this.content.selfEnrollmentGroups.filter(e=>e.group).map(e=>e.group);this.selfEnrollGroupInfo=await l.getSelfEnrollmentGroupInfo(n,e,t),this.isSelfEnrollment=this.selfEnrollGroupInfo.isSelfEnrollment}else this.isSelfEnrollment=!1}async openContentEnrollPanel(){this.fromView?this.ultraState.current.name.endsWith("discussion.view.with-grading.peek.discussion-details")?(await this.ultraState.leavePeekState(),await this.ultraState.leavePeekState(),await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id,fromView:this.fromView})):(await this.ultraState.leavePeekState(),await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id,fromView:this.fromView})):await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id})}isBeforeEnrollment(){return this.selfEnrollGroupInfo&&"Before"===this.selfEnrollGroupInfo.enrollmentDateState}isOpenEnrollment(){return this.selfEnrollGroupInfo&&"Open"===this.selfEnrollGroupInfo.enrollmentDateState}isOpenEnrollmentWithEnding(){return this.selfEnrollGroupInfo&&"Open"===this.selfEnrollGroupInfo.enrollmentDateState&&null!=this.selfEnrollGroupInfo.relativeDate}isAfterEnrollment(){return this.selfEnrollGroupInfo&&"After"===this.selfEnrollGroupInfo.enrollmentDateState}};p=Object(s.__decorate)([Object(d.a)({moduleName:h,componentName:"bbGroupStudentEnrollment",template:c,bindings:{content:"<",fromView:"@"},requireModules:[i.d,o.a,a.moduleName,r.b]}),Object(s.__param)(0,Object(u.b)("$scope")),Object(s.__param)(1,Object(u.b)(i.f)),Object(s.__param)(2,Object(u.b)(o.b)),Object(s.__param)(3,Object(u.b)(a.serviceName)),Object(s.__param)(4,Object(u.b)(r.d))],p)},"5m/6":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-filter-options",use:"icon-small-filter-options-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-filter-options"><path d="M1 1h8M1 5h8M1 9h8M1 13h5M13 1v14M11 13l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"5uNO":function(e,t,n){},"5vTq":function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell student-column">\n  <div class="grade-grid-cell-controls"\n       ng-click="gradeGridColumnStudentReborn.popupMenu($event, user)"\n       role="button"\n       analytics-id="components.directives.grade.grid.student">\n  </div>\n  <div class="student-info">\n    <bb-user-avatar class="avatar"\n                    user="user"\n                    ng-click="gradeGridColumnStudentReborn.popupMenu($event, user)"\n                    analytics-id="components.directives.grade.grid.studentAvatar">\n    </bb-user-avatar>\n    <div class="name-and-groups">\n      <bb-username class="ellipse username" user="user" auto-update="true" format-sync="true" show-pronouns="true" show-pronunciation="true" ng-class="{ inactive: !isUserCourseAvailable }"></bb-username>\n      <bb-filtered-users-groups\n        class="group-names"\n        user-id="user.id">\n      </bb-filtered-users-groups>\n    </div>\n  </div>\n</div>\n'},"66CI":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-lock-circle",use:"icon-small-lock-circle-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-lock-circle"><g stroke-width="2"><circle cx="8" cy="8" r="7" transform="rotate(-90 8 8)" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 8h6v3H5V8z" stroke-linecap="round" stroke-linejoin="round" /><path d="M6 9h4v1H6z" /><path d="M6 8V5.7143C6 4.857 6.6667 4 8 4m0 0c.3333 0-.3333 0 0 0zm0 0c1.3333 0 2 .8571 2 1.7143V8" stroke-linecap="round" stroke-linejoin="round" /></g></symbol>'});i.add(o);e.exports=o},"6CeR":function(e,t){e.exports='<div id="grade-grid-container" class="grade-grid-container">\n  <div class="spinner bb-secondary-color-2" ng-if="!gg.initialized" aria-hidden="true"></div>\n  <div class="overall-grade-setup grade-search-filter-panel student-column" ng-if="gg.showFilterCriteria">\n      <bb-grade-grid-search-filter-reborn merged-courses="::gg.mergedCourses"></bb-grade-grid-search-filter-reborn>\n  </div>\n\n  <div id="grade-grid" bb-grid-reborn="gg.gridOptions"></div>\n  <div class="overall-grade-setup text-center" ng-if="gg.isOverallPanelShown && gg.canViewOverallPanel">\n    <bb-setup-overall-grade show-fixed-view="gg.canViewOverallPanel" course-id="course().id" setup-overall-grade-hide-message-callback="gg.setupOverallGradeHideMessageCallback()"></bb-setup-overall-grade>\n  </div>\n</div>\n'},"6Fqm":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-search",use:"icon-small-search-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-search"><circle cx="6.5" cy="6.5" r="5.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M15 15l-4.5-4.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"6PP7":function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown" role="menu">\n    <li ng-if="col.isScorm()" role="presentation">\n      <a role="menuitem"\n         ng-click="col.previewScorm()"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.viewScorm">\n        <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.viewScorm</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canView() && !col.canEdit() && !col.isScorm()" role="presentation">\n      <a role="menuitem"\n          ng-click="col.viewOrEdit()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.viewItem">\n        <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.viewItem</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canEdit()" role="presentation">\n      <a  role="menuitem"\n          class="js-edit-column"\n          ng-click="col.viewOrEdit()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.edit">\n        <bb-svg-icon size="small" icon="draw"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.edit</bb-translate>\n      </a>\n    </li>\n    <li ng-if="canPostGrades" role="presentation">\n      <a  role="menuitem"\n          class="js-post-column"\n          ng-click="col.postGrades()"\n          href="javascript:void(0);"\n          bb-confirmation-needed="{{grade.getPostAllGradeConfirmationNeededStringsKey(col.data)}}"\n          modal-aria-type="alertdialog"\n          show-type="always"\n          analytics-id="components.directives.grade.grid.post">\n        <bb-svg-icon size="small" icon="post"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.post</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.data.isQuestionAnalysisAvailable() && col.canViewQuestionAnalysis()"\n        remove-from-dom="true"\n        role="presentation">\n      <a  role="menuitem"\n          class="js-open-question-analysis"\n          ng-click="col.openQuestionAnalysisOverview()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.openQuestionAnalysis">\n        <bb-svg-icon size="small" icon="question-analysis"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.openQuestionAnalysis</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.showDownloadResults()" role="presentation">\n      <a role="menuitem"\n          class="js-download-results"\n          ng-click="col.openDownloadTestResultsPanel()"\n          href="javascript:void(0)"\n          analytics-id="components.directives.grade.grid.downloadResults">\n        <bb-ui-icon-small-download></bb-ui-icon-small-download>\n        <bb-translate class="ellipse">components.directives.grade.grader-column.downloadResults.overflowMenuLabel</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.hasDownloads() && col.canDownloadAll()" role="presentation">\n      <a role="menuitem"\n          class="js-download-all"\n          ng-click="col.openDownloadAll()"\n          href="javascript:void(0)"\n          analytics-id="components.directives.grade.grid.downloadAll">\n        <bb-ui-icon-small-download-file></bb-ui-icon-small-download-file>\n        <bb-translate class="ellipse">components.directives.grade.grid.downloadSubmissions</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canDelete()" role="presentation">\n      <a class="js-delete-column"\n         href="javascript:void(0);"\n         ng-click="col.triggerDelete($event)"\n         ng-switch="!!col.data.contentId"\n         analytics-id="components.directives.grade.grid.deleteColumn.link"\n         role="button">\n        \x3c!-- Content column --\x3e\n        <bb-delete callback-function="col.deleteColumn()"\n                   class="ellipse"\n                   content-id="col.data.contentId"\n                   course-id="col.data.courseId"\n                   display-mode="controls"\n                   ng-switch-when="true"\n                   role="menuitem">\n        </bb-delete>\n        \x3c!-- Grading column --\x3e\n        <bb-delete class="ellipse"\n                   confirmation-handler="{{col.getConfirmationMessage()}}"\n                   delete-function="col.deleteColumn()"\n                   display-mode="controls"\n                   ng-switch-when="false"\n                   role="menuitem">\n        </bb-delete>\n      </a>\n    </li>\n  </ul>\n</div>\n'},"6ZXc":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-download",use:"icon-medium-download-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-download"><path d="M12 15V1M8 11l4 4 4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 7v16h22V7h-4M1 7h4-4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"6sUD":function(e,t){e.exports='<div>\n  \x3c!-- Display a loading spinner if page is rendering --\x3e\n  <div class="telemetry-loading-anim" ng-if="telemetryPanelHeader.showSpinner">\n    <div class="spinner bb-secondary-color-2"/>\n  </div>\n  <header class="panel-header simple-header">\n    <div class="panel-titles-container">\n      <div class="panel-sub-title">{{ ::course().name }}</div>\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background"\n                type="button"\n                analytics-id="components.directives.telemetry.panel.menu.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>components.directives.telemetry.panel.menu</span>\n        </button>\n        <h1 class="panel-title" ng-if="::titleKey" bb-translate>{{::titleKey}}</h1>\n        <h1 class="panel-title" ng-if="title">{{::title}}</h1>\n        \x3c!-- BUTTON 2 (displayed to the left of Button 1) --\x3e\n        <button ng-if="buttonTwoIcon" id="button-two"\n                aria-haspopup="true"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonTwoAriaLabel,\'title\': buttonTwoTitle}"\n                ng-click="buttonTwoCallback()"\n                ng-class="{ \'active\': mobileStudentListVisible }"\n                analytics-id="components.directives.telemetry.panel.buttonwTwo.button">\n          <i class="{{ ::buttonTwoIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonTwoTitle</span>\n        </button>\n        \x3c!-- BUTTON 1 (displayed on the far right) --\x3e\n        <button ng-if="buttonOneIcon"\n                id="button-one"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonOneAriaLabel,\'title\': buttonOneTitle}"\n                ng-click="buttonOneCallback()"\n                analytics-id="components.directives.telemetry.panel.buttonOne.button">\n          <i class="{{ ::buttonOneIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonOneTitle</span>\n        </button>\n      </div>\n    </div>\n  </header>\n</div>\n'},"6xt4":function(e,t){e.exports='<div id="{{::addContentButton.getButtonWrapperId()}}" tabindex="-1">\n  <button\n    id="{{::addContentButton.getTargetId()}}"\n    class="button-add-content js-show-add-options"\n    data-show-add-options\n    ng-click="addContentButton.toggleOverflowMenu()"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-haspopup="true"\n    aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    analytics-id="components.directives.add-content-button.course-outline.addContentMenu.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible && !addContentButton.isEmptyFolder()"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  aria-labelledby="{{::addContentButton.getTargetId()}}"\n  analytics-id="components.directives.add-content-button.contextualMenu">\n</bb-ui-contextual-menu>\n<ul class="element-list-add-menu angular-animate small-block-grid-2 medium-block-grid-2"\n    ng-class="!addContentButton.isOneDriveAvailable ? \'large-block-grid-3\' : \'large-block-grid-4\'"\n    ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n    ng-show="addContentButton.isEmptyFolder()">\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-create"\n       bb-peek-sref="content-manage.create(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.link">\n      <div>\n        <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.create</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.currentCourse.canCopy() && addContentButton.isEmptyFolder()">\n    <a class="content-import-button"\n       bb-peek-sref="content-manage.copy(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.import.link">\n      <div>\n        <bb-svg-icon size="small" icon="duplicate"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.copy</span>\n      </div>\n    </a>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      is-content="true"\n      primary-key="fileListViewLocalId"\n      skip-zip-file-check="true"\n      class="js-file-upload"\n      depth="depth()">\n      <button ng-if="addContentButton.isEmptyFolder()"\n              class="file-upload-button"\n              analytics-id="components.directives.add-content-button.course-outline.upload.button">\n        <div>\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n          <span bb-translate>components.directives.add-content-button.upload</span>\n        </div>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="true"\n      monitor-leave="true"\n      is-third-party-upload="true"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      cloud-upload-selected-content-id="addContentButton.positionForFiles.positionAfter"\n      primary-key="fileListViewId"\n      skip-zip-file-check="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      target-div="{{\'#\' + fileListViewId}}"\n      disable-drag="true"\n      ignored-states="[\'content-manage.import\']">\n      <button\n        class="doc-add-media clear ng-scope"\n        bb-cloud-storage-integration\n        primary-key="fileListViewId"\n        attach-handler="addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="true"\n        on-files-selected="addContentButton.onFilesSelectedHandler"\n        analytics-id="components.directives.add-content-button.course-outline.importContentFromCloudStorage.button">\n        <bb-svg-icon size="small" icon="upload-cloud"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isOneDriveAvailable && addContentButton.isEmptyFolder()">\n    <a class="js-one-drive-link"\n       href="javascript:void(0);"\n       ng-click="addContentButton.openOneDriveFilePicker()"\n       analytics-id="components.directives.add-content-button.course-outline.openFromOneDrive.link">\n       <div>\n        <bb-ui-icon-small-one-drive class="bb-ui-icon-folder"></bb-ui-icon-small-one-drive>\n        <span bb-translate>components.directives.add-content-button.openFromOneDrive</span>\n       </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-market"\n       href="javascript:void(0);"\n       ng-click="addContentButton.openContentMarket()"\n       analytics-id="components.directives.add-content-button.course-outline.openContentMarket.link">\n      <div>\n        <bb-ui-icon-small-content-market class="bb-ui-icon-folder"></bb-ui-icon-small-content-market>\n        <span bb-translate>components.directives.add-content-button.contentMarket</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-collection"\n       bb-peek-sref="content-collection(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.contentCollection.link">\n      <div>\n        <bb-svg-icon size="small" icon="content-collection"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.contentCollection</span>\n      </div>\n    </a>\n  </li>\n</ul>\n'},"7OC/":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var s=n("Llzl"),i=n("LN5R"),o=n("o5Lu"),a=n("lEL+"),r=n("TmUJ"),c=n("dF44"),l=n("+4Px"),d=n("qH3X"),u=n("8NsT"),h=n("6PP7"),p=n("LTOG");const m="ultra.components.directives.gradeGridColumnHeaderOverallReborn";class b extends p.a{constructor(t,n,s,i,o,a,r,u){super(n,u),this.rootScope=t,this.element=s,this.attrs=i,this.$compile=o,this.gradeGridRebornController=a,this.grade=r,this.canPostGrades=!1,this.initializeEventHandler(),this.menuScope=n.$new(!0),n.$watch("col",e=>{n.columnMetadata=e.data,this.col=e,this.highlight(this.col),this.canPostGrades=this.grade.canPostGrades(e.gridData.course,e.data)}),n.$on(c.b.CELL_FOCUSED,()=>{s.find(".content").focus()}),s.find(".content").on("keydown",t=>{if(t.keyCode===l.g)this.scope.$emit(c.b.LEAVE_GRID);else{if(!l.y(t))return;e(t.target).click()}t.preventDefault(),t.stopPropagation()}),s.find(".content").on("keyup",e=>{l.y(e)&&(e.preventDefault(),e.stopPropagation())}),n.$on(d.a.FOCUSIN_CELL,(e,t)=>{t.columnId===this.col.id&&(this.gradeGridRebornController.getElement().find(".is-active").removeClass("is-active"),this.element.find(".content").addClass("is-active"))}),n.$on(d.a.FOCUSOUT_CELL,(e,t)=>{t.columnId===this.col.id&&this.element.find(".content").removeClass("is-active")})}initializeEventHandler(){this.element.find(".content-header-bg").focusin(()=>{this.focusin()}).focusout(()=>{this.focusout()})}focusin(){this.rootScope.$broadcast(d.a.FOCUSIN_CELL,{columnId:this.col.id})}focusout(){this.rootScope.$broadcast(d.a.FOCUSOUT_CELL,{columnId:this.col.id})}get possible(){return 100}popupMenu(t){const n=`grade-grid-column-header-menu-reborn-${this.col.id}`;if(!this.gradeGridRebornController.isMenuExisting(n)){const s=e(t.target).closest(".grade-grid-header-cell").offset();s.top+=87,this.menuScope.col=this.col,this.menuScope.grade=this.grade,this.menuScope.autoDestroy=!1,this.menuScope.adjustPosition=e=>{const t=s.left+e.width(),n=this.gradeGridRebornController.getGradeGridContainerElementRight();t>n&&(s.left-=t-n+Object(r.a)()),e.offset(s)},this.gradeGridRebornController.popupMenu(n,h,this.menuScope),this.timeout(()=>{const e=this.gradeGridRebornController.getPopupMenu();e.on("keydown",t=>{t.keyCode===l.g||t.keyCode===l.u?(e.data("destroy")(),this.scope.$emit(c.b.CELL_FOCUSED),t.preventDefault(),t.stopPropagation()):l.y(t)&&this.scope.$emit(c.b.CELL_FOCUSED)}),this.gradeGridRebornController.getMenuitems().first().focus()},this.menuScope,0,!1),t.preventDefault(),t.stopPropagation()}}}b.$inject=["$rootScope","scope","element","attrs","$compile","gradeGridRebornController",o.i,a.b];class g{constructor(e){this.$injector=e,this.restrict="E",this.template=u,this.scope=!0,this.require=`^${i.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnHeaderOverallReborn=this.$injector.instantiate(b,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}g.$inject=["$injector"],s.module(m,[]).directive("bbGradeGridColumnHeaderOverallReborn",["$injector",e=>e.instantiate(g)])}).call(this,n("5iHu"))},"7UH7":function(e,t){e.exports='<div class="text-editor" tabindex="-1" bb-load-bundle="components/directives/text-editor" bb-cache-compilation="basic-text-editor">\n  <label ng-if="inputLabelKey" class="text-editor-label" for="{{::elementId}}" bb-translate>{{::inputLabelKey}}</label>\n  <textarea id="{{::elementId}}"\n         class="read-mode editor-element"\n         name="{{::elementId}}"\n         tabindex="0"\n         type="text"\n         bb-validate-maxlength="{{::getInputMaxLength()}}"\n         ng-model="ngModel"\n         maxlength="{{::(getInputMaxLength() || \'\')}}"\n         ng-model-options="{ getterSetter: true }"\n         ng-disabled="readonly()"\n         fng-blur="textEditor.onBlur()"\n         fng-focus="textEditor.onFocus()"\n         fng-keyup="textEditor.onChange($event)"\n         fng-keydown="textEditor.onKeydown($event)"\n         bb-translate-attrs="{ \'placeholder\': \'{{placeholderKey}}\' }"\n         aria-label="{{textEditor.getContentLabel()}}"\n         translate-attrs-values="{{::placeholderAttrsValues}}"\n         bb-focus-on="{{::focusOn}}"\n         ng-required="::fieldRequired()"\n         analytics-id="components.textEditor.basicEditor.textarea"></textarea>\n  <div bb-validation-messages\n       ng-if="::!noValidationMessage()"\n       for="{{::elementId}}" immediate="true">\n    <span ng-message="maxlengthImmediate">\n      <span bb-translate translate-values="{ diff: element.$errorImmediate.maxlengthImmediate.diff }">\n        components.directives.validation.messages.errors.maxlength.plural\n      </span>\n    </span>\n  </div>\n</div>\n'},"7XaY":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-export",use:"icon-small-export-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-export"><path d="M7 9l8-8M12 1h3v3M15 9.091V15H1V1h5.909" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"8+lX":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-replies",use:"icon-small-replies-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-replies"><path d="M1 5h14v10H1v-4" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 3L1 5l2 2" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"810X":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var s=n("Llzl"),i=n("LN5R"),o=n("pjml"),a=n("0JpG"),r=n("lEL+"),c=n("+4Px"),l=n("dF44"),d=n("5vTq"),u=n("kkz3"),h=n("moHC");const p="ultra.components.directives.gradeGridColumnStudentReborn";class m{constructor(e,t,n,s,i,o){this.scope=e,this.element=t,this.attrs=n,this.gradeGridRebornController=s,this.bbLocalize=i,this.timeout=o,e.$watch("row",t=>{const n=s.getGridData().getRowById(t.id).metadata;e.user=n.user,e.fullName=this.bbLocalize.formatUsernameSync(e.user,a.ILocaleUsernameFormat.Short,e,{noWrap:!0}),e.isUserCourseAvailable=n.isAvailable,e.courseRole=this.getLocalizedRoleNameByCourseRole(n.courseRole)}),this.isRtl=this.bbLocalize.isRTL(),e.$on(l.b.ENTER_CELL,(e,t)=>{t.find("bb-username").click()})}popupMenu(t,n){const s=`grade-grid-column-student-card-reborn-${n.id}`;if(!this.gradeGridRebornController.isMenuExisting(s)){const n=e(t.target).closest(".grade-grid-cell").offset(),i=60;n.top+=20;const o=this.scope.$new(!1);o.waiting=200,o.adjustPosition=e=>{const t=n.top+e.height(),s=n.left+e.width(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom(),a=this.gradeGridRebornController.getGradeGridContainerElementRight();t>o&&(n.top-=i),s>a&&this.isRtl?n.left=a-e.width()-i:n.left+=30,e.offset(n)},this.gradeGridRebornController.popupMenu(s,u,o),this.timeout(()=>{const t=e(`#${s}`);t.on("keydown",e=>{e.keyCode!==c.g&&e.keyCode!==c.u||(t.data("destroy")(),e.preventDefault(),e.stopPropagation())}),o.$on("$destroy",()=>this.scope.$emit(l.b.LEAVE_CELL)),t.focus()},o,0,!1),t.preventDefault(),t.stopPropagation()}}getLocalizedRoleNameByCourseRole(e){return e.identifier&&e.identifier.toString()in o.w.toBeLocalizedRoleLabels?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:o.w.toBeLocalizedRoleLabels[e.identifier.toString()]}):e.courseName.rawValue}}m.$inject=["scope","element","attrs","gradeGridRebornController",a.serviceName,r.b];class b{constructor(e){this.$injector=e,this.restrict="E",this.template=d,this.scope=!0,this.require=`^${i.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnStudentReborn=this.$injector.instantiate(m,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}b.$inject=["$injector"],s.module(p,[h.a]).directive("bbGradeGridColumnStudentReborn",["$injector",e=>e.instantiate(b)])}).call(this,n("5iHu"))},"85nY":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-conversation",use:"icon-small-conversation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-conversation"><path d="M15 4.5C15 6.433 13.433 8 11.5 8c-.4457 0-.872-.0833-1.264-.2352L8 8l.25-2.1985A3.4905 3.4905 0 018 4.5C8 2.567 9.567 1 11.5 1S15 2.567 15 4.5zM7 15c0-2-2-4-4-4M3 11c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"884J":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("+1SJ");const o="ultra.components.directives.bbUiIcon.small.Upload";Object(s.a)(i.a,o,"bbUiIconSmallUpload")},"8MYS":function(e,t,n){"use strict";var s=n("D57K"),i=(n("xoIb"),n("6BRP"),n("XSys"),n("nsO7")),o=n("Llzl"),a=n("wgY5"),r=n("z6Q5"),c=n("0JpG"),l=n("vhkR"),d=n("IWgv"),u=n("Fvsw"),h=n("dJ97"),p=n("ap1t"),m=n("Sa5G"),b=n("f4B+"),g=n("o5Lu"),v=n("P2dS"),f=n("pjml"),C=n("A0nf"),y=n("8jzW"),w=n("TnpK"),S=n("x8kk"),I=n("fYJU"),O=n("nsX6"),E=n("ERkP"),D=n("SToD"),k=n("1ZbL"),$=n("tN4z"),L=n("0x+l"),R=n("nmzr");const j="ultra.directives.grade.sendMessageButton";const T={Class:Object(D.a)(e=>{const{analyticsIdTagPrefix:t,courseId:n,recipientIds:s,localize:i}=e;return E.createElement($.AnalyticsOutlineButton,{analyticsId:`${t}.sendMessage.button`,startIcon:E.createElement(L.Messages,null),href:"#",style:{textDecoration:"none"},onClick:()=>{!function(e,t){R.router.goPeekState(Object(R.sendMessageRequest)({courseId:e,recipientIds:t}))}(n,s)}},i.translate("components.directives.grade.course-grades-student.message.sendMessage"))}),attributes:["analyticsIdTagPrefix"],bindingNames:["courseId","recipientIds"],renderLocalized:!0,withProvider:!0};o.module(j,[]).component("bbSendMessageButtonComponent",Object(k.a)(T));var x=n("JNtI"),G=n("zisU"),A=n("aHpC"),_=n("JfV0"),M=n("zGdY"),P=n("nYZ0"),B=n("R4kC"),N=n("gkef"),F=n("hFzC"),z=n("kmeh"),U=n("yC9S"),V=n("pqmn"),H=n("uFkY"),q=n("ZQFV");n.d(t,"a",(function(){return K}));const K="ultra.directives.grade.courseGradesStudent";let W=class{constructor(e,t,n,s,o,a,r,c,l,d,u,h,p,m,b,v,f){this.scope=e,this.attrs=t,this.$q=n,this.$modal=s,this.grade=o,this.categoryService=a,this.context=r,this.scoreProviderHelper=c,this.batchApi=l,this.bbLocalize=d,this.ltiService=u,this.ultraState=h,this.contextUser=p,this.userModel=m,this.contentService=b,this.windowSizeService=v,this.submissionList=f,this.gradesLoaded=!1,this.itemDescriptionLabelMap={},this.resolveCurrentUser=e=>e||this.currentUser?!this.currentUser||e&&this.currentUser.id!==e?this.userModel.$new(e).$fetch().$asPromise().then(e=>(this.currentUser=e,e)):this.$q.when(this.currentUser):(this.currentUser=this.contextUser.userModel,this.$q.when(this.currentUser)),this.init=()=>this.resolveCurrentUser(this.scope.$eval(this.attrs.userId)).then(e=>{const t=this.isUserStudent;return this.$q.all([this.grade.loadCurrentColumnsAndGrades(null,null,t,C.a.Scorm,e.id),this.categoryService.getOrLoadCategoriesForCourse(this.scope.course.model.id),this.scope.course.model.isToolAvailable("bb-attendance")])}).then(e=>{const t=this.filterVisibleColumns(e[0]),n=e[1];this.setGrades(t,n),this.hasGrades=this.userGrades.length>0,this.gradesLoaded=!0,this.isAttendanceEnabled=e[2],this.populateLabelMaps(t),this.filterColumnName()}),this.init(),this.isUserStudent="true"===this.attrs.isUserStudent,this.scope.$on("bb-assessment-attempt-save",(e,t,n,s=!1)=>{const o=i.findIndex(this.userGrades,e=>e.column.id===n),a=this.userGrades[o].column;this.init().then(()=>{this.scope.courseGrades.course.gradebook.columns.$new(a.id).grades.$fetch({userId:this.currentUser.id}).$then(e=>{const n=e[0];t?(s?n.ui.groupAttempt=n.ui.attempt=t:n.ui.attempt=t,n.column=a,this.userGrades[o]=n):(n.column=a,this.grade.loadAttempt(n,this.scope.courseGrades.course).then(e=>{this.userGrades[o]=e}))},e=>{console.error(e.$response.data.message),e.$response.status=null})})}),this.scope.$on(S.c,()=>{this.init()}),Object(H.d)(this.scope,(e,t,n)=>{var s;for(let e=0;e<this.userGrades.length;e++){const i=null===(s=this.userGrades[e].attempts)||void 0===s?void 0:s.find(e=>e.id===n.id);if(i){i.feedbackToUser=t;break}}}),this.scope.$on(H.a,(e,t,n,s,i)=>{for(let e=0;e<this.userGrades.length;e++)if(this.userGrades[e].id===i.id){this.userGrades[e].instructorFeedback=i.instructorFeedback;break}}),U.b.OnRootScope(this.scope,g.b,()=>{this.init()}),U.b.OnRootScope(this.scope,g.a,()=>{this.init()}),this.isUserStudent?this.targetMembership=this.scope.course.membership:this.submissionList.fetchMembership(this.scope.course.model,this.ultraState.params.membershipId).then(e=>{this.targetMembership=e})}filterColumnName(){this.userGrades.forEach(e=>{e.column.localizedColumnName&&(e.column.localizedColumnName.languageKey=b.a.HTML(e.column.localizedColumnName.languageKey))})}filterVisibleColumns(e){return e.filter(e=>e.column.visibleInBook)}sort(e){let t=i.remove(e,e=>null!=e.column.dueDate),n=i.remove(e,e=>M.CalculationType.NonCalculated!==e.column.calculationType),s=e;return t=t.sort((e,t)=>e.column.dueDate.getTime()-t.column.dueDate.getTime()),n=n.sort((e,t)=>e.column.columnName.localeCompare(t.column.columnName)),s=s.sort((e,t)=>e.column.columnName.localeCompare(t.column.columnName)),t.concat(s).concat(n)}setGrades(e,t){if(this.externalGrade=i.remove(e,e=>e.column.externalGrade)[0],this.externalGrade){const e=this.externalGrade.column.calculatedFormula,t=Object(q.parseMathMLFormula)(e);this.isRunningTotal=t.running}e.forEach(e=>{for(let n=0;n<t.length;n++){const s=t[n];if(s.id===e.column.gradebookCategoryId){e.column.categoryTitle=s.title;break}}}),this.userGrades=e}populateLabelMaps(e){const t=this.bbLocalize.loadBundle("components/directives/grade/course-grades-student"),n=[],s=i.filter(e,e=>e.hasAttempts()&&e.column.seemsAttemptBased()&&!e.column.isDiscussion());s.length>0&&this.batchApi.performBatch(()=>{s.forEach(e=>{const t=e.column.grades.$buildRaw(e).attempts.$fetch().$asPromise().then(t=>{e.attempts=t});n.push(t)})}),n.push(t),this.$q.all(n).then(()=>{e.forEach(e=>{const t=e.column.id;this.itemDescriptionLabelMap[t]=this.getItemDescriptionLabel(e)})})}isActionable(e){return this.isUserStudent?this.isActionableForStudent(e):this.isActionableForInstructor(e)}isActionableForStudent(e){return!e.column.restricted&&(e.column.seemsAttemptBased()||e.column.isOffline()||this.isAttendanceEnabled&&e.column.isAttendance())}isActionableForInstructor(e){if(!this.isActionableForStudent(e))return!1;if(!e.column.delegatedGrading)return!0;return e.column.isUserReconciler(this.contextUser.userId)||e.isSubmitted()}launchLti(e){this.ltiService.ltiLaunch({courseId:e.column.courseId,contentId:e.column.contentId,linkType:m.f.parse(e.column.scoreProviderHandle.toString()),linkRefId:e.column.linkId,gradeDetail:e})}showAnonymouslyGradedItemErrorModal(){this.$modal.open({template:z,scope:this.scope})}getOverflowMenuItems(){return[{icon:"accommodations",labelKey:"components.directives.grade.course-grades-student.accommodation.accommodations",show:()=>{var e,t;return(null===(e=this.targetMembership)||void 0===e?void 0:e.permissions.editDueDateException)||(null===(t=this.targetMembership)||void 0===t?void 0:t.permissions.editTimeLimitException)},onClick:()=>this.ultraState.goPeekState(R.CourseRoutes.ACCOMMODATION,{membershipId:this.ultraState.params.membershipId})},{icon:"messages",labelKey:"components.directives.grade.course-grades-student.message.sendMessage",show:()=>{var e;return(null===(e=this.targetMembership)||void 0===e?void 0:e.isAvailable)&&this.windowSizeService.isSmallBreakpoint()},onClick:()=>this.ultraState.goPeekState(R.CourseRoutes.COURSE_MESSAGE,Object(R.sendMessageRequest)({courseId:this.scope.course.model.id,recipientIds:this.currentUser.id}).getArgs())}]}getShortFormatUsername(e){return this.bbLocalize.formatUsernameSync(e,c.ILocaleUsernameFormat.Short,this.scope,{noWrap:!0})}showOverallGradeVisibilityInformation(){var e,t;return!this.isUserStudent&&!(null===(t=null===(e=this.externalGrade)||void 0===e?void 0:e.column.isVisibleToStudents())||void 0===t||t)}openItem(e){const t=e.column.scoreProviderHandle;if(!t||this.scoreProviderHelper.supportsOverall(t))if(this.scoreProviderHelper.supportsExternalEdit(t))this.launchLti(e);else{const t=e.column;t.seemsAttemptBased()||t.isAttendance()?this.goToCurrentUserViewStateRef(e):this.ultraState.goPeekState(R.GradeRoutes.GRADE_AND_FEEDBACK,{courseId:t.courseId,columnId:t.id,userId:this.currentUser.id})}}goToCurrentUserViewStateRef(e){const t=e.column;return this.isUserStudent?this.$q.when(this.gotoStudentViewStateRef({columnId:t.id,courseId:t.courseId,contentId:t.contentId},e)):this.goToInstructorViewStateRef(e)}gotoStudentViewStateRef(e,t){t.column.isCollectExternalSubmissions()&&(t.ui.attempt?(e.state=R.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW,e.attemptId=t.ui.attempt.groupAttemptId?t.ui.attempt.groupAttemptId:t.ui.attempt.id,e.skipTransitionEvents=!0):e.state=R.AssessmentRoutes.ASSESSMENT_EXTERNAL_OVERVIEW),this.scoreProviderHelper.studentViewStateRef(t.column.scoreProviderHandle,e,y.a.GoToState)}attachContentToGrade(e){var t,n,s,i,o;if(!(null===(t=null==e?void 0:e.column)||void 0===t?void 0:t.contentId)||(null===(s=null===(n=null==e?void 0:e.column)||void 0===n?void 0:n.ui)||void 0===s?void 0:s.content))return this.$q.when();const a=this.contentService.findRootNode(this.context.course.model,V.a.ROOT).findInTreeById(null===(i=null==e?void 0:e.column)||void 0===i?void 0:i.contentId);return a?(e.column.ui.content=a,this.$q.when()):this.scope.course.model.contents.$find(null===(o=null==e?void 0:e.column)||void 0===o?void 0:o.contentId).$asPromise().then(t=>{e.column.ui.content=t},t=>{var n;console.error(`Unable to load course content for ${null===(n=null==e?void 0:e.column)||void 0===n?void 0:n.contentId}`,t)})}goToInstructorViewStateRef(e){if(e.column.anonymousGrading)return this.showAnonymouslyGradedItemErrorModal();const t=this.ultraState.params.membershipId;return this.resolveCurrentUser().then(()=>e.column.isAttendance()?null:this.$q.all([Object(_.fetchGroupsByContentId)({contentId:e.column.contentId,courseId:this.scope.course.model.id,expand:"memberships"}),this.attachContentToGrade(e)])).then(n=>{var s;const o=null==n?void 0:n[0],{column:a,attempts:r}=e,c=null==o?void 0:o.groups,l={columnId:a.id,contentId:a.contentId,courseId:this.scope.course.model.id,gradeId:e.id,userId:this.currentUser.id,membershipId:t},d=a.isDiscussion();d&&(l.participantId=this.currentUser.id);const u=r.length>a.multipleAttempts;if(a.isSingleAttempt()&&!u&&(l.attemptId=e.lastAttemptId),!i.isEmpty(c)){const e=null===(s=Object.keys(c).map(e=>c[e].memberships).reduce((e,t)=>e.concat(t),[]).find(e=>e.userId===this.currentUser.id))||void 0===s?void 0:s.groupId;l.groupId=e,d&&(l.disGroupId=e)}return a.isAttendance()&&(l.memberId=e.memberId,l.isSingleUserView=!0),this.scoreProviderHelper.gradingStateRef(a,e,l,y.a.GoToState)})}getCourseName(){var e;return(null===(e=this.scope.courseGrades)||void 0===e?void 0:e.course)?this.scope.courseGrades.course.displayName:""}getStatusKey(e){return this.isUserStudent?this.getStudentStatusKey(e):this.getInstructorStatusKey(e)}getStudentStatusKey(e){if(e.column.seemsAttemptBased())return e.isPastDueZero()?"components.directives.grade.course-grades-student.statusColumn.student.pastDue":M.ManualGradeStatus.IsPosted===e.manualStatus?"components.directives.grade.course-grades-student.statusColumn.student.graded":e.hasAttempts()?M.AttemptStatus.InProgress===e.ui.attempt.status?"components.directives.grade.course-grades-student.statusColumn.draftSaved":M.AttemptStatus.NeedsGrading===e.ui.attempt.status?"components.directives.grade.course-grades-student.statusColumn.student.submitted":"components.directives.grade.course-grades-student.statusColumn.student.graded":e.column.isCollectExternalSubmissions()?"components.directives.grade.course-grades-student.statusColumn.student.notSubmitted":"components.directives.grade.course-grades-student.statusColumn.student.unopened"}getInstructorStatusKey(e){var t;if(e.column.seemsAttemptBased())return e.column.anonymousGrading?"components.directives.grade.course-grades-student.statusColumn.instructor.anonymous":M.ManualGradeStatus.IsPosted!==e.manualStatus||e.isPastDueZero()?e.hasAttempts()?M.AttemptStatus.InProgress===e.ui.attempt.status?"components.directives.grade.course-grades-student.statusColumn.draftSaved":(null===(t=e.attempts)||void 0===t?void 0:t.getNumAttemptsToReconcile())>0&&e.column.isUserReconciler(this.contextUser.userId)?"components.directives.grade.course-grades-student.statusColumn.instructor.reconcile":e.isReadyToPost()?"components.directives.grade.course-grades-student.statusColumn.instructor.needsPost":M.AttemptStatus.NeedsGrading===e.ui.attempt.status?"components.directives.grade.course-grades-student.statusColumn.instructor.needsGrading":"components.directives.grade.course-grades-student.statusColumn.instructor.completed":"components.directives.grade.course-grades-student.statusColumn.instructor.noSubmission":"components.directives.grade.course-grades-student.statusColumn.instructor.completed"}getItemDescriptionLabel(e){const t=this.isLate(e);if(e.column.isCollectExternalSubmissions())return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.externalSubmissionLate":"components.directives.grade.course-grades-student.itemDescription.externalSubmission",noWrap:!0});if(e.column.isDiscussion()){const n=this.firstParticipationDate(e);return n?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.discussions.firstParticipationLate":"components.directives.grade.course-grades-student.itemDescription.discussions.firstParticipation",params:{date:n},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.discussions.noParticipationLate":"components.directives.grade.course-grades-student.itemDescription.discussions.noParticipation"})}if(e.column.seemsAttemptBased())if(e.column.isSingleAttempt()){if(t)return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.course-grades-student.itemDescription.single.late",noWrap:!0})}else{if(e.column.isUnlimitedAttempts()){const n=e.attempts.length,s=e.attempts.getNumAttemptsSubmittedLate(e.column.dueDate);return e.hasAttempts()?M.AttemptStatus.InProgress===e.ui.attempt.status?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.unlimited.draftSavedLate":"components.directives.grade.course-grades-student.itemDescription.unlimited.draftSaved",params:{currentAttemptNumber:n,numberOfAttemptsSubmittedLate:s},noWrap:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.unlimited.submittedLate":"components.directives.grade.course-grades-student.itemDescription.unlimited.submitted",params:{currentAttemptNumber:n,numberOfAttemptsSubmittedLate:s},noWrap:!0}):this.scoreProviderHelper.supportsExternalEdit(e.column.scoreProviderHandle)?"":this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.unlimited.unopenedLate":"components.directives.grade.course-grades-student.itemDescription.unlimited.unopened",noWrap:!0})}if(e.column.isMultipleAttempts()){const n=e.column.multipleAttempts,s=e.attempts.getNumAttemptsSubmitted(),i=e.attempts.getNumAttemptsSubmittedLate(e.column.dueDate);if(!e.hasAttempts())return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.multiple.unopenedLate":"components.directives.grade.course-grades-student.itemDescription.multiple.unopened",params:{numberOfAttemptsPossible:n},noWrap:!0});if(M.AttemptStatus.InProgress===e.ui.attempt.status){const n=e.column.multipleAttempts-e.attemptsLeft;return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.multiple.draftSavedLate":"components.directives.grade.course-grades-student.itemDescription.multiple.draftSaved",params:{currentAttemptNumber:n,numberOfAttemptsSubmittedLate:i},noWrap:!0})}return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t?"components.directives.grade.course-grades-student.itemDescription.multiple.submittedLate":"components.directives.grade.course-grades-student.itemDescription.multiple.submitted",params:{numberOfAttemptsSubmitted:s,numberOfAttemptsSubmittedLate:i},noWrap:!0})}}return""}isAttemptInProgress(e){var t;return e.column.isAttemptBased&&!!(null===(t=e.ui.attempt)||void 0===t?void 0:t.isInProgress())}isAttemptSubmittableAfterDueDate(e){return!e.column.lateAttemptCreationDisallowed()||this.isAttemptInProgress(e)}isLate(e){var t;if(!(null===(t=this.targetMembership)||void 0===t?void 0:t.isDueDateExcepted())){const t=a(this.context.getServerTime());if(e.column.seemsAttemptBased()&&!e.column.isDiscussion())return!e.hasAttempts()&&t.isAfter(e.column.dueDate)||e.column.isMultipleAttempts()&&e.attemptsLeft&&t.isAfter(e.column.dueDate)||e.hasAttempts()&&a(e.ui.attempt.attemptDate).isAfter(e.column.dueDate);if(e.column.isDiscussion()){const n=this.firstParticipationDate(e);return!n&&t.isAfter(e.column.dueDate)||n&&a(n).isAfter(e.column.dueDate)}}return!1}firstParticipationDate(e){return e.column.isDiscussion()&&e.ui&&e.ui.attempt&&e.ui.attempt.attemptDate||null}disableRubricEvalClick(e){return!e.column.isJournal()}};W=Object(s.__decorate)([Object(s.__param)(0,Object(A.b)("scope")),Object(s.__param)(1,Object(A.b)("attrs")),Object(s.__param)(2,Object(A.b)("$q")),Object(s.__param)(3,Object(A.b)("$modal")),Object(s.__param)(4,Object(A.b)(g.i)),Object(s.__param)(5,Object(A.b)(v.b)),Object(s.__param)(6,Object(A.b)(u.b)),Object(s.__param)(7,Object(A.b)(y.c)),Object(s.__param)(8,Object(A.b)(r.b)),Object(s.__param)(9,Object(A.b)(c.serviceName)),Object(s.__param)(10,Object(A.b)(l.b)),Object(s.__param)(11,Object(A.b)(w.d)),Object(s.__param)(12,Object(A.b)(I.b)),Object(s.__param)(13,Object(A.b)(f.Jb.serviceName)),Object(s.__param)(14,Object(A.b)(P.f)),Object(s.__param)(15,Object(A.b)(N.b)),Object(s.__param)(16,Object(A.b)(B.b))],W);class J{constructor(e){this.$injector=e,this.restrict="E",this.template=F,this.link=(e,t,n)=>{e.courseGradesStudent=this.$injector.instantiate(W,{scope:e,attrs:n})}}}J.$inject=["$injector"],o.module(K,[d.a,u.a,h.a,p.c,g.h,f.N,x.b,y.b,c.moduleName,l.a,w.b,N.a,P.d,B.a,j,O.a,G.a]).directive("bbCourseGradesStudent",["$injector",e=>e.instantiate(J)])},"8NsT":function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content content-header-bg"\n       ng-click="gradeGridColumnHeaderOverallReborn.popupMenu($event)"\n       tabindex="0"\n       role="columnheader"\n       aria-describedby="summary-points-{{::columnMetadata.id}}"\n       analytics-id="components.directives.grade.grid.gradeGridColumnHeaderOverallReborn.popupMenu"\n  >\n    <div bb-content-item-icon content-column="columnMetadata" class="element-image" role="presentation"></div>\n    <div class="grade-grid-header-title grade-name">\n      <bb-svg-icon class="visibility-icon"\n                   ng-if="!columnMetadata.visible"\n                   size="small"\n                   icon="invisible"\n                   role="img"\n                   bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.gradeNotVisible\'}"\n      ></bb-svg-icon>\n      <span class="ellipse" title="{{::columnMetadata.columnName}}">{{::columnMetadata.columnName}}</span>\n    </div>\n  </div>\n  <div class="grade-grid-header-summary" tabindex="1" id="summary-points-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse points"\n          bb-translate-attrs="{\'title\': \'components.directives.grade.grid.points.plural\'}" translate-attrs-values="{count: gradeGridColumnHeaderOverallReborn.possible}"\n          bb-translate translate-values="{count: gradeGridColumnHeaderOverallReborn.possible}">components.directives.grade.grid.points.plural</span>\n    <span class="sr-only"\n          bb-translate translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n  </div>\n\n  <div class="grade-grid-header-summary" tabindex="1" ng-if="columnMetadata.isCalculated()" id="summary-info-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse items-count"\n          bb-translate-attrs="{\'title\': \'components.directives.grade.grid.itemsTip\'}" translate-attrs-values="{count: columnMetadata.itemsCount}"\n          bb-translate translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n  </div>\n</div>\n'},"9Fiv":function(e,t,n){"use strict";var s=n("D57K"),i=n("5iHu"),o=n("nsO7"),a=n("0JpG"),r=n("lEL+"),c=n("X/qj"),l=n("+4Px"),d=n("5Dl8"),u=n("aHpC"),h=n("yC9S"),p=n("gK/k"),m=n("dF44"),b=n("s52B"),g=n("7/CN");n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return w}));const v="rbGridContainer";let f=class{constructor(e,t,n,s,i,o,a){this.$q=e,this.position=t,this.columns=n,this.grid=s,this.timeout=i,this.bbLocalize=o,this.gradebookPermissionService=a,this.renderedRows=[],this.nextRenderedRows=[],this.renderedColumns=[],this.nextRenderedColumns=[],this.scrollTop=0,this.scrollLeft=0,this.id=s.id+"-container-"+t,this.rows=s.options.memberships,this.totalWidth=this.initColumnsPosition(n,!1),this.totalHeight=s.options.rowHeight*s.options.memberships.length,this.isMain="center"===t,this.headerBorder=s.options.headerBorder,this.rowBorder=s.options.rowBorder,this.callbacks=s.options.callbacks,this.isRtl=this.bbLocalize.isRTL(),this.deferedInit=this.$q.defer(),this.initialized=this.deferedInit.promise}initColumnsPosition(e=this.columns,t=!0){const n=[];let s=0;for(let i=0;i<e.length;i++){const o=e[i];o.accumulativeWidth=s,t&&n.push(`.rb-column-position-${o.id} {${this.isRtl?"right":"left"}: ${Object(d.b)(s)};}`),s+=o.columnWidth}if(t){i(`style#${this.id}`).remove();const e=i(`<style scoped id="${this.id}"></style>`);e.text(n.join("\n")),this.grid.$element.prepend(e)}return s}getCssPosition(){return this.isRtl&&"center"!==this.position?"left"===this.position?"right":"left":this.position}getContainerStyle(){const e=this.grid.containers.left,t=this.grid.containers.right;return this.isMain?{[this.isRtl?"right":"left"]:Object(d.b)(e&&e.totalWidth),[this.isRtl?"left":"right"]:Object(d.b)(t&&t.totalWidth+this.grid.scrollbarWidth)}:{[this.getCssPosition()]:"0"}}getHeaderCanvasStyle(){return{width:Object(d.b)(this.totalWidth),height:Object(d.b)(this.grid.options.headerHeight)}}getBodyCanvasStyle(){return{width:Object(d.b)(this.totalWidth),height:Object(d.b)(this.totalHeight)}}getBodyStyle(){return{"overflow-x":this.hasHScrollbar?"scroll":"hidden","overflow-y":this.hasVScrollbar?"scroll":"hidden"}}init(e,t){if(this.element=t,this.scope=e,this.element.addClass(this.id),this.header=this.element.find(".rb-grid-header"),this.body=this.element.find(".rb-grid-body"),this.canAddColumn()){const e=this.scope.$watch("container",t=>{null!=t&&t.canAddColumn()&&(this.columnAdder=new C(this.element.find(".rb-add-column"),this),e(),this.deferedInit.resolve(this))})}return this.adjustRows(),this.adjustColumns(),this.addEventListeners(),this.canAddColumn()||this.deferedInit.resolve(this),this.initialized}toggleFirstAddColumnPlaceholder(e){this.element.find(".rb-add-column-placeholder.first")[e?"show":"hide"]()}resetColumns(e){this.columns=[...e],this.columns.sort((e,t)=>e.order-t.order),this.totalWidth=this.initColumnsPosition(e,!1),this.adjustColumns()}resetRows(e){this.initialized.then(()=>{this.rows=e,this.totalHeight=this.grid.options.rowHeight*this.rows.length,this.adjustRows()})}addEventListeners(){this.element.on("wheel",this.handleWheel.bind(this)),this.body.on("scroll",this.handleScroll.bind(this))}handleScroll(){const e=(t=this.body.scrollLeft(),n=this.isRtl,s=this.getMaxScrollLeft(),n&&Object(g.e)()!==g.a.Negative?s-t:Math.abs(t));var t,n,s;const i=this.body.scrollTop();this.grid.scrollContainers({scrollLeft:e!==this.scrollLeft?e:null,scrollTop:i!==this.scrollTop?i:-1})}handleWheel(e){if(this.body[0].scrollWidth===this.body[0].clientWidth&&this.body[0].scrollHeight===this.body[0].clientHeight)return;const t=e.originalEvent;let n=this.isRtl?-t.deltaX:t.deltaX,s=t.deltaY;if(1===t.deltaMode){const e=parseInt(this.element.css("font-size"),10);n*=e,s*=e}if(this.atTop()&&s<0||this.atBottom()&&s>0||this.atLeft()&&n<0||this.atRight()&&n>0)return;if(0===n&&0===s)return;e.preventDefault(),e.stopPropagation();let i=-1,o=null;0!==s&&(i=Math.max(0,Math.min(this.scrollTop+s,this.getMaxScrollTop()))),0!==n&&(o=Math.max(0,Math.min(this.scrollLeft+n,this.getMaxScrollLeft()))),this.grid.scrollContainers({scrollTop:i,scrollLeft:o})}scrollHorizontally(e){const t=(n=e,s=this.isRtl,i=this.getMaxScrollLeft(),s?Object(g.e)()===g.a.Negative?-n:i-n:n);var n,s,i;this.body.scrollLeft(t),this.header.scrollLeft(t),this.scrollLeft=e,this.adjustColumns()}scrollVertically(e){this.body.scrollTop(e),this.scrollTop=e,this.adjustRows()}canAddColumn(){return this.isMain&&this.grid.canAddColumn()&&this.gradebookPermissionService.canModify()}getVisibleColRange(){const e=this.scrollLeft;let t=0,n=this.columns.length;for(let n=0,s=0;n<this.columns.length;n++)if((s+=this.columns[n].columnWidth)>=e){t=n;break}for(let t=0,s=0;t<this.columns.length;t++)if((s+=this.columns[t].columnWidth)>=e+this.body[0].clientWidth){n=t;break}return{start:t,end:n}}calculateNextRenderedColumns(){const{start:e,end:t}=this.getVisibleColRange();this.nextRenderedColumns=this.columns.slice(e,t+m.a+1)}adjustColumns(){this.calculateNextRenderedColumns(),this.grid.debounceRefresh()}getVisibleRowRange(){const e=Math.ceil(this.body[0].clientHeight/this.grid.options.rowHeight),t=Math.floor(this.scrollTop/this.grid.options.rowHeight);return{start:t,end:t+e}}calculateNextRenderedRows(){const{start:e,end:t}=this.getVisibleRowRange();this.nextRenderedRows=this.rows.slice(e,t+m.e)}isRowOutOfBound(e){const{start:t,end:n}=this.getVisibleRowRange();return{top:e<=t,bottom:e>=n}}isColOutOfBound(e){const{start:t,end:n}=this.getVisibleColRange();return{left:e<=t,right:e>=n}}adjustRows(){this.calculateNextRenderedRows(),this.grid.debounceRefresh()}applyData(){this.renderedRows=this.nextRenderedRows,this.renderedColumns=this.nextRenderedColumns}getMaxScrollTop(){return this.totalHeight-this.body[0].clientHeight}getMaxScrollLeft(){return this.totalWidth-this.body[0].clientWidth}getTopRowScrollTop(e){return this.grid.options.rowHeight*e}getBottomRowScrollTop(e){return Math.max(0,this.grid.options.rowHeight*(e+1)-this.body[0].clientHeight)}getLeftColScrollLeft(e){return e.accumulativeWidth}getRightColScrollLeft(e){return Math.max(0,e.accumulativeWidth+e.columnWidth-this.body[0].clientWidth)}atTop(){return 0===this.scrollTop}atBottom(){return this.scrollTop===this.getMaxScrollTop()}atLeft(){return!this.isMain||0===this.scrollLeft}atRight(){return!this.isMain||this.scrollLeft===this.getMaxScrollLeft()}};f=Object(s.__decorate)([Object(s.__param)(0,Object(u.b)("$q")),Object(s.__param)(1,Object(u.b)("position")),Object(s.__param)(2,Object(u.b)("columns")),Object(s.__param)(3,Object(u.b)("grid")),Object(s.__param)(4,Object(u.b)(r.b)),Object(s.__param)(5,Object(u.b)(a.serviceName)),Object(s.__param)(6,Object(u.b)(c.b))],f);class C{constructor(e,t){this.element=e,this.container=t,this.grid=t.grid,this.scope=t.scope,this.bbLocalize=t.bbLocalize,e.css("height",`calc(100% - ${Object(d.b)(this.grid.scrollbarWidth)}`),this.button=e.find(".button"),this.firstPlaceholder=this.container.element.find(".rb-add-column-placeholder.first"),this.button.on("keydown",e=>{let t;this.grid.previousCell.tabPressed=!1;let n=this.container.currentColumn;if(l.z(e)||e.keyCode===l.j||e.keyCode===l.g){const e=n||this.grid.containers.left.columns.slice(-1)[0],s=this.container.columns.indexOf(e);s>=0&&this.container.isColOutOfBound(s).left?this.grid.scroll({scrollLeft:this.container.getLeftColScrollLeft(e)},()=>{this.grid.$scope.$broadcast(m.b.FOCUS_CELL,t,e)}):this.grid.$scope.$broadcast(m.b.FOCUS_CELL,t,e)}else{if(!l.A(e)&&e.keyCode!==l.s)return;{const e=this.grid.getFocusableColumns();let s=NaN,i=NaN;n?(n=e[(e.indexOf(n)+1)%e.length])===e[0]&&(t=this.container.rows[0],i=0):n=this.container.columns[0];const a=this.container.columns.indexOf(n);this.container.isColOutOfBound(a).right&&(s=this.container.getRightColScrollLeft(n)),Object(o.isNaN)(s)&&Object(o.isNaN)(i)?this.grid.$scope.$broadcast(m.b.FOCUS_CELL,t,n):this.grid.scroll({scrollTop:i,scrollLeft:s},()=>this.grid.$scope.$broadcast(m.b.FOCUS_CELL,t,n))}}this.hide(),e.preventDefault(),e.stopPropagation()}),h.b.OnWindow("click",e=>{i(e.target).closest(this.button).length||(this.button.removeClass("active"),this.hide())},this.container.scope),this.container.scope.$on(m.b.SCROLL_H,()=>{this.hide()}),this.container.scope.$on(m.b.SCROLL_V,()=>{this.button.hasClass("active")&&this.hide()})}enter(e,t){this.button.hasClass("active")||this.show(i(e.target),t)}leave(){this.button.hasClass("active")||this.hide()}show(e=this.firstPlaceholder,t){this.element.show(),this.element.offset(e.offset()),this.element.css("opacity","1"),this.container.currentColumn=t||this.grid.containers.left.columns.slice(-1)[0],this.addAriaLabel()}hide(){this.element.hide(),this.element.css("opacity","0")}onClick(e){this.button.toggleClass("active"),this.button.hasClass("active")&&this.container.callbacks.column(e,this.container.currentColumn)}addAriaLabel(){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.lastAddButtonAriaLabel",params:{columnName:this.container.currentColumn.data.columnName},noWrap:!0,noEscape:!0});this.button.attr("aria-label",e)}}class y{}class w{constructor(){this.replace=!0,this.restrict="A",this.require=[`^${p.a}`,v],this.template=b,this.controller=y,this.scope=!0,this.link=(e,t,n,s)=>{const[i,o]=s;i.initializedWithOptions.then(()=>{const s=i.containers[n[v]];e.container=s,e.grid=i,s.init(e,t),o.container=s})}}}},"9KIl":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var s=n("Llzl"),i=n("nsO7"),o=n("X/qj"),a=n("LN5R"),r=n("o5Lu"),c=n("pjml"),l=n("lEL+"),d=n("0JpG"),u=n("T1pL"),h=n("dF44"),p=n("qH3X"),m=n("TmUJ"),b=n("+4Px"),g=n("wJOA"),v=n("mWXo");const f="ultra.components.directives.gradeGridColumnOverallReborn";class C{constructor(e,t,n,s,o,a,r,c,l,d,u,m,b){this.rootScope=e,this.window=t,this.$q=n,this.CourseModel=s,this.gradeService=o,this.gradebookPermissionService=a,this.$compile=r,this.scope=c,this.element=l,this.attrs=d,this.gradeGridRebornController=u,this.timeout=m,this.bbLocalize=b,this.initializeEventHandler(),this.gridData=this.gradeGridRebornController.getGridData(),c.$watchGroup(["row","col"],e=>{this.changeRecord(e)}),c.$on(p.a.REFRESH,(e,t)=>{const n=t.rowId,s=t.columnIds;i.forEach(s,e=>{this.scope.row.id===n&&this.cell.column.id===e&&(this.initializeCell(n,e),this.initializeUI(),this.initializeGradeDetail(this.cell.data),this.scope.$broadcast(p.a.REFRESH_OVERALL_EDITOR))})}),c.$on(h.b.ENTER_CELL,(e,t)=>t.find(".grade-grid-cell").click()),c.$on("$destroy",()=>{})}changeRecord(e){const[t,n]=e;this.initializeCell(t.id,n.id),this.initializeState(),this.initializeUI(),this.initializeGradeDetail(this.cell.data)}initializeEventHandler(){this.element.parents(".rb-cell").focusin(()=>{this.focusin()}).focusout(()=>{this.focusout()}),this.element.children(".grade-grid-cell").mousedown(()=>this.mousedown())}focusin(){this.rootScope.$broadcast(p.a.FOCUSIN_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}focusout(){this.rootScope.$broadcast(p.a.FOCUSOUT_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}initializeUI(){const e=this.element.children(".grade-grid-cell");this.isLoading||this.isEditing?e.children(".score").hide():e.children(".overall-display-grade").show()}initializeGradeDetail(e){this._gradeDetail=i.isUndefined(e)||i.isNull(e)?void 0:this.gradeService.gradeDetailToPercentage(e.grade);const t=this.extractGradeFromGradeDetail(this.gradeDetail);this.setUpScreenReader(this.cell,t)}extractGradeFromGradeDetail(e){return e&&e.displayGrade&&e.displayGrade.perfCode&&e.displayGrade.perfCode.code||e&&e.getScore()}get disabledEditor(){return!this.canBeEdited&&i.isEmpty(this.extractGradeFromGradeDetail(this.gradeDetail))}initializeState(){this._isEditing=!1}initializeCell(e,t){this.cell=this.gridData.getCell(e,t),this._oldScore=this._score=void 0}get isReady(){return!i.isUndefined(this.cell)}get isLoading(){return!this.isReady||!this.cell.isLoaded}get score(){if(this.isReady){if(i.isUndefined(this._score)){let e=this.gradeDetail&&this.gradeDetail.getScore();e=e?this.bbLocalize.formatNumberSync(Math.round(100*parseFloat(e))/100,this.scope,{maximumFractionDigits:r.d.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL}):e,i.isEmpty(e)&&this.gradeDetail&&!i.isUndefined(this.gradeDetail.displayGrade.perfCode)&&(e=this.gradeDetail.displayGrade.perfCode.code),this._oldScore=this._score=e}return this._score}}set score(e){this._score=e}get isReadonly(){if(this.isReady)return!1}get isEditing(){return this._isEditing}get gradeDetail(){return this._gradeDetail}get pointsPossible(){return this.gradeDetail?this._gradeDetail.pointsPossible:100}insertCellEditor(){this.editorScope=this.scope.$new(!1,this.scope),this.$compile(C.OVERALL_EDITOR_TEMPLATE)(this.editorScope,e=>this.element.children(".grade-grid-body-cell").append(e)),this.timeout(()=>{this.addInputKeyEventListeners();const e=this.scope.$on(h.b.SCROLL_H,()=>{this.closeEditor(),e(),t(),this.scope.$apply()}),t=this.scope.$on(h.b.SCROLL_V,()=>{this.closeEditor(),t(),e(),this.scope.$apply()})},this.scope,200)}removeCellEditor(){this.element.find("#bb-grade-grid-overall-editor-reborn").remove()}gotoNextCell(){this.nextDeferred=this.$q.defer(),this.nextDeferred.promise.then(()=>{this.scope.$emit(h.b.ENTER_NEXT_CELL)})}mousedown(){e(this.window).trigger("click")}isConfirmDialogExisting(){return!!e(".grade-grid-group-confirm-dialog").length}get canBeEdited(){return!this.gridData.course.isComplete()&&!i.isUndefined(this.cell)&&this.gradebookPermissionService.canOverrideGrades()}enterEditor(e){this.isConfirmDialogExisting()||!this.canBeEdited||this.isLoading||this._isEditing||(this._isEditing=!0,this.element.find(".overall-display-grade").hide(),this.insertCellEditor(),this.popupMenu(e))}popupMenu(t){const n=`grade-grid-notation-menu-reborn-${this.scope.row.id}-${this.scope.col.id}`;if((this.scope.col.gradeNotations.length||this.gradeDetail&&this.gradeDetail.displayGrade&&this.gradeDetail.displayGrade.isOverride)&&!this.gradeGridRebornController.isMenuExisting(n)){const s=e(t.target).closest(".grade-grid-cell").offset();s.top+=60;const i=this.scope.$new(!1);i.adjustPosition=e=>{const t=s.left+e.width(),n=s.top+e.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();t>i&&(s.left-=t-i+Object(m.a)()),n>o&&(s.top-=e.height()+40),e.offset(s)},this.gradeGridRebornController.popupMenu(n,v,i),this.addMenuKeyEventListeners(),t.preventDefault(),t.stopPropagation()}}addInputKeyEventListeners(){this.element.find("#bb-grade-grid-overall-editor-reborn input").on("keydown",e=>{const t=this.gradeGridRebornController.getMenuitems();if(b.A(e))t.first().focus();else{if(!b.z(e))return;t.last().focus()}e.preventDefault(),e.stopPropagation()})}addMenuKeyEventListeners(){this.timeout(()=>{const t=this.gradeGridRebornController.getPopupMenu();t.on("keydown",n=>{const s=this.gradeGridRebornController.getMenuitems();if(b.A(n)){const t=s.index(e(n.target))+1;t<s.length?s.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(b.z(n)){const t=s.index(e(n.target))-1;t>=0?s.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(b.y(n))this.scope.$emit(h.b.LEAVE_CELL);else{if(n.keyCode!==b.g)return;t.data("destroy")(),this.scope.$emit(h.b.LEAVE_CELL)}n.preventDefault(),n.stopPropagation()})},this.scope,0,!1)}onInputBlur(e,t){if(!this.isLoading&&this._isEditing&&(this.closeEditor(),e)){this.score=t;const e=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],n=this.createGradeSubmission(e,this.gradeService.parseGrade(this.score,e,this.scope));if(this.score){const e=i.find(this.cell.column.gradeNotations,e=>e.code===this.score);e&&(n.perfCodeId=e.id)}this.saveGrade(n)}}closeEditor(){!this.isLoading&&this._isEditing&&(this._isEditing=!1,this.removeCellEditor(),this.editorScope.$destroy(),this.element.find(".overall-display-grade").show())}isDirty(){if(i.isUndefined(this._oldScore)&&!i.isEmpty(this.score))return!0;if(!i.isUndefined(this._oldScore)){const e=this.bbLocalize.parseNumberSync(this._oldScore,this.scope),t=this.bbLocalize.parseNumberSync(this.score,this.scope);return i.isNaN(e)||i.isNaN(t)?this._oldScore!==this.score:e!==t}return!1}createGradeSubmission(e,t){const n=this.gradeService.createGradeSubmission(this.cell.column.data,t,e);return n.clearGrade=this.gradeService.wasGradeCleared(this._oldScore,this.score),n}saveGrade(e){if(this.isDirty()){if(i.isUndefined(e)){const t=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId];e=this.createGradeSubmission(t,this.gradeService.parseGrade(this.score,t,this.scope))}this.gradeService.saveGrade(e,this.cell.data&&this.cell.data.grade,void 0,{userId:this.cell.row.metadata.user.id}).then(e=>this.cell.column.data.summary.$fetch()).then(()=>{this.gridData.refreshDataCell(this.cell.row,this.cell.column),this.rootScope.$broadcast(h.b.DATA_UPDATE),this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)})}else this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}undoOverride(){this.score="",this.saveGrade()}selectNotation(e){this.score=e.code;const t=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],n=this.createGradeSubmission(t,this.score);n.perfCodeId=e.id,this.saveGrade(n)}setUpScreenReader(e,t){const n=e&&e.row&&e.row.metadata.user,s=n&&n.givenName.concat(n&&n.familyName),i=e&&e.column.data.columnName,o=!this.gridData.course.isComplete();if(t){const n=this.gradeService.getGradeToDisplay(e.data.grade.displayGrade,this.scope,this.gridData.getSchema()[e.column.data.gradingSchemaId].scaleType);this.ariaLabelContent=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:o?"components.directives.grade.grid.tableCellAriaLabel":"components.directives.grade.grid.tableCellAriaLabelReadOnly",params:{userName:s,assignmentName:i,grade:n||t},noWrap:!0,noEscape:!0})}else this.ariaLabelContent=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:o?"components.directives.grade.grid.tableCellAriaLabelEmpty":"components.directives.grade.grid.tableCellAriaLabelEmptyReadOnly",params:{userName:s,assignmentName:i},noWrap:!0,noEscape:!0})}}C.OVERALL_EDITOR_TEMPLATE='<div bb-grade-grid-overall-editor-reborn id="bb-grade-grid-overall-editor-reborn" class="editor"></div>',C.$inject=["$rootScope","$window","$q",c.m.serviceName,r.i,o.b,"$compile","scope","element","attrs","gradeGridRebornController",l.b,d.serviceName];class y{constructor(e){this.$injector=e,this.restrict="E",this.template=g,this.scope=!0,this.require=`^${a.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnOverallReborn=this.$injector.instantiate(C,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}y.$inject=["$injector"],s.module(f,[u.a]).directive("bbGradeGridColumnOverallReborn",["$injector",e=>e.instantiate(y)])}).call(this,n("5iHu"))},"9Zs+":function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown" role="menu">\n    <li role="presentation">\n      <a role="menuitem"\n         class="js-add-calculation"\n         bb-peek-sref="gradebook-item.calculation({positionAfter: positionAfter})"\n         analytics-id="components.directives.grade.grid.addCalculation">\n        <bb-svg-icon size="small" icon="calculation"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addCalculation</bb-translate>\n      </a>\n    </li>\n\n    <li role="presentation">\n      <a role="menuitem"\n         class="js-add-item"\n         bb-peek-sref="grade-item.create({positionAfter: positionAfter})"\n         analytics-id="components.directives.grade.grid.addItem">\n        <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addItem</bb-translate>\n      </a>\n    </li>\n\n    <li role="presentation" ng-if="!attendanceColumnExists && attendanceIsAvailable">\n      <a role="menuitem"\n         bb-peek-sref="attendance"\n         analytics-id="components.directives.grade.grid.addAttendance">\n        <bb-svg-icon size="small" icon="attendance" ></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addAttendance</bb-translate>\n      </a>\n    </li>\n  </ul>\n</div>'},"9hUw":function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return O}));var s=n("D57K"),i=n("VdDF"),o=n("DN+C"),a=n("Llzl"),r=n("VAMW"),c=n("6fZB"),l=n("Sa5G"),d=n("JfV0"),u=n("zGdY"),h=n("nsO7"),p=n("9OUN"),m=n("aHpC"),b=n("nmzr"),g=n("TnpK"),v=n("fYJU"),f=n("12mu"),C=n("0JpG"),y=n("Fvsw"),w=n("U50L"),S=n("aPUy");const I="ultra.components.services.assessment.peerReview",O="peerReview";let E=class{constructor(e,t,n,s,i,o,a,r,c,l,d){this.$rootScope=e,this.$ngRedux=t,this.localizeService=n,this.contextUser=s,this.modal=i,this.ultraState=o,this.context=a,this.$q=r,this.courseId=c,this.contentId=l,this.columnId=d,this.reviewableAttemptsOnly=[],this.deletedAttemptsOnly=[],this.hasLoadedReviewableAttempts=!1}initPeerContentObject(){this.subscribeToReduxStore();const{courseId:e,contentId:t,columnId:n}=this,s=[];return this.content||s.push(this.loadContents({courseId:e,contentId:t}).then(()=>this)),this.column||s.push(this.loadGradebookColumn({courseId:e,columnId:n}).then(()=>this)),this.$q.all(s).then(()=>this)}subscribeToReduxStore(){this.unsubscribeFromReduxStore=this.$ngRedux.connect(e=>{var t;const n=this.courseId,s=this.columnId,i=this.contextUser.userId;return{reviewableAttemptsOnly:Object(h.sortBy)(d.select.gradebookAttempt.getReviewableGradebookAttempts(e,n,s,i),["delegatedGraderOrder"]),deletedAttemptsOnly:d.select.gradebookAttempt.getDeletedReviewableGradebookAttempts(e,s),content:d.select.content.getContentById(e,this.contentId),column:d.select.gradebookColumn.getGradebookColumnById(e,s),assessmentHasEnoughSubmissions:null===(t=d.select.assessment.getAssessmentByContentId(e,this.contentId))||void 0===t?void 0:t.hasEnoughPeerSubmissions}},e=>Object(p.bindActionCreators)({assignNewAttemptForPeerReview:d.actions.gradebookAttempt.assignNewAttemptForPeerReview,loadGradebookAttemptsByColumnId:d.actions.gradebookAttempt.loadGradebookAttemptsByColumnId,loadGradebookColumn:d.actions.gradebookColumn.loadGradebookColumn,loadContents:d.actions.content.loadContents},e))(this)}canPeerViewAttempt(e,t){if(!this.peerGrading||!t)return!1;const n=this.reviewableAttempts.some(e=>e.id===t.id),s=this.contextUser.userId===t.userId;return!!(n||s)}canDelegatedReconcileAttempt(e){return e.delegatedGrading&&e.isUserReconciler(this.contextUser.userId)}canPeerReviewAttempt(e,t){return this.canPeerViewAttempt(e,t)&&t.userId!==this.contextUser.userId&&!this.canDelegatedReconcileAttempt(e)}canPeerAddFeedbackToAttempt(e,t){return this.canPeerReviewAttempt(e,t)&&!t.isReconciled()&&u.AttemptStatus.Completed!==t.status}get completedPeerReviews(){return this.peerGrading?this.reviewableAttempts.filter(e=>u.AttemptStatus.Completed===(null==e?void 0:e.status)).length:0}openNotEnoughStudentSubmissionsModal(){const e=this.$rootScope.$new();e.translateOpts={title:{key:"components.services.peer-review.modal.error-not-enough-submissions.title"}},e.descriptionKey="components.services.peer-review.modal.error-not-enough-submissions.description";const t={scope:e,template:w,resolve:{translations:[C.serviceName,e=>e.loadBundle("components/services/peer-review")]}};this.modal.open(t)}getReviewableAttemptByDelegatedGraderOrder(e){return this.reviewableAttempts.find(t=>t.delegatedGraderOrder===e)}assignNewPeerReview(){if(!this.peerGrading||this.reviewableAttempts.length===this.numOfPeerReviewsToComplete)return this.$q.resolve(null);const e=this.hasDeletedAttempts?this.deletedAttempts[0].delegatedGraderOrder:null;return this.$q.when(this.assignNewAttemptForPeerReview({courseId:this.column.courseId,columnId:this.column.id,userId:this.contextUser.userId})).then(()=>{const t=null!=e?e:this.reviewableAttempts.length-1;return Object(S.a)(this.$rootScope,{listIndex:t,reviewableAttempt:this.reviewableAttempts[t]}),this.reviewableAttempts[t]}).catch(e=>{throw e instanceof d.AssessmentConflictNotEnoughPeerReviews&&this.openNotEnoughStudentSubmissionsModal(),e})}navigateToPeerReview(e){if(!this.peerGrading)return this.$q.resolve();if(null===this.getReviewableAttemptByDelegatedGraderOrder(e))return this.$q.reject(new Error("Cannot navigate to a row that does not exist"));const t=this.getReviewableAttemptByDelegatedGraderOrder(e),n={courseId:this.column.courseId,columnId:this.column.id,userId:this.contextUser.userId,attemptId:null==t?void 0:t.id,gradeId:null==t?void 0:t.gradeId,initialPeerIndex:e};return this.ultraState.goPeekState(`${b.AssessmentRoutes.ASSESSMENT_PEER_GRADING}`,n)}loadReviewableAttempts(){var e;return!this.peerGrading||this.loadReviewableAttemptsPromise||this.hasLoadedReviewableAttempts?null!==(e=this.loadReviewableAttemptsPromise)&&void 0!==e?e:this.$q.resolve(this):(this.loadReviewableAttemptsPromise=this.$q.when(this.loadGradebookAttemptsByColumnId({courseId:this.column.courseId,columnId:this.column.id,reviewableAttemptsOnly:!0})).then(()=>(this.hasLoadedReviewableAttempts=!0,this)),this.loadReviewableAttemptsPromise)}get reviewableAttempts(){var e;return this.peerGrading&&null!==(e=this.reviewableAttemptsOnly)&&void 0!==e?e:[]}get deletedAttempts(){var e;return this.peerGrading&&null!==(e=this.deletedAttemptsOnly)&&void 0!==e?e:[]}get hasEnoughSubmissionsForPeerAssessment(){var e;return null!==(e=this.assessmentHasEnoughSubmissions)&&void 0!==e&&e}get hasDeletedAttempts(){return this.deletedAttempts.length>0}get numberOfLatePeerReviews(){return this.peerGrading?this.reviewableAttempts.filter(e=>this.isAfterPeerReviewDueDate(e.attemptLastGradedDate)&&u.AttemptStatus.Completed===e.status).length:null}get numberOfStartedPeerReviews(){if(!this.peerGrading)return null;return this.reviewableAttempts.filter(e=>u.AttemptStatus.NeedsGrading===e.status).length+this.deletedAttempts.length}get peerGrading(){var e;return!!(null===(e=this.column)||void 0===e?void 0:e.peerGrading)}get numOfPeerReviewsToComplete(){var e;return this.peerGrading?null===(e=this.content.peerSettings)||void 0===e?void 0:e.peerReviewsPerStudent:null}parseCurrentStringToDateAndMemoize(e){return i.a.parseStringToDate(e)}get peerSubmissionDueDate(){return this.peerGrading?this.parseCurrentStringToDateAndMemoize(this.column.dueDate):null}get peerReviewDueDate(){var e;return this.peerGrading?this.parseCurrentStringToDateAndMemoize(null===(e=this.content.peerSettings)||void 0===e?void 0:e.peerReviewDueDate):null}get allowLatePeerReviews(){return!!this.peerGrading&&!!this.content.peerSettings.allowLatePeerReviews}get isPeerGradingConfigured(){return!!this.peerGrading&&(null!=this.numOfPeerReviewsToComplete&&null!=this.peerReviewDueDate)}get isInPeerReviewWindow(){return!this.isAfterPeerReviewDueDate()&&this.isAfterPeerSubmissionDueDate()}get isAfterPeerReviewWindow(){return this.isAfterPeerReviewDueDate()}isAfterPeerReviewDueDate(e){var t;if(!this.peerGrading)return!1;const n=null!==(t=i.a.parseStringToDate(e))&&void 0!==t?t:new Date;return i.a.isWithinDateRange(n,{end:null,start:this.peerReviewDueDate},!1)}isAfterPeerSubmissionDueDate(e){var t;if(!this.peerGrading)return!1;const n=null!==(t=i.a.parseStringToDate(e))&&void 0!==t?t:new Date;return i.a.isWithinDateRange(n,{end:null,start:this.peerSubmissionDueDate},!1)}};Object(s.__decorate)([Object(o.LRUMemoize)()],E.prototype,"parseCurrentStringToDateAndMemoize",null),E=Object(s.__decorate)([Object(s.__param)(0,Object(m.b)("$rootScope")),Object(s.__param)(1,Object(m.b)("$ngRedux")),Object(s.__param)(2,Object(m.b)(C.serviceName)),Object(s.__param)(3,Object(m.b)(v.b)),Object(s.__param)(4,Object(m.b)(f.b)),Object(s.__param)(5,Object(m.b)(g.d)),Object(s.__param)(6,Object(m.b)(y.b)),Object(s.__param)(7,Object(m.b)("$q")),Object(s.__param)(8,Object(m.b)("courseId")),Object(s.__param)(9,Object(m.b)("contentId")),Object(s.__param)(10,Object(m.b)("columnId"))],E);class D{constructor(e){this.service=e,this.key=r.TransitService.PeerReview}getOrCreatePeerContentFromContent(e){return Object(c.a)(this.service.getOrCreatePeerContentFromContent(e))}}let k=class{constructor(e,t,n){this.$injector=e,this.$q=t,this.localizeService=n,this.peerContentMap=new Map,Object(r.registerService)(new D(this))}getPeerContent(e){return this.peerContentMap.get(e)}createPeerContent(e,t,n){const s=this.$injector.instantiate(E,{courseId:e,contentId:t,columnId:n});return this.peerContentMap.set(t,s),s.initPeerContentObject()}getOrCreatePeerContent(e,t,n){const s=this.getPeerContent(t);return s?this.$q.resolve(s):this.createPeerContent(e,t,n)}getDeployedAssessment(e){return(null==e?void 0:e.contentDetail)&&e.getDeployedAssessment()}getOrCreatePeerContentFromContent(e){var t,n;if(!e)return this.$q.resolve(null);const{courseId:s,id:i}=e,o=null===(n=null===(t=this.getDeployedAssessment(e))||void 0===t?void 0:t.gradingColumn)||void 0===n?void 0:n.id;return s&&i&&o?this.getOrCreatePeerContent(s,i,o):this.$q.resolve(null)}getOrCreatePeerContentWithAttemptsFromContent(e){return this.getOrCreatePeerContentFromContent(e).then(e=>null==e?void 0:e.loadReviewableAttempts())}getOrCreatePeerContentFromColumn(e){if(!e)return this.$q.resolve(null);const{courseId:t,contentId:n,id:s}=e;return t&&n&&s?this.getOrCreatePeerContent(t,n,s):this.$q.resolve(null)}getOrCreatePeerContentWithAttemptsFromColumn(e){return this.getOrCreatePeerContentFromColumn(e).then(e=>null==e?void 0:e.loadReviewableAttempts())}isPeerEvaluationItem(e){return l.r.PeerEvaluationTest.isEqualTo(e)}wrapPeerEvaluationItemTitle(e,t){return this.localizeService.translateSync({locale:t,key:"components.services.peer-review.peerEvaluationTitleWrapper",params:{itemTitle:e},noWrap:!0,noEscape:!0})}};k=Object(s.__decorate)([Object(s.__param)(0,Object(m.b)("$injector")),Object(s.__param)(1,Object(m.b)("$q")),Object(s.__param)(2,Object(m.b)(C.serviceName))],k);class $ extends k{}a.module(I,[C.moduleName,v.a,f.a,g.b,y.a]).service(O,k)},"9hp7":function(e,t){e.exports='<div bb-load-bundle="components/directives/add-content-button">\n  <div class="add-element no-select js-add-content-button {{::contextArea + \'-add-button\'}}"\n       ng-class="{\n         \'force-show-add-button\': addContentButton.isForceShowAddButton && addContentButton.isForceShowAddButton(),\n         \'is-active\': addContentButton.isMenuVisible,\n         \'button-visible\': addContentButton.isButtonVisible,\n         hide: hideDividerLines() && !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)\n       }"\n       ng-keydown="addContentButton.onKeydown($event)">\n    <template></template>\n  </div>\n  <div id="{{::fileListViewId}}">\n    <bb-progress display-results="false" primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId" target-div="{{::\'#\' + fileListViewId}}"></bb-progress>\n  </div>\n</div>'},AVdi:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I}));var s=n("D57K"),i=(n("dY8P"),n("5uNO"),n("w0/N"),n("6BRP"),n("zexu"),n("nsO7")),o=n("Llzl"),a=n("0JpG"),r=n("BJLZ"),c=n("XGja"),l=n("yMoE"),d=n("o5Lu"),u=n("p7NW"),h=n("dd1C"),p=n("+4Px"),m=n("pjml"),b=n("lEL+"),g=n("t3AZ"),v=n("TnpK"),f=n("m2KQ"),C=n("aHpC"),y=n("zGdY"),w=n("ho2F"),S=n("RjAI");const I="ultra.components.directives.grade.gradeInput";let O=class t{constructor(n,s,i,o,a,r,c,d,u,h,m,b,g,v,f,C){this.$rootScope=n,this.$compile=s,this.$q=i,this.$injector=o,this.scope=a,this.element=r,this.attrs=c,this.form=d,this.bbLocalize=u,this.grade=h,this.AttemptModel=m,this.GradeModel=b,this.GroupAttemptModel=g,this.CourseModel=v,this.timeout=f,this.ultraState=C,this.alertScreenReaderNewGrade=!1,this.gradeDisplayItem=this.$injector.instantiate(l.a,{gradeDetail:this.scope.gradeDetail,scope:this.scope}),this.id=this.attrs.id,this.isSaving=!1,this.wrapperDiv=this.element.find("."+t.WRAPPER_CLASS),this.inputElement=this.wrapperDiv.find("input"),this.isWrapperDivClickHandled=!1,this.gradeNotationsWrapperSelector=this.scope.gradeNotationsWrapperSelector||"body",this.inputElementBluredByTab=!1,this.isProcessingFocusEvent=!1,this.onDismissCallback=()=>{this.gradeDialog.isVisible=!1,this.form[this.id].$setPristine(),this.inputElement.blur()},this.onSuccessCallback=()=>{this.gradeDialog.isVisible=!1,this.validateAndSave(!0).finally(()=>{this.setFocusOnNextTabbableElement()})},this.wrapperDiv.on("click",()=>{this.isRubricEvalMode()||(this.isWrapperDivClickHandled=!0,this.scope.onClick&&!this.isReadOnly()&&this.scope.onClick(),this.wrapperDiv.addClass(t.WRAPPER_FOCUS_CLASS),this.inputElement.is(":focus")||(this.inputElement.focus(),this.inputElement.select()))}),this.inputElement.on("click",t=>{e("#performanceCodes-"+this.id).hasClass("f-open-dropdown")&&(t.preventDefault(),t.stopPropagation())}),this.inputElement.on("focus",n=>{if(!this.isProcessingFocusEvent){this.isProcessingFocusEvent=!0;try{n.preventDefault(),n.stopPropagation(),this.wrapperDiv.addClass(t.WRAPPER_FOCUS_CLASS),this.inputElement.select(),this.scope.$emit("grade-input-in-focus",this.id);const s=e("#performanceCodes-"+this.id);this.scope.offsetTop&&this.scope.offsetTop()||s.addClass("show"),this.isWrapperDivClickHandled||this.timeout(()=>{s&&!s.hasClass("f-open-dropdown")&&(this.inputElement.trigger("click.fndtn.dropdown"),this.scope.offsetTop&&this.repositionGradeNotationDropdown(s))},this.scope,0,!1)}finally{this.isProcessingFocusEvent=!1}}}),this.inputElement.on("keydown",t=>{const n=e("#performanceCodes-"+this.id);if(n&&n.hasClass("f-open-dropdown")&&t.keyCode===p.u&&!t.shiftKey){this.inputElementBluredByTab=!0;const e=n.find(":tabbable");e&&(e.first().focus(),t.preventDefault(),t.stopPropagation())}else(t.keyCode===p.f||t.keyCode===p.m||t.keyCode===p.u&&!t.shiftKey)&&(t.preventDefault(),this.inputElement.is(":focus")&&this.inputElement.trigger("click.fndtn.dropdown"),this.$q.when(this.validateAndSave()).finally(()=>{this.gradeDialog.isVisible||this.setFocusOnNextTabbableElement()}))}),this.element.foundation(),this.scope.$watch("::column",e=>{e&&(this.courseId=e.courseId,this.gradeDisplayItem.init(e).then(()=>{this.attrs.gradeDetail&&this.scope.$watchGroup(["gradeDetail.id","gradeDetail.displayGrade","gradeDetail.ui.attempt.displayGrade","isGroupGradeInProgress()","isGroupGradeMultiple()","column.gradingSchemaId","column.possible"],e=>{this.isSaving||this.refreshInputBox()})}),e.externalGrade?this.errorMessageKey="components.directives.grade.grade-input.errorMessage.overallGrade":this.errorMessageKey="components.directives.grade.grade-input.errorMessage.default")}),this.buildGradeDialog()}buildGradeDialog(){this.gradeDialog={isVisible:!1,textContent:{title:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.title"),body:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.body"),secondaryButtonText:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.secondaryButtonText"),primaryButtonText:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.primaryButtonText")},onDismiss:this.onDismissCallback,onSuccess:this.onSuccessCallback}}getStringFromLocale(e){return this.bbLocalize.translateSync({key:e,locale:this.bbLocalize.getLocale(this.scope)})}isFormDirty(){return this.form[this.id].$dirty}isFormValid(){return this.form[this.id].$valid}repositionGradeNotationDropdown(e){const t=this.inputElement.closest(this.gradeNotationsWrapperSelector).height(),n=e.position()&&e.position().top;let s=n+e.height();if(this.scope.offsetTop&&this.scope.offsetTop()){const t=n+2*this.scope.offsetTop();e.css("top",t),e.addClass("show"),s=t+e.height()}s>t&&this.scope.$root.$broadcast("performance-dropdown-container-height-update",s-t+30)}showGradeNotationDropdown(){e("#performanceCodes-"+this.id).length>0&&e("#performanceCodes-"+this.id).remove();const t=this.$compile(w)(this.scope);this.inputElement.closest(this.gradeNotationsWrapperSelector).append(t),this.scope.offsetTop&&this.isWrapperDivClickHandled&&this.repositionGradeNotationDropdown(t),t.on("keydown",n=>{if(n.keyCode!==p.u||n.shiftKey)n.keyCode===p.g&&(n.preventDefault(),n.stopPropagation(),this.inputElement.trigger("click.fndtn.dropdown"),this.timeout(()=>{e("#performanceCodes-"+this.id).remove()},this.scope,0,!1),this.$q.when(this.validateAndSave()).finally(()=>{this.gradeDialog.isVisible||this.setFocusOnNextTabbableElement()}));else{const e=t.find(":tabbable");e.last().is(":focus")&&(n.preventDefault(),e.eq(0).focus())}}),this.element.foundation()}refreshInputBox(){const e=this.scope.gradeDetail&&this.scope.gradeDetail.id,t=this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade,n=this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress(),s=this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple(),i=this.scope.column.gradingSchemaId;this.gradeDisplayItem.schema.id!==i&&this.gradeDisplayItem.init(this.scope.column),e&&t?(this.gradeDisplayItem.displayGrade=t,this.updateGradeColor()):n?(this.gradeDisplayItem.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.in_progress"}),this.gradeDisplayItem.parsedValue="",this.updateGradeColor()):s?(this.gradeDisplayItem.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.multiple"}),this.gradeDisplayItem.parsedValue="",this.updateGradeColor()):t?(this.gradeDisplayItem.displayGrade=t,this.updateGradeColor()):(this.gradeDisplayItem.displayGrade=null,this.updateGradeColor())}shouldShowTotalPoints(){return(this.gradeDisplayItem.shouldShowTotalPoints()||this.hasFocus()||this.form[this.id]&&this.isFormDirty())&&(!this.isMultipleShown()&&!this.isInProgressShown()||(this.isMultipleShown()||this.isInProgressShown())&&this.hasFocus())&&!this.getPerfCodeFromDisplayValue(this.gradeDisplayItem.displayValue)}isReadOnly(){return this.scope.readOnly&&this.scope.readOnly()}hasFocus(){return this.inputElement.is(":focus")||this.wrapperDiv.hasClass(t.WRAPPER_FOCUS_CLASS)}scoreHasChanged(){var e;return((null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.getScore())?this.bbLocalize.parseNumberSync(this.scope.gradeDetail.getScore()):null)!==(this.gradeDisplayItem.displayValue?this.bbLocalize.parseNumberSync(this.gradeDisplayItem.displayValue):null)}validateAndSave(e){if(!this.isGradeErased()||e||this.isGradeErased()&&!this.scope.hasRubricClearConfirmationCallout){if(this.wrapperDiv.removeClass(t.WRAPPER_FOCUS_CLASS),this.scope.$emit("grade-input-blur",this.id),this.shouldShowPastDueZeroIndicator()&&""===this.form[this.id].$viewValue&&(this.gradeDisplayItem.displayValue="0",this.form[this.id].$setPristine()),this.isFormValid())if(this.isFormDirty()&&this.scoreHasChanged()){if(this.scope.forGroup&&this.isReservedWord(this.form[this.id].$viewValue))this.wrapperDiv.removeClass(this.inputColorClass);else if(!this.isSaving){const e=this._save();return this.scope.$emit("grade-input-save-promise",e),e.then(e=>{this.form[this.id]&&this.form[this.id].$setPristine(),this.alertScreenReaderNewGrade=!0,this.scope.$emit("bb-grade-input-save",e,this.scope.column.id,this.scope.forUser&&this.scope.forUser.id),this.refreshInputBox()}).finally(()=>{this.isSaving=!1}),e}}else this.form[this.id].$setPristine(),this.refreshInputBox()}else this.isSaving||(this.gradeDialog.isVisible=!0)}_validate(){const e=this.grade.createGradeSubmission(this.scope.column,this.gradeDisplayItem.displayValue,this.gradeDisplayItem.schema);e.clearGrade=this.isGradeErased();const t=this.grade.validateGrade(e,this.scope);return this.$q.when(t).then(e=>{this.form[this.id].$setValidity("invalidGrade",e)})}getPerfCodeFromDisplayValue(e){let t=null;if(e){const n=this.scope.gradeNotations?this.scope.gradeNotations():[];if(n.length>0){const s=i.find(n,t=>t.code===e);s&&(t=s.id)}}return t}_save(){var e,t,n;let s=this.$q.when();const o=null!==(t=null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.ui.groupAttempt)&&void 0!==t?t:null===(n=this.scope.gradeDetail)||void 0===n?void 0:n.ui.attempt;this.isSaving=!0,this.perfCodeId=this.getPerfCodeFromDisplayValue(this.gradeDisplayItem.displayValue);const a=this.perfCodeId?this.gradeDisplayItem.displayValue:this.grade.parseGrade(this.gradeDisplayItem.displayValue,this.gradeDisplayItem.schema,this.scope),r=this.grade.createGradeSubmission(this.scope.column,a,this.gradeDisplayItem.schema);if(this.perfCodeId&&(r.perfCodeId=this.perfCodeId),this.scope.column&&this.scope.column.externalGrade&&this.scope.gradeDetail){const e=this.scope.gradeDetail.pointsPossible||this.scope.column.possible,t=r.gradeValue;if(e&&e>0&&t&&t.isNumeric){const n=parseFloat(t.grade);t.grade=String(100*n/e)}}if(this.isGradeErased()&&(r.clearGrade=!0,this.scope.forGroup?r.groupAttemptId=null==o?void 0:o.id:r.attemptId=null==o?void 0:o.id,(this.scope.column.isAssignment()||this.scope.column.isDiscussion())&&(this.scope.forGroup?this.scope.forGroup&&!this.scope.gradeDetail.ui.groupAttempt&&(s=this.scope.column.getContentGroupIdToGroupAttempt({expand:"attempts,toolAttemptDetail,attempts.toolAttemptDetail,lastFeedbackAuthor,attempts.lastFeedbackAuthor"}).then(e=>{i.values(e.lookup).forEach(e=>{e[0].groupId===this.scope.forGroup.id&&(this.scope.gradeDetail.ui.groupAttempt=e[0])})})):s=this.$q.when()),this.isRubricAssociated())){const e=null==o?void 0:o.rubricEvaluation;e&&(e.cells=[]),r.setGradeToEmpty=!0,r.rubricEvaluation=e}return s.then(()=>{const e=this.scope.override&&this.scope.override()&&!(this.isGradeErased()&&(this.scope.column.isAssignment()||this.scope.column.isDiscussion()||this.scope.forGroup))?null:o,t=!(!this.scope.gradeDetail||!this.scope.gradeDetail.isPosted()),n=this.isGradeErased();let s=this.scope.gradeDetail;return this.scope.column.externalGrade&&s&&(s=this.grade.percentageToGradeDetail(s,this.scope.column.possible)),this.grade.saveGrade(r,s,e,{userId:this.scope.forUser&&this.scope.forUser.id,group:this.scope.forGroup}).then(e=>{if(this.isRubricAssociated()&&this.$rootScope.$emit(u.d,r.gradeValue.grade),this.scope.column.externalGrade&&e.displayGrade&&e.displayGrade.isOverride&&(e.pointsPossible=100),e instanceof this.AttemptModel)this.scope.gradeDetail.displayGrade=e.displayGrade,n&&(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.NoOverride),Object.assign(this.scope.gradeDetail.ui.attempt,e);else if(e instanceof this.GroupAttemptModel)this.gradeDisplayItem.displayGrade=e.displayGrade,this.scope.gradeDetail.displayGrade=e.displayGrade;else if(e instanceof this.GradeModel){const t=this.scope.gradeDetail?this.scope.gradeDetail.permissions:null;this.scope.gradeDetail=e,t&&(this.scope.gradeDetail.permissions=t),this.scope.column.externalGrade&&e.displayGrade&&!e.displayGrade.isOverride&&(this.scope.gradeDetail=this.grade.gradeDetailToPercentage(this.scope.gradeDetail)),this.scope.column.externalGrade&&(this.gradeDisplayItem.gradeDetail=this.scope.gradeDetail)}else e[0]instanceof this.GradeModel&&(this.scope.gradeDetail.displayGrade=e[0].displayGrade);return(this.scope.column.isAssignment()||this.scope.column.isDiscussion())&&!n&&t&&(e.isPosted&&!e.isPosted()||e.isCompleted&&!e.isCompleted()||e[0]&&e[0].isReadyToPost&&e[0].isReadyToPost())?this._postGrade(e):e})})}_postGrade(e){return this.scope.forGroup?this.scope.column.postReadyGroupAttempts({groupAssociationId:this.scope.gradeDetail.ui.groupAttempt.groupAssociationId}).then(t=>(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.IsPosted,e instanceof Array&&e.forEach(e=>{e.manualStatus=y.ManualGradeStatus.IsPosted}),e)):this.scope.gradeDetail.postReadyGrades().then(t=>(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.IsPosted,e.status=y.AttemptStatus.Completed,e))}isMultipleShown(){return this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple()}isInProgressShown(){return this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress()}gradeValueOnChange(){this.$q.when(this._validate()).then(()=>{this.scope.hasGradeAndIsValid=this.form[this.id].$valid&&!!this.gradeDisplayItem.displayValue})}onFocus(){this.canOverrideByGradeNotation()&&this.showGradeNotationDropdown(),this.isFormValid()&&!this.isFormDirty()&&(this.gradeDisplayItem.displayValue=this.gradeDisplayItem.parsedValue)}shouldShowOverrideIndicator(){return!(null==this.scope.enableOverrideIndicator||!this.scope.enableOverrideIndicator||!this.scope.gradeDetail)&&(!this.shouldShowPastDueZeroIndicator()&&this.grade.isRubricGradeOverridden(this.scope.gradeDetail,this.scope.gradeDetail.ui.attempt,this.scope.column,this.scope.forGroup))}shouldShowPastDueZeroIndicator(){return this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade&&this.scope.gradeDetail.displayGrade.scoredByAutomaticZero}isRubricAssociated(){return this.scope.column.hasRubricAssociation()}isRubricEvalMode(){return!!this.scope.enableRubricEvalAction&&this.scope.enableRubricEvalAction()&&this.isRubricAssociated()}shouldShowInput(){return!this.isRubricEvalMode()||this.isRubricEvalMode()&&this.scope.enableEditableInputMode}openRubricEvaluation(){var e,t;if(!this.isRubricAssociated()||this.scope.disableRubricEvalClick&&this.scope.disableRubricEvalClick())return;let n;n=(null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.groupAssociationId)?(null===(t=this.scope.forUser)||void 0===t?void 0:t.id)||null:this.scope.gradeDetail.user&&(this.scope.gradeDetail.user.$pk||this.scope.gradeDetail.user.id)||null,this.timeout(()=>{this.ultraState.goPeekState("rubric-evaluation",{userId:n,groupId:this.scope.forGroup?this.scope.forGroup.id:null,columnId:this.scope.column.id})},this.scope,0,!1)}updateGradeColor(){this.wrapperDiv.removeClass(this.inputColorClass),!this.gradeDisplayItem.displayValue||this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple()||this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress()||(this.inputColorClass=this.gradeDisplayItem.getGradeColor(),this.wrapperDiv.addClass(this.inputColorClass))}isGradeErased(){return this.isFormDirty()&&this.gradeDisplayItem.wasValueErased}setFocusOnNextTabbableElement(){this.timeout(()=>{c.b(null,this.inputElement)},this.scope,0,!1)}isReservedWord(e){const t=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.multiple"}).toLocaleLowerCase(),n=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.in_progress"}).toLocaleLowerCase(),s=e.toLocaleLowerCase();return s===t||s===n}getGradeInputAriaLabelKey(){if(!this.scope.forUser&&!this.scope.forGroup)return;let e="components.directives.grade.grade-input.aria.",t=this.shouldShowOverrideIndicator()?"overrideScoreInput":"scoreInput";return this.shouldShowPastDueZeroIndicator()&&(t="pastDueZeroScoreInput"),e+=t,this.scope.forGroup&&(e+="Group"),e+=this.gradeDisplayItem.displayValue?"Graded":"Empty"}canOverrideByGradeNotation(){const e=this.scope.gradeNotations?this.scope.gradeNotations():[];return this.scope.canOverrideByGradeNotation&&this.scope.canOverrideByGradeNotation()&&(e&&e.length>0||this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade&&this.scope.gradeDetail.displayGrade.isOverride)}getAriaDescribeById(){return`invalidGradeAriaDescribeById_${this.scope.forUser.id}`}clickGradeNotation(e,t){t.stopPropagation(),this.gradeDisplayItem.displayValue=e.code,this.perfCodeId=e.id,this.afterClickDropdownListItem()}undoOverride(){this.gradeDisplayItem.displayValue="",this.perfCodeId=null,this.afterClickDropdownListItem()}afterClickDropdownListItem(){this.form[this.id].$setDirty(!0),this.form[this.id].$setValidity("invalidGrade",!0),this.timeout(()=>{e("#performanceCodes-"+this.id).remove()},this.scope,0,!1),this.$q.when(this.validateAndSave()).finally(()=>{this.setFocusOnNextTabbableElement()})}onBlur(t){this.isWrapperDivClickHandled=!1;let n=[];t&&t.relatedTarget&&t.relatedTarget.classList&&(n=t.relatedTarget.classList),this.inputElementBluredByTab||i.includes(n,"performance-code-option")||(this.timeout(()=>{this.inputElementBluredByTab=!1,e("#performanceCodes-"+this.id).remove()},this.scope,0,!1),this.validateAndSave())}};O.WRAPPER_CLASS="wrapping-input-style",O.WRAPPER_FOCUS_CLASS="wrapping-input-style-focus",O=Object(s.__decorate)([Object(s.__param)(0,Object(C.b)("$rootScope")),Object(s.__param)(1,Object(C.b)("$compile")),Object(s.__param)(2,Object(C.b)("$q")),Object(s.__param)(3,Object(C.b)("$injector")),Object(s.__param)(4,Object(C.b)("scope")),Object(s.__param)(5,Object(C.b)("element")),Object(s.__param)(6,Object(C.b)("attrs")),Object(s.__param)(7,Object(C.b)("form")),Object(s.__param)(8,Object(C.b)(a.serviceName)),Object(s.__param)(9,Object(C.b)(d.i)),Object(s.__param)(10,Object(C.b)(m.A.serviceName)),Object(s.__param)(11,Object(C.b)(m.D.serviceName)),Object(s.__param)(12,Object(C.b)(m.E.serviceName)),Object(s.__param)(13,Object(C.b)(m.m.serviceName)),Object(s.__param)(14,Object(C.b)(b.b)),Object(s.__param)(15,Object(C.b)(v.d))],O);class E{constructor(e,t){this.$injector=e,this.bbLocalize=t,this.restrict="E",this.template=f,this.require="^form",this.scope={column:"=",gradeDetail:"=",onClick:"&",onBlur:"&",enableRubricEvalAction:"&?",hasRubricClearConfirmationCallout:"<?",disableRubricEvalClick:"&?",enableEditableInputMode:"&?",forUser:"=?",forGroup:"=?",hasGradeAndIsValid:"=?",isGroupGradeMultiple:"&?",isGroupGradeInProgress:"&?",notAllowEmptyString:"&?",override:"&?",readOnly:"&?",enableOverrideIndicator:"=?",canOverrideByGradeNotation:"&?",gradeNotations:"&?",gradeNotationsWrapperSelector:"@?",offsetTop:"&?"},this.link=(e,t,n,s)=>{if(!n.id&&!n.column)throw new Error("Id and Column are required.");if(!n.gradeDetail)throw new Error("A grade object must be provided");if(n.gradeDetail&&!n.forUser&&!n.forGroup)throw new Error("forUser or forGroup is required.");e.gradeInput=this.$injector.instantiate(O,{scope:e,element:t,attrs:n,form:s})}}}E.$inject=["$injector"],o.module(I,["puElasticInput",r.a,h.a,g.a,v.b,S.a]).directive("bbGradeInput",["$injector",e=>e.instantiate(E)])}).call(this,n("5iHu"))},"Aw+3":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-feedback",use:"icon-small-feedback-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-feedback"><path d="M1 1h14v12h-4l-3 2-3-2H1V1zM4 4h8M4 7h8M4 10h4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},BJLZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("5iHu"),i=n("Llzl"),o=n("e6jQ"),a=n("lEL+");const r="ultra.directives.accessibility.alert";class c{constructor(e,t){this.$injector=e,this.timeout=t,this.restrict="A",this.link=(e,t,n)=>{this.alertContainerId=n.alertId?n.alertId:o.a(),e.$on("$destroy",()=>{s(`#${this.alertContainerId}`).remove()}),e.$watch(()=>t.html(),t=>{this.alertArea.html("");const s=Number(n.bbAxAlert)||0;null!=t&&""!==t&&(0===s?this.trigger(t):this.timeout(this.trigger.bind(this,t),e,s,!1))})},this.trigger=e=>{this.alertArea.append(s(`<div id="${this.alertContainerId}"></div>`).append(e))},this.alertArea=s("body > .ax-alert-area"),0===this.alertArea.length&&(s("body").append('<div class="ax-alert-area" role="alert" aria-atomic="false" aria-live="assertive"></div>'),this.alertArea=s("body > .ax-alert-area"))}}c.$inject=["$injector",a.b],i.module(r,[a.a]).directive("bbAxAlert",["$injector",e=>e.instantiate(c)])},BLb8:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const s=(e,t)=>{e.$on("refresh-items",t)},i=(e,t)=>{e.$on("close-scorm-launch-frame",t)},o=(e,t)=>{e.content.$fetch().$asPromise().then(n=>{n===e.content?((e,t)=>{t?e.$broadcast("refresh-items",t):e.$broadcast("refresh-items")})(e,t):e.content=n})}},BMpZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("D57K"),i=n("aHpC"),o=n("yC9S"),a=(n("DlnX"),n("IgL1"));const r="ultra.components.directives.buttonComplexTooltip";let c=class{constructor(e,t){this.$scope=e,this.$rootScope=t}$onInit(){this.$scope.buttonComplexTooltip=this}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}};c=Object(s.__decorate)([Object(o.a)({moduleName:r,componentName:"bbButtonComplexTooltip",template:a}),Object(s.__param)(0,Object(i.b)("$scope")),Object(s.__param)(1,Object(i.b)("$rootScope"))],c)},BXQP:function(e,t){e.exports='<div class="timestamp" bb-load-bundle="components/directives/duration" ng-cloak bb-cache-compilation="duration-directive">\n  <div ng-if="!duration.needAgo()">\n    <div class="js-split-datetime" ng-if="duration.separateDatetime()">\n      <span class="date" ng-bind="duration.date"></span>\n      <span class="time" ng-bind="duration.time"></span>\n    </div>\n    <bb-datetime ng-if="!duration.separateDatetime()" ng-class="{\'date\':duration.date}" value="date" format="Short"></bb-datetime>\n  </div>\n  <div ng-if="duration.needAgo()"\n       class="js-duration-ago"\n       bb-translate="components.directives.duration.agoText"\n       translate-values="{durationDate: duration.date, durationTime: duration.time}"></div>\n</div>'},BiyI:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-add-plus",use:"icon-small-add-plus-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add-plus"><path d="M8 5v6M11 8H5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},C2vp:function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"l",(function(){return v})),n.d(t,"k",(function(){return f})),n.d(t,"c",(function(){return C})),n.d(t,"g",(function(){return y})),n.d(t,"j",(function(){return w})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return O})),n.d(t,"d",(function(){return E})),n.d(t,"h",(function(){return D})),n.d(t,"b",(function(){return k}));var s,i=n("D57K"),o=n("X/qj"),a=n("FBBZ"),r=n("pjml"),c=n("nsO7"),l=n("TnpK"),d=n("yMoE"),u=n("A0nf"),h=n("8jzW"),p=n("vhkR"),m=n("nmzr"),b=n("aHpC");!function(e){e[e.UNLOADED=0]="UNLOADED",e[e.WAITING=1]="WAITING",e[e.LOADING=2]="LOADING",e[e.LOADED=3]="LOADED"}(s||(s={}));let g=class{constructor(e,t,n,i,o,a,r,c,l,d,u=null,h=s.UNLOADED){this.$q=e,this.$injector=t,this.ltiService=n,this.CourseModel=i,this.scoreProviderHelper=o,this.ultraState=a,this.gradebookPermissionService=r,this.gridData=c,this.row=l,this.column=d,this.data=u,this.loadState=h}get isUnloaded(){return this.loadState===s.UNLOADED}get isWaiting(){return this.loadState===s.WAITING}get isLoading(){return this.loadState===s.LOADING}get isLoaded(){return this.loadState===s.LOADED}get isPosted(){return!c.isNull(this.data)&&this.data.grade.isPosted()}get hasNewSubmission(){return!c.isNull(this.data)&&this.data.needsGradingAttemptCount>0}get isPastDueZero(){return!c.isNull(this.data)&&this.data.grade.isPastDueZero()}setLoadState(e){this.loadState=e}getScore(e){const t=this.getGrade();if(null==t)return;const n=t.displayGrade,s=this.column.data,i=this.getGridData().getSchema()[s.gradingSchemaId],o=this.$injector.instantiate(d.a,{scope:e,gradeDetail:t});return o.init(s,i),o.displayGrade=n,o.parsedValue}getGrade(){return c.isNull(this.data)?void 0:this.data.grade}view(){throw new Error("Unsupported operation exception")}post(){return this.data&&this.column.data.grades.$new(this.data.grade.id).postReadyGrades()}get canBeView(){return!1}get isReadyToPost(){return!this.isPosted}canPost(){return this.gradebookPermissionService.canPostGrades(null,this.column.data)}getGridData(){return this.gridData}get isCleanAttemptGrade(){return!1}get isNeedAutoPost(){return!1}get canBeEdited(){return this.column.data.delegatedGrading?this.canPost():!this.isAnonymousGrading}get isAnonymousGrading(){return this.column.data.anonymousGrading}};g=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(p.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(h.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column"))],g);let v=class extends g{constructor(e,t,n,i,o,a,r,c,l,d){super(e,t,n,i,o,a,r,c,l,d,null,s.LOADED),this.$q=e,this.$injector=t,this.ltiService=n,this.CourseModel=i,this.scoreProviderHelper=o,this.ultraState=a,this.gradebookPermissionService=r,this.gridData=c,this.row=l,this.column=d}};v.$inject=[],v=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(p.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(h.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column"))],v);class f extends g{}class C extends g{canPost(){return!1}get canBeEdited(){return!1}}class y extends g{}class w extends y{get canBeView(){return this.gradebookPermissionService.canViewGrades()}view(){this.ultraState.goPeekState(m.GradeRoutes.GRADE_AND_FEEDBACK,{columnId:this.column.id,userId:this.row.metadata.user.id})}}class S extends y{getGroupId(){}get canBeView(){return this.gradebookPermissionService.canViewAttempts()&&!!this.data&&this.data.attemptCount>0}view(){var e;if(null!=this.column.data.linkId&&(u.a.PartnerCloud.isEqualTo(this.column.data.scoreProviderHandle)||u.a.LTILink.isEqualTo(this.column.data.scoreProviderHandle)))this.CourseModel.$new(this.gridData.course.id).gradebook.columns.$new(this.column.id).grades.$new(this.data.grade.id).attempts.$fetch().$then(e=>{const t=a.d({gradableItemId:this.column.id,courseId:this.gridData.course.id,attemptId:e[0].id,membershipId:this.row.metadata.id,linkId:this.column.data.linkId});this.ltiService.launch(t)});else{const t={courseId:this.gridData.course.id,columnId:this.column.id,gradeId:this.data.grade.id,contentId:this.column.data.contentId,userId:this.row.metadata.user.id},n=(null===(e=this.data.grade.attempts)||void 0===e?void 0:e.length)>this.column.data.multipleAttempts;if(!(this.column.data.isAttemptBased&&(this.column.data.isMultipleAttempts()||n)))if(this.data.grade.lastAttemptId)t.attemptId=this.data.grade.lastAttemptId;else if(this.data.grade.attempts&&this.data.grade.attempts.length){const e=c.last(this.data.grade.attempts);t.attemptId=e&&e.id}else if(this.data.grade.groupAttempts&&this.data.grade.groupAttempts.length){const e=c.last(this.data.grade.groupAttempts);t.attemptId=e&&e.id}t.groupId=this.getGroupId(),this.scoreProviderHelper.gradingStateRef(this.column.data,this.data.grade,t,h.a.GoToState)}}}class I extends S{constructor(e,t,n,s,i,o,a,r,c,l,d){super(e,t,n,s,i,o,a,r,c,l),this._group=d}getGroupId(){return this.group.groupId}get group(){return this._group}}I.$inject=["$q","$injector",p.b,r.m.serviceName,h.c,l.d,o.b,"gridData","row","column","group"];let O=class extends I{constructor(e,t,n,s,i,o,a,r,c,l,d){super(e,t,n,s,i,o,a,r,c,l,d),this.$q=e,this.$injector=t,this.ltiService=n,this.CourseModel=s,this.scoreProviderHelper=i,this.ultraState=o,this.gradebookPermissionService=a,this.gridData=r,this.row=c,this.column=l}get canBeView(){return!0}view(){this.ultraState.goPeekState("submission-list",{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.user.id,disGroupId:this.getGroupId()})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}};O.$inject=[],O=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(p.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(h.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column")),Object(i.__param)(10,Object(b.b)("group"))],O);class E extends S{get canBeView(){return!0}view(){this.ultraState.goPeekState("submission-list",{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.user.id})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}}class D extends S{get canBeView(){return!0}view(){this.ultraState.goPeekState(m.JournalRoutes.JOURNAL_PARTICIPATION_DETAIL,{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.id,gradebookView:"grid"})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}}class k extends y{get isAttendance(){return!0}get canBeView(){return!0}view(){const e=this.row.metadata.user.id,t=this.row.metadata.id;this.ultraState.goPeekState("attendance-student-records",{userId:e,membershipId:t})}}},C36k:function(e,t,n){"use strict";n("67oV");var s=n("Llzl"),i=n("+4Px"),o=n("e6jQ"),a=n("GbAM"),r=n("lEL+"),c=n("0JpG"),l=n("GwhK");n.d(t,"a",(function(){return d}));const d="ultra.components.directives.typeahead-search-box";class u{constructor(e,t,n,s,i){this.scope=e,this.$rootScope=t,this.element=n,this.timeout=s,this.bbLocalize=i,this.showResults=!1,this.searchValue="",this.isFocus=!1,this.srLabel=e.srLabel,this.inputPlaceholder=e.inputPlaceholder||"",this.srEmptyResults=e.srEmptyResults||"",this.srResultsFound=e.srResultsFound,this.srNoResultsFound=e.srNoResultsFound,this.clearAriaLabel=e.clearAriaLabel,this.icon=e.icon,this.randomElementId=this.scope.randomElementId||o.a(),this.srResultsFound&&this.srNoResultsFound&&this.clearAriaLabel||this.bbLocalize.loadBundle("components/directives/typeahead").then(()=>{this.srResultsFound="typeahead.resultsFound",this.srNoResultsFound="typeahead.noResultsFound",this.clearAriaLabel="typeahead.clear"}),e.$on("typeahead-search-box-clear",(function(){e.typeaheadSearchBox.showResults=!1,e.typeaheadSearchBox.searchResults=[],e.typeaheadSearchBox.searchValue=""}))}onSearchValueChange(){this.searchValue.length>0?this.typeAheadSearch(this.searchValue):this.clear()}itemSelected(e){const t=this.scope.itemSelected({item:e});this.showResults=!1,this.searchResults=[],s.isString(t)?this.searchValue=t:this.searchValue="",this.element.find("input").focus()}search(e){if(this.searchValue.length>0){const t=this.scope.search({searchText:e});t&&(this.showResults=!1,this.searchResults=[],s.isString(t)?this.searchValue=t:this.searchValue="")}}typeAheadSearch(e){this.scope.typeAheadSearch({searchText:e}).then(e=>{this.searchResults=e,this.showResults=e.length>0,this.getSearchResultsAlert(this.showResults)})}getSearchResultsAlert(e){const t=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:e?this.srResultsFound:this.srNoResultsFound,noWrap:!0,noEscape:!0});this.timeout(()=>{this.$rootScope.$broadcast(a.b,t)},this.scope,1e3)}handleUpAndDownArrow(e){this.showResults||(this.showResults=!0);let t=s.element(e.target);t.hasClass("typeahead-search-entry")?(t=e.keyCode===i.d?t.next():t.prev()).focus():this.element.find(".typeahead-search-entry:first").focus(),e.preventDefault()}onInputBoxKeyDown(e){e.keyCode===i.f?this.search(this.searchValue):e.keyCode===i.d||e.keyCode===i.v?this.handleUpAndDownArrow(e):e.keyCode===i.g&&this.showResults&&(this.showResults=!1,e.stopPropagation(),e.preventDefault())}onFocusInputBox(e){this.searchResults&&this.searchResults.length>0&&(this.showResults=!0)}onFocusClearBtn(e){this.isFocus=!0}onBlurClearBtn(e){document.activeElement!==e.currentTarget&&(this.showResults=!1,this.isFocus=!1)}onClickOutside(){this.showResults=!1}onInputBoxClick(){this.showResults=!0}onResultEntryKeyDown(e,t){e.keyCode===i.f||e.keyCode===i.t?this.itemSelected(t):e.keyCode===i.d||e.keyCode===i.v?this.handleUpAndDownArrow(e):e.keyCode===i.u?this.showResults=!1:e.keyCode===i.g&&(this.showResults=!1,this.element.find("input").focus(),e.stopPropagation(),e.preventDefault())}onResultEntryClick(e,t){this.itemSelected(t)}clear(){const e=this.searchValue;this.showResults=!1,this.searchResults=[],this.searchValue="",this.timeout(()=>{(this.scope.clearSearch||s.noop)({searchText:e})},this.scope,50)}}u.$inject=["scope","$rootScope","element",r.b,c.serviceName];class h{constructor(e,t){this.$interpolate=e,this.$injector=t,this.restrict="E",this.template=l,this.scope={itemSelected:"&",search:"&",typeAheadSearch:"&",inputPlaceholder:"@?",clearSearch:"&",srEmptyResults:"@",srLabel:"@",srResultsFound:"@?",srNoResultsFound:"@?",clearAriaLabel:"@?",icon:"@?",randomElementId:"@?"},this.transclude=!0,this.replace=!0,this.link=(e,t)=>{e.typeaheadSearchBox=this.$injector.instantiate(u,{scope:e,element:t})}}}h.$inject=["$interpolate","$injector"],s.module(d,[]).directive("bbTypeaheadSearchBox",["$injector",e=>e.instantiate(h)]).directive("typeaheadInject",()=>({link(e,t,n,s,i){if(i){const n=e.$new();i(n,(function(e){t.empty(),t.append(e),t.on("$destroy",(function(){n.$destroy()}))}))}}}))},CG4K:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-custom-toggle-grid",use:"icon-custom-toggle-grid-usage",viewBox:"0 0 12 12",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="icon-custom-toggle-grid"><path fill="none" stroke-width="2" stroke-miterlimit="10" d="M0 1h12M0 6h12M0 11h12M1 12V0M6 12V0M11 12V0" /></symbol>'});i.add(o);e.exports=o},"D8d/":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var s=n("Llzl"),i=n("0JpG"),o=n("A+IJ"),a=n("2a+M"),r=n("pjml"),c=n("lEL+"),l=n("GbAM"),d=n("W6wm");const u="ultra.components.directives.bbDropHandler";class h{constructor(e,t,n,s,i,o,r,c){this.scope=e,this.element=t,this.$rootScope=s,this.$q=i,this.timeout=o,this.dragDropService=r,this.bbLocalizeService=c,this.isDraggingOverFolder=!1,this.isEmptyTarget="emptyTarget"in n,this.dropTargetElement=t.closest(this.dragDropService.dragElementSelector),e.$on("bb-drag-move",()=>{if(this.isEnabledForReordering()&&this.isNotSameDropTarget()&&this.isOnSamePanel()){const e=t.offset(),n=t.height()+e.top,s=t.width()+e.left;this.dragDropService.pointerPosition.left>=e.left&&this.dragDropService.pointerPosition.left<=s&&this.dragDropService.pointerPosition.top>=e.top&&this.dragDropService.pointerPosition.top<=n?this.dragOverFunc(this.dragDropService.pointerPosition.top):this.dragLeaveFunc()}}),e.$on("bb-drag-end",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.dropHandlerFunc()}),t.on("drop",t=>{t.originalEvent.dataTransfer.files&&t.originalEvent.dataTransfer.files.length>0&&e.onFileDropHandler&&e.onFileDropHandler()(t.originalEvent.dataTransfer.files,e.content())}),e.$on("bb-drag-cancel",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&(e.content().id===this.dragDropService.currentDragId&&(this.dragDropService.positionBefore=e.content().id),this.dropHandlerFunc())}),e.$on("keyboard-drag-start",()=>{this.isEnabledForReordering()&&e.content().id===this.dragDropService.currentDragId&&(this.dragPosition=a.b.SELF,this.dragDropService.originalElement=t.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass),this.dragDropService.originalElement.addClass(this.dragDropService.dragHoverClass),this.dragDropService.setDropTarget(e.content().id))}),e.$on("keyboard-drag-end",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.timeout(()=>{this.dragDropService.originalElement&&this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),a.b.FOLDER.isEqualTo(this.dragPosition)?this.dragDropService.positionAfter=e.content().id:a.b.TOP.isEqualTo(this.dragPosition)?(this.dragDropService.positionBefore=e.content().id,this.dragDropService.positionAfter=null):(this.dragDropService.positionAfter=e.content().id,this.dragDropService.positionBefore=null),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove(),this.isDropPreventedByContentDepthRules().then(t=>{if(!this.isDnDPreventedInDiscussionContext()&&!t&&!this._isDroppingInSamePlace()){const t={dragContentId:this.dragDropService.currentDragId,dragElement:this.dragDropService.currentDragElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};e.onMoveHandler()(t)}this._keyboardEndDragAndClearValues()})},e)}),e.$on("keyboard-drag-cancel",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._keyboardEndDragAndClearValues(),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.remove())}),e.$on("keyboard-drag-up",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.TOP),a.b.SELF.isEqualTo(this.dragPosition)||a.b.TOP.isEqualTo(this.dragPosition)?e.previousContentId&&e.previousContentId()?this.keyboardMoveUpToItem(e.previousContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveOntoFolder(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.FOLDER.isEqualTo(this.dragPosition)?this._keyboardMoveAboveThisItem():a.b.BOTTOM.isEqualTo(this.dragPosition)&&this.isDropPreventedByContentDepthRules().then(t=>{this.isAFolder()?!0!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t?!1!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t||this.keyboardMoveOntoFolder(this.scope.content().id):(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsLastItem()):this._keyboardMoveAboveThisItem()}))}),e.$on("keyboard-drag-down",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.BOTTOM),a.b.SELF.isEqualTo(this.dragPosition)||a.b.BOTTOM.isEqualTo(this.dragPosition)?e.nextContentId&&e.nextContentId()?this.keyboardMoveDownToItem(e.nextContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveBelowItem(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.FOLDER.isEqualTo(this.dragPosition)?this.isDropPreventedByContentDepthRules().then(t=>{e.isFolderOpen&&!0===e.isFolderOpen()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!t?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsFirstItem()):this._keyboardMoveBelowThisItem()}):a.b.TOP.isEqualTo(this.dragPosition)&&this.isDropPreventedByContentDepthRules().then(e=>{this.isAFolder()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!e?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem()}))}),e.$on("keyboard-drag-right",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.FOLDER.isEqualTo(this.dragPosition)&&e.isFolderOpen&&!1===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)}),e.$on("keyboard-drag-left",()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.FOLDER.isEqualTo(this.dragPosition)&&e.isFolderOpen&&!0===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)}),e.$on("keyboard-move-up-to-item",(t,n)=>{this.isEnabledForReordering()&&e.content().id===n&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.SELF,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.scope.isFolderOpen&&!0===this.scope.isFolderOpen()?this.keyboardMoveIntoFolderAsLastItem():(this.dragPosition=a.b.FOLDER,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this._keyboardMoveAboveThisItem())}),e.$on("keyboard-move-down-to-item",(t,n)=>{this.isEnabledForReordering()&&e.content().id===n&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.SELF,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem())}),e.$on("keyboard-move-above-item",(t,n)=>{this.isEnabledForReordering()&&e.content().id===n&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveAboveThisItem())}),e.$on("keyboard-move-below-item",(t,n)=>{this.isEnabledForReordering()&&e.content().id===n&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveBelowThisItem())}),e.$on("keyboard-move-onto-folder",(t,n)=>{this.isEnabledForReordering()&&e.content().id===n&&(this.dragDropService.setDropTarget(e.content().id),this.dragPosition=a.b.FOLDER,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}),e.$on("remove-placeholder",()=>{this.isEnabledForReordering()&&this.dragDropService.dropPlaceholderElement&&this.dragDropService.dropPlaceholderElement.remove(),this.isEmptyTarget&&this.element.children("bb-add-content-button").show()})}_keyboardMoveBelowThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.content().id):this.scope.nextContentId&&this.scope.nextContentId()===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.nextContentId()):(this.dragPosition=a.b.BOTTOM,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_keyboardMoveAboveThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.content().id):this.scope.previousContentId&&this.scope.previousContentId()===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.previousContentId()):(this.dragPosition=a.b.TOP,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_informScreenReaderOfNewLocation(){const e=this.element.find("[bb-drag-handle]").eq(0).attr("drag-item-name");let t="";if(""!==this.dragDropService.queuedScreenReaderMessages&&(t+=this.dragDropService.queuedScreenReaderMessages,t+=" "),-1!==this.dragDropService.currentDropTargetId.indexOf("blank"))return t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-only-item-in-folder",noWrap:!0}),this.$rootScope.$broadcast(l.a,t),void(this.dragDropService.queuedScreenReaderMessages="");this.scope.previousContentId&&this.scope.previousContentId()||!a.b.TOP.isEqualTo(this.dragPosition)&&!a.b.SELF.isEqualTo(this.dragPosition)?this.scope.nextContentId&&this.scope.nextContentId()||!a.b.BOTTOM.isEqualTo(this.dragPosition)&&!a.b.SELF.isEqualTo(this.dragPosition)||(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-end-of-list",noWrap:!0}),t+=" "):(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-top-of-list",noWrap:!0}),t+=" "),a.b.SELF.isEqualTo(this.dragPosition)?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-self",noWrap:!0}):a.b.FOLDER.isEqualTo(this.dragPosition)?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-folder",params:{itemName:e},noWrap:!0}):a.b.TOP.isEqualTo(this.dragPosition)?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-above",params:{itemName:e},noWrap:!0}):a.b.BOTTOM.isEqualTo(this.dragPosition)&&(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-below",params:{itemName:e},noWrap:!0})),this.$rootScope.$broadcast(l.a,t),this.dragDropService.queuedScreenReaderMessages=""}_applyKeyboardPlaceholderAndStyling(){let e=this.dropTargetElement;a.b.SELF.isEqualTo(this.dragPosition)?this.dropTargetElement.addClass(this.dragDropService.dragHoverClass):a.b.FOLDER.isEqualTo(this.dragPosition)?(this.dropTargetElement.before(this.dragDropService.currentDragElement),this.dragDropService.currentDragElement&&(1===this.scope.content().depth?this.dragDropService.currentDragElement.addClass(this.dragDropService.onFolderClass):2===this.scope.content().depth&&this.dragDropService.currentDragElement.addClass(this.dragDropService.onNestedFolderClass))):a.b.BOTTOM.isEqualTo(this.dragPosition)?(e=this.dragDropService.currentDragElement,this.dropTargetElement.after(this.dragDropService.currentDragElement)):a.b.TOP.isEqualTo(this.dragPosition)&&(e=this.dragDropService.currentDragElement,this.dropTargetElement.before(this.dragDropService.currentDragElement)),this._scrollContainer(e)}_removeKeyboardPlaceholderAndStyling(){this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&(this.dragDropService.currentDragElement.removeClass(this.dragDropService.onFolderClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.onNestedFolderClass),this.dragDropService.currentDragElement.remove())}_scrollContainer(e){this.dragDropService.scrollDragDropItemsContainer(e.offset().top,a.a.SCROLLING_CONSTANTS.keyboardInteractionDistanceToScroll)}_keyboardEndDragAndClearValues(){this.timeout(()=>{e('[bb-drag-handle][drag-item-id="'+this.dragDropService.currentDragId+'"]').focus(),this.dragDropService.clearDropTarget(),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dragDropService.isKeyboardDragging=!1},this.scope,0,!1)}isDropPreventedByContentDepthRules(){const e=()=>r.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType);if(void 0!==this.dragDropService.currentDragHasFolderChild)return this.dragDropService.currentDragHasFolderChild.then(t=>e()&&(this.isDraggingOverFolder&&this.scope.content().depth===o.l||this.scope.content().depth>o.l||this.isDraggingOverFolder&&t));const t=this.$q.defer();return t.resolve(!1),t.promise}isDnDPreventedInDiscussionContext(){return(()=>d.a.Discussions===this.dragDropService.currentDragContext)()&&(()=>r.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType))()&&(this.isDraggingOverFolder&&this.scope.content().depth===o.k||this.scope.content().depth>o.k)}dragOverFunc(e){if(this.dragDropService.currentDragId&&this.dragDropService.currentDragId!==this.scope.content().id){this.dragDropService.setDropTarget(this.scope.content().id),!this.folderHoverTimeout&&this.scope.isFolderOpen&&!1===this.scope.isFolderOpen()&&(this.dropTargetElement.addClass(this.dragDropService.dragHoverClass),this.folderHoverTimeout=this.timeout(()=>{this.isDropPreventedByContentDepthRules().then(e=>{e||this.isDnDPreventedInDiscussionContext()?(this.dragDropService.isShowingDepthMessage=!0,this.$rootScope.$broadcast("show-override-message",this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:this.dragDropService.folderDepthMessageKey}),this.scope.content().id)):(this.scope.$emit("toggle-folder-by-id",this.scope.content().id),this.wasFolderOpened=!0)})},this.scope,1500)),this.dragDropService.isShowingDepthMessage&&this.dragDropService.isNotSameDropTarget()&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const t=e,n=this.element.offset().top+this.element.height()/2,s=this.dragPosition;this.isAFolder()&&(this.isDraggingOverFolder=!0),this.scope.content().id.indexOf("placeholder")>-1?(this.dragDropService.positionAfter=this.scope.content().parentId,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.BOTTOM):t<=n?(this.dragDropService.positionBefore=this.scope.content().id,this.dragDropService.positionAfter=void 0,this.dragPosition=a.b.TOP):(this.dragDropService.positionAfter=this.scope.content().id,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.BOTTOM),(this.dragDropService.isNotSameDropTarget()||this.dragPosition!==s)&&(this._moveDropPlaceholderElement(),this.isEmptyTarget&&this.element.children().hide())}}_moveDropPlaceholderElement(){if(this.$rootScope.$broadcast("remove-placeholder"),this.dragDropService.currentDragId===this.dragDropService.currentDropTargetId)return;(()=>this.dragDropService.positionBefore&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfNextItem)()?this.dropTargetElement.before(this.dragDropService.dropPlaceholderElement):(()=>!(this.dragDropService.currentDropTargetId.indexOf("placeholder")>-1&&this.dragDropService.idOfNextItem===this.dragDropService.currentDropTargetId)&&(this.dragDropService.positionAfter&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfPreviousItem))()&&this.dropTargetElement.after(this.dragDropService.dropPlaceholderElement)}_isDroppingInSamePlace(){if(null!=this.dragDropService.positionAfter&&this.scope.previousContentId&&this.dragDropService.positionAfter===this.scope.previousContentId()||this.dragDropService.positionAfter===this.dragDropService.currentDragId||null!=this.dragDropService.positionBefore&&this.scope.nextContentId&&this.dragDropService.positionBefore===this.scope.nextContentId()||this.dragDropService.positionBefore===this.dragDropService.currentDragId)return!0}dropHandlerFunc(){this.timeout.cancel(this.folderHoverTimeout),this.dropTargetElement.parents("[data-parent-id]").last().removeAttr("style"),this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("remove-placeholder"),this.$rootScope.$broadcast("file-drag-restore"),this.dragDropService.isShowingDepthMessage&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const e={dragContentId:this.dragDropService.currentDragId,originalElement:this.dragDropService.originalElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};this.isDropPreventedByContentDepthRules().then(t=>{this._isDroppingInSamePlace()||this.isDnDPreventedInDiscussionContext()?this.dropCleanupFunc():!t&&this.isDraggingOverFolder?this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()):this.scope.$apply(()=>{this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()}):t?this.dropCleanupFunc():this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveHandler()(e),this.dropCleanupFunc()):this.scope.$apply(()=>{this.scope.onMoveHandler()(e),this.dropCleanupFunc()}),this.isDraggingOverFolder=!1})}dropCleanupFunc(){this.wasFolderOpened&&(this.wasFolderOpened=!1,this.scope.$emit("toggle-folder-by-id",this.scope.content().id)),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove()}dragLeaveFunc(){this.isDraggingOverFolder=!1,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.timeout.cancel(this.folderHoverTimeout),this.folderHoverTimeout=void 0,this.isDropPreventedByContentDepthRules().then(e=>{e&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage())})}broadcastShowOverrideMessage(){this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id):this.scope.$apply(()=>this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id))}keyboardMoveUpToItem(e){this.timeout(()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-up-to-item",e)},this.scope)}keyboardMoveDownToItem(e){this.timeout(()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-down-to-item",e)},this.scope)}keyboardMoveBelowItem(e){this.timeout(()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-below-item",e)},this.scope)}keyboardMoveAboveItem(e){this.timeout(()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-above-item",e)},this.scope)}keyboardMoveOntoFolder(e){this.timeout(()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-onto-folder",e)},this.scope)}keyboardMoveIntoFolderAsLastItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveBelowItem(e[e.length-1].id):this.keyboardMoveBelowItem(this.scope.content().id+"blank")}keyboardMoveIntoFolderAsFirstItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveAboveItem(e[0].id):this.keyboardMoveAboveItem(this.scope.content().id+"blank")}isNotSameDropTarget(){return this.scope.content().id!==this.dragDropService.currentDragId}isOnSamePanel(){return this.element.closest(".panel-content").is(this.dragDropService.originalElement.closest(".panel-content"))}isEnabledForReordering(){return!(this.scope.disableForReordering&&this.scope.disableForReordering())}isAFolder(){return null!=this.scope.isFolderOpen}}h.$inject=["scope","element","attrs","$rootScope","$q",c.b,a.d,i.serviceName];class p{constructor(e){this.$injector=e,this.scope={onMoveIntoFolderHandler:"&?",onMoveHandler:"&",onFileDropHandler:"&",isFolderOpen:"&?",content:"&",previousContentId:"&?",nextContentId:"&?",disableForReordering:"&?"},this.restrict="A",this.link=(e,t,n)=>{e.dropHandlerDirective=this.$injector.instantiate(h,{scope:e,element:t,attrs:n})}}}p.$inject=["$injector"],s.module(u,[a.c,c.a]).directive("bbDropHandler",["$injector",e=>e.instantiate(p)])}).call(this,n("5iHu"))},DAbe:function(e,t){e.exports="<div ng-transclude></div>"},DMV0:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.errorTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.errorFull</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="components.directives.cloudStorageIntegration.modal.cancelUploadText">\n    <bb-translate>components.directives.cloudStorageIntegration.modal.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},DXZ4:function(e,t,n){},DnQR:function(e,t){e.exports='<div bb-load-bundle="components/directives/folder" class="folder" ng-class="{\'is-empty-folder\': content.children.length === 0 && folder.showEmptyMenu, \'learning-module\': content.isLearningModule()}" bb-cache-compilation="content-folder">\n  <div bb-drop-handler on-move-handler="onMoveHandler" on-move-into-folder-handler="onMoveIntoFolderHandler" on-file-drop-handler="onFileDropHandler" content="content" is-folder-open="folder.isOpen" next-content-id="nextContentId" previous-content-id="previousContentId">\n    <div ng-if="::(!content.isLearningModule())"\n         class="row collapse element-list-row folder-row-container js-parent js-course-skip-link-target"\n         can-create="canCreate"\n         bb-content-item-mouseover\n         ng-class="{open: folder.isOpen, \'is-conditional-release\': content.isConditionalReleaseLocked(), \'element-list-row-extra-icon\': folder.isProgressTrackingStateShown(content)}"\n         bb-click-to-invoke-child="button.content-title">\n      <bb-content-item-base contents="contents" content="content" context-area="folder.contextArea" can-move="canMove"></bb-content-item-base>\n      <div class="list-tree-toggle" ng-if="folder.canToggle()">\n        <button class="button super-clear"\n                ng-click="folder.toggleFolder()"\n                aria-controls="{{::\'folder-contents-\' + content.id}}"\n                aria-expanded="{{folder.isOpen}}"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.folder.aria-label.toggle-folder\'}"\n                translate-attrs-values="{folderName: content.title}"\n                analytics-id="course.content.folder.toggle.button">\n          <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n        </button>\n      </div>\n    </div>\n\n    <div ng-if="::(content.isLearningModule())" ng-class="{open: folder.isOpen}">\n      <bb-learning-module-base-item content="content" contents="contents" context-area="folder.contextArea" can-toggle="::folder.canToggle()"\n        toggle-func="folder.toggleFolder()" can-move="canMove" is-open="folder.isOpen">\n      </bb-learning-module-base-item>\n    </div>\n  </div>\n  <div ng-attr-id="{{::(content.isLearningModule() ? \'learning-module-contents-\' : \'folder-contents-\') + content.id}}" class="folder-contents" aria-expanded="{{folder.isOpen}}" ng-class="{\'not-empty\': content.children && content.children.length > 0}">\n    <div ng-if="(content.children.length > 0 || folder.showOutlineOverride) && folder.isOpen">\n      <bb-content-outline hide-add-menu-override="folder.showOutlineOverride" on-file-drop-handler="onFileDropHandler" on-move-handler="onMoveHandler"\n                          on-move-into-folder-handler="onMoveIntoFolderHandler" load-more-children="loadMoreChildren" parent-folder="folder.content"\n                          contents="folder.content.children" can-create="canCreate" can-move="canMove" context-area="folder.contextArea"\n                          can-copy-import="canCopyImport"></bb-content-outline>\n    </div>\n    <div class=\'drag-element\'>\n      <div bb-drop-handler\n        ng-show="content.children.length === 0"\n        on-move-handler="onMoveHandler"\n        on-move-into-folder-handler="onMoveIntoFolderHandler"\n        on-file-drop-handler="onFileDropHandler"\n        content="{id: content.id + \'blank\', parentId: content.id, depth: content.depth + 1}"\n        empty-target\n      >\n        <span class="empty-message" ng-if="content.children.length === 0 && folder.showEmptyMenu && !canCreate"\n          ng-class="{\'foder-in-force-sequence-empty-message\': content.isForcedSequenceItem()}"\n          bb-translate="{{\n              content.isLearningModule() ?\n                \'components.directives.learning-module.empty\' :\n                \'components.directives.folder.empty\'\n          }}">\n        </span>\n        \x3c!-- (|| false) keep showMenuOverride in watch status in add-content-button directive --\x3e\n        \x3c!-- use ng-show instead of ng-if to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n        <ng-switch on="::content.isLearningModule()">\n          <bb-add-content-button ng-switch-when="false" show-menu-override="folder.showMenuOverride || false" depth="(content.depth + 1)" content="content"\n                                 root-content="rootContent()" parent-id="content.id" position-before="\'start\'"\n                                 ng-show="canCreate && folder.showEmptyMenu" context-area="folder.contextArea"\n                                 can-copy-import="canCopyImport" folder-nested-button="true"></bb-add-content-button>\n          <bb-add-content-button ng-switch-when="true" show-menu-override="false" depth="(content.depth + 1)" content="content"\n                                 root-content="content" parent-id="content.id" position-before="\'start\'"\n                                 is-render-by-default="true"\n                                 class="empty-lm-add-content-btn"\n                                 ng-show="canCreate && folder.showEmptyMenu" context-area="folder.contextArea"\n                                 can-copy-import="canCopyImport" folder-nested-button="true"></bb-add-content-button>\n        </ng-switch>\n      </div>\n    </div>\n  </div>\n</div>\n'},E7GM:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="grade-grid-group-confirm-dialog" aria-haspopup="true" role="dialog">\n  <div class="message-wrapper">\n    <div class="message">\n      <span bb-translate>components.directives.grade.grid.confirmContent</span>\n    </div>\n    <div class="buttons">\n      <button class="button" \n              ng-click="saveGroup()" \n              bb-translate  \n              analytics-id="components.directives.grade.grid.yes">components.directives.grade.grid.yes</button>\n      <button class="button button--secondary" \n              ng-click="saveOne()" \n              ng-disabled="isSaveOneDisabled" \n              analytics-id="components.directives.grade.grid.no"\n              bb-translate>components.directives.grade.grid.no</button>\n    </div>\n  </div>\n</div>'},EGJL:function(e,t){e.exports='<div ng-class="{\'is-restricted\': graderColumn.column.isHidden() && !graderColumn.column.externalGrade, \'grader-column\': true}">\n  <div class="row tabular-row js-row grader-column-item" bb-click-to-invoke-child="a.bb-click-target" aria-describedby="guidance-moment-grade-click">\n    <div ng-class="{\'medium-5\': !graderColumn.isCourseView, \'medium-4\': graderColumn.isCourseView}" class="columns">\n      <div class="element-card">\n        <div bb-content-item-icon show-alert-icon="graderColumn.showAlertIcon()" content-column="graderColumn.column" class="element-image" ng-if="graderColumn.column"></div>\n        <div class="element-details">\n          <div ng-class="{\'gradebook-overall-grade-title\': graderColumn.column.externalGrade}">\n            <bb-svg-icon\n              id="{{graderColumn.column.id + \'grade-not-visible-icon\'}}"\n              size="small"\n              ng-if="graderColumn.column.externalGrade && !graderColumn.column.visible"\n              icon="invisible"\n              class="visibility-icon"\n              role="img"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.gradeNotVisible\'}"\n            ></bb-svg-icon>\n            <span class="name ellipse" ng-if="graderColumn.itemLinkIsClickable">\n              <a  class="bb-click-target"\n                  ng-click="graderColumn.handleColumnClick()"\n                  href="javascript:void(0);"\n                  bb-key-hide-ftue="grades.grader.base.column.clickItem"\n                  id="{{\'graderColumn_\' + graderColumn.course.courseId}}"\n                  analytics-id="components.directives.grade.graderColumn.name.link"\n                  aria-label="{{graderColumn.attendanceAriaLabel}}"\n                  ng-attr-aria-describedby="{{graderColumn.column.externalGrade && !graderColumn.column.visible ? graderColumn.column.id + \'grade-not-visible-icon\' : undefined}}">\n                  {{graderColumn.column.columnName}}\n              </a>\n            </span>\n          </div>\n          <span class="name ellipsis" ng-if="!graderColumn.itemLinkIsClickable">\n            <span id="{{ \'graderColumn_\' + graderColumn.course.courseId}}">{{graderColumn.column.columnName}}</span>\n          </span>\n          <div class="name-controls" ng-if="::!graderColumn.column.isOffline()">\n            <span class="secondary-text" ng-if="::graderColumn.column.seemsAttemptBased()">\n              <span ng-if="graderColumn.column.dueDate && graderColumn.numMissingStudents">\n                <span class="items-missing" bb-translate translate-values="{missingCount: graderColumn.numMissingStudents}">components.directives.grade.grader-column.studentsMissing.plural</span>\n                <span ng-if="!graderColumn.column.isOffline()">|</span>\n              </span>\n              <span ng-if="graderColumn.column.summary.numStudentSubmissions && graderColumn.column.summary.numEligibleToBeGraded">\n                <bb-translate ng-if="graderColumn.column.isDiscussion()" class="submittedCount" translate-values="{participatedCount: graderColumn.column.summary.numStudentSubmissions(), totalCount: graderColumn.column.summary.numEligibleToBeGraded}">components.directives.grade.grader-column.studentsParticipated.plural</bb-translate>\n                <bb-translate ng-if="!graderColumn.column.isDiscussion()" class="submittedCount" translate-values="{submittedCount: graderColumn.column.summary.numStudentSubmissions(), totalCount: graderColumn.column.summary.numEligibleToBeGraded}">components.directives.grade.grader-column.studentsSubmitted.plural</bb-translate>\n              </span>\n            </span>\n            <span class="secondary-text" ng-if="::graderColumn.column.isAttendance() && graderColumn.column.summary.averageGradeForStudents">\n                <span bb-translate translate-values="{percentage: graderColumn.column.summary.averageGradeForStudents}">components.directives.grade.grader-column.attendance.average</span>\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ng-if="graderColumn.isCourseView" class="date columns medium-2 large-2 hide-for-small-only">\n      <bb-datetime ng-if="!graderColumn.column.isAttendance()" format="Short" value="graderColumn.column.dueDate">\n      </bb-datetime>\n      <span ng-if="graderColumn.column.isAttendance()" bb-translate>components.directives.grade.grader-column.attendance.ongoing</span>\n    </div>\n\n    <div ng-class="{\'grade-status-container columns medium-7\': !graderColumn.isCourseView, \'columns medium-5 course-only-grade-status-container\': graderColumn.isCourseView}">\n      <div class="grade-progress" ng-class="{\'columns medium-7 course-only-grade-status\': graderColumn.isCourseView}" ng-if="!graderColumn.column.isAttendance()">\n        <div ng-switch="graderColumn.column.isCollectExternalSubmissions()">\n          \x3c!-- External submission statuses are calculated differently from others since the instructor is initiating the attempt\n          when they go to grade the user. Therefore, we want to include people who have no submission as ready to be graded //--\x3e\n          <div ng-switch-when="true">\n            <div ng-switch="graderColumn.column.summary.getStatus().toString()">\n              <div class="grade-count" ng-switch-when="NEEDS_GRADING">\n                <span bb-translate translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0">|</span>\n                <span class="grade-posted-count-before" ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0"\n                      bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">\n                  components.directives.grade.grader-column.statuses.numToPost.plural\n                </span>\n              </div>\n              <span ng-switch-when="NEEDS_POSTING">\n                <span bb-translate ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0"\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0">|</span>\n                <span bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">\n                  components.directives.grade.grader-column.statuses.numToPost.plural\n                </span>\n              </span>\n              <span ng-switch-when="ALL_GRADED">\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() === 0" bb-translate>\n                  components.directives.grade.grader-column.statuses.allGraded\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0" bb-translate\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n              </span>\n              <div class="grade-progress-complete" ng-switch-when="ALL_POSTED">\n                <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                <span bb-translate>components.directives.grade.grader-column.statuses.allPosted</span>\n              </div>\n              <span ng-switch-when="NOTHING_TO_GRADE">\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() === 0" bb-translate>\n                  components.directives.grade.grader-column.statuses.nothingToGrade\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0" bb-translate\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n              </span>\n              <div class="grade-progress-restricted" ng-switch-when="RESTRICTED">\n                <bb-button-complex-tooltip></bb-button-complex-tooltip>\n                <span bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n              </div>\n            </div>\n          </div>\n          <div ng-switch-default>\n            <div ng-switch="graderColumn.column.summary.getStatus().toString()" ng-if="::!graderColumn.column.isCalculated()">\n              <div class="grade-count js-grade-progress-needs-grading" ng-switch-when="NEEDS_GRADING">\n                <span ng-if="::graderColumn.column.isOffline()"\n                      bb-translate translate-values="{count: graderColumn.column.summary.numStudentsNeedsGrading}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="::!graderColumn.column.isOffline()"\n                      bb-translate translate-values="{count: graderColumn.getNumberOfSubmissionsNeedsGrading()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0">|</span>\n                <span class="grade-posted-count-before" ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0" bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">components.directives.grade.grader-column.statuses.numToPost.plural</span>\n              </div>\n              <span class="js-grade-progress-needs-posting" ng-switch-when="NEEDS_POSTING" bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">components.directives.grade.grader-column.statuses.numToPost.plural</span>\n              <span class="js-grade-progress-all-graded" ng-switch-when="ALL_GRADED" bb-translate>components.directives.grade.grader-column.statuses.allGraded</span>\n              <div class="grade-progress-complete" ng-switch-when="ALL_POSTED">\n                <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                <span bb-translate>components.directives.grade.grader-column.statuses.allPosted</span>\n              </div>\n              <span class="js-grade-progress-nothing-to-show" ng-switch-when="NOTHING_TO_GRADE" bb-translate>components.directives.grade.grader-column.statuses.nothingToGrade</span>\n              <div class="grade-progress-restricted" ng-switch-when="RESTRICTED">\n                <bb-button-complex-tooltip></bb-button-complex-tooltip>\n                <span bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n              </div>\n            </div>\n            <div ng-if="::graderColumn.column.isCalculated()">\x3c!-- Needed for spacing --\x3e</div>\n          </div>\n        </div>\n      </div>\n      <div class="grade-progress" ng-class="{\'columns medium-7 course-only-grade-status\': graderColumn.isCourseView}"\n           ng-if="graderColumn.column.isAttendance()" bb-translate>\n        components.directives.grade.grader-column.attendance.markAttendance\n      </div>\n      <div class="grade-status" ng-class="{\'columns medium-5 course-only-grade-status\': graderColumn.isCourseView}">\n        <div ng-if="::!graderColumn.column.isCalculated()">\n          <div ng-if="!graderColumn.course.isComplete() && graderColumn.column.summary.hasGradesToPost() && graderColumn.canPostGrades" class="post">\n            <button class="button button--secondary send-grade" bb-confirmation-needed="{{graderColumn.grade.getPostAllGradeConfirmationNeededStringsKey(graderColumn.column)}}"\n                    modal-aria-type="alertdialog" show-type="always" ng-click="graderColumn.postGrades()"\n                    bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.postGrades\'}"\n                    translate-attrs-values="{courseName: graderColumn.course.name, columnName: graderColumn.column.columnName}"\n                    bb-translate="{{graderColumn.isCourseView ? \'components.directives.grade.grader-column.actions.postGrades\' : \'components.directives.grade.grader-column.actions.basePostGrades\'}}"\n                    analytics-id="{{graderColumn.isCourseView ? \'components.directives.grade.grader-column.actions.postGrades\' : \'components.directives.grade.grader-column.actions.basePostGrades\'}}" >\n            </button>\n          </div>\n        </div>\n        <div ng-if="::graderColumn.column.isCalculated()">\x3c!-- Needed for spacing --\x3e</div>\n      </div>\n    </div>\n    <div ng-if="(graderColumn.showOverflowMenu || graderColumn.showDragControls) && !graderColumn.isRestrictedGroupContent"\n        class="columns medium-1 large-1 last-row-item item-controls dots" bb-foundation-defer>\n\n      \x3c!-- disable if its a group and has user is not entitled --\x3e\n      <button bb-drag-handle ng-if="graderColumn.showDragControls"\n              drag-item-id="{{::graderColumn.column.id}}"\n              drag-item-name="{{graderColumn.column.columnName}}"\n              class="super-clear small button icon js-drag-handle drag-drop-button"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.reorder-grader-item\', \'title\': \'components.directives.grade.grader-column.aria-label.move-tip\'}"\n              translate-attrs-values="{columnName: graderColumn.column.columnName}"\n              analytics-id="components.directives.grade.graderColumn.reorderItem.button" >\n        <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n      </button>\n\n      \x3c!-- disable if its a group and has user is not entitled --\x3e\n      <div ng-if="graderColumn.showOverflowMenu" class="overflow-menu-container right">\n        <bb-overflow-menu element-id="{{graderColumn.overflowMenuId}}"\n                          element-name="{{graderColumn.column.columnName}}"\n                          menu-items="graderColumn.getOverflowMenuItems()"\n                          analytics-id-tag-prefix="components.directives.grade.grader-column.overflowMenu">\n        </bb-overflow-menu>\n      </div>\n    </div>\n  </div>\n\n  <div ng-if="graderColumn.showConversionMessage">\n    <bb-course-access-alert course="course"\n                            alert-type="graderColumn.getAlertType()"\n                            confirm-callback="graderColumn.closeConversionTooltip()"\n                            timeout-callback="graderColumn.closeConversionTooltip()">\n    </bb-course-access-alert>\n  </div>\n</div>\n<bb-add-content-button\n                      position-after="graderColumn.column.id" item-name="graderColumn.column.columnName"\n                      context-area="graderColumn.contextArea"\n                      ng-if="graderColumn.isCourseView && !graderColumn.course.isComplete() && graderColumn.canModify"\n                      show-add-attendance="attendanceIsAvailable() && !attendanceColumnExists()">\n</bb-add-content-button>\n'},ELoy:function(e,t,n){"use strict";n("px9Z"),n("GkCm");var s=n("Llzl"),i=n("lEL+"),o=n("6sUD");n.d(t,"a",(function(){return a}));const a="ultra.directives.telemetry.panel.header";class r{constructor(e,t){this.scope=e,this.timeout=t,this.showSpinner=!1,this.spinnerTimeout=this.timeout(()=>{this.showSpinner=!0},this.scope,r.WAIT_TIME_TO_SHOW_SPINNER),this.scope.$watch("::panelDataLoaded()",e=>{e&&this.dataLoaded()})}dataLoaded(){this.timeout.cancel(this.spinnerTimeout),this.showSpinner=!1}}r.$inject=["scope",i.b],r.WAIT_TIME_TO_SHOW_SPINNER=1e3;class c{constructor(e){this.$injector=e,this.restrict="E",this.template=o,this.transclude=!0,this.scope={course:"&",panelDataLoaded:"&",titleKey:"@?",title:"@?",buttonOneIcon:"@",buttonOneCallback:"&",buttonOneAriaLabel:"@",buttonOneTitle:"@",buttonTwoIcon:"@",buttonTwoCallback:"&",buttonTwoAriaLabel:"@",buttonTwoTitle:"@"},this.link=e=>{e.telemetryPanelHeader=this.$injector.instantiate(r,{scope:e})}}}c.$inject=["$injector"],s.module(a,[]).directive("bbTelemetryPanelHeader",["$injector",e=>e.instantiate(c)])},Efpj:function(e,t){e.exports='<div class="grades-list instructor-wrapper">\n  <div class="row tabular-list-header course-grades-column-headers" ng-if="courseGradesGraderList.columns.length > 0">\n    <div class="columns small-6 medium-4 large-4 tabular-list-header-offset"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.name</span></div>\n    <div class="columns hide-for-small-only medium-2 large-2"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.dueDate</span></div>\n    <div class="columns hide-for-small-only medium-3 large-3 end course-grades-column-progress-header"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.progress</span></div>\n  </div>\n\n\n  <div bb-mouse-leave-enter="course-gradebook">\n\n    <bb-add-content-button position-before="\'start\'" item-name="courseGradesGraderList.columns[0].columnName"\n                           context-area="courseGradesGraderList.contextArea"\n                           show-menu-override="!courseGradesGraderList.hasColumns"\n                           always-show="isFirst"\n                           show-add-attendance="attendanceIsAvailable() && !courseGradesGraderList.attendanceColumnExists"\n                           ng-if="courseGradesGraderList.contextArea && !course().isComplete() && courseGradesGraderList.canModify" bb-key-hide-ftue="grades.grader.course.column.add"></bb-add-content-button>\n    \x3c!-- set keep-guidance-when-focusout to be true then add bb-key-hide-ftue="grades.grader.course.column.add" on its preceding element --\x3e\n    <div bb-guidance-target component-key="grades.grader.course.column.add" keep-guidance-when-focusout="true" aria-describedby="guidance-moment-grade-add"></div>\n\n    <bb-guidance id="guidance-moment-grade-add" component-key="grades.grader.course.column.add"\n                 class="grades-list-guidance guidance-element-overlay" role="tooltip">\n      <bb-translate>components.directives.grade.course-grades-grader.ftue.add</bb-translate>\n    </bb-guidance>\n\n    <div class="grade-list-columns">\n      <div class="drag-element" ng-class="{\'no-hover\': (course().isComplete() || (column.isAttendance() && !attendanceIsAvailable)), \'last-tabular-row-container\': $last}"\n           ng-repeat="column in courseGradesGraderList.columns track by column.id" bb-content-item-mouseover>\n        <div bb-drop-handler on-move-handler="courseGradesGraderList.onMoveGraderItem" content="column"\n             next-content-id="courseGradesGraderList.columns[$index+1].id"\n             previous-content-id="courseGradesGraderList.columns[$index-1].id">\n\n          <bb-grader-column column="column"\n                            course="course()"\n                            is-course-view="true"\n                            category-map="courseGradesGraderList.categoryMap"\n                            attendance-column-exists="courseGradesGraderList.attendanceColumnExists"\n                            attendance-is-available="attendanceIsAvailable()">\n          </bb-grader-column>\n        </div>\n      </div>\n    </div>\n    <bb-setup-overall-grade ng-if="courseGradesGraderList.showSetupOverallGradeMessage && courseGradesGraderList.canModify"\n                            course-id="courseGradesGraderList.course.id"\n                            setup-overall-grade-hide-message-callback="courseGradesGraderList.setupOverallGradeHideMessageCallback()">\n    </bb-setup-overall-grade>\n  </div>\n</div>\n'},Et3n:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("D57K"),i=n("0JpG"),o=n("yC9S"),a=n("dL5/");const r="ultra.directives.group.group-count";let c=class{$onInit(){}isSelfEnrollment(){return!!(this.content.selfEnrollmentGroups&&this.content.selfEnrollmentGroups.length>0)&&this.content.selfEnrollmentGroups.some(e=>e.group&&!e.group.groupSetId)}};c=Object(s.__decorate)([Object(o.a)({moduleName:r,componentName:"bbGroupCount",template:a,bindings:{content:"<"},requireModules:[i.moduleName]})],c)},GGpz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n("Llzl"),i=n("AuQm"),o=n("1ZbL");const a="ultra.components.directives.new-feature-badge",r={Class:i.NewFeatureBadge,attributes:["customBadgeClass"],renderLocalized:!0};s.module(a,[]).component("bbNewFeatureBadge",Object(o.a)(r))},GiMb:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("KPeV");const o="ultra.components.directives.bbUiIcon.small.DownloadFile";Object(s.a)(i.a,o,"bbUiIconSmallDownloadFile")},GkCm:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-main-menu",use:"icon-small-main-menu-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-main-menu"><path d="M1 3h14M15 8H1M1 13h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},GwhK:function(e,t){e.exports='<div class="typeahead-search" bb-click-outside="typeaheadSearchBox.onClickOutside()" is-active="true" bb-load-bundle="components/directives/typeahead">\n  <label for="typeahead-search-box-{{::typeaheadSearchBox.randomElementId}}">\n    <bb-svg-icon ng-if="::typeaheadSearchBox.icon" icon="{{::typeaheadSearchBox.icon}}" size="small" class="magnifying-glass"></bb-svg-icon>\n    <span ng-if="::typeaheadSearchBox.srLabel" class="sr-only" bb-translate="{{::typeaheadSearchBox.srLabel}}"></span>\n  </label>\n  <input aria-describedby="requiredPrompt" type="text" id="typeahead-search-box-{{::typeaheadSearchBox.randomElementId}}"\n         ng-model="typeaheadSearchBox.searchValue"\n         ng-model-options="{ debounce: 250 }"\n         role="combobox"\n         aria-activedescendant="typeahead-result-{{::typeaheadSearchBox.randomElementId}}-0"\n         aria-autocomplete="list"\n         aria-owns="typeahead-search-autocomplete"\n         name="typeaheadSearchBox"\n         autocomplete="off"\n         ng-keydown="typeaheadSearchBox.onInputBoxKeyDown($event)"\n         ng-click="typeaheadSearchBox.onInputBoxClick($event)"\n         ng-change="typeaheadSearchBox.onSearchValueChange()"\n         ng-focus="typeaheadSearchBox.onFocusInputBox($event)"\n         bb-translate-attrs="{\'placeholder\': \'{{typeaheadSearchBox.inputPlaceholder}}\'}"\n         class="truncated"\n         ng-class="{\'not-empty with-clear-btn\': typeaheadSearchBox.searchValue, \'empty\': !typeaheadSearchBox.searchValue,\n                    \'with-icon\': typeaheadSearchBox.icon, \'is-active\': typeaheadSearchBox.isFocus}"\n         analytics-id="components.directives.typeheadSearchBox.input.text"/>\n    <button class="typeahead-clear-button" bb-translate-attrs="{\'aria-label\': \'{{typeaheadSearchBox.clearAriaLabel}}\'}"\n            tabindex="0"\n            ng-show="typeaheadSearchBox.searchValue"\n            ng-click="typeaheadSearchBox.clear()"\n            ng-focus="typeaheadSearchBox.onFocusClearBtn($event)"\n            ng-blur="typeaheadSearchBox.onBlurClearBtn($event)"\n            analytics-id="components.directives.typeheadSearchBox.clearAriaLabel.button">\n      <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n    </button>\n  <span id="requiredPrompt" class="sr-only" bb-translate="{{::typeaheadSearchBox.srEmptyResults}}"></span>\n  <div id="typeahead-search-autocomplete" class="typeahead-search-autocomplete adding"\n       ng-if="typeaheadSearchBox.showResults"\n       role="listbox"\n       tabindex="-1">\n    <div class="typeahead-search-entry" ng-repeat="item in typeaheadSearchBox.searchResults"\n         role="option"\n         tabindex="-1"\n         id="typeahead-result-{{::typeaheadSearchBox.randomElementId}}-{{$index}}"\n         ng-keydown="typeaheadSearchBox.onResultEntryKeyDown($event, item)"\n         ng-click="typeaheadSearchBox.onResultEntryClick($event, item)"\n         analytics-id="components.directives.typeheadSearchBox.onResultEntryClick">\n      <typeahead-inject></typeahead-inject>\n    </div>\n  </div>\n</div>'},"H/mg":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("ERkP"),o=n("1ZbL"),a=n("Dz4E");const r="ultra.components.directives.react-toolkit.contextual-menu";class c extends i.Component{render(){return this.props.show?i.createElement(a.ContextualMenu,{items:this.props.items,directionalHint:this.props.directionalHint,target:document.getElementById(this.props.targetId),onDismiss:this.props.dismiss,labelElementId:this.props.ariaLabelledby,analyticsId:this.props.analyticsId}):null}}const l={Class:c,bindingNames:["items","targetId","show","dismiss","directionalHint"],attributes:["ariaLabelledby","analyticsId"]};s.module(r,[]).component("bbUiContextualMenu",Object(o.a)(l))},HE6t:function(e,t){e.exports='<div ng-if="$ctrl.isInitialized && $ctrl.isPeerGrading" class="content-item-peer-assessment">\n  <div ng-if="$ctrl.isPeerGradingConfigured" class="peer-review-due-date">\n    <bb-svg-icon size="small" icon="peer-review"></bb-svg-icon>\n    <span bb-translate class="content-peer-review-due-date-label"\n          translate-values="{ peerReviewsNumber: $ctrl.peerReviewsPerStudent, datetime: $ctrl.peerReviewDueDate }">\n        components.directives.content-item-base.peer-review-due-date\n      </span>\n    <div ng-if="::$ctrl.contextCourseMembership.isStudentMembership()" class="tooltip-container">\n      <bb-ui-content-item-peer-assessment-tooltip tooltip-title="::$ctrl.getTooltipMessage()">\n      </bb-ui-content-item-peer-assessment-tooltip>\n    </div>\n  </div>\n</div>\n'},HwkA:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-custom-toggle-table",use:"icon-custom-toggle-table-usage",viewBox:"0 0 12 12",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="icon-custom-toggle-table"><path fill="none" stroke-width="2" stroke-miterlimit="10" d="M0 1h12M0 6h12M0 11h12" /></symbol>'});i.add(o);e.exports=o},IgL1:function(e,t){e.exports='<button bb-complex-tooltip=""\n  enhanced-tooltip="true"\n  tooltip-position="top-center"\n  tooltip-disable-on-mouse-over="false"\n  tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n  tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n  tooltip-scope="buttonComplexTooltip.$scope"\n  tooltip-template="{{ buttonComplexTooltip.getToolTipTemplate() }}"\n  tooltip-open-on-activation="true"\n  tooltip-auto-update="true"\n  tooltip-always-underline="false"\n  analytics-id="components.directives.content-item-base.conditionalRelease.date.link"\n  tooltip-center-content="true"\n  title="components.directives.grade.grader-column.statuses.restricted">\n  <bb-svg-icon size="small" icon="information" status="default"></bb-svg-icon>\n</button>\n'},IjED:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var s=n("nsO7"),i=n("nbDY"),o=n.n(i),a=n("TnpK");const r="ultra.services.slideoutPanel",c="slideoutPanel";class l extends o.a{}l.RubricEvaluation=new l("rubric-evaluation"),l.RubricView=new l("rubric-view"),l.AssessmentSubmissionFeedback=new l("assessment-submission-feedback"),l.DiscussionFeedback=new l("discussion-feedback");class d{constructor(e){this.ultraState=e,this.slideoutPanelIsOpen=!1,this.getMostRecentPanelState=e=>e.split(".").pop(),this.isPanelClosing=(e,t)=>this._doesStateRequireSlidePanel(this.getMostRecentPanelState(e))&&!this._doesStateRequireSlidePanel(this.getMostRecentPanelState(t)),this.setSlideoutPanelState=()=>{this.slideoutPanelIsOpen=this._doesStateRequireSlidePanel(this.getMostRecentPanelState(this.ultraState.current.name))},this.isOpen=()=>(this.setSlideoutPanelState(),this.slideoutPanelIsOpen),this.setSlideoutPanelState()}isRubricState(){return this.getMostRecentPanelState(this.ultraState.current.name)===l.RubricEvaluation.toString()||this.getMostRecentPanelState(this.ultraState.current.name)===l.RubricView.toString()}_doesStateRequireSlidePanel(e){return s.some(l.getValues(),t=>e===t.toString())}}d.$inject=[a.d];class u extends d{}angular.module(r,[]).service(c,d)},J8YL:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options" data-show-add-options ng-click="addContentButton.toggleMenu()"\n     ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n     aria-expanded="{{addContentButton.isMenuVisible}}" aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n     aria-label="{{addContentButton.addButtonAriaLabel}}"\n     ng-focus="addContentButton.showButton()" ng-blur="addContentButton.hideButton()"\n     analytics-id="components.directives.add-content-button.assignment.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        allow-multiple="true"\n        monitor-leave="true"\n        disable-drag="disableDrag && disableDrag()"\n        target-div="{{\'#\' + fileListViewId}}"\n        hide-transclude-during-upload="false"\n        is-third-party-upload="false"\n        disallow-folder-uploads="true"\n        skip-zip-file-check="true"\n        ignored-states="::ignoredStates()"\n        position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.fileUpload.link" >\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon><span bb-translate analytics-id="course.content.buildContentArea.addFiles">course.content.buildContentArea.addFiles</span>\n        </a>\n      </bb-file-upload>\n    </li>\n    <li ng-if="!addContentButton.isMobile">\n      \x3c!-- Skip zip file check, assignment does not support unzip file(LRN-101238) --\x3e\n      <bb-file-upload allow-multiple="true" monitor-leave="true" is-third-party-upload="true"  hide-transclude-during-upload="false" skip-zip-file-check="true"\n                      click-enabled="false" primary-key="fileListViewId" disable-drag="disableDrag && disableDrag()"\n                      third-party-download-handler="addContentButton.downloadFile" target-div="{{\'#\' + fileListViewId}}"\n                      position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           primary-key="fileListViewId"\n           is-flatten="false"\n           attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n           ignored-states="::ignoredStates()"\n           bb-translate-attrs="{\'aria-label\':\'components.directives.add-content-button.aria-label.content.oneDrive\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.oneDrive.link">\n          <div>\n            <i class="icon-cloud"></i><span bb-translate>components.directives.add-content-button.oneDrive</span>\n          </div>\n        </a>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},JuVx:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var s=n("D57K"),i=n("Sa5G"),o=n("jhBu"),a=n("oi1r"),r=n("nsO7"),c=n("C2vp"),l=n("cbVV"),d=n("qH3X"),u=n("o5Lu"),h=n("yC9S"),p=n("aHpC"),m=n("vYaK"),b=n("Qbdf"),g=n("zGdY"),v=n("JfV0"),f=n("ZQFV");class C{constructor(e,t){this.cells=e,this.metadata=t}isCellExisting(e){return this.isCellExistingByColumnId(e.column.id)}isCellExistingByColumnId(e){return!r.isUndefined(this.cells[e])}insertDataCell(e){this.isCellExisting(e)||(this.cells[e.column.id]=e)}deleteDataCellByColumnId(e){this.isCellExistingByColumnId(e)&&delete this.cells[e]}}let y=class e{constructor(e,t,n,s,i,o,a,r){this.$rootScope=e,this.$injector=t,this.$q=n,this.CourseModel=s,this.entitlementService=i,this.schemaService=o,this.currentCourse=a,this.gradeGridRebornDirectiveScope=r,this._canViewGrades=!1,this.gradeSchemaBySchemaId={},this.dataRowsByMembershipId={},this.columns=[],this.assignedGroupByGradeColumnId={},this.allGroupMemberships=[],this.userIdsByGroupId={},this.requestQueue=[],this.canViewGroups=!1,this.MAX_SUMMARY_REQUEST_SIZE=1e3,h.b.OnRootScope(this.$rootScope,u.a,(e,t)=>{const n=this.getColumnMetadatas().find(e=>e.id===t);n&&this.$rootScope.$broadcast(u.c,n)}),this.deferredInit=this.$q.defer(),this.initialized=this.deferredInit.promise;const c=r.$watchCollection("columnMetadatas",e=>{e&&(this.initialize(this.currentCourse.course,e),c())})}get canViewGrades(){return this._canViewGrades}get course(){return this._course}getSchema(){return this.gradeSchemaBySchemaId}getColumnIdGroupsMap(){return this.assignedGroupByGradeColumnId}getAllGroupMemberships(){return this.allGroupMemberships}getGroupIdUserIdMap(){return this.userIdsByGroupId}initializeSchemas(e){this.gradeSchemaBySchemaId={},e.forEach(e=>{this.gradeSchemaBySchemaId[e.id]=e})}initialize(e,t){this._course=e,this.courseId=e.id,this.columnMetadatas=t;const n=this.entitlementService.hasCourseEntitlement(i.o.ViewGroups,this.courseId).then(e=>(this.canViewGroups=e,this.canViewGroups?this.initializeGroupsMemberships():this.$q.resolve(!1))),s=this.entitlementService.hasAnyCourseEntitlement([i.n.ViewGrades,i.n.ViewGrades],e.id).then(e=>(this._canViewGrades=e,e)),o=this.loadSchemas(this.courseId).then(e=>{this.initializeSchemas(e)}),a=this.fetchMemberships({}).then(e=>{this.dataRowsByMembershipId={},this.insertRows(e);let t=!1;this.columns=this.getColumnMetadatas().map(e=>(e.externalGrade&&(t=e.externalGrade),this.insertColumnByMetadata(e)));const n=this.createStudentColumn(t);return this.insertColumn(n,!0),{memberships:e,columns:this.columns}});return this.$q.all([a,n,o,s]).then(e=>this.deferredInit.resolve(e[0])).catch(e=>this.deferredInit.reject(e)),this.getOverallColumn(),this.initialized}getAssignedGroupsByColumnId(e){return this.assignedGroupByGradeColumnId[e]}loadSchemas(e){return this.schemaService.loadSchemas(e)}initializeColumnIdGroupsMap(e){this.assignedGroupByGradeColumnId={},r.isEmpty(this.getColumnMetadatas())||this.getColumnMetadatas().forEach(t=>{t.contentId&&!t.isScorm()&&e[t.contentId]&&(this.assignedGroupByGradeColumnId[t.id]=e[t.contentId])})}initializeGroupsMemberships(){return this.allGroupMemberships=[],this.getGroupsMemberships().then(()=>(this.initializeGroupIdUserIdMap(),!0))}initializeGroupIdUserIdMap(){this.userIdsByGroupId={};const e={};this.allGroupMemberships.forEach(t=>{this.userIdsByGroupId[t.id]=t.memberships.map(e=>e.userId),t.assignedContents.forEach(t=>{(e[t.contentId]=e[t.contentId]||[]).push(t)})}),this.initializeColumnIdGroupsMap(e)}getGroupsMemberships(){return this.course.groups.$refresh({offset:this.allGroupMemberships.length,limit:1e4,fields:"id,memberships,assignedContents"}).$asPromise().then(e=>(this.allGroupMemberships=this.allGroupMemberships.concat(e),e.paging.nextPage?this.getGroupsMemberships():this.allGroupMemberships))}fetchMemberships(e){return this.fetchMembershipsRecursively([],e,0)}fetchMembershipsRecursively(t,n,s){return this.course.memberships.$refresh({fields:e.MEMBERSHIPS_REQUEST_FIELDS,sort:e.MEMBERSHIPS_SORTING,...f.GRID_MEMBERSHIPS_IMPLICIT_FILTERS,...n,offset:s}).$asPromise().then(e=>{const s=t.concat(e);if(e.paging.nextPage){const t=new URLSearchParams(e.paging.nextPage),i=parseInt(t.get("offset"),10);return this.fetchMembershipsRecursively(s,n,i)}return s})}getFilteredColumns(e){let t=[];return this.course.gradebook.columns.$refresh({...e}).$asPromise().then(n=>{if(n.filter(e=>!1===e.visibleInBook).forEach(e=>n.$remove(e)),t=t.concat(n),Object.keys(e).length>0&&this.overallColumn&&t.push(this.overallColumn),n.paging.nextPage)return this.getFilteredColumns(e);if((null==t?void 0:t.length)>0){this.expandColumnSummaries(t);let e=!1;const n=t.map(t=>(t.externalGrade&&(e=t.externalGrade),this.updateColumnByMetadata(t)));this.columns=n;const s=this.createStudentColumn(e);return n.unshift(s),n}return[]})}getOverallColumn(){this.course.gradebook.columns.$find("finalGrade").$allow([g.HttpStatus.NotFound]).$asPromise().then(e=>{var t;(null===(t=e.$response)||void 0===t?void 0:t.status)!==g.HttpStatus.NotFound&&(this.overallColumn=e)})}clearOverallColumn(){this.overallColumn=void 0}expandColumnSummaries(e){var t,n;const s=null!==(n=null===(t=e.paging)||void 0===t?void 0:t.count)&&void 0!==n?n:this.MAX_SUMMARY_REQUEST_SIZE,i=this.course.gradebook.summaries.expandingColumns(e);return this.$q.all(r.range(0,s,this.MAX_SUMMARY_REQUEST_SIZE).map(e=>i.$fetch({limit:this.MAX_SUMMARY_REQUEST_SIZE,offset:e,excludeCalculations:!0}).$asPromise())).then(()=>e)}fetchGradeBulkView(e,t,n){return e.gradebook.bulkView.$fetch({membershipIds:t,columnIds:n,expand:"attempts,lastAttemptId,needsGradingAttemptCount,groupAttempts",timestamp:(new Date).getTime()}).$asPromise()}createColumnByColumnMetadata(e){return e.externalGrade?this.createOverallColumn(e):e.isCalculated()?this.createCalculationColumn(e):e.isOffline()?this.createOfflineItemColumn(e):e.isDiscussion()?r.isEmpty(this.assignedGroupByGradeColumnId[e.id])?this.createDiscussionItemColumn(e):this.createGroupDiscussionGradeColumn(e,this.assignedGroupByGradeColumnId[e.id]):e.isAttendance()?this.createAttendanceItemColumn(e):this.assignedGroupByGradeColumnId[e.id]?this.createGroupTestGradeColumn(e,this.assignedGroupByGradeColumnId[e.id]):e.seemsAttemptBased()&&e.scoreProviderHandle?this.createAttemptBasedItemGradeColumn(e):e.scoreProviderHandle?this.createItemGradeColumn(e):this.createOfflineItemColumn(e)}createStudentColumn(t){return this.$injector.instantiate(l.l,{gridData:this,data:{id:e.COLUMN_STUDENT},headerTemplate:"<bb-grade-grid-column-header-student-reborn></bb-grade-grid-column-header-student-reborn>",cellTemplate:"<bb-grade-grid-column-student-reborn></bb-grade-grid-column-student-reborn>",columnWidth:e.STUDENT_COLUMN_WIDTH,position:"left",border:!t,order:0})}createOverallColumn(t){return this.overallColumn=t,this.$injector.instantiate(l.k,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-overall-reborn></bb-grade-grid-column-header-overall-reborn>",cellTemplate:"<bb-grade-grid-column-overall-reborn></bb-grade-grid-column-overall-reborn>",columnWidth:e.COLUMN_WIDTH,position:"left",border:!0,order:10})}createCalculationColumn(t){return this.$injector.instantiate(l.d,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createItemGradeColumn(t){return this.$injector.instantiate(l.i,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createOfflineItemColumn(t){return this.$injector.instantiate(l.j,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createDiscussionItemColumn(t){return this.$injector.instantiate(l.e,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createAttendanceItemColumn(t){return this.$injector.instantiate(l.b,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createAttemptBasedItemGradeColumn(t){return this.$injector.instantiate(l.a,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createGroupTestGradeColumn(t,n){return this.$injector.instantiate(l.h,{groups:n,gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createGroupDiscussionGradeColumn(t,n){return this.$injector.instantiate(l.f,{groups:n,gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}getColumnMetadata(e){return r.find(this.columnMetadatas,t=>t.id===e)}getColumnMetadataByContentId(e){return r.find(this.columnMetadatas,t=>t.contentId===e)}isColumnMetadataExisting(e){return!r.isUndefined(this.getColumnMetadata(e))}getColumnMetadatas(){return this.columnMetadatas}getRowById(e){return this.dataRowsByMembershipId[e]}getRowByUserId(e){return r.find(r.values(this.dataRowsByMembershipId),t=>t.metadata.user.id===e)}getGroupById(e){return this.allGroupMemberships.find(t=>t.id===e)}getCell(e,t){return this.dataRowsByMembershipId[e].cells[t]}insertRows(e){e.forEach(e=>this.insertRow(e))}insertRow(e){this.dataRowsByMembershipId[e.id]=new C({},e)}createCell(t,n){if(n.id===e.COLUMN_STUDENT)return this.$injector.instantiate(c.l,{gridData:this,row:t,column:n});const s=n.data;return s.externalGrade?this.$injector.instantiate(c.k,{gridData:this,row:t,column:n}):s.isCalculated()?this.$injector.instantiate(c.c,{gridData:this,row:t,column:n}):s.isOffline()?this.$injector.instantiate(c.j,{gridData:this,row:t,column:n}):s.isDiscussion()?n instanceof l.g&&n.userIdGroupIdMap[t.metadata.user.id]?this.$injector.instantiate(c.f,{gridData:this,row:t,column:n,group:n.getGroupById(n.userIdGroupIdMap[t.metadata.user.id])}):this.$injector.instantiate(c.d,{gridData:this,row:t,column:n}):s.isAttendance()?this.$injector.instantiate(c.b,{gridData:this,row:t,column:n}):n instanceof l.g&&n.userIdGroupIdMap[t.metadata.user.id]?this.$injector.instantiate(c.e,{gridData:this,row:t,column:n,group:n.getGroupById(n.userIdGroupIdMap[t.metadata.user.id])}):s.isJournal()?this.$injector.instantiate(c.h,{gridData:this,row:t,column:n}):s.seemsAttemptBased()?this.$injector.instantiate(c.a,{gridData:this,row:t,column:n}):this.$injector.instantiate(c.g,{gridData:this,row:t,column:n})}insertColumn(e,t=!1){t?this.columns.unshift(e):this.columns.push(e),this.insertDataCells(e)}insertDataCells(e){r.forOwn(this.dataRowsByMembershipId,t=>t.insertDataCell(this.createCell(t,e)))}insertColumnByMetadata(e){const t=this.createColumnByColumnMetadata(e);return this.insertColumn(t),t}updateColumnByMetadata(e){this.isColumnExisting(e.id)&&this.deleteColumnById(e.id);const t=this.createColumnByColumnMetadata(e);return this.insertColumnAtIndex(t,this.getColumnMetadataIndexInColumnMetadatas(e)+1),this.insertDataCells(t),t}refreshDataCell(e,t){r.isUndefined(e)||(e.deleteDataCellByColumnId(t.id),e.insertDataCell(this.createCell(e,t)))}deleteColumn(e){this.deleteColumnById(e.id)}deleteColumnById(e){let t=r.remove(this.columns,t=>t.id===e);this.deleteDataCellsByColumnId(e),t&&t[0]&&t[0].data&&t[0].data.contentId&&(t=r.remove(this.columns,e=>e.data&&e.data.contentId===t[0].data.contentId)).forEach(e=>this.deleteDataCellsByColumnId(e.id))}deleteDataCellsByColumnId(e){r.forOwn(this.dataRowsByMembershipId,t=>t.deleteDataCellByColumnId(e))}getColumnMetadataIndexInColumnMetadatas(e){return r.findIndex(this.columnMetadatas,t=>e.id===t.id)}insertColumnAtIndex(e,t){this.columns.splice(t,0,e)}getColumn(e){return r.find(this.columns,t=>t.id===e)}getColumns(){return this.columns}isColumnExisting(e){return!r.isUndefined(this.getColumn(e))}getRowCount(){return r.keys(this.dataRowsByMembershipId).length}loadGradeData(t,n){if(r.isEmpty(t)||r.isEmpty(n))return;if(r.isEmpty(n.filter(t=>t.id!==e.COLUMN_STUDENT)))return;const[s,i]=this.filterRowsAndColumns(t.map(e=>e.id),n.map(e=>e.id),e=>e.isUnloaded||e.isWaiting);r.isEmpty(s)||r.isEmpty(i)||this.prepareFetchGrades(s,e.ROW_NUMBER_PER_REQUEST,i,e.COLUMN_NUMBER_PER_REQUEST)}filterRowsAndColumns(e,t,n){const s=this.filterRows(e,t,n);return[s,this.filterColumns(s,t,n)]}filterRows(e,t,n){const s=[];return e.forEach(e=>{const i=this.dataRowsByMembershipId[e];r.find(t,e=>n(i.cells[e]))&&s.push(e)}),s}filterColumns(e,t,n){const s=[];return t.forEach(t=>{r.find(e,e=>n(this.dataRowsByMembershipId[e].cells[t]))&&s.push(t)}),s}prepareFetchGrades(e,t,n,s){const i=r.isEmpty(this.requestQueue),o=[];r.chunk(e,t<=0?e.length:t).forEach(e=>{r.chunk(n,s<=0?n.length:s).forEach(t=>{i?this.requestQueue.push([e,t]):o.push([e,t]),this.markWaiting(e,t)})}),this.requestQueue=o.concat(this.requestQueue),i&&this.fetchGrades()}fetchGrades(){for(let t=0;t<e.REQUEST_WORKER_NUMBER;t++)this.fetchGrade()}fetchGrade(){if(!r.isEmpty(this.requestQueue)){let[e,t]=this.requestQueue.shift();[e,t]=this.filterRowsAndColumns(e,t,e=>e.isWaiting),r.isEmpty(e)||r.isEmpty(t)?this.fetchGrade():(this.markLoading(e,t),this.fetchGradeBulkView(this.CourseModel.$new(this.courseId),e,t).then(n=>{this.assignGrade(n),this.markLoaded(e,t),this.fetchGrade()}))}}assignGrade(e){e.bulkViewUsers.forEach(e=>{const t=this.dataRowsByMembershipId[e.courseMembershipId];e.grades.forEach(e=>{const n=t.cells[e.columnId];n.isLoading&&(n.data=e)})})}markWaiting(e,t){e.forEach(e=>t.forEach(t=>{const n=this.dataRowsByMembershipId[e].cells[t];n.isUnloaded&&n.setLoadState(c.i.WAITING)}))}markLoading(e,t){e.forEach(e=>t.forEach(t=>{const n=this.dataRowsByMembershipId[e].cells[t];n.isWaiting&&n.setLoadState(c.i.LOADING)}))}markLoaded(e,t){e.forEach(e=>t.forEach(t=>{const n=this.dataRowsByMembershipId[e].cells[t];n.isLoading&&n.setLoadState(c.i.LOADED)})),this.broadcastRefreshEvent(e,t)}broadcastRefreshEvent(e,t){e.forEach(e=>{const n=t.filter(t=>this.dataRowsByMembershipId[e].cells[t].isLoaded);this.gradeGridRebornDirectiveScope.$broadcast(d.a.REFRESH,{rowId:e,columnIds:n})})}refreshAllColumns(){r.forEach(this.getColumnMetadatas(),e=>this.updateColumnByMetadata(e))}addUpdatedColumnFlag(e){r.forEach(e,e=>{const t=r.find(this.columns,t=>t.id===e);t&&(t.isUpdated=!0)})}destroy(){this.requestQueue=[]}};y.COLUMN_WIDTH=142,y.COLUMN_STUDENT="COLUMN_STUDENT",y.STUDENT_COLUMN_WIDTH=220,y.REQUEST_WORKER_NUMBER=5,y.ROW_NUMBER_PER_REQUEST=0,y.COLUMN_NUMBER_PER_REQUEST=0,y.MEMBERSHIPS_REQUEST_FIELDS=["role","courseRole","childCourseId","user","id","isAvailable","dueDateExceptionType"].join(","),y.MEMBERSHIPS_SORTING=Object(v.buildSortParameters)(f.GRID_MEMBERSHIPS_SORT),y=Object(s.__decorate)([Object(s.__param)(0,Object(p.b)("$rootScope")),Object(s.__param)(1,Object(p.b)("$injector")),Object(s.__param)(2,Object(p.b)("$q")),Object(s.__param)(3,Object(p.b)(m.serviceName)),Object(s.__param)(4,Object(p.b)(o.b)),Object(s.__param)(5,Object(p.b)(a.b)),Object(s.__param)(6,Object(p.b)(b.e)),Object(s.__param)(7,Object(p.b)("gradeGridRebornDirectiveScope"))],y)},Jwnl:function(e,t){e.exports='\x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n<button ng-if="!contentItemBase.isEngagementOutline()"\n        class="content-title" ng-class="{\'name-middle\': contentItemFolder.shouldAlignMiddle()}"\n        ng-click="contentItemFolder.toggleFolder()"\n        aria-expanded="{{content.ui.isOpen}}"\n        aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n        bb-translate-attrs="{\'aria-label\':\'components.directives.content-item-base.aria-label.toggle-folder\'}"\n        translate-attrs-values="{folderName: content.title}"\n        analytics-id="content.item.folder.toggleFolder.button"\n        aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n        tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></button>\n<button ng-if="contentItemBase.isEngagementOutline()"\n        class="content-title name"\n        ng-click="contentItemFolder.toggleFolder()"\n        aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n        aria-expanded="{{content.ui.isOpen}}"\n        analytics-id="content.item.folder.engagementOutline.toggleFolder.button"><span>{{ content.title }}</span></button>\n'},Jygx:function(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new s("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,a=0,r=0,c="";o=t.charAt(r++);~o&&(i=a%4?64*i+o:o,a++%4)?c+=String.fromCharCode(255&i>>(-2*a&6)):0)o=n.indexOf(o);return c}},KXuk:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-complete",use:"icon-small-complete-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-complete"><rect x="1" y="1" width="14" height="14" rx="7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 8l2 3 4-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},KeOq:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content student-content student-column" role="columnheader" tabindex="0">\n    <div class="ellipse left-bold location" course-org-token-resolver bb-translate>components.directives.grade.grid.students</div>\n  </div>\n  <div class="summary student-column"></div>\n  <div class="summary student-column">\n    <span bb-translate course-org-token-resolver translate-values="{count: studentsTotal}">components.directives.grade.grid.studentsSummary.plural</span>\n  </div>\n</div>\n'},KvMR:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("+pNa");const o="ultra.components.directives.bbUiIcon.small.Download";Object(s.a)(i.Download,o,"bbUiIconSmallDownload")},"L+81":function(e,t,n){"use strict";var s=n("D57K"),i=(n("zhNR"),n("XPgl"),n("lx16")),o=n("Llzl"),a=n("kC07"),r=n("D8d/"),c=n("lEL+"),l=n("DnQR"),d=(n("lwNT"),n("vcLy"),n("KXuk"),n("Sa5G")),u=n("0JpG"),h=n("MKP7"),p=n("JNtI"),m=n("Ocaa"),b=n("pIXs"),g=n("aTRN"),v=n("nYZ0"),f=n("w9Zy"),C=n("TnpK"),y=n("X455"),w=n("oi1r"),S=n("jhBu"),I=n("1ZbL"),O=n("xGbf");const E="ultra.features.course.content.banners.bbForcedSequenceWarningBanner",D={Class:n.n(O).a,withThemeProvider:!0,renderLocalized:!0};o.module(E,[]).component("bbForcedSequenceWarningBanner",Object(I.a)(D));var k=n("VUvS"),$=n("aHpC"),L=n("e6jQ"),R=n("BLb8"),j=n("nmzr"),T=n("/5AG"),x=n("Htol"),G=n("Y+9S");let A=class{constructor(e,t,n,s,i,o,a,r,c,l,u,h,p){var m;this.scope=e,this.$rootScope=t,this.element=n,this.attrs=s,this.localizeService=i,this.$q=o,this.contentService=a,this.offcanvasService=r,this.timeout=c,this.ultraState=l,this.contextCourseMembership=u,this.entitlementService=p,this.lmTitlePlaceholder=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.learning-module.base-item.title-placeholder"}),this.description="",this.controlId=Object(L.a)(),this.conditionalRelease=h.instantiate(g.a,{scope:e}),e.content.title||(e.content.title=this.lmTitlePlaceholder),e.content.description=null!==(m=e.content.description)&&void 0!==m?m:"",this.scope.$on("refresh-conditional-release-rules",(e,t)=>{this.scope.content.id===t.id&&this.conditionalRelease.getConditions(t)}),this.scope.$on("bb-update-CR-tooltip",(e,t,n,s)=>{t&&(this.rulesCriteria&&this.rulesCriteria.gradeColumnId)===t.id&&this.conditionalRelease.getConditions(this.scope.content,n,s)}),(e.content.isConditionalReleaseLocked()||e.content.isConditionalRelease()||e.content.isForcedSequenceModule())&&this.conditionalRelease.getConditions(e.content),this.entitlementService.hasCourseEntitlement(d.e.ModifyContent,this.scope.content.courseId).then(e=>{this.entitledToModifyContent=e}),this.scope.$on(x.b,(t,n)=>{let s;if(n&&e.content.isForcedSequenceModule()&&this.contextCourseMembership.isStudentMembership()&&(()=>e.content.id===n.parentId||e.content.children&&e.content.children.some(e=>e.id===n.parentId&&(s=e,!0)))()){const t=[e.content.$fetch().$asPromise(),e.content.getChildren({limit:e.content.children.length+1}).$asPromise()];s&&s.children&&t.push(s.getChildren({limit:s.children.length+1}).$asPromise()),o.all(t).then(([,t,n])=>{t.forEach((n,s)=>{const i=e.content.children.findIndex(e=>e.id===n.id);-1!==i&&(t[s].ui=e.content.children[i].ui,t[s]=Object.assign(e.content.children[i],t[s]))}),s&&n&&n.forEach((e,t)=>{const i=s.children.findIndex(t=>t.id===e.id);-1!==i&&(s.children[i]=Object.assign(s.children[i],n[t]))})})}}),Object(R.b)(this.scope,(e,t)=>{this.scope.content.isConditionalReleaseLocked()&&this.scope.content.containsCriteriaWithGradeColumnId(t)&&Object(R.c)(this.scope,t)}),Object(R.a)(this.scope,e=>{this.scope.content.isConditionalReleaseLocked()&&Object(R.c)(this.scope)})}deleteContent(){this.scope.$emit("deleteContent",this.scope.content)}getOverflowMenu(){return[{icon:"draw",labelKey:"global.edit",show:()=>this.scope.content.canEdit(),onClick:this.edit.bind(this)},{icon:"trash",labelKey:"global.delete",show:()=>this.scope.content.canDelete(),onClick:this.deleteContent.bind(this),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>this.getDeleteConfirmationKeyAndShowType().then(e=>{const t=e.confirmationKey.replace(/^resource\//,"");return this.$q.when(p.a(t))})}}]}edit(){this.ultraState.goPeekState(j.ContentRoutes.EDIT_LEARNING_MODULE_PEEK_PANEL,{id:this.scope.content.id})}getDeleteConfirmationKeyAndShowType(){return this.contentService.generateDeleteConfirmationKey(this.scope.content,this.scope.contextArea).then(e=>({confirmationKey:this.scope.content.ui.deleteConfirmationKey,showType:this.scope.content.ui.modalShowType}))}toggleLM(){var e,t;null===(t=(e=this.scope).toggleFunc)||void 0===t||t.call(e),this.scope.content.ui.isOpen&&this.fetchProgress().then(()=>{const e={type:G.MessageType.LearningModuleOpened,status:G.MessageStatus.Success,contentId:this.scope.content.id};Object(G.sendMessageToMobile)(e)})}isCourseCompletedAndInInstructorView(){return!this.scope.content.canEdit()&&this.entitledToModifyContent}get canOpenConditionalRelease(){return!!(this.scope.content&&this.scope.content.permissions&&this.scope.content.permissions.adaptiveRelease&&this.scope.content.permissions.adaptiveRelease.view)}openConditionalRelease(){this.ultraState.goPeekState(j.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:this.scope.content.id})}getNeighborReviewState(){return T.NeighborContentReviewState.None}shouldShowReviewStateIcon(){var e;return null===(e=this.scope.content.permissions)||void 0===e?void 0:e.canViewReviewState}onChangeVisibility(){this.scope.content.visibility=this.contentService.determineVisibility(this.scope.content.isAvailable);this.scope.content.withParams({fields:"id"}).$save(["isAvailable","isPartiallyVisible","adaptiveReleaseRules"]).$asPromise().then(()=>{this.$rootScope.$broadcast("content-update",this.scope.content)})}fetchProgress(){return this.scope.content.$fetch({expand:"hasProgressed"}).$asPromise().then(e=>{this.scope.content=e})}shouldShowForcedSequenceWarningBanner(){return this.scope.content.canEdit()&&this.scope.content.isForcedSequenceModule()&&this.scope.isOpen&&!this.scope.content.isHiddenFromStudents()&&this.scope.content.hasProgressed}};A=Object(s.__decorate)([Object(s.__param)(0,Object($.b)("scope")),Object(s.__param)(1,Object($.b)("$rootScope")),Object(s.__param)(2,Object($.b)("element")),Object(s.__param)(3,Object($.b)("attrs")),Object(s.__param)(4,Object($.b)(u.serviceName)),Object(s.__param)(5,Object($.b)("$q")),Object(s.__param)(6,Object($.b)(v.f)),Object(s.__param)(7,Object($.b)(f.e)),Object(s.__param)(8,Object($.b)(c.b)),Object(s.__param)(9,Object($.b)(C.d)),Object(s.__param)(10,Object($.b)(y.d)),Object(s.__param)(11,Object($.b)("$injector")),Object(s.__param)(12,Object($.b)(S.b))],A);class _{constructor(e){this.$injector=e,this.restrict="E",this.template=k,this.scope={content:"=",canToggle:"&",toggleFunc:"&",canMove:"=",contextArea:"=",isOpen:"="},this.link=(e,t,n)=>{e.baseItem=this.$injector.instantiate(A,{scope:e,element:t,attrs:n})}}}_.$inject=["$injector"],o.module("ultraUi.components.directives.content.learningModule.learningModuleBaseItem",[h.a,b.a,v.d,m.a,f.d,c.a,C.b,w.a,S.a,E]).directive("bbLearningModuleBaseItem",["$injector",e=>e.instantiate(_)]);var M=n("zGdY");n.d(t,"a",(function(){return P}));const P="ultra.directives.folder";let B=class{constructor(e,t,n,s){this.scope=e,this.element=t,this.timeout=n,this.contextCourseMembership=s,this.showEmptyMenu=!0,this.showMenuOverride=!1,this.showOutlineOverride=!1,this.isOpen=!1,this.toggleLabelKey="components.directives.folder.aria-label.open",this.initialChildrenLength=0,this.FOLDER_CONTENTS_SELECTOR=".folder-contents",this.contextArea=e.contextArea,this.loadMoreChildren=e.loadMoreChildren,this.contents=e.contents,this.content.ui?this.content.ui.isOpen=!1:this.content.ui={isOpen:!1},e.$on("toggle-folder",(e,t)=>{this.canToggle()&&t===this.content&&this.toggleFolder()}),e.$on("toggle-folder-by-id",(t,n)=>{this.canToggle()&&n===this.content.id&&(this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?this.toggleFolder():e.$apply(()=>{this.toggleFolder()}))}),e.$on("close-folder-immediately-by-id",(e,t)=>{this.isOpen&&this.canToggle()&&t===this.content.id&&this._closeFolderImmediately()}),e.$on("bb-drag-start",()=>{this.isOpen&&this.canToggle()&&(null==this.content.children||0===this.content.children.length)&&this._closeFolderImmediately()}),e.$on("close-all-add-menus",(e,t)=>{if(this.isOpen&&(null==this.content.children||0===this.content.children.length)&&this.content.id!==t){if(this.content.isLearningModule())return;this.toggleFolder()}}),e.$on("showContentImportProgress",(t,n,s)=>{this.content.id!==s||0!==this.content.children.length||this.showOutlineOverride||(this.showOutlineOverride=!0,this.timeout(()=>{this.scope.$broadcast("showContentImportProgress",n,s)},e))}),e.$on("keyboard-drag-move",(e,t)=>{this.content.id+"blank"===t?this.showEmptyMenu=!1:this.showEmptyMenu=!0}),e.$on("keyboard-drag-lost-focus",()=>{this.showEmptyMenu=!0}),e.$on("keyboard-drag-end",()=>{this.showEmptyMenu=!0})}_closeFolderImmediately(){this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).hide(),this.isOpen=!1,this.content.ui.isOpen=!1):this.scope.$apply(()=>{this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).hide(),this.isOpen=!1,this.content.ui.isOpen=!1})}toggleFolder(){this.isOpen||null!=this.content.children&&0!==this.content.children.length||this.loadMoreChildren(this.content).$then(()=>{var e;this.content.children&&0===this.content.children.length&&(null===(e=this.scope.content.permissions)||void 0===e?void 0:e.canHaveReviewState)&&this.scope.content.state!==M.ContentReviewState.Completed&&this.scope.content.updateState(M.ContentReviewState.Completed,!0)}),this.content.children&&(this.isOpen=this.content.ui.isOpen=!this.content.ui.isOpen,this.content.children.$then(()=>{this.initialChildrenLength=this.content.children.length,0===this.content.children.length?(this._calculateDurationAndToggle(),this.showMenuOverride=!0,(this.isOpen||this.isOpen&&this.content.isLearningModule())&&this.scope.$root.$broadcast("close-all-add-menus",this.content.id)):this.timeout(()=>{this._calculateDurationAndToggle(),this.showMenuOverride=!1},this.scope),this.clearWatcher&&this.clearWatcher(),this.clearWatcher=this.scope.$watch(()=>this.content.children&&this.content.children.length,(e,t)=>{this.showMenuOverride=0===e,0===e&&e!==t&&this.isOpen&&this.scope.$root.$broadcast("close-all-add-menus",this.content.id),null==e&&this.isOpen&&(this._closeFolderImmediately(),this.toggleFolder())})}),this.toggleLabelKey=this.isOpen?"components.directives.folder.aria-label.close":"components.directives.folder.aria-label.open")}_calculateDurationAndToggle(){const e=this.isOpen?1e3:2e3,t=this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).outerHeight(),n=Math.round(1.17*t),s=Math.min(e,n);this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).slideToggle(s)}canToggle(){return this.content.canEdit()||!this.content.isRestricted()}get content(){return this.scope.content}isProgressTrackingStateShown(e){var t;return null===(t=e.permissions)||void 0===t?void 0:t.canViewReviewState}};B=Object(s.__decorate)([Object(s.__param)(0,Object($.b)("scope")),Object(s.__param)(1,Object($.b)("element")),Object(s.__param)(2,Object($.b)(c.b)),Object(s.__param)(3,Object($.b)(y.d))],B);class N{constructor(e){this.$injector=e,this.restrict="E",this.scope={content:"=",contextArea:"=",canCreate:"=",contents:"=",canMove:"=",loadMoreChildren:"=",nextContentId:"=?",onFileDropHandler:"=?",onMoveHandler:"=",onMoveIntoFolderHandler:"=",previousContentId:"=?",canCopyImport:"=?",rootContent:"&?"},this.compile=e=>({pre:(e,t)=>{e.folder=this.$injector.instantiate(B,{scope:e,element:t})}}),this.template=l}}N.$inject=["$injector"],o.module(P,[a.b,r.a,i.a,c.a,"ultraUi.components.directives.content.learningModule.learningModuleBaseItem"]).directive("bbFolder",["$injector",e=>e.instantiate(N)])},L2Kv:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}));var s=n("D57K"),i=n("0JpG"),o=n("lEL+"),a=n("aHpC"),r=n("+4Px"),c=n("gK/k"),l=n("9Fiv"),d=n("dF44"),u=n("kjyA");const h="rbGridCell";class p{}let m=class{constructor(t,n,s,i,o,a,c,l){this.scope=t,this.element=n,this.grid=s,this.container=i,this.$q=o,this.timeout=a,this.localizeService=c,this.debounce=l,this.goPreviousColumnImpl=()=>{this.removeFocus();let{row:e}=this.scope;const{col:t}=this.scope,n=this.container.rows,s=this.grid.getFocusableColumns(),i=s[(s.indexOf(t)-1+s.length)%s.length];if("right"===this.container.position&&this.scope.$first)return void this.grid.scrollToRight(()=>this.notifyFocus(e,i));if(i===s[s.length-1]){if(e){const t=n.indexOf(e)-1;e=n[t];let s=NaN;this.container.isRowOutOfBound(t).top&&(s=this.container.getTopRowScrollTop(t)),this.grid.scrollToRightWithTop(s,()=>this.notifyFocus(e,i))}return}const o=this.container.columns.indexOf(i),a=o>=0;this.container.isColOutOfBound(o).left?this.grid.scroll({scrollLeft:a?this.container.getLeftColScrollLeft(i):0},()=>this.notifyFocus(e,i)):this.notifyFocus(e,i)},this.goNextColumnImpl=()=>{this.removeFocus();const{row:e,col:t}=this.scope,n=this.container.rows,s=this.grid.getFocusableColumns(),i=s[(s.indexOf(t)+1)%s.length];if("left"===this.container.position&&this.scope.$last)return void this.grid.scrollToLeft(()=>this.notifyFocus(e,i));if(i===s[0]){let t=-1,s=n[0];if(void 0===e)t=0;else{const i=n.indexOf(e)+1;(s=n[i])&&this.container.isRowOutOfBound(i).bottom&&(t=this.container.getBottomRowScrollTop(i))}return void this.grid.scroll({scrollLeft:0,scrollTop:t},()=>this.notifyFocus(s,i))}const o=this.container.columns.indexOf(i);this.container.isColOutOfBound(o).right?this.grid.scroll({scrollLeft:this.container.getRightColScrollLeft(i)},()=>this.notifyFocus(e,i)):this.notifyFocus(e,i)},this.goUpImpl=(e=!1)=>{this.removeFocus();const{row:t,col:n}=this.scope,s=this.container.rows,i=s.indexOf(t)-1;if(!t)return void this.grid.scrollToBottom(()=>this.notifyFocus(s[s.length-1],n));const o=s[i];o?this.container.isRowOutOfBound(i).top?this.grid.scroll({scrollTop:this.container.getTopRowScrollTop(i)},()=>this.notifyFocus(o,n)):this.notifyFocus(o,n):e?this.grid.scrollToBottom(()=>this.notifyFocus(s[s.length-1],n)):this.notifyFocus(void 0,n)},this.goDownImpl=(e=!1)=>{this.removeFocus();const{row:t,col:n}=this.scope,s=this.container.rows,i=s.indexOf(t)+1;let o=s[i];o?void 0!==t?this.container.isRowOutOfBound(i).bottom?this.grid.scroll({scrollTop:this.container.getBottomRowScrollTop(i)},()=>this.notifyFocus(o,n)):this.notifyFocus(o,n):this.grid.scrollToTop(()=>this.notifyFocus(o,n)):e?(o=s[0],this.grid.scrollToTop(()=>this.notifyFocus(o,n))):this.notifyFocus(o,n)},this.goPreviousColumn=this.debounce.asDebounced(this.goPreviousColumnImpl,this.scope,d.c),this.goNextColumn=this.debounce.asDebounced(this.goNextColumnImpl,this.scope,d.c),this.goUp=this.debounce.asDebounced(this.goUpImpl,this.scope,d.c),this.goDown=this.debounce.asDebounced(this.goDownImpl,this.scope,d.c),this.setTabindex(),n.on("keydown",t=>{const n=this.getHandler(t);n&&(this.grid.previousCell=this,this.tabPressed=t.keyCode===r.u,Object(r.x)(t)&&e(document.body).removeClass("hide-focus-outline"),n.call(this),t.preventDefault(),t.stopPropagation())}),t.$on(d.b.FOCUS_CELL,(e,t,n)=>{this.scope.row===t&&this.scope.col===n&&(this.handleFocus(),this.grid.cellFocusDeferred&&this.grid.cellFocusDeferred.resolve(this))}),t.$on(d.b.LEAVE_CELL,()=>{this.handleFocus()}),t.$on(d.b.ENTER_NEXT_CELL,()=>{this.grid.cellFocusDeferred=new function(){this.promise=new Promise(e=>this.resolve=e)},this.goForth(),this.grid.cellFocusDeferred.promise.then(e=>{e.handleEnter(),this.grid.cellFocusDeferred=null})})}setTabindex(){this.scope.col.focusable&&this.element.attr("tabindex",0)}goLeft(){return this.localizeService.isRTL(this.scope)?this.goNextColumn():this.goPreviousColumn()}goRight(){return this.localizeService.isRTL(this.scope)?this.goPreviousColumn():this.goNextColumn()}goForth(){this.goDown(!0)}goBack(){this.goUp(!0)}removeFocus(){this.container.element.find(".rb-ax-focus-placeholder").focus()}notifyFocus(e,t){this.grid.$scope.$broadcast(d.b.FOCUS_CELL,e,t)}handleFocus(){this.element.focus()}isFirst(){const{row:e,col:t}=this.scope,n=this.grid.getFocusableColumns();return void 0===e&&t===n[0]}isLast(){const{row:e,col:t}=this.scope,n=this.container.rows,s=this.grid.getFocusableColumns();return e===n[n.length-1]&&t===s[s.length-1]}getHandler(e){return Object(r.z)(e)&&!this.isFirst()?this.goBack:Object(r.A)(e)&&!this.isLast()?this.goForth:e.keyCode===r.j?this.goLeft:e.keyCode===r.s?this.goRight:e.keyCode===r.v?this.goUp:e.keyCode===r.d?this.goDown:Object(r.y)(e)?this.handleEnter:e.keyCode===r.g?this.element.is(e.target)?this.handleEscape:this.handleFocus:void 0}handleEnter(){this.scope.$broadcast(d.b.ENTER_CELL,this.element)}handleEscape(){this.scope.$emit(d.b.LEAVE_GRID)}};m=Object(s.__decorate)([Object(s.__param)(0,Object(a.b)("scope")),Object(s.__param)(1,Object(a.b)("element")),Object(s.__param)(2,Object(a.b)("grid")),Object(s.__param)(3,Object(a.b)("container")),Object(s.__param)(4,Object(a.b)("$q")),Object(s.__param)(5,Object(a.b)(o.b)),Object(s.__param)(6,Object(a.b)(i.serviceName)),Object(s.__param)(7,Object(a.b)(u.b))],m);class b extends m{setTabindex(){this.scope.col.focusable&&this.element.attr("tabindex",this.scope.col.headerFocusable?0:-1)}goBack(){this.goLeft()}goForth(){const{row:e,col:t}=this.scope;this.canAddColumn()?this.container.canAddColumn()?this.notifyFocus(e,t):this.grid.scrollToLeft(()=>this.notifyFocus(e,t)):this.goRight()}handleFocus(){const e=this.grid.previousCell,t=this.grid.containers.center.columnAdder;e.tabPressed&&e instanceof b&&e.canAddColumn()&&this.canAddColumn()?(this.container.canAddColumn()?t.show(this.element.find(".rb-add-column-placeholder"),this.scope.col):t.show(),t.button.focus()):this.scope.col.headerFocusable?super.handleFocus():this.scope.$broadcast(d.b.CELL_FOCUSED,this.element)}canAddColumn(){return this.container.canAddColumn()||this.grid.canAddColumn()&&"left"===this.container.position&&this.scope.$last}}let g=class{constructor(e,t){this.$injector=e,this.$compile=t,this.templates=Object.create(null),this.restrict="A",this.require=[`^${c.a}`,`^${l.c}`,h],this.controller=p,this.transclude=!0,this.link=(e,t,n,s,i)=>{const o=e.$eval(n[h]);(this.templates[o]=this.templates[o]||this.$compile(o))(e,e=>t.append(e)),i(e=>t.append(e));const[a,r,c]=s;c.cellNavigator=this.$injector.instantiate(e.row?m:b,{scope:e,element:t,grid:a,container:r.container})}}};g=Object(s.__decorate)([Object(s.__param)(0,Object(a.b)("$injector")),Object(s.__param)(1,Object(a.b)("$compile"))],g)}).call(this,n("5iHu"))},LFd7:function(e,t,n){"use strict";var s=n("D57K"),i=n("X455"),o=n("Sa5G"),a=n("aHpC"),r=n("yC9S"),c=n("9hUw"),l=n("0JpG"),d=n("Llzl"),u=n("ERkP"),h=n("1ZbL"),p=n("/n7R"),m=n("0x+l");const b="ultra.components.directives.content.contentItem.contentItemType.contentItemPeerAssessment.tooltip";class g extends u.Component{render(){return u.createElement(p.AnalyticsTooltip,{placement:"top",title:this.props.tooltipTitle,"aria-label":this.props.tooltipTitle,analyticsId:"components.directives.content-item-base.content-item-peer-assessment.tooltip.button"},u.createElement("button",{className:"peer-review-info-tooltip"},u.createElement(m.Information,null)))}}const v={Class:g,bindingNames:["tooltipTitle"]};d.module(b,[]).component("bbUiContentItemPeerAssessmentTooltip",Object(h.a)(v));var f=n("HE6t");n.d(t,"a",(function(){return C}));const C="ultra.components.directives.content.contentItem.contentItemType.contentItemPeerAssessment";let y=class{constructor(e,t,n,s){this.$scope=e,this.contextCourseMembership=t,this.peerReviewService=n,this.localize=s}$onInit(){var e;this.$scope.contentItemPeerAssessment=this,o.f.TestLink.isEqualTo(null===(e=this.content)||void 0===e?void 0:e.contentHandler)?this.peerReviewService.getOrCreatePeerContentFromContent(this.content).then(e=>{this.peerReviewContentObject=e,this.isInitialized=!0}):this.isInitialized=!0}getTooltipMessage(){return this.localize.translateSync({key:"components.directives.content-item-base.content-item-peer-assessment.peer-review-information-tooltip",locale:this.localize.getLocale(this.$scope)})}get peerReviewsPerStudent(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.numOfPeerReviewsToComplete)&&void 0!==t?t:0}get peerReviewDueDate(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerReviewDueDate}get isPeerGrading(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerGrading)&&void 0!==t&&t}get isPeerGradingConfigured(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isPeerGradingConfigured)&&void 0!==t&&t}};y=Object(s.__decorate)([Object(r.a)({moduleName:C,componentName:"bbContentItemPeerAssessment",bindings:{content:"<"},template:f,requireModules:[l.moduleName,c.a,b]}),Object(s.__param)(0,Object(a.b)("$scope")),Object(s.__param)(1,Object(a.b)(i.d)),Object(s.__param)(2,Object(a.b)(c.b)),Object(s.__param)(3,Object(a.b)(l.serviceName))],y)},LN5R:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return q})),n.d(t,"a",(function(){return K}));var s=n("D57K"),i=(n("wAzH"),n("KXuk"),n("Tt7N"),n("01PJ"),n("Vdys"),n("xoIb"),n("Lrq8"),n("VCKY"),n("6Fqm"),n("JuVx")),o=n("qH3X"),a=n("cbVV"),r=n("Llzl"),c=n("nsO7"),l=n("yC9S"),d=n("nmzr"),u=n("aHpC"),h=n("2bSy"),p=n("810X"),m=n("7OC/"),b=n("9KIl"),g=n("jSqS"),v=n("TnpK"),f=n("kN1T"),C=n("xcel"),y=n("y+vt"),w=n("0JpG"),S=n("gK/k"),I=n("lEL+"),O=n("hkqm"),E=n("X/qj"),D=n("ROik"),k=n("AVdi"),$=n("o5Lu"),L=n("xiEu"),R=n("C36k"),j=n("s+Z7"),T=n("zGdY"),x=n("JfV0"),G=n("+4Px"),A=n("6CeR"),_=n("9Zs+"),M=n("dF44"),P=n("TmUJ"),B=n("2o5C"),N=n("fGDP"),F=n("uFkY"),z=n("vYaK"),U=n("Kpdw"),V=n("ZzR9"),H=n("ZQFV");const q="ultra.components.directives.gradeGridReborn",K="bbGradeGridReborn";let W=class{constructor(e,t,n,s,i,r,u,h,p,m,b,g,v,f,C,y,w){this.$compile=e,this.$element=t,this.$injector=n,this.$ngRedux=s,this.$q=i,this.$scope=r,this.$location=h,this.ultraState=p,this.gradeService=m,this.gradebookPermissionService=b,this.$attrs=g,this.bbLocalize=v,this.CourseModel=f,this.GradeColumn=C,this.timeout=y,this.toast=w,this.headerHeight=150,this.rowHeight=80,this.showFilterCriteria=!1,this.mergedCourses=[],this.studentsTotal=0,this.onUrlFiltersUpdated=()=>{const e=this.$location.search(),t=this.hasUrlFilters;this.hasUrlFilters=!!(e.memberId||e.gradebookColumnId||e.gradebookCategoryId||e.courseGroupId||e.childCourseId),t!==this.hasUrlFilters&&this.setContainerHeight(),this.updateFilterConditions(e)},this.initialized=!1,l.b.OnWindow("resize",c.debounce(this.setContainerHeight.bind(this),100),r),this.setContainerHeight(),r.$on(V.a.$locationChangeSuccess,()=>{this.timeout(()=>this.setContainerHeight(),this.$scope,50)}),this.mergedCourses.push(...this.$scope.mergedCourses),r.$on(o.a.FOCUSIN_CELL,(e,t)=>{this.activeColumnId=t.columnId}),r.$on(o.a.FOCUSOUT_CELL,(e,t)=>{this.activeColumnId=void 0}),r.$on(V.b.$stateChangeStart,()=>this.changingState=!0),r.$on(V.b.$stateChangeSuccess,()=>this.changingState=!1),this.subscribeToReduxChanges(),this.initialize().then(()=>{this.onUrlFiltersUpdated(),this.setupSearchFilterListener(),this.setupColumnChangeListener(),r.$on(V.a.$locationChangeSuccess,this.onUrlFiltersUpdated)}),this.$scope.$on("bb-change-overall-panel-visibility",(e,t,n)=>{var s;this.gridData.course.id!==t&&this.gridData.course.isComplete()||("true"===(null===(s=this.setupOverallGradeMessageIsHiddenPreference)||void 0===s?void 0:s.value)?this.isOverallPanelShown=!1:this.isOverallPanelShown=n)}),this.$scope.$on("grade-notation-cache-update",(e,t)=>{this.updateOverallNotation()}),this.$scope.$on("bb-grades-schema-save",(e,t)=>{this.refreshSchema(t)}),l.b.OnRootScope(this.$scope,"bb-grade-input-save",(e,t,n,s)=>{const i=this.gridData.getColumn(n),o=i.data;o.$fetch().$asPromise().then(()=>o.summary.$fetch().$asPromise()).then(()=>{if(i instanceof a.c)return this.updateAffectedColumns(this.getAffectedColumns(i))}).then(()=>{if(s){const e=this.gridData.getRowByUserId(s);this.refreshDataCell(e,i)}else this.gridData.updateColumnByMetadata(o),this.$scope.$broadcast(M.b.COLUMN)})}),this.$scope.$on(F.a,(e,t,n,s,i)=>{const o=this.gridData.getRowById(n),a=this.gridData.getColumn(t);this.refreshDataCell(o,a)}),this.$scope.$on("course.grades.gradebook-item.submission.grade-status-change",(e,t)=>{const n=this.gridData.getRowByUserId(t.userId),s=this.gridData.getColumn(t.columnId),i=s.data;i.$fetch().$asPromise().then(()=>i.summary.$fetch().$asPromise()).then(()=>{if(s instanceof a.c)return this.updateAffectedColumns(this.getAffectedColumns(s))}).then(()=>{s instanceof a.h?this.refreshDataCells(this.gridData.getGroupIdUserIdMap()[t.groupId].map(e=>this.gridData.getRowByUserId(e)),[s]):t.updateColumn?(this.gridData.updateColumnByMetadata(i),this.$scope.$broadcast(M.b.COLUMN)):this.refreshDataCell(n,s)})}),this.$scope.$on("bb-reload-grid-view",e=>{this.$scope.$emit("grade-notation-update",this.gridData.course.id)}),this.$scope.$on(B.b,()=>{this.refreshColumns()}),this.$scope.$on(N.a,(e,t)=>{this.refreshColumns(()=>{this.gridData.addUpdatedColumnFlag(t)})}),this.$scope.$on(V.b.$stateChangeSuccess,(e,t,n,s)=>{s.name.endsWith(d.GradeRoutes.GRADEBOOK_GRID_ADVANCED_FILTERS)&&this.updateFilterConditions(n)}),this.$scope.$on("$destroy",()=>{this.columnFiltersPresent()&&this.setUnfilteredColumns()}),this.canViewOverallPanel=b.canModify()}updateFilterConditions(e){const t={membershipId:e.memberId,groupId:e.courseGroupId,childCourseId:e.childCourseId},n={columnId:e.gradebookColumnId,gradebookCategoryId:e.gradebookCategoryId};this.changingState||(c.isEqual(t,this.rowFilterParams)||(this.rowFilterParams=t,this.rowFiltersPresent()?this.setAdvancedFilterRows(e):this.setUnfilteredRows()),c.isEqual(n,this.columnFilterParams)||(this.columnFilterParams=n,this.columnFiltersPresent()?this.setAdvancedFilterColumns(e):this.setUnfilteredColumns()))}updateAffectedColumns(e){return this.$q.all(e.map(e=>{const t=e.data;return t.$fetch().$asPromise().then(()=>t.summary.$fetch().$asPromise())})).then(()=>{e.forEach(e=>this.gridData.updateColumnByMetadata(e.data))})}rowFiltersPresent(){const e=this.ultraState.params;return Object(d.areCourseGradesRowFiltersPresent)(e)}columnFiltersPresent(){const e=this.ultraState.params;return!!e.gradebookCategoryId||!!e.gradebookColumnId}setUnfilteredRows(){this.studentsTotal=this.availableRowSelectedOptions.length,this.$scope.$broadcast(M.b.ROW,this.availableRowSelectedOptions),this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,this.availableRowSelectedOptions)}setUnfilteredColumns(){this.gridData.getFilteredColumns({}).then(e=>{this.availableColumnSelectedOptions=e,this.$scope.$broadcast(M.b.COLUMN,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,this.availableColumnSelectedOptions)})}setAdvancedFilterRows(e){const t={membershipId:e.memberId,groupId:e.courseGroupId,childCourseId:e.childCourseId};this.gridData.fetchMemberships(t).then(e=>{this.studentsTotal=e.length,this.$scope.$broadcast(M.b.ROW,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,e)})}setAdvancedFilterColumns(e){const t={columnId:e.gradebookColumnId,gradebookCategoryId:e.gradebookCategoryId};this.gridData.getFilteredColumns(t).then(e=>{this.filteredColumns=e,this.$scope.$broadcast(M.b.COLUMN,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,e)})}initialize(){return this.$q((e,t)=>{this.$q.all([this.bbLocalize.loadBundle("components/directives/grade/grade-grid"),this.bbLocalize.loadBundle("components/directives/grade/grade-input")]).then(()=>{this.gridData=this.$injector.instantiate(i.a,{gradeGridRebornDirectiveScope:this.$scope}),this.gridData.initialized.then(n=>{this.availableRowSelectedOptions=n.memberships,this.studentsTotal=n.memberships.length,this.availableColumnSelectedOptions=n.columns,this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,this.availableRowSelectedOptions),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,this.availableColumnSelectedOptions),this.gridOptions={memberships:n.memberships,columns:n.columns,rowHeight:this.rowHeight,headerHeight:this.headerHeight,headerContentHeight:89,headerBorder:!0,rowBorder:!0,callbacks:{data:(e,t)=>this.gridData.loadGradeData(e,t),column:this.gridData.course.isComplete()?void 0:(e,t)=>this.onClickAddColumnButton(e,t)}},this.initialized=!0,this.handleMergedCourse(),this.gridData.course.isComplete()?(this.isOverallPanelShown=!1,e(!0)):this.gradeService.needsToSetupOverall(this.gridData.getColumnMetadatas(),this.gridData.course.id).then(t=>{t?this.loadSetupOverallGradeMessageIsHiddenPreference&&!this.setupOverallGradeMessageIsHiddenPreference&&this.loadSetupOverallGradeMessageIsHiddenPreference(H.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key).then(()=>{var e;const t="true"===(null===(e=this.setupOverallGradeMessageIsHiddenPreference)||void 0===e?void 0:e.value);this.isOverallPanelShown=!t}):this.isOverallPanelShown=t,e(!0)}).catch(t)}).catch(e=>{console.error(e),t(e)})}).catch(e=>{console.error(e),t(e)})})}subscribeToReduxChanges(){const e=this.$ngRedux.connect(e=>({setupOverallGradeMessageIsHiddenPreference:x.select.coursePreference.getCoursePreferenceByKeyAndCourseId(e,H.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key,this.$scope.course().id)}),e=>({loadSetupOverallGradeMessageIsHiddenPreference:t=>e(x.actions.coursePreference.loadCoursePreference({key:t,courseId:this.$scope.course().id}))}))(this);this.$scope.$on("$destroy",e)}refreshSchema(e){this.gridData.getSchema()[e.id]=e,c.forEach(this.gridData.getColumnMetadatas(),e=>{const t=this.gridData.getSchema()[e.gradingSchemaId];(null==t?void 0:t.scaleType)===T.SchemaScaleType.Tabular&&this.gridData.updateColumnByMetadata(e)}),this.$scope.$broadcast(M.b.COLUMN)}refreshDataCells(e,t){c.forEach(e,e=>{c.forEach(t,t=>{this.gridData.refreshDataCell(e,t)})}),this.$scope.$broadcast(M.b.COLUMN)}refreshDataCell(e,t){this.gridData.refreshDataCell(e,t),this.$scope.$broadcast(M.b.COLUMN)}addStudentColumnBorder(e){e.externalGrade&&!this.gridData.isColumnExisting(e.id)&&this.gridData.getColumn(i.a.COLUMN_STUDENT).deleteBorder()}deleteStudentColumnBorder(e){e.externalGrade&&this.gridData.getColumn(i.a.COLUMN_STUDENT).addBorder()}updateOverallNotation(){const e=c.find(this.gridData.getColumns(),e=>e instanceof a.k);e&&(e.loadNotation(),this.gridData.updateColumnByMetadata(e.data)&&this.$scope.$broadcast(M.b.COLUMN))}getAffectedColumnsBeforeEdit(e){const t=this.gridData.getColumn(e.id);let n=[];return t instanceof a.i&&(n=t.affectedColumnsBeforeEdit),n}getAffectedColumns(e){const t=e.findAffectedColumns(),n=c.find(this.gridData.getColumns(),e=>e instanceof a.k);return n&&t.push(n),t}setupSearchFilterListener(){this.$scope.$on(o.a.GRADEBOOK_USER_SELECTED,(e,t)=>{const n=this.availableRowSelectedOptions;t&&t.length>0?this.$scope.$broadcast(M.b.ROW,c.intersectionWith(n,t,(e,t)=>e.userId===t)):n.length!==this.gridOptions.memberships.length&&(this.searchedResult&&"user"===this.searchedResult.type?this.$scope.$broadcast(M.b.ROW,[]):this.$scope.$broadcast(M.b.ROW,n))}),this.$scope.$on(o.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,(e,t)=>{const n=this.getAvailableRowSelectedOptions();this.availableRowSelectedOptions&&this.availableRowSelectedOptions.length!==this.gridOptions.memberships.length&&this.$scope.$broadcast(M.b.ROW,n),this.filteredColumns&&this.filteredColumns.length!==this.availableColumnSelectedOptions.length&&this.$scope.$broadcast(M.b.COLUMN,this.availableColumnSelectedOptions),this.ids&&(this.ids=null),this.handleMergedCourse()}),this.$scope.$on(o.a.GRADEBOOK_COLUMN_SELECTED,(e,t)=>{const n=this.availableColumnSelectedOptions;this.filterColumns((e,t)=>c.filter(e,e=>e.filterByColumId(t)),t,n)}),this.$scope.$on(o.a.GRADEBOOK_CATEGORY_SELECTED,(e,t)=>{const n=this.availableColumnSelectedOptions;this.ids=t,this.filterColumns((e,t)=>c.filter(e,e=>e.filterByCategoryId(t)),t,n)})}setupColumnChangeListener(){this.$scope.$on($.c,(e,t,n)=>{t.summary.$fetch().$asPromise().then(()=>{this.addStudentColumnBorder(t),this.updateColumns(t),this.updateFilteredColumns(),this.updateCategoryColumns(),this.filteredColumns&&this.toast.show({messageKey:"components.directives.grade.grid.newItemAdded",icon:"icon-check",toastStatus:"success"})})}),this.$scope.$on("content-update",(e,t)=>{if(t.isScorm()){const e=t.getScormGradebookItems().map(e=>this.$scope.course().gradebook.columns.$buildRaw(e.gradingColumn));this.$q.all(e.map(e=>(e.ui={content:t},e.summary.$fetch().$asPromise()))).then(()=>{e.forEach(e=>this.updateColumns(e))})}if(t.isDiscussion()){const e=this.gridData.getColumnMetadataByContentId(t.id);c.isUndefined(e)||this.gridData.initializeGroupsMemberships().then(()=>e.summary.$fetch().$asPromise()).then(()=>{this.updateColumns(e)})}}),this.$scope.$on("bb-delete-column",(e,t)=>{const n=this.gridData.getColumn(t.id);this.deleteStudentColumnBorder(t);let s=this.$q.when();if(n instanceof a.c){const e=this.getAffectedColumns(n);s=this.$q.all(e.map(e=>e.data.$fetch().$asPromise())).then(()=>{e.forEach(e=>this.gridData.updateColumnByMetadata(e.data))})}n instanceof a.k&&this.gridData.clearOverallColumn(),s.then(()=>{this.gridData.deleteColumnById(t.id),c.remove(this.filteredColumns,e=>e.data.id===t.id),this.$scope.$broadcast(M.b.COLUMN),this.timeout(()=>{const e=this.$element.find(":focus").parents("bb-grade-grid-column-header-reborn").data("col");c.isUndefined(e)||this.$scope.$broadcast(o.a.FOCUSIN_CELL,{columnId:e.id})},this.$scope,0,!1)})}),this.$scope.$on("attempt-base-content-update",(e,t)=>{this.updateAttempBaseContent(t)}),this.$scope.$on("attempt-base-content-update-by-regrading",(e,t)=>{this.updateAttempBaseContent(t)})}updateAttempBaseContent(e){const t=this.gridData.getColumnMetadataByContentId(e.id);c.isUndefined(t)||t.$fetch().$asPromise().then(()=>{this.gridData.initializeGroupsMemberships().then(()=>t.summary.$fetch().$asPromise()).then(()=>{this.updateColumns(t)})})}updateColumns(e){const t=this.getAffectedColumnsBeforeEdit(e),n=this.gridData.updateColumnByMetadata(e);if(n instanceof a.c){let e=n.findAffectedColumns();e=c.unionBy(t,e,"id");const s=c.find(this.gridData.getColumns(),e=>e instanceof a.k);s&&e.push(s),this.$q.all(e.map(e=>e.data.$fetch().$asPromise())).then(()=>{e.forEach(e=>this.gridData.updateColumnByMetadata(e.data)),this.$scope.$broadcast(M.b.COLUMN)})}else this.$scope.$broadcast(M.b.COLUMN)}setContainerHeight(){const t=e(".course-grades-header-buttons-wrapper"),n=t.offset().top+t.outerHeight()+parseFloat(t.css("margin-bottom")),s=window.innerHeight-n;this.$element.find(".grade-grid-container").css("height",s)}getRowCount(){return this.studentsTotal}getGridData(){return this.gridData}getElement(){return this.$element}createMenuScope(e,t){const n=this.$scope.$new(!0);return n.adjustPosition=t=>{const n=e.left+t.width(),s=this.getGradeGridContainerElementRight();n>s&&(e.left-=n-s+Object(P.a)()),t.offset(e)},n.positionAfter=t,n.attendanceColumnExists=this.isAttendanceExisting(),n.attendanceIsAvailable=this.attendanceIsAvailable,n}onClickAddColumnButton(t,n){const s=c.isUndefined(n)||"left"===n.position?"start":n.id,i=`grade-grid-add-column-menu-reborn-${s}`;if(this.isMenuExisting(i))return;const o=e(t.target).offset();o&&(o.top+=30);const a=this.createMenuScope(o,s);this.popupMenu(i,_,a),this.timeout(()=>{const s=this.getPopupMenu();s.on("keydown",i=>{i.keyCode===G.g||i.keyCode===G.u?(s.data("destroy")(),e(t.target).click(),e(t.target).focus(),i.preventDefault(),i.stopPropagation()):G.y(i)&&this.$scope.$broadcast(M.b.FOCUS_CELL,void 0,n)}),this.getMenuitems().first().focus()},a,0,!1),t.preventDefault(),t.stopPropagation()}getPopupMenu(){return this.$element.find("[bb-grade-grid-menu-reborn]")}getMenuitems(){return this.getPopupMenu().find("li>:tabbable")}getGradeGridContainerElement(){return this.$element.children("#grade-grid-container")}getGradeGridContainerElementRight(){const e=this.getGradeGridContainerElement();return e.offset().left+e.width()}getGradeGridContainerElementBottom(){const e=this.getGradeGridContainerElement();return e.offset().top+e.height()}popupMenu(e,t,n,s){n.id=e,this.showMenu(t,n,s)}isMenuExisting(e){return!!this.$element.children(`#${e}`).length}showMenu(e,t,n){t.$applyAsync(()=>{this.$compile(e)(t,e=>{this.$element.append(e),c.isUndefined(n)||e.offset(n)})})}isAttendanceExisting(){return!!this.availableColumnSelectedOptions.find(e=>this.gridData.getColumnMetadata(e.id)&&this.gridData.getColumnMetadata(e.id).isAttendance())}get attendanceIsAvailable(){return this.$scope.attendanceIsAvailable&&this.$scope.attendanceIsAvailable()}setupOverallGradeHideMessageCallback(){this.$scope.$apply(()=>this.isOverallPanelShown=!1)}refreshColumns(e=c.noop){this.gridData.refreshAllColumns(),e(),this.$scope.$broadcast(M.b.COLUMN)}filterColumns(e,t,n){t&&(this.filteredColumns=e(n,t),this.$scope.$broadcast(M.b.COLUMN,this.filteredColumns))}updateFilteredColumns(){const e=c.find(this.filteredColumns,e=>e instanceof a.k);this.filteredColumns&&!e&&(this.filteredColumns.push(c.find(this.availableColumnSelectedOptions,e=>e instanceof a.k)),this.$scope.$broadcast(M.b.COLUMN,this.filteredColumns))}updateCategoryColumns(){const e=this.availableColumnSelectedOptions;this.filterColumns((e,t)=>c.filter(e,e=>e.filterByCategoryId(t)),this.ids,e)}handleMergedCourse(){this.mergedCourses.forEach(e=>{if(this.availableRowSelectedOptions){c.find(this.availableRowSelectedOptions,t=>t.childCourseId===e.id)||(e.ui.hidden=!0)}})}getCheckedMergeCourseIds(){return c.filter(this.mergedCourses,e=>e.ui.checked).map(e=>e.id)}getAvailableRowSelectedOptions(){return this.availableRowSelectedOptions}};W=Object(s.__decorate)([Object(s.__param)(0,Object(u.b)("$compile")),Object(s.__param)(1,Object(u.b)("$element")),Object(s.__param)(2,Object(u.b)("$injector")),Object(s.__param)(3,Object(u.b)("$ngRedux")),Object(s.__param)(4,Object(u.b)("$q")),Object(s.__param)(5,Object(u.b)("$scope")),Object(s.__param)(6,Object(u.b)("$rootScope")),Object(s.__param)(7,Object(u.b)("$location")),Object(s.__param)(8,Object(u.b)(v.d)),Object(s.__param)(9,Object(u.b)($.i)),Object(s.__param)(10,Object(u.b)(E.b)),Object(s.__param)(11,Object(u.b)("$attrs")),Object(s.__param)(12,Object(u.b)(w.serviceName)),Object(s.__param)(13,Object(u.b)(z.serviceName)),Object(s.__param)(14,Object(u.b)(U.serviceName)),Object(s.__param)(15,Object(u.b)(I.b)),Object(s.__param)(16,Object(u.b)(O.b))],W);class J{constructor(e){this.$injector=e,this.restrict="E",this.template=A,this.controller=W,this.controllerAs="gg",this.scope={course:"&",columnMetadatas:"<columns",attendanceIsAvailable:"&?",mergedCourses:"<"}}}J.$inject=["$injector"],r.module(q,[S.b,h.a,p.a,m.a,b.a,f.a,C.a,y.a,D.a,k.a,R.a,j.a,E.a,O.a,L.a,v.b,g.a]).directive(K,["$injector",e=>e.instantiate(J)])}).call(this,n("5iHu"))},LTOG:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));const s=6e3;class i{constructor(e,t){this.scope=e,this.timeout=t}highlight(t){t.isUpdated?(e(".rb-col-"+t.id).addClass("highlighted"),delete t.isUpdated,this.timeout(()=>{e(".rb-col-"+t.id).removeClass("highlighted")},this.scope,s,!1)):e(".rb-col-"+t.id).removeClass("highlighted")}}}).call(this,n("5iHu"))},LecS:function(e,t,n){"use strict";var s=n("Llzl"),i=n("pjml"),o=n("/hmo");n.d(t,"a",(function(){return a}));const a="ultra.directives.lti";class r{constructor(e){this.CourseModel=e,this.replace=!0,this.restrict="E",this.scope={content:"=",targetContent:"=?",prefix:"="},this.template=o,this.link=(e,t)=>{const n=e.$watch("targetContent.contentHandler",t=>{null!=t&&(e.$emit("click-to-invoke-child-directive-init"),n())});!e.targetContent&&e.content&&e.content.contentDetail&&(e.targetContent=e.content.getLinkContentSource(),e.targetContent.$then(()=>{e.content.description=e.targetContent.description}))}}}r.$inject=[i.m.serviceName],s.module(a,[]).directive("bbLtiLinkItem",["$injector",e=>e.instantiate(r)])},Lrq8:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-add-feedback",use:"icon-medium-add-feedback-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-add-feedback"><path d="M1 1h22v19h-8l-3 3-3-3H1V1zM12 6v10M7 11h10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},MKP7:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var s=n("D57K"),i=n("7UH7"),o=n("Llzl"),a=n("/KQw"),r=n("0JpG"),c=n("TnpK"),l=n("+4Px"),d=n("e6jQ"),u=n("tecA"),h=n("aHpC");const p="ultra.directives.basicTextEditor";let m=class extends u.a{constructor(e,t,n,s,i,o){super(t,n,s,i,o),this.shouldPreventLineBreaking=!0,t.$on(u.b,()=>{this.updateOriginalValues(),this.isTextTouched=!1}),t.shouldPreventLineBreaking&&(this.shouldPreventLineBreaking=t.shouldPreventLineBreaking())}onKeydown(e){this.shouldPreventLineBreaking&&e.keyCode===l.f&&(e.stopPropagation(),e.preventDefault())}};m.$inject=[],m=Object(s.__decorate)([Object(s.__param)(0,Object(h.b)("$q")),Object(s.__param)(1,Object(h.b)("scope")),Object(s.__param)(2,Object(h.b)("element")),Object(s.__param)(3,Object(h.b)("ctrl")),Object(s.__param)(4,Object(h.b)(r.serviceName)),Object(s.__param)(5,Object(h.b)(c.d))],m);class b{constructor(e){this.$injector=e,this.require=["ngModel"],this.replace=!0,this.restrict="E",this.scope={placeholderKey:"@",placeholderAttrsValues:"@",elementId:"@",readonly:"&",getInputMaxLength:"&?inputMaxLength",onchangeFunc:"&?",onblurFunc:"&?",onFocusFunc:"&",ngModel:"=",fieldRequired:"&?",plainText:"=?",validationMessage:"@?",focusOn:"@?",noValidationMessage:"&?",direction:"&?",shouldPreventLineBreaking:"&?"},this.link=(e,t,n,s)=>{const i=s[0];e.textEditor=this.$injector.instantiate(m,{scope:e,element:t,ctrl:i}),e.elementId||(e.elementId="text-editor-"+d.a())},this.template=i}}b.$inject=["$injector"],o.module(p,[a.a,r.moduleName,c.b]).directive("bbBasicTextEditor",["$injector",e=>e.instantiate(b)])},Mnbc:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-groups",use:"icon-small-groups-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-groups"><path d="M12 15s-1-2-4-2M4 15s1-2 4-2M8 13c1.6569 0 3-1.3431 3-3S9.6569 7 8 7s-3 1.3431-3 3 1.3431 3 3 3zM12 5c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2zM1 7s1-2 3-2 3 2 3 2M9 7s1-2 3-2 3 2 3 2M4 5c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},NEyJ:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-move-item-up-down",use:"icon-small-move-item-up-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-move-item-up-down"><path d="M5 11V3M7 4L5 2 3 4M11 5v8M9 12l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},NZ4S:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification upload-disallowed-file-type upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.fileTypeError.title\'}" \n          modal-title-key="course.grades.grades-upload-settings.fileTypeError.title" aria-describedby="gradebook-upload-failed"\n          analytics-id-tag-prefix="course.grades.grades-upload-settings">\n  <div name="modal-contents">\n    <p id="gradebook-upload-failed" bb-translate="course.grades.grades-upload-settings.fileTypeError.content"></p>\n  </div>\n  <a name="modal-footer-help-link" \n     href="" \n     bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkUpload\'}" \n     target="_blank" \n     bb-translate="course.grades.grades-upload-settings.helpButton" \n     rel="noopener noreferrer"\n     analytics-id="course.grades.grades-upload-settings.helpButton">\n  </a>\n  <button name="modal-footer-button-primary" \n          class="button js-discard-changes js-primary-button" \n          ng-click="$dismiss()"\n          analytics-id="course.grades.gradesUploadSettingsError.closeButton.button">\n    <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n  </button>\n</bb-modal>'},Ne7M:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-discussion",use:"icon-medium-discussion-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-discussion"><path d="M8 21.4025a10.4446 10.4446 0 01-1.75-.8072L1 22l1.4318-5.2034C1.5217 15.2417 1 13.4318 1 11.5 1 5.701 5.701 1 11.5 1c4.5718 0 8.4611 2.9218 9.9025 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M9 16c0 3.866 3.134 7 7 7 1.3878 0 2.6812-.3803 3.7692-1.0769L23 23l-1.0769-3.2308C22.6197 18.6812 23 17.3878 23 16c0-3.866-3.134-7-7-7s-7 3.134-7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="13" cy="16" r=".5" /><circle cx="16" cy="16" r=".5" /><circle cx="19" cy="16" r=".5" /></symbol>'});i.add(o);e.exports=o},Nyb7:function(e,t){e.exports='<div class="complex-statistic-contents"></div>'},OFW5:function(e,t,n){"use strict";n.r(t);n("h3DF");var s=n("Llzl"),i=n("bd9L"),o=n("Fvsw"),a=n("zEHu"),r=n("D57K"),c=n("5KgE"),l=n("aHpC");let d=class{constructor(e,t,n,s){if(this.$scope=e,this.course=t,this.firstTimeHelper=n,this.stateParams=s,e.courseGrades=this,e.course)if(e.course.membership.isStudentMembership()){const n=t.isOrganization?"organization":"course";e.course.headerKey=`${n}.grades.studentHeaderLabel`}else e.course.headerKey="course.grades.instructorHeaderLabel";n.fadeAddContentButton(e,"grades.grader.course.column.add")}};d=Object(r.__decorate)([Object(r.__param)(0,Object(l.b)("$scope")),Object(r.__param)(1,Object(l.b)("currentCourse")),Object(r.__param)(2,Object(l.b)(c.c)),Object(r.__param)(3,Object(l.b)("$stateParams"))],d);class u extends d{}var h=n("fGDP"),p=n("8MYS"),m=n("Ij+l"),b=n("8HGT"),g=n("UiBk"),v=n("X6r5"),f=n("IjED"),C=n("eAkB"),y=n("0JpG"),w=n("1ZbL");const S="ultra.course.grades.gradebook-item.download-test-result-panel",I={Class:n("ZQFV").DownloadTestResults,bindingNames:["courseId","columnId","courseName","isOrganization"],renderLocalized:!0};s.module(S,[y.moduleName]).component("bbDownloadTestResultPanel",Object(w.a)(I)),n.d(t,"moduleName",(function(){return O})),n.d(t,"controllerName",(function(){return E})),n.d(t,"template",(function(){return C}));const O="ultra.course.grades",E="ultra.course.grades.controller";s.module(O,[i.e,o.a,a.a,h.c,p.a,m.a,c.b,b.a,g.a,v.a,f.a,S]).controller("ultra.course.grades.controller",d)},Ocaa:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));n("0lMW"),n("gORw");var s=n("Llzl"),i=n("nbDY"),o=n.n(i),a=n("0JpG"),r=n("2a+M"),c=n("+4Px"),l=n("pjml"),d=n("lEL+"),u=n("GbAM"),h=n("Qbdf"),p=n("nYZ0"),m=n("W6wm");const b="ultra.components.directives.bbDragHandle";class g extends o.a{}g.Vertical=new g("vertical"),g.Horizontal=new g("horizontal"),g.Omnidirectional=new g("omnidirectional");class v{constructor(t,n,s,i,o,a){this.$rootScope=t,this.bbLocalizeService=n,this.dragDropService=s,this.timeout=i,this.currentCourseService=o,this.contentService=a,this.bbDragMoveTimeoutId=null,this.scope={dragItemId:"@",dragItemName:"@",dragItemType:"@",dragDirection:"@?",dragItemContext:"@?"},this.restrict="A",this.link=(t,n,s)=>{this.dragDirection=g.parse(t.dragDirection)||g.Vertical,this.dragDropService.currentDragContext=t.dragItemContext,e(n).parent().attr("role","application"),n.on("mousedown",s=>{function i(e){e.stopImmediatePropagation()}s.preventDefault(),document.addEventListener("click",i,!0),this.dragStart(s,n,t),e(document).on("mousemove.reorder",e=>{this.dragMove(e,t)}),e(document).on("mouseup.reorder",s=>{this.dragEnd(s,n),e(document).off("mousemove.reorder"),e(document).off("mouseup.reorder"),n.on("$destroy",()=>{document.removeEventListener("click",i,!0)}),this.timeout(()=>{document.removeEventListener("click",i,!0)},t,0,!1)})}),n.on("keydown",n=>{if(n.stopPropagation(),n.keyCode===c.f||n.keyCode===c.t)if(n.preventDefault(),this.dragDropService.isKeyboardDragging){const n=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-stopped",noWrap:!0});this.$rootScope.$broadcast(u.a,n),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-end")}else{this.dragDropService.isKeyboardDragging=!0,this.dragDropService.currentDragId=t.dragItemId,this.dragDropService.currentDragType=t.dragItemType,this.contentHasFolderChild(t),this.dragDropService.currentDropTargetId=t.dragItemId,this.dragDropService.positionBefore=t.dragItemId,e(document.body).addClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-start");const n=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-started",params:{itemName:t.dragItemName},noWrap:!0});this.$rootScope.$broadcast(u.a,n)}else if(n.keyCode===c.v)n.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-up");else if(n.keyCode===c.d)n.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-down");else if(n.keyCode===c.s)n.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-right");else if(n.keyCode===c.j)n.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-left");else if(n.keyCode===c.g&&(n.preventDefault(),this.dragDropService.isKeyboardDragging)){const n=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-canceled"});this.$rootScope.$broadcast(u.a,n),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel")}}),n.on("blur",()=>{this.dragDropService.isKeyboardDragging&&(e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel"))});const i=e=>{this.dragStart(e,n,t)},o=e=>{this.dragMove(e,t)},a=e=>{this.dragEnd(e,n)},r=()=>{this.dragCancel()};n[0].addEventListener("touchstart",i,!1),n[0].addEventListener("touchmove",o,!1),n[0].addEventListener("touchend",a,!1),n[0].addEventListener("touchcancel",r,!1),t.$on("$destroy",()=>{n[0].removeEventListener("touchstart",i,!1),n[0].removeEventListener("touchmove",o,!1),n[0].removeEventListener("touchend",a,!1),n[0].removeEventListener("touchcancel",r,!1)})}}contentHasFolderChild(e){if(l.p.ContentHandler.Folder.isEqualTo(e.dragItemType)&&!(()=>m.a.Discussions===this.dragDropService.currentDragContext)()){const e=l.p.ContentRootNode.ROOT,t=this.currentCourseService.course,n=this.contentService.findRootNode(t,e);this.contentService.getContentInContentTree(n,t.courseId,this.dragDropService.currentDragId).then(e=>{e.content&&(this.dragDropService.currentDragHasFolderChild=e.content.getChildren().$asPromise().then(e=>e.some(e=>e.isUiFolder())))})}}dragStart(t,n,s){if(this.dragDropService.currentDragElement){const t=e(".f-open-dropdown");t.length>0&&window.Foundation.libs.dropdown.close(t),this.dragDropService.currentDragElement.remove()}this.$rootScope.$broadcast("bb-drag-start"),e(document.body).addClass("bb-is-dragging"),this.dragDropService.originalElement=n.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.idOfPreviousItem=this.dragDropService.originalElement.prev(".drag-element").find("[drag-item-id]").attr("drag-item-id"),this.dragDropService.idOfNextItem=this.dragDropService.originalElement.next(".drag-element").find("[drag-item-id]").attr("drag-item-id");const i=e(".f-open-dropdown");if(i.length>0&&window.Foundation.libs.dropdown.close(i),this.$rootScope.$broadcast("foundation-offcanvas-close-panel"),l.p.ContentHandler.Folder.isEqualTo(s.dragItemType)){this.$rootScope.$broadcast("close-folder-immediately-by-id",s.dragItemId),this.dragDropService.currentDragElement.find(".img-icon-folder-open").removeClass("img-icon-folder-open").addClass("img-icon-folder")}this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass).addClass("mouse-touch-drag"),this.dragDropService.originalElement.after(this.dragDropService.currentDragElement),this.dragDropService.currentDragId=s.dragItemId,this.dragDropService.currentDragType=s.dragItemType,this.contentHasFolderChild(s),this.dragDropService.currentDropTargetId=s.dragItemId,this.dragDropService.positionBefore=s.dragItemId,this.dragDropService.createDropPlaceholderElement(this.dragDropService.currentDragElement),this.dragMove(t,s)}dragEnd(t,n){e(document.body).removeClass("bb-is-dragging"),t.preventDefault(),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.movableElementClass),this.dragDropService.currentDragElement.removeAttr("style"),this.$rootScope.$broadcast("bb-drag-end")}dragCancel(){this.$rootScope.$broadcast("bb-drag-cancel"),e(document.body).removeClass("bb-is-dragging")}dragMove(e,t){e.preventDefault();const n=this.dragDropService.currentDragElement.find("[bb-drag-handle]"),s=this.dragDropService.originalElement.find("[bb-drag-handle]").offset(),i=n.offset(),o=this.dragDropService.currentDragElement.offset(),a=i.left-o.left,c=i.top-o.top,l=a+n.width()/2,d=c+n.height()/2,u=g.Horizontal.isEqualTo(this.dragDirection)||g.Omnidirectional.isEqualTo(this.dragDirection),h=g.Vertical.isEqualTo(this.dragDirection)||g.Omnidirectional.isEqualTo(this.dragDirection);let p,m,b,v;e.touches?(p=u?e.touches[0].pageX-l:o.left,m=h?e.touches[0].pageY-d:o.top,b=u?e.touches[0].pageX:s.left,v=h?e.touches[0].pageY:s.top):(p=u?e.pageX-l:o.left,m=h?e.pageY-d:o.top,b=u?e.pageX:s.left,v=h?e.pageY:s.top),this.dragDropService.currentDragElement.offset({left:p,top:m}),this.dragDropService.pointerPosition={left:b,top:v},this.dragDropService.scrollDragDropItemsContainer(this.dragDropService.pointerPosition.top,r.a.SCROLLING_CONSTANTS.mouseInteractionDistanceToScroll),this.timeout.cancel(this.bbDragMoveTimeoutId),this.bbDragMoveTimeoutId=this.timeout(()=>{this.$rootScope.$broadcast("bb-drag-move")},t,150,!1)}}v.$inject=["$rootScope",a.serviceName,r.d,d.b,h.e,p.f],s.module(b,[a.moduleName,r.c,d.a,h.b,p.d]).directive("bbDragHandle",["$injector",e=>e.instantiate(v)])}).call(this,n("5iHu"))},OsJo:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));class s{static insertElement(e,t,n,s){const i=`lr_${t}_scope`,o=`lr_${t}_element`;return e&&!e[i]&&(e[i]=e.$new(),n(e[i],t=>{e[o]=t,s.append(e[o])}),e.$applyAsync()),{childScope:e[i],childElement:e[o]}}static removeElement(e,t){const n=`lr_${t}_scope`,s=`lr_${t}_element`;e&&e[n]&&(e[s].remove(),delete e[s],e[n].$destroy(),delete e[n],e.$applyAsync())}}},Pq3J:function(e,t){e.exports='<bb-guidance-feature-announcement\n  component-key="\'gradebook.advancedFilters\'"\n  button-aria-label="$ctrl.buttonAriaLabel"\n  announcement-title="$ctrl.announcementTitle"\n  content="$ctrl.content"\n  done-button-text="$ctrl.doneButtonText"\n  link-href="$ctrl.linkHref"\n  link-text="$ctrl.linkText"\n  close-label="$ctrl.closeLabel"\n></bb-guidance-feature-announcement>\n'},R4kC:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var s=n("D57K"),i=n("nsO7"),o=n("Llzl"),a=n("pjml"),r=n("aHpC"),c=n("jhBu"),l=n("o5Lu"),d=n("Sa5G"),u=n("JfV0");const h="ultra.services.submissionList",p="submissionList",m=["courseCardColorIndex","id","isAvailable","dueDateExceptionType","timeLimitExceptionType","role","courseRole","user.id","user.userName","user.avatar","user.familyName","user.givenName","user.lastModifiedAt","userHasHidden","userId","isPreviewStudent"].join(),b=["isPreviewStudent(asc)","user.familyName(asc)","user.givenName(asc)"].join();let g=class{constructor(e,t,n,s,i,o){this.$rootScope=e,this.$q=t,this.CourseModel=n,this.gradeService=s,this.entitlementService=i,this.$ngRedux=o,this.loadAssignedGroupAndGroupRows=(e,t,n)=>this.CourseModel.$new(e.Column.courseId).contents.$find(e.Column.contentId,{expand:"assignedGroups"}).$asPromise().then(s=>{var i,o,a;const r=null===(i=null==s?void 0:s.assignedGroups)||void 0===i?void 0:i.find(t=>t.groupId===e.group.id);return this.gradeService.loadGroupRows(this.CourseModel.$new(t),[r],n,e.Column,null===(a=null===(o=e.Column.ui)||void 0===o?void 0:o.content)||void 0===a?void 0:a.isSafeAssignEnabled())}),this.listeners=new Map,this.subscribeToRedux()}subscribeToRedux(){this.$ngRedux.connect(null,e=>({loadMembership:(t,n)=>e(u.actions.courseMembership.loadCourseMembershipByMemberId(t,n))}))(this)}setSubmissionList(e,t,n,s){this.submissionList&&this.submissionList.courseId===e&&this.submissionList.columnId===t||(this.submissionList=Object.create(null)),this.submissionList.courseId=e,this.submissionList.columnId=t,this.submissionList.memberships=n,this.submissionList.rows=s||[],this.submissionList.canViewGroups=this.entitlementService.areAllEntitled([d.o.ViewGroups,d.e.ViewAsDesigner],e)}getListeners(e,t){const n=`${e}|${t}`;return this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n)}notifyRowsListeners(){if(!this.submissionList)return;this.getListeners(this.submissionList.courseId,this.submissionList.columnId).forEach(e=>{null==e||e()})}addOnRowsUpdated(e,t,n){return this.getListeners(e,t).add(n),()=>{this.removeOnRowsUpdated(e,t,n)}}loadRowsListeners(){if(!this.submissionList)return;this.getListeners(this.submissionList.courseId,this.submissionList.columnId).forEach(e=>e())}removeOnRowsUpdated(e,t,n){this.getListeners(e,t).delete(n)}refreshAttempts(e,t,n){var s,i,o,a,r,c,l,d;if(e!==(null===(s=this.submissionList)||void 0===s?void 0:s.courseId)||t!==(null===(i=this.submissionList)||void 0===i?void 0:i.columnId))return this.$q.when();let u;return"attemptId"in n?u=null===(a=null===(o=this.submissionList)||void 0===o?void 0:o.rows)||void 0===a?void 0:a.find(e=>{var t,s;return null===(s=null===(t=e.grade)||void 0===t?void 0:t.attempts)||void 0===s?void 0:s.some(e=>(null==e?void 0:e.id)===n.attemptId)}):"userId"in n?u=null===(c=null===(r=this.submissionList)||void 0===r?void 0:r.rows)||void 0===c?void 0:c.find(e=>{var t;return(null===(t=e.user)||void 0===t?void 0:t.id)===n.userId}):"groupId"in n&&(u=null===(d=null===(l=this.submissionList)||void 0===l?void 0:l.rows)||void 0===d?void 0:d.find(e=>{var t;return(null===(t=e.group)||void 0===t?void 0:t.id)===n.groupId})),u?this.loadAttempt(e,u).then(e=>{if(1!==(null==e?void 0:e.length))return;const t=e[0];u.grade=t.grade,u.attemptCount=t.attemptCount,u.lastAttemptDate=t.lastAttemptDate,u.attemptsReadyToPost=t.attemptsReadyToPost,this.notifyRowsListeners()}):this.$q.when()}loadAttempt(e,t){var n;return(null===(n=t.group)||void 0===n?void 0:n.id)?this.loadGroupAttempt(e,t):this.loadIndividualAttempt(t)}loadGroupAttempt(e,t){var n,s,i,o,a,r;if(!this.submissionList.canViewGroups)return this.$q.when();const c=null===(i=null===(s=null===(n=t.Column.ui)||void 0===n?void 0:n.content)||void 0===s?void 0:s.assignedGroups)||void 0===i?void 0:i.find(e=>e.groupId===t.group.id),l=null===(o=t.group)||void 0===o?void 0:o.memberships.map(e=>this.submissionList.memberships.find(t=>t.userId===e.userId)).filter(e=>!!e);return c?this.gradeService.loadGroupRows(this.CourseModel.$new(e),[c],l,t.Column,null===(r=null===(a=t.Column.ui)||void 0===a?void 0:a.content)||void 0===r?void 0:r.isSafeAssignEnabled()):this.loadAssignedGroupAndGroupRows(t,e,l)}loadIndividualAttempt(e){var t,n;return this.gradeService.loadCustomizedBulkViewRows([e.membership],e.Column,null,null,null===(n=null===(t=e.Column.ui)||void 0===t?void 0:t.content)||void 0===n?void 0:n.isSafeAssignEnabled())}sortSubmissionList(e){e&&e.sort((e,t)=>this.getBucketNum(e)-this.getBucketNum(t)||(e.group?e.group.title.localeCompare(t.group.title):this.sortByGivenNamesForSimilarFamilyNames(e,t)))}getBucketNum(e){return e.RowStatus.valueOf()}sortByGivenNamesForSimilarFamilyNames(e,t){return e.user.familyName===t.user.familyName?e.user.givenName.localeCompare(t.user.givenName):e.user.familyName.localeCompare(t.user.familyName)}fetchMemberships(e,t){const n=i.merge({fields:m,roleBucket:"taking",sort:b},t);return e.memberships.$refresh(n).$asPromise()}fetchMembership(e,t){return this.$q.resolve(this.loadMembership(e.id,t).then(t=>{const n=e.memberships.$build(t);return this.$rootScope.$emit(`course-${e.id}-memberships-after-fetch`,[n]),n}))}};g=Object(s.__decorate)([Object(s.__param)(0,Object(r.b)("$rootScope")),Object(s.__param)(1,Object(r.b)("$q")),Object(s.__param)(2,Object(r.b)(a.m.serviceName)),Object(s.__param)(3,Object(r.b)(l.i)),Object(s.__param)(4,Object(r.b)(c.b)),Object(s.__param)(5,Object(r.b)("$ngRedux"))],g);class v extends g{}o.module(h,[c.a,l.h]).service(p,g)},ROik:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var s=n("Llzl"),i=n("LN5R"),o=n("nsO7"),a=n("yC9S"),r=n("lEL+"),c=n("dF44"),l=n("+4Px"),d=n("DAbe"),u=n("KvMR"),h=n("GiMb");const p="ultra.components.directives.gradeGridMenuReborn";class m{constructor(t,n,s,i,a){this.scope=t,this.element=n,this.attrs=s,this.gradeGridRebornController=i,this.timeout=a,n.data("destroy",()=>{if(o.isUndefined(t.onBeforeDestroy)||t.onBeforeDestroy(n),n.remove(),a.cancel(this.timeoutRef),this.scrollHDeregistration&&this.scrollHDeregistration(),this.scrollVDeregistration&&this.scrollVDeregistration(),!1===t.autoDestroy){const n=e(window);n.off(`click.${t.id}`),n.off(`blur.${t.id}`)}else t.$destroy()}),t.keepOthers||e("[bb-grade-grid-menu-reborn]").each((t,s)=>{s!==n[0]&&e(s).data("destroy")()}),n.mousedown(t=>{e(t.target).closest("button:disabled").length&&t.preventDefault()}),o.isUndefined(t.waiting)?this.listenOnWindow():a(()=>{this.listenOnWindow()},t,t.waiting,!1),this.timeoutRef=a(()=>{this.scrollHDeregistration=t.$on(c.b.SCROLL_H,()=>{a(()=>n.data("destroy")(),t,0,!1)}),this.scrollVDeregistration=t.$on(c.b.SCROLL_V,()=>{a(()=>n.data("destroy")(),t,0,!1)})},t,200,!1),a(()=>{o.isUndefined(t.adjustPosition)||t.adjustPosition(n)},t,0,!1)}listenOnWindow(){const t=(t,n)=>{n||e(t.target).closest("button:disabled").length||this.element.data("destroy")()},n=e=>{this.element.data("destroy")()};if(!1===this.scope.autoDestroy){const n=e(window);n.on(`click.${this.scope.id}`,t),n.on(`blur.${this.scope.id}`,t)}else a.b.OnWindow("click",t,this.scope),a.b.OnWindow("blur",n,this.scope)}}m.$inject=["scope","element","attrs","gradeGridRebornController",r.b];class b{constructor(t,n){this.$injector=t,this.timeout=n,this.restrict="A",this.template=d,this.require=`^${i.a}`,this.transclude=!0,this.link=(t,n,s,i)=>{t.gradeGridMenuReborn=this.$injector.instantiate(m,{scope:t,element:n,attrs:s,gradeGridRebornController:i}),this.timeout(()=>{n.on("keydown",t=>{const s=n.find("li>:tabbable"),i=e(t.target);if(t.keyCode===l.v)s.eq((s.index(i)-1+s.length)%s.length).focus();else if(t.keyCode===l.d)s.eq((s.index(i)+1)%s.length).focus();else{if(!l.y(t))return;i.click()}t.preventDefault(),t.stopPropagation()})},t,0,!1)}}}b.$inject=["$injector",r.b],s.module(p,[u.a,h.a]).directive("bbGradeGridMenuReborn",["$injector",e=>e.instantiate(b)])}).call(this,n("5iHu"))},RjAI:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("0JpG"),o=n("AuQm"),a=n("1ZbL");const r="ultra.components.directives.components.confirmationCalloutDialog",c={Class:o.ConfirmationCalloutDialog,bindingNames:["analyticsId","target","isVisible","textContent","onDismiss","onSuccess"],renderLocalized:!0};s.module(r,[i.moduleName]).component("bbConfirmationCalloutDialog",Object(a.a)(c))},SE1T:function(e,t){e.exports='<button class="button-add-content js-show-add-options"\n        data-show-add-options\n        ng-click="addContentButton.addGroup()"\n        ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n        aria-label="{{addContentButton.addButtonAriaLabel}}"\n        ng-focus="addContentButton.showButton()"\n        ng-blur="addContentButton.hideButton()"\n        analytics-id="components.directives.add-content-button.course-group.button">\n</button>\n'},SY8P:function(e,t,n){var s=n("Llzl");s.module("dibari.angular-ellipsis",[]).directive("ellipsis",["$timeout","$window","$sce",function(e,t,n){var i=function(t){var n=null,s=[];this.remove=function(t){-1!==s.indexOf(t)&&(s.splice(s.indexOf(t),1),0===s.length&&(e.cancel(n),n=null))},this.add=function(i){-1===s.indexOf(i)&&s.push(i),n||(n=e((function(){var e=s.slice();n=null,s.length=0,e.forEach((function(e){e()}))}),t))}},o=new i(0),a=new i(75);return{restrict:"A",scope:{ngShow:"=",ngBind:"=",ngBindHtml:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@",ellipsisSeparator:"@",useParent:"@",ellipsisSeparatorReg:"=",ellipsisFallbackFontSize:"@"},compile:function(e,i,r){return function(e,i,r){function c(){var t=e.ngBind||e.ngBindHtml,o=!1;if(n.isEnabled()&&s.isObject(t)&&n.getTrustedHtml(t)&&(o=!0,t=n.getTrustedHtml(t)),t){var a=!e.ngBind&&!!e.ngBindHtml,c=0,d=void 0!==r.ellipsisSymbol?r.ellipsisSymbol:"&hellip;",u=void 0!==e.ellipsisSeparator?r.ellipsisSeparator:" ",h=void 0!==e.ellipsisSeparatorReg&&e.ellipsisSeparatorReg,p=void 0!==e.ellipsisAppend&&""!==e.ellipsisAppend?d+"<span class='angular-ellipsis-append'>"+e.ellipsisAppend+"</span>":d,m=h?t.match(h):t.split(u);if(r.isTruncated=!1,a?i.html(t):i.text(t),void 0!==r.ellipsisFallbackFontSize&&l(i)&&i.css("font-size",r.ellipsisFallbackFontSize),l(i,e.useParent)){var b=m.length,g=e.useParent?function(e){var t=0;return s.forEach(e.parent().children(),(function(n){n!=e[0]&&(t+=n.clientHeight)})),e.parent()[0].clientHeight-t}(i):i[0].clientHeight;for(a?i.html(t+p):i.text(t).html(i.html()+p),i.attr("data-overflowed","true");c<b;c++){var v=m.pop();if(0===m.length&&(m[0]=v.substring(0,Math.min(v.length,5))),a?i.html(m.join(u)+p):i.text(m.join(u)).html(i.html()+p),(e.useParent?i.parent()[0]:i[0]).scrollHeight<g||!1===l(i,e.useParent)){r.isTruncated=!0;break}}d!=p&&void 0!==e.ellipsisAppendClick&&""!==e.ellipsisAppendClick&&i.find("span.angular-ellipsis-append").bind("click",(function(t){e.$apply((function(){e.ellipsisAppendClick.call(e,{event:t})}))})),!o&&n.isEnabled()&&n.trustAsHtml(t)}else i.attr("data-overflowed","false")}}function l(e,t){return(e=t?e.parent():e)[0].scrollHeight>e[0].clientHeight}function d(){r.lastWindowResizeWidth==window.innerWidth&&r.lastWindowResizeHeight==window.innerHeight||c(),r.lastWindowResizeWidth=window.innerWidth,r.lastWindowResizeHeight=window.innerHeight}r.lastWindowResizeTime=0,r.lastWindowResizeWidth=0,r.lastWindowResizeHeight=0,r.lastWindowTimeoutEvent=null,r.isTruncated=!1,e.$watch("ngShow",(function(){o.add(c)})),e.$watch("ngBind",(function(){o.add(c)})),e.$watch("ngBindHtml",(function(){o.add(c)})),e.$watch("ellipsisAppend",(function(){c()})),e.$watch((function(){return 0!=i[0].offsetWidth&&0!=i[0].offsetHeight}),(function(){a.add(c)}));var u=e.$on("dibari:refresh-ellipsis",(function(){o.add(c)}));function h(){a.add(d)}var p=s.element(t);p.bind("resize",h),e.$on("$destroy",(function(){p.unbind("resize",h),o.remove(c),a.remove(d),u&&(u(),u=null)}))}}}}])},Sq3Z:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-activity-indicator",use:"icon-small-activity-indicator-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-activity-indicator"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="8" cy="8" r="2" stroke-width="4" /></symbol>'});i.add(o);e.exports=o},T1pL:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var s=n("Llzl"),i=n("nsO7"),o=n("o5Lu"),a=n("3l3z"),r=n("LN5R"),c=n("TmUJ"),l=n("qH3X"),d=n("+4Px"),u=n("lEL+"),h=n("dF44"),p=n("TUWB");const m="ultra.components.directives.gradeGridOverallEditorReborn";class b{constructor(e,t,n,s,i,o,a,r){this.$compile=e,this.window=t,this.scope=n,this.element=s,this.attrs=i,this.gradeGridRebornController=o,this.gradeService=a,this.timeout=r,this.initialize(),n.$on(l.a.REFRESH_OVERALL_EDITOR,()=>{this.initialize()}),n.$on("$destroy",()=>{this.removeErrorMessage()})}initialize(){this.score=this.scope.gradeGridColumnOverallReborn.score,this.element.find("input").focus(),this.element.find(".wrapping-input-style").css({"border-color":"#c36fd3"}),this.timeout(()=>{this.element.find("input").select()},this.scope,0,!1),this.checkValue(this.score).then(e=>{this.isValidated=e})}removeErrorMessage(){this.element.removeClass("validation-alert"),i.isUndefined(this.messageElement)||(this.messageElement.remove(),this.messageElement=void 0),i.isUndefined(this.messageScope)||(this.messageScope.$destroy(),this.messageScope=void 0)}createErrorMessage(){if(this.messageElement&&this.removeErrorMessage(),i.isUndefined(this.messageElement)){this.element.addClass("validation-alert");const e=this.element.parent(".grade-grid-cell").offset();e.top+=60,this.messageScope=this.scope.$new(!1,this.scope),this.messageScope.adjustPosition=t=>{const n=e.left+t.width(),s=e.top+t.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();n>i&&(e.left-=n-i+Object(c.a)()),s>o&&(e.top-=t.height()+40),this.messageElement.offset(e)},this.$compile(b.CELL_MESSAGE_TEMPLATE)(this.messageScope,e=>{this.messageElement=e,this.element.parents("bb-grade-grid-reborn").append(this.messageElement)})}}get isValidated(){return this._isValidated}set isValidated(e){this._isValidated=e,this.isValidated?this.removeErrorMessage():this.createErrorMessage()}stopPropagation(e){e.preventDefault(),e.stopPropagation()}mousedown(){e(this.window).trigger("click")}get isHiddenPointsPossible(){return!(i.isUndefined(this.score)||/^-?\d*(\.\d+)?$/.test(this.score))}onChange(){this.checkValue(this.score).then(e=>{this.isValidated=e})}onInputBlur(){this.scope.gradeGridColumnOverallReborn.onInputBlur(this.isValidated,this.score)}checkValue(e){const t=this.gradeGridRebornController.getGridData().getSchema()[this.scope.col.data.gradingSchemaId],n=this.gradeService.createGradeSubmission(this.scope.col.data,e,t);return this.gradeService.validateGrade(n,this.scope)}onKeydown(t){d.y(t)?(this.scope.gradeGridColumnOverallReborn.gotoNextCell(),e(t.target).blur(),this.mousedown(),t.preventDefault(),t.stopPropagation()):t.keyCode===d.g?(e(t.target).blur(),this.mousedown(),this.scope.$emit(h.b.LEAVE_CELL)):d.x(t)&&(!this.score||t.keyCode!==d.j&&t.keyCode!==d.s?this.mousedown():t.stopPropagation())}}b.$inject=["$compile","$window","scope","element","attrs","gradeGridRebornController",o.i,u.b],b.CELL_MESSAGE_TEMPLATE='<div bb-grade-grid-message-reborn class="grade-grid-reborn-message" ng-mousedown="gradeGridMessageReborn.mousedown()"></div>';class g{constructor(e){this.$injector=e,this.restrict="A",this.template=p,this.require=`^${r.a}`,this.link=(e,t,n,s)=>{e.gradeGridOverallEditorReborn=this.$injector.instantiate(b,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}g.$inject=["$injector"],s.module(m,[a.a]).directive("bbGradeGridOverallEditorReborn",["$injector",e=>e.instantiate(g)])}).call(this,n("5iHu"))},TML7:function(e,t){e.exports='<div class="rb-grid">\n  <style scoped id="rb-grid"></style>\n  <style scoped id="rb-grid-rows-initial-position"></style>\n\n  <div ng-if="grid.containers.left" rb-grid-container="left" id="rb-grid-container-left"></div>\n\n  <div rb-grid-container="center"></div>\n\n  <div ng-if="grid.containers.right" rb-grid-container="right"></div>\n\n  <div ng-transclude></div>\n\n</div>\n'},TOu5:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-question-analysis",use:"icon-small-question-analysis-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-question-analysis"><path d="M11 1H5l1 2v4l-5 8h14l-5-8V3l1-2zM4.125 10h7.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},TUWB:function(e,t){e.exports='<div class="wrapping-input-style no-hover">\n  <div>\n    <input autocomplete="off" pu-elastic-input pu-elastic-input-minwidth="10px" pu-elastic-input-maxwidth="180px" pu-elastic-input-width-delta="8"\n           ng-blur="gradeGridOverallEditorReborn.onInputBlur()"\n           placeholder="--" ng-model="gradeGridOverallEditorReborn.score"\n           ng-mousedown="gradeGridOverallEditorReborn.stopPropagation($event)"\n           ng-click="gradeGridOverallEditorReborn.stopPropagation($event)"\n           ng-change="gradeGridOverallEditorReborn.onChange()"\n           ng-keydown="gradeGridOverallEditorReborn.onKeydown($event)" spellcheck="false" \n           analytics-id="components.directives.grade.grid.overAll.input.text"/>\n  </div>\n  <div ng-mousedown="gradeGridOverallEditorReborn.mousedown()" ng-class="{hidden: gradeGridOverallEditorReborn.isHiddenPointsPossible}">\n    <span class="slash"></span><span class="possible" ng-bind="gradeGridColumnOverallReborn.pointsPossible"></span>\n  </div>\n</div>\n'},TmUJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("5iHu");let i;function o(){if(null==i){const e=s('<div style="width:100px; height:100px; overflow:hidden; position:absolute; top:-200px; left:-200px;"><div class="inner" style="height:200px;"></div>'),t=e.find(".inner");s("body").append(e);const n=t.innerWidth();e.css("overflow","auto");const o=t.innerWidth();s(e).remove(),i=n-o}return i}},Tn43:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));n("367g"),n("Aw+3"),n("8+lX"),n("aAQ7"),n("UyCM");var s=n("Llzl"),i=n("nsO7"),o=n("en1n"),a=n("0JpG"),r=n("suMx"),c=n("jciN"),l=n("JNtI"),d=n("+e2k"),u=n("+g6d"),h=n("TnpK"),p=n("g7Mf"),m=n("r6lH"),b=n("ELoy"),g=n("pjml"),v=n("f4B+"),f=n("nmzr"),C=n("yC9S"),y=n("Wqh6"),w=n("Y+9S");const S="ultra.components.directives.discussion";class I{constructor(e,t,n,s,o,a,r,c,l,d){this.$window=e,this.$sce=t,this.scope=n,this.element=s,this.$stateParams=o,this.bbLocalize=a,this.telemetry=r,this.discussion=c,this.ultraState=l,this.courseModel=d,n.isLoaded=!1,n.courseId=n.content().courseId,n.contentId=n.content().id,n.isGroupDiscussion=n.content().isGroupContent,this.createDfiReport(n.courseId,n.contentId),C.b.OnWindow("resize",i.debounce(()=>{(this.scope.displayNonParticipants||this.scope.displayNonParticipantGroup)&&(this.updateNonParticipantView(),this.scope.$apply())},150),n),this.notifyMobileApp()}notifyMobileApp(){var e;const t={type:w.MessageType.DiscussionTelemetryOpened,status:w.MessageStatus.Success,contentId:this.scope.contentId,contentTitle:this.scope.content().title,prevState:Object(w.fetchState)(null===(e=this.ultraState.prev)||void 0===e?void 0:e.name)};Object(w.sendMessageToMobile)(t)}createDfiReport(e,t,n){(n?this.telemetry.loadDiscussionActivityData(e,t,n):this.telemetry.loadDiscussionActivityData(e,t)).then(e=>{this.scope.discussionData=e,this.scope.header=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.header",params:{title:this.scope.content().title},noEscape:!0,noWrap:!0}),this.scope.course=this.courseModel.$find(this.scope.courseId),this.scope.isSingleGroup=!!n,this.scope.groups=this.scope.discussionData.groups,this.scope.isGradable=!!this.scope.discussionData.gradeColumnId,this.scope.gradingColumn=this.scope.discussionData.gradeColumnId,this.scope.viewedOnlyCount=this.scope.discussionData.viewedOnlyCount,this.scope.avgCommentsPerStudent=this.scope.discussionData.avgCommentsPerStudent?this.scope.discussionData.avgCommentsPerStudent:0,this.scope.avgWordCountPerComment=this.scope.discussionData.avgWordCountPerComment?this.scope.discussionData.avgWordCountPerComment:0,this.scope.avgGradeOfDiscussion=this.scope.discussionData.avgGrade?this.scope.discussionData.avgGrade/100:0,this.scope.numberOfCommentsToDisplay=1,this.scope.topComments=[],this.scope.displayTopComments=!1,this.scope.topParticipants=[],this.scope.displayTopParticipants=!1,this.scope.nonParticipants=[],this.scope.showNonparticipant=[],this.scope.showLargeNonparticipantPanel=!0,this.scope.minHeightForTopBoxes="auto",this.scope.nonParticipants=this.getNonParticipants(),this.scope.displayNonParticipants=!!this.scope.nonParticipants.length&&!this.scope.isGroupDiscussion,this.scope.displayNonParticipantGroups=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&!this.scope.isSingleGroup,this.scope.displayNonParticipantGroup=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&this.scope.isSingleGroup,this.scope.nonParticipantGroups=this.scope.displayNonParticipantGroups?this.getNonParticipantGroups():[],this.scope.totalNonParticipants=this.scope.nonParticipants.length,this.scope.totalParticipants=this.scope.discussionData.totalParticipants+this.scope.totalNonParticipants,this.scope.displayedNonParticipants=24,this.scope.additionalNonParticipants=this.scope.totalNonParticipants,this.scope.currentPanelWidth=0,this.scope.lastPanelWidth=-1,this.scope.isLoaded=!0;for(let e=0;e<this.scope.displayedNonParticipants;e++)this.scope.showNonparticipant[e]=!0;this.getTopComments(),this.getTopParticipants(),this.getParticipantBarChart(),this.updateNonParticipantView(),this.scope.overflowItems=this.getOverflowMenu(),this.scope.statisticsConfig=this.getSummaryInsightNumbers(),this.scope.topCommentsColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-8 large-9":"small-12",this.scope.topParticipantColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-4 large-3":"small-12"})}getSummaryInsightNumbers(){const e=this.bbLocalize.getLocale(this.scope),t=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.numParticipants"}),n=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.formattedParticipation",params:{count:this.scope.totalParticipants-this.scope.totalNonParticipants,total:this.scope.totalParticipants},noWrap:!0}),s=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgComments"}),i=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgCount"}),o=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgGrade"}),a=this.scope.isGradable&&this.scope.avgGradeOfDiscussion>0?this.bbLocalize.formatPercentageSync(this.scope.avgGradeOfDiscussion,this.scope):this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.na"}),r=[];return r.push({title:t,data:n}),r.push({title:s,data:this.bbLocalize.formatNumberSync(this.scope.avgCommentsPerStudent,this.scope).toString()}),this.scope.avgWordCountPerComment&&this.scope.avgWordCountPerComment>0&&r.push({title:i,data:this.bbLocalize.formatNumberSync(this.scope.avgWordCountPerComment,this.scope).toString()}),this.scope.isGradable&&r.push({title:o,data:a}),r}getParticipantBarChart(){let t=0,n=0,s=100;const i=this.scope.totalParticipants-this.scope.totalNonParticipants;this.scope.totalParticipants>0?s=100-((t=Math.floor((this.scope.totalParticipants-this.scope.totalNonParticipants)/this.scope.totalParticipants*100))+(n=Math.floor(this.scope.viewedOnlyCount/this.scope.totalParticipants*100))):(t=0,n=0,s=100),e(".bar-chart .participated").attr("style","width: "+t+"%"),e(".bar-chart .opened").attr("style","width: "+n+"%"),e(".bar-chart .unopened").attr("style","width: "+s+"%");const o=this.scope.totalNonParticipants-this.scope.viewedOnlyCount;this.scope.barchartNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartNonParticipants",params:{count:o},noWrap:!0}),this.scope.barchartOpenedNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartOpenedNonParticipants",params:{count:this.scope.viewedOnlyCount},noWrap:!0}),this.scope.barchartParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartParticipants",params:{count:i},noWrap:!0}),this.scope.percentParticipatedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentParticipated",params:{percent:this.bbLocalize.formatPercentageSync(t/100,this.scope)},noWrap:!0}),this.scope.percentOpenedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentOpened",params:{percent:this.bbLocalize.formatPercentageSync((n+t)/100,this.scope)},noWrap:!0})}getNonParticipantGroups(){const e=[];return this.scope.nonParticipants.length>0&&s.forEach(this.scope.groups,t=>{const n={id:t.id,name:t.name,nonParticipants:[],total:0,hidden:0};s.forEach(this.scope.nonParticipants,e=>{e.group.id===t.id&&(e.localizedName=this.bbLocalize.formatUsernameSync(e,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),n.nonParticipants.push(e),n.total++)}),n.hidden=n.total>4?n.total-4:0,n.total>0&&e.push(n)}),e}getTopComments(){this.scope.numberOfCommentsToDisplay=o.k()?3:5,this.scope.discussionData.topComments.forEach(e=>{const t={user:e.user,message:v.a.text(e.message),messageId:e.messageId,numReplies:e.numReplies};t.user.localizedName=this.bbLocalize.formatUsernameSync(e.user,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),t.user.avatarData=e.user,this.scope.topComments.push(t),this.scope.displayTopComments=!0})}getTopParticipants(){this.scope.discussionData.topParticipants.forEach(e=>{const t={user:e.user,numComments:e.numComments,numReplies:e.numReplies};t.user.localizedName=this.bbLocalize.formatUsernameSync(e.user,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),t.user.avatarData=e.user,this.scope.topParticipants.push(t),this.scope.displayTopParticipants=!0})}getNonParticipants(){const e=[];return this.scope.discussionData.nonParticipants.forEach(t=>{t.avatarData=t,t.localizedName=this.bbLocalize.formatUsernameSync(t,a.ILocaleUsernameFormat.Short,null,{noWrap:!1,noEscape:!0}),t.localizedNameWithoutWrap=this.bbLocalize.formatUsernameSync(t,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),e.push(t)}),e}toggleIndividualNonParticipantDisplay(){i.defer(()=>{let e=s.element("#discussion-insights").find(".non-participant-box").innerWidth()-30;e=e<1118?e:1118;const t=2*Math.ceil((e+20)/126);this.scope.displayedNonParticipants=0;for(let e=0;e<18;e++)e<t&&e<this.scope.totalNonParticipants?(this.scope.showNonparticipant[e]=!0,this.scope.displayedNonParticipants++):this.scope.showNonparticipant[e]=!1;this.scope.additionalNonParticipants=this.scope.totalNonParticipants>this.scope.displayedNonParticipants?this.scope.totalNonParticipants-this.scope.displayedNonParticipants:0,this.scope.nonParticipationSummary=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.nonParticipationSummary",params:{count:this.scope.displayedNonParticipants,total:this.scope.totalNonParticipants},noWrap:!0}),this.setNonParticipantMargin(e)})}setNonParticipantMargin(t){const n=e("li.non-participant"),s=Math.floor(t/126),i=126*s+106,o=s-1>0?20+(t-i-2)/s:20+t-i;e(n).css("margin-right",o),e(n[s]).css("margin-right","2px"),2*s+1<=n.length&&e(n[2*s+1]).css("margin-right","2px")}updateNonParticipantView(){const e=this.bbLocalize.getLocale(this.scope);this.scope.nonParticipantsOptions=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.nonparticipantsOptions"}),this.scope.numberOfCommentsToDisplay=o.k()?3:5,this.scope.currentPanelWidth=s.element("#discussion-insights").find(".non-participant-box").innerWidth(),this.scope.currentPanelWidth!==this.scope.lastPanelWidth&&(o.k()?this.scope.showLargeNonparticipantPanel=!1:(this.scope.showLargeNonparticipantPanel=!0,this.toggleIndividualNonParticipantDisplay())),this.scope.lastPanelWidth=this.scope.currentPanelWidth}getSafeHtml(e){return this.$sce.trustAsHtml(e)}hasNavScrollbar(){const e=s.element(".group-selector")[0];return!!(e&&e.scrollWidth>e.clientWidth)}goToDiscussion(e){e?(this.discussion.groupId=e,this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,disGroupId:e,courseId:this.scope.courseId})):this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,courseId:this.scope.courseId})}goToGrade(e){this.scope.isGradable&&!this.scope.isGroupDiscussion&&this.ultraState.goPeekState("submission-list",{columnId:this.scope.gradingColumn,participantId:e,contentId:this.scope.contentId})}goToMessage(e){this.ultraState.goPeekState(f.CourseRoutes.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:e})}isFocusedNonparticipant(t){return e(document.activeElement).is(s.element(e("a#non-participant-link-"+t)))}sortNamesAlphabetically(e){let t="";return e.sort((e,t)=>e.givenName+e.familyName<t.givenName+t.familyName?-1:1).forEach(e=>{t+=e.id+","}),t.slice(0,-1)}goToMessageAll(){const e=this.sortNamesAlphabetically(this.scope.nonParticipants);this.ultraState.goPeekState(f.CourseRoutes.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:e,conversationPerRecipient:!0})}updateDfiPanel(t,n,s){e(".group-selector .selected").removeClass("selected"),e(t.target).addClass("selected"),n?(this.discussion.groupId=n,this.scope.currentGroupId=n,this.scope.currentGroupName=s,this.createDfiReport(this.scope.courseId,this.scope.contentId,n),this.updateNonParticipantView()):(this.discussion.groupId=void 0,this.scope.currentGroupId=void 0,this.scope.currentGroupName=void 0,this.createDfiReport(this.scope.courseId,this.scope.contentId))}updateMessagesCount(){s.element("bb-overflow-menu.ddm-nonparticipant-options:visible").find("#ddm-nonparticipant-options_messages span").text(this.scope.overflowItems[0].labelKey).attr("analytics-id",this.scope.overflowItems[0].labelKey)}getOverflowMenu(){return[{icon:"messages",labelKey:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.messageNonParticipants",params:{count:this.scope.totalNonParticipants},noWrap:!0}),uniqueId:"discussion-insights-message",onClick:()=>{this.goToMessageAll()}}]}}I.$inject=["$window","$sce","scope","element","$stateParams",a.serviceName,m.b,p.c,h.d,g.m.serviceName];class O{constructor(e){this.$injector=e,this.restrict="EA",this.template=y,this.scope={content:"&"},this.link=(e,t,n)=>{e.discussionInsights=this.$injector.instantiate(I,{scope:e,element:t,attrs:n})}}}O.$inject=["$injector"],s.module(S,[r.a,c.a,l.b,d.a,u.a,m.a,b.a,h.b]).directive("bbDiscussionInsights",["$injector",e=>e.instantiate(O)])}).call(this,n("5iHu"))},Tt7N:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-calculation",use:"icon-small-calculation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-calculation"><path d="M4 2v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="10" cy="10" r=".5" /><circle cx="14" cy="14" r=".5" /><path d="M2 10l4 4M2 14l4-4M14 10l-4 4M14 4h-4M6 4H2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},TuNX:function(e,t){e.exports='<bb-modal class="notification proctoring-modal" analytics-id-tag-prefix="components.services.proctoring">\n  <div name="modal-contents">\n    <p bb-translate>{{::requirementsText}}</p>\n    <p ng-bind-html="::downloadText"></p>\n    <p bb-translate>{{::browserText}}</p>\n  </div>\n  \x3c!-- htmlhint:analytics-id:disable --\x3e\n  <button name="modal-footer-button-primary"\n          role="button"\n          class="button js-primary-button proctoring-modal-button"\n          ng-click="$parent.$dismiss()"\n          bb-translate-attrs="{\'aria-label\':\'components.services.proctoring.modal.continue\'}"\n          analytics-id="components.services.proctoring.modal.continue.button"\n  >\n  \x3c!-- htmlhint:analytics-id:enable --\x3e\n    <bb-translate>components.services.proctoring.modal.continue</bb-translate>\n  </button>\n</bb-modal>\n'},U50L:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-aria-type="alertdialog"\n          modal-translate-options="translateOpts"\n          analytics-id-tag-prefix="components.services.error-modal.error-not-enough-submissions">\n  <div name="modal-contents">\n    <p bb-translate>{{::descriptionKey}}</p>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          bb-translate\n          analytics-id="components.services.error-modal.dismiss">components.services.error-modal.dismiss</button>\n</bb-modal>\n'},UEFj:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-beast-analytics",use:"icon-small-beast-analytics-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-beast-analytics"><rect x="1" y="1" width="14" height="14" rx="7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8 8V1M8 8l5-4M8 8l4.5 4.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},UGfE:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("pjml"),o=n("/BCe"),a=n("JfV0");const r="ultra.directives.courseLinkItem";class c{constructor(e){this.CourseModel=e,this.replace=!0,this.restrict="E",this.scope={content:"=",targetContent:"=?",prefix:"=",aria:"=?",tabbable:"=?"},this.template=o,this.link=(e,t)=>{const n=e.$watch("targetContent.contentHandler",t=>{null!=t&&(e.$emit("click-to-invoke-child-directive-init"),n())});!e.targetContent&&e.content&&e.content.contentDetail&&(e.targetContent=e.content.getLinkContentSource(),e.targetContent.$then(()=>{e.content.description=e.targetContent.description})),e.ariaDescribedBy="content-item-icon-"+e.content.id,e.content.ui.hasIndicator&&(e.ariaDescribedBy+=" activity-indicator-"+e.content.id),a.ContentHelper.isNotAccessibleButVisibleForcedSequenceItem(e.content)?(e.aria=!0,e.tabbable=!0):(e.aria=!1,e.tabbable=!1)}}}c.$inject=[i.m.serviceName],s.module(r,[]).directive("bbCourseLinkItem",["$injector",e=>e.instantiate(c)])},UODz:function(e,t){e.exports='<div class="submission-card" ng-class="{\'is-late\': isLate, \'inline\': inline}" bb-load-bundle="components/directives/submission-card">\n  <div class="panel" ng-class="{\'clickable-panel\': clickable}">\n    <bb-ui-icon-large-assignments class="submission-card__icon" ng-if="!inline" color="{{::submissionCard.showLateIcon ? \'error\' : \'inherit\'}}"></bb-ui-icon-large-assignments>\n    <div class="info" ng-class="{\'completed\': submissionCard.attempt.isCompleted(), \'rubric-icon-spacing\': submissionCard.shouldExpandForRubricIcon()}">\n      <span class="name ellipsis" bb-translate ng-if="!inline">{{title}}</span>\n      <span class="detail">\n        <span class="test-status ellipsis" ng-show="!!status">\n          <span class="inline-status" ng-if="inline && !hasAttempt && showLate" bb-translate>\n            components.directives.submission-card.outlineStatus.late\n          </span>\n          <span class="inline-status" ng-if="inline && !hasAttempt && !showLate" bb-translate>\n            components.directives.submission-card.outlineStatus.new\n          </span>\n          <span ng-if="inline && !hasAttempt"> - </span>\n          <span bb-translate class="status">{{status}}</span>\n          <ng-switch on="submissionCard.attempt.status" ng-if="submissionCard.attempt">\n            <bb-datetime class="date" format="Short" ng-switch-when="COMPLETED" value="::submissionCard.attempt.attemptLastGradedDate"></bb-datetime>\n            <bb-datetime class="date" format="Short" ng-switch-default value="::submissionCard.attempt.attemptDate"></bb-datetime>\n          </ng-switch>\n          <bb-datetime class="date" format="Short" ng-if="!submissionCard.attempt && gradingColumn.dueDate" value="::gradingColumn.dueDate"></bb-datetime>\n        </span>\n      </span>\n    </div>\n    <div class="grade-container">\n      <ng-switch on="gradeDetail.isPosted()">\n        <bb-display-grade ng-switch-when="true"\n                          grade-detail="gradeDetail"\n                          column="gradingColumn"\n                          display-type="GradeColor"\n                          show-rubric-button="showRubricButton()"\n                          show-rubric-div="showRubricDiv()"></bb-display-grade>\n        <bb-display-grade ng-switch-default\n                          attempt="submissionCard.attempt"\n                          display-type="AttemptStatus"></bb-display-grade>\n      </ng-switch>\n    </div>\n  </div>\n</div>\n'},UeHE:function(e,t){e.exports='<div ng-if="addContentButton.isCloudServiceAvailable">\n  <bb-file-upload\n    allow-multiple="true"\n    monitor-leave="true"\n    target-div="{{\'#\' + fileListViewId}}"\n    hide-transclude-during-upload="false"\n    click-enabled="false"\n    primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n    skip-zip-file-check="true"\n    disable-drag="true"\n    is-third-party-upload="true"\n    third-party-download-handler="addContentButton.downloadFile"\n    ignored-states="::ignoredStates()">\n    <button ng-click="addContentButton.assignPosition()"\n            class="doc-add-media clear ng-scope"\n            bb-cloud-storage-integration\n            primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n            attach-handler="addContentButton.cloudUploadAttachHandler"\n            web-location="{{webLocation}}"\n            file-location="{{fileLocation}}"\n            allow-multiple="true"\n            on-files-selected="addContentButton.onFilesSelectedHandler"\n            analytics-id="components.directives.add-content-button.cloud-upload.button">\n      <div class="import-action-header">\n        <i class="icon-cloud add-content-cloud-upload-icon"></i>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n        <div class="action-details" bb-translate="components.directives.add-content-button.importContentFromCloudStorage.description"></div>\n      </div>\n    </button>\n  </bb-file-upload>\n</div>\n'},Ui4O:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell"\n  ng-click="gradeGridColumnReborn.enterEditor($event)"\n  analytics-id="components.directives.grade.grid.gradeGridColumnReborn.enterEdit"\n>\n  <div class="score hide" aria-label="{{gradeGridColumnReborn.ariaLabelContent}}">\n    <div id="displayedScore" class="hide">\n      <span id="display" class="hide"></span>\n      <span id="posted"  class="grade-posted-symbol hide" bb-translate>components.directives.grade.grid.postedLabel</span>\n      <span id="pastDueZero" class="past-due-zero-symbol hide" bb-translate>components.directives.grade.grid.pastDueZero</span>\n      <span id="slash" class="slash hide"></span>\n      <span id="pointsPossible" class="pointsPossible hide"></span>\n    </div>\n\n    <div id="gradeNow" class="hide" aria-label="{{gradeGridColumnReborn.ariaLabelContent}}">\n      <a href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.gradeNow"\n         bb-translate>components.directives.grade.grid.gradeNow</a>\n    </div>\n\n    <div id="newSubmission" class="hide">\n      <span class="new-submission" bb-translate>components.directives.grade.grid.newSubmissionLabel</span>\n    </div>\n\n    <span id="blank" class="sr-only">\n        {{gradeGridColumnReborn.ariaLabelContent}}\n    </span>\n  </div>\n  <div id="group" class="group-label" ng-if="!gradeGridColumnReborn.isRestrictedGroupContent">{{gradeGridColumnReborn.group.groupTitle}}</div>\n  <div id="ungraded" class="ungraded hide">\n    <span class="ellipse">{{gradeGridColumnReborn.ungraded}}</span>\n  </div>\n  <div class="anonymous hide">\n    <button\n      bb-tooltip\n      enhanced-tooltip="true"\n      tooltip-position="bottom-center"\n      class="anonymous-button"\n      analytics-id="components.directives.grade.grid.anonymous.button"\n      bb-translate-attrs="{ title: \'components.directives.grade.grid.anonymous.tooltip\' }">\n      <span bb-translate>components.directives.grade.grid.anonymous.label</span>\n    </button>\n  </div>\n</div>\n'},UsDD:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("fewm");const o="ultra.components.directives.bbUiIcon.large.Rubric";Object(s.a)(i.a,o,"bbUiIconLargeRubric")},UyCM:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-messages",use:"icon-small-messages-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-messages"><path d="M1 3h14v10H1V3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 3l7 7 7-7M1 13l5-5M15 13l-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},VCKY:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-add",use:"icon-small-add-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add"><path d="M1 8c0-3.866 3.134-7 7-7v0c3.866 0 7 3.134 7 7v0c0 3.866-3.134 7-7 7v0c-3.866 0-7-3.134-7-7v0zM11 8H5M8 5v6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},VUvS:function(e,t){e.exports='<div bb-load-bundle="components/directives/content/learning-module/learning-module-base-item" class="base-content-item bb-lm-base-item"\n  bb-cache-compilation="lm-base-item" role="region" aria-labelledby="::learning-module-title-{{content.id}}">\n  <div class="content-item-base-container guidance-overflow-fix js-content-item-base" ng-paste="$event.stopPropagation()">\n    <div ng-switch on="content.ui.importPlaceholder">\n      \x3c!-- Import placeholder  --\x3e\n      <div ng-switch-when="true" class="placeholder-container" bb-focus>\n        <div class="placeholder-text" bb-translate>components.directives.content-item-base.copy-placeholder</div>\n        <div class="sr-only" bb-translate>components.directives.content-item-base.please-wait</div>\n      </div>\n\n      \x3c!-- Non-imported content --\x3e\n      <div ng-switch-default class="drag-element-row" ng-class="{\'is-restricted\': content.canEdit() && content.isHiddenFromStudents(), \'isNotClickable\': content.isConditionalReleaseLocked() || content.isRestricted() && !content.canEdit()}">\n        <div class="content-item-row">\n          <div class="content-item-details" ng-class="{\'is-uploading\':content.ui.isUploading}">\n            <div class="element-card outline-item">\n\n              <ng-switch on="content.ui.isUploading">\n                \x3c!-- Uploading section begin --\x3e\n\n                <div ng-switch-when="true" class="upload-file">\n                  <bb-progress displayResults="false" id="{{content.ui.fileUploadId}}" class="bb-progress"></bb-progress>\n                </div>\n                \x3c!-- Uploading section end --\x3e\n\n                <div class="outline-item-inner" ng-switch-default>\n\n                  <div class="lm-header-section">\n                    \x3c!-- Learning Module title --\x3e\n                    <div class="lm-header-row"\n                         ng-class="{\'lm-header-row-with-icon\': baseItem.shouldShowReviewStateIcon()}"\n                         bb-click-to-invoke-child=".list-tree-toggle button">\n                      \x3c!-- Header row section --\x3e\n                      <div class="lm-title-container">\n                        <div class="title-container">\n                          \x3c!-- Conditional release section begin --\x3e\n                          <bb-review-state-icon\n                            ng-if="::baseItem.shouldShowReviewStateIcon()"\n                            content-id="content.id"\n                            course-id="content.courseId"\n                            has-automatic-review-state-transition="!content.canUpdateReviewState()"\n                            before-item-state="baseItem.getNeighborReviewState()"\n                            after-item-state="baseItem.getNeighborReviewState()"\n                          ></bb-review-state-icon>\n                          \x3c!-- Conditional release section end --\x3e\n\n                          \x3c!-- Attach event only at Instructor View --\x3e\n                          <div ng-if="::content.canEdit()" class="lm-title-instructor">\n                            <button class="lm-title secondary-title ellipse"\n                              tabindex="0"\n                              bb-translate-attrs="{\'aria-label\': \'components.directives.learning-module.aria-label.toggleLM\'}"\n                              translate-attrs-values="{learningModuleName: content.title}"\n                              aria-expanded="{{isOpen}}"\n                              id="{{::\'learning-module-title-\' + content.id}}"\n                              ng-click="baseItem.toggleLM()"\n                              analytics-id="course.learning.module.base.item.toggleLm.button"\n                              aria-controls="{{::\'learning-module-contents-\' + content.id}}">\n                              {{content.title}}\n                            </button>\n                          </div>\n\n                          \x3c!-- Just display title at Student View --\x3e\n                          <div class="lm-title-student" ng-if="::(!content.canEdit())">\n                            <button class="lm-title secondary-title ellipse"\n                                tabindex="0"\n                                bb-translate-attrs="{\'aria-label\': \'components.directives.learning-module.aria-label.toggleLM\'}"\n                                translate-attrs-values="{learningModuleName: content.title}"\n                                aria-expanded="{{isOpen}}"\n                                ng-click="!content.isConditionalReleaseLocked() && baseItem.toggleLM()"\n                                id="{{::\'learning-module-title-\' + content.id}}"\n                                analytics-id="course.learning.module.base.item.toggleLm.button"\n                                aria-controls="{{::\'learning-module-contents-\' + content.id}}">\n                              {{::content.title}}\n                            </button>\n                            <div ng-if="content.isConditionalReleaseLocked()"\n                              role="tooltip"\n                              tabindex="0"\n                              class="lock-info"\n                              bb-complex-tooltip\n                              enhanced-tooltip="true"\n                              tooltip-position="bottom"\n                              tooltip-open-on-activation="true"\n                              tooltip-disable-on-mouse-over="true"\n                              tooltip-scope="baseItem.conditionalRelease.tooltipScope"\n                              tooltip-template="{{::baseItem.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n                              <span bb-translate>components.directives.content-item-base.conditionalRelease.lock-info</span>\n                              <span class="sr-only">{{baseItem.conditionalRelease.tooltips}}</span>\n                            </div>\n                          </div>\n                        </div>\n\n                        \x3c!-- Learning Module visibility selector  --\x3e\n                        <div class="lm-visibility-selector" ng-if="content.canEdit() || (baseItem.isCourseCompletedAndInInstructorView() && content.isConditionalRelease())">\n                          <bb-content-visibility-selector\n                            ng-if="::content.canEdit()"\n                            content="content"\n                            is-visibility-selector-enabled="true"\n                            onchange-func="baseItem.onChangeVisibility()"\n                            open-panel-on-restricted="true"\n                            disable-restricted="false"\n                            enable-conditional-release="true">\n                          </bb-content-visibility-selector>\n                          <div class="rules" ng-if="(content.canEdit() || baseItem.isCourseCompletedAndInInstructorView()) && content.isConditionalRelease()">\n                            <a href="javascript:void(0);"\n                              ng-click="baseItem.canOpenConditionalRelease && baseItem.openConditionalRelease()"\n                              bb-complex-tooltip\n                              enhanced-tooltip="true"\n                              tooltip-position="bottom"\n                              tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n                              tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n                              tooltip-auto-update="true"\n                              tooltip-scope="baseItem.conditionalRelease.tooltipScope"\n                              tooltip-template="{{::baseItem.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n                              analytics-id="components.directives.content-item-base.conditionalRelease.link">\n                              <span>{{baseItem.conditionalRelease.getConditionDescription()}}</span>\n                              <span class="sr-only">{{baseItem.conditionalRelease.tooltips}}</span>\n                            </a>\n                          </div>\n                        </div>\n                        <div ng-if="content.isForcedSequenceModule() && content.canEdit()"\n                          class="lm-instructor-note"\n                          bb-translate\n                        >\n                          components.directives.learning-module.base-item.forced-sequence.instructor-note\n                        </div>\n                        \x3c!-- Learning Module control section begin --\x3e\n\n                        \x3c!-- for student --\x3e\n                        \x3c!-- <div ng-if="::(!content.canEdit())">\n                          <span class="lm-counting">{{baseItem.completed}} / {{baseItem.count}}</span>\n                        </div> --\x3e\n\n                        \x3c!-- for instructor --\x3e\n                        <div ng-if="::(content.canEdit() && canMove)" class="lm-drag-button">\n                          <button bb-drag-handle drag-item-id="{{content.id}}"\n                                  drag-item-name="{{content.title}}"\n                                  drag-item-type="{{content.contentHandler}}"\n                                  drag-item-context="{{contextArea}}"\n                                  class="super-clear small button icon js-drag-handle"\n                                  translate-attrs-values="{contentTitle: content.title}"\n                                  bb-translate-attrs="{\'title\': \'components.directives.content-item-base.move\', \'aria-label\': \'components.directives.content-item-base.aria-label.move\'}"\n                                  analytics-id="course.learning.module.base.item.move.button">\n                            <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n                          </button>\n                        </div>\n                        <div bb-foundation-defer>\n                          <bb-overflow-menu ng-if="::(content.canDelete() || content.canEdit() || content.hasConversation() && !content.isConditionalReleaseLocked())"\n                                            element-id="{{::(\'learning-module\' + baseItem.controlId)}}"\n                                            element-name="{{content.title}}"\n                                            menu-items="baseItem.getOverflowMenu()"\n                                            analytics-id-tag-prefix="components.directives.learning-module.base-item.overflowMenu">\n                          </bb-overflow-menu>\n                        </div>\n                      </div>\n\n                      \x3c!-- Learning Module description section begin --\x3e\n                      <div class="lm-description">\n                        <div class="description-show-text-container" ng-if="content.description">\n                          <p class="description-show-text">\n                            {{content.description}}\n                          </p>\n                        </div>\n                      </div>\n\n                      \x3c!-- Learning Module control section end --\x3e\n                      <div class="list-tree-toggle" ng-if="::(content.canEdit() || !content.isRestricted())">\n                        <button class="button super-clear" ng-click="baseItem.toggleLM()" aria-controls="{{::\'learning-module-contents-\' + content.id}}"\n                          aria-expanded="{{isOpen}}"\n                          bb-translate-attrs="{title: isOpen ? \'components.directives.learning-module.base-item.collapse\' : \'components.directives.learning-module.base-item.expand\'}"\n                          translate-attrs-values="{learningModuleName: content.title}"\n                          analytics-id="course.learning.module.base.item.toggleLm.button"\n                          >\n                          <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <bb-forced-sequence-warning-banner ng-if="baseItem.shouldShowForcedSequenceWarningBanner()"></bb-forced-sequence-warning-banner>\n\n                    \x3c!-- Learning Module title section end --\x3e\n                  </div>\n                </div>\n              </ng-switch>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},WAgA:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.wrongDelimiter.title\'}" \n    modal-title-key="course.grades.grades-upload-settings.wrongFormat.title" aria-describedby="wrong-format-content"\n    analytics-id-tag-prefix="course.grades.gradesUploadSettingsWrongFormat">\n    <div name="modal-contents">\n        <p id="wrong-format-content" bb-translate="course.grades.grades-upload-settings.wrongFormat.content"></p>\n    </div>\n    <a name="modal-footer-help-link" \n       href="" \n       bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkUpload\'}" \n       target="_blank" \n       bb-translate="course.grades.grades-upload-settings.helpButton" \n       rel="noopener noreferrer"\n       analytics-id="course.grades.grades-upload-settings.helpButton">\n    </a>\n    <button name="modal-footer-button-primary" \n            class="button js-discard-changes js-primary-button" \n            ng-click="$dismiss()"\n            analytics-id="course.grades.gradesUploadSettingsWrongFormat.closeButton.button">\n        <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n    </button>\n</bb-modal>'},WSu0:function(e,t,n){"use strict";var s=n("aY38");function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(s(e.split(".")[n]))}catch(e){throw new i("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=i},Wqh6:function(e,t){e.exports='<div class="panel-wrap telemetry-panel">\n  <bb-telemetry-panel-header title="{{header}}"\n                           course="course"\n                           panel-data-loaded="true">\n  </bb-telemetry-panel-header>\n\n  <nav class="group-selector" ng-class="{\'horizontal-scroll\': discussionInsights.hasNavScrollbar()}" ng-if="isGroupDiscussion">\n    <ul class="group-list">\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.overall-link"\n          tabindex="0">\n        <a href="javascript:void(0);"\n           class="overall-link selected"\n           ng-click="discussionInsights.updateDfiPanel($event)"\n           bb-translate="components.directives.discussion.insights.overall"\n           analytics-id="components.directives.discussion.insights.overall">\n        </a>\n      </li>\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.group-menu-link"\n          tabindex="0"\n          ng-repeat="group in ::groups">\n        <a href="javascript:void(0);"\n           class="group-menu-link"\n           ng-click="discussionInsights.updateDfiPanel($event, group.id, group.name)"\n           analytics-id="components.directives.discussion.insights.group.link">\n          {{group.name}}\n        </a>\n      </li>\n    </ul>\n  </nav>\n\n  <section id="discussion-insights" class="panel-content discussion-insights" bb-foundation-defer>\n    <div class="insights">\n      <div class="insight-summary row collapse summary-box">\n        <div class="column small-12">\n          <bb-statistics\n            config="statisticsConfig"\n            ng-if="isLoaded"\n            small-per-row="1"\n            large-per-row="4"></bb-statistics>\n        </div>\n      </div>\n\n      <div class="participation-chart-container">\n        <div class="bar-chart">\n          <span class="participated"\n                aria-label="{{barchartParticipants}}"\n                title="{{barchartParticipants}}"></span>\n          <span class="opened"\n                aria-label="{{barchartOpenedNonParticipants}}"\n                title="{{barchartOpenedNonParticipants}}"></span>\n          <span class="unopened"\n                aria-label="{{barchartNonParticipants}}"\n                title="{{barchartNonParticipants}}"></span>\n        </div>\n        <div class="legend">\n          <div class="participatedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentParticipatedCaption)"></div>\n          <div class="openedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentOpenedCaption)"></div>\n        </div>\n      </div>\n\n      <div class="non-participant-groups row" ng-if="displayNonParticipantGroups">\n        <div class="column small-12 non-participant-box clearfix" bb-foundation-defer>\n          <h3 class="stat-title"\n              bb-translate="components.directives.discussion.insights.groupNonParticipants"\n              translate-values="{count: totalNonParticipants}"></h3>\n          <div class="float-right">\n            <bb-overflow-menu class="ddm-nonparticipant-options"\n                              element-id="ddm-nonparticipant-options"\n                              element-name={{nonParticipantsOptions}}\n                              on-menu-toggle="discussionInsights.updateMessagesCount()"\n                              menu-items="discussionInsights.getOverflowMenu()"\n                              analytics-id-tag-prefix="components.directives.discussion.insights.nonParticipantsGroups.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n\n          <div class="group-nonparticipants" ng-repeat="nonParticipantGroup in nonParticipantGroups track by nonParticipantGroup.id">\n            <div class="group-heading child-is-invokable" bb-click-to-invoke-child="a.group-link">\n              <a class="group-link"\n                 href="javascript:void(0);"\n                 ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 analytics-id="components.directives.discussion.insights.nonParticipantGroup.link">\n                {{nonParticipantGroup.name}}\n              </a>\n            </div>\n            <div class="nonparticipant-in-group-container"\n                 ng-class="nonParticipantGroup.total > 3 ? \'space-evenly\' : \'set-margin\' ">\n              <div class="nonparticipant-in-group child-is-invokable"\n                   bb-click-to-invoke-child="a.group-non-participant-link"\n                   ng-repeat="nonParticipant in nonParticipantGroup.nonParticipants | limitTo: 4 track by nonParticipant.id">\n                <bb-avatar user="nonParticipant"></bb-avatar>\n                <a class="group-non-participant-link"\n                   href="javascript:void(0);"\n                   aria-label="{{nonParticipant.localizedName}}"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipant.link">\n                  {{nonParticipant.localizedName}}\n                </a>\n              </div>\n            </div>\n            <div class="count-link">\n              <a ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 ng-show="nonParticipantGroup.hidden > 0"\n                 href="javascript:void(0);"\n                 bb-translate="components.directives.discussion.insights.moreLink"\n                 translate-values="{count: nonParticipantGroup.hidden}"\n                 analytics-id="components.directives.discussion.insights.moreLink">\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="non-participants row" ng-show="(displayNonParticipants || displayNonParticipantGroup)">\n        <div class="column small-12 non-participant-box clearfix" ng-if="showLargeNonparticipantPanel" bb-foundation-defer>\n          <h3 class="stat-title" bb-translate="components.directives.discussion.insights.nonParticipants"></h3>\n          <div class="float-right">\n            <bb-overflow-menu class="ddm-nonparticipant-options"\n                              element-id="ddm-nonparticipant-options"\n                              element-name={{nonParticipantsOptions}}\n                              on-menu-toggle="discussionInsights.updateMessagesCount()"\n                              menu-items="discussionInsights.getOverflowMenu()"\n                              analytics-id-tag-prefix="components.directives.discussion.insights.nonParticipants.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n          <ul class="non-participant-list clearfix">\n            <li class="non-participant child-is-invokable"\n                bb-click-to-invoke-child="a.non-participant-link"\n                tabindex="-1"\n                ng-show="showNonparticipant[$index]"\n                ng-repeat="nonParticipant in nonParticipants | limitTo: 18 track by nonParticipant.id">\n              <div class="non-participant-cell"\n                   ng-class="{\'show-focus-outline\': discussionInsights.isFocusedNonparticipant(nonParticipant.id)}">\n                <a class="non-participant-link hide-focus-outline"\n                   bb-translate-attrs="{\'aria-label\':\'{{nonParticipant.localizedNameWithoutWrap}}\'}"\n                   id="non-participant-link-{{nonParticipant.id}}"\n                   tabindex="0"\n                   href="javascript:void(0);"\n                   ng-focus="true"\n                   ng-blur="true"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipantLink.link">\n                  <bb-avatar class="non-participant-avatar" user="nonParticipant.avatarData"></bb-avatar>\n                </a>\n                <span class="byline stacked" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.localizedName)"></span>\n              </div>\n            </li>\n          </ul>\n          <label class="summary-line">{{nonParticipationSummary}}</label>\n        </div>\n        <div class="column small-12 non-participant-box clearfix" ng-if="!showLargeNonparticipantPanel">\n          <h3 class="stat-title subheader">{{barchartNonParticipants}}</h3>\n          <button class="messageAllButton button"\n                  bb-translate="components.directives.discussion.insights.messageAll"\n                  bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageAll\'}"\n                  ng-click="discussionInsights.goToMessageAll()"\n                  analytics-id="components.directives.discussion.insights.messageAll">\n            </button>\n        </div>\n      </div>\n\n      <div class="row equal-height" ng-if="displayTopComments || displayTopParticipants">\n        <div class="top-comments column {{topCommentsColumns}} student-list-box" ng-if="displayTopComments">\n          <h3 class="stat-title subheader"\n              id="most-replies-heading"\n              bb-translate="components.directives.discussion.insights.mostReplies"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-comment-row child-is-invokable"\n                 bb-click-to-invoke-child="a.discussion-link"\n                 ng-class="{\'last\':$last}"\n                 ng-repeat="comment in topComments | limitTo: numberOfCommentsToDisplay | orderBy: \'-numReplies\'">\n              <a href="javascript:void(0);"\n                 class="discussion-link"\n                 ng-click="discussionInsights.goToDiscussion(comment.user.group.id)"\n                 aria-labelledby="comment-user-{{comment.user.id}} most-replies-heading"\n                 aria-describedby="comment-message-{{comment.user.id}}\n                 comment-replies-{{comment.user.id}}"\n                 analytics-id="components.directives.discussion.insights.goToDiscussion.link">\n                <bb-avatar class="top-participant-avatar" user="comment.user.avatarData"></bb-avatar>\n                <div class="comment-info">\n                  <div class="comment-message ellipsis" id="comment-message-{{comment.user.id}}">{{comment.message}}</div>\n                  <div class="byline ellipsis">\n                    <span id="comment-user-{{comment.user.id}}">\n                      <bb-translate>components.directives.discussion.insights.by</bb-translate> {{comment.user.localizedName}}\n                      <span ng-show="isGroupDiscussion"><bb-translate>components.directives.discussion.insights.inGroup</bb-translate> {{comment.user.group.name}}</span>\n                    </span> |\n                    <span id="comment-replies-{{comment.user.id}}"> {{comment.numReplies}} <bb-translate>components.directives.discussion.insights.replies</bb-translate></span>\n                  </div>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n        <div class="top-participants column {{topParticipantColumns}} student-list-box" ng-if="displayTopParticipants">\n          <h3 id="top-heading" class="stat-title subheader" bb-translate="components.directives.discussion.insights.topParticipants"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-participants-row child-is-invokable"\n                 bb-click-to-invoke-child="a.grading-panel-link"\n                 ng-class="{\'last\':$last, \'not-graded\': (!isGradable || isGroupDiscussion), \'group-row\':isGroupDiscussion}"\n                 ng-repeat="participant in topParticipants | limitTo: numberOfCommentsToDisplay | orderBy: \'-numComments\'">\n              <a href="javascript:void(0);"\n                 class="grading-panel-link"\n                 aria-labelledby="user-{{participant.user.id}} top-heading"\n                 aria-describedby="span-replies-{{participant.user.id}} span-feedback-{{participant.user.id}}"\n                 ng-class="{\'not-graded\': (!isGradable || isGroupDiscussion)}"\n                 ng-click="discussionInsights.goToGrade(participant.user.id)"\n                 analytics-id="components.directives.discussion.insights.goToGrade.link">\n                <bb-avatar class="comment-avatar" user="participant.user.avatarData"></bb-avatar>\n                <div class="top-participant-info ellipsis" ng-class="{\'not-graded\': !isGradable}">\n                  <span class="discussion-insights-heading" id="user-{{participant.user.id}}">{{participant.user.localizedName}}</span><br>\n                  <span class="ellipsis" ng-show="isGroupDiscussion">{{participant.user.group.name}}</span><br ng-show="isGroupDiscussion">\n                  <span class="byline" id="span-feedback-{{participant.user.id}}">\n                    <bb-svg-icon class="top-participant-icon" size="small" icon="feedback" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.feedback\'}"></bb-svg-icon>\n                    {{participant.numComments}}\n                  </span>\n                  <span class="byline" id="span-replies-{{participant.user.id}}">\n                  <bb-svg-icon class="top-participant-icon" size="small" icon="replies" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.replies\'}"></bb-svg-icon>\n                    {{participant.numReplies}}\n                  </span>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ui-view="telemetry-discussion-forum-insights-base@"></div>\n  </section>\n</div>\n'},X6r5:function(e,t,n){"use strict";var s=n("D57K"),i=(n("smDF"),n("dV61"),n("Ybms"),n("nsO7")),o=n("Sa5G"),a=n("jhBu"),r=n("8W6D"),c=n("pjml"),l=n("0JpG"),d=n("TnpK"),u=n("gkef"),h=n("5KgE"),p=n("p7NW"),m=n("g66W"),b=n("zGdY"),g=n("aHpC"),v=n("UsDD"),f=n("GGpz"),C=n("ZQFV"),y=n("yC9S"),w=n("2tKw");n.d(t,"a",(function(){return S}));const S="ultra.components.directives.rubric.rubricList";let I=class{constructor(e,t,n,s,i,o,a,r,c,l){this.element=e,this.$rootScope=t,this.$scope=n,this.CourseModel=s,this.bbLocalize=i,this.ultraState=o,this.windowSize=a,this.entitlements=r,this.firstTimeHelper=c,this._rubricService=l,this.enableRubricAssociation=!1,this.editable=!1,this.hasViewAccess=!1,this.showCompleteDescription=!1,this.rubricIdList=[],this.contextArea="rubrics",this.shouldShowNewBadge=!1,n.rubricList=this}$onInit(){const e={sort:"title(asc)",limit:1e3,expand:"columnHeaders,rows"};this.CourseModel.$new(this.course.id).rubrics.$fetch(e).$allow(["403"]).$asPromise().then(e=>this.handleRubricResponse(e)),this.destroyRubricSaveListener=this.$rootScope.$on("rubric-save",(t,n)=>{this.course.rubrics.$refresh(e).$allow(["403"]).$asPromise().then(e=>this.handleRubricResponse(e))}),this.entitlements.hasCourseEntitlement(o.k.ViewRubrics,this.course.id).then(e=>{this.hasViewAccess=e}),this.setShouldShowBadge()}handleRubricResponse(e){403!==e.$response.status&&(this.rubrics=e)}$onDestroy(){if(this.destroyRubricSaveListener(),this.shouldShowNewBadge){const e=Object(m.a)("NEW_BADGE_COMPONENT_KEY",h.a);this.firstTimeHelper.hide(e)}}getOverflowMenuItems(e){return[{icon:"duplicate",labelKey:"components.directives.rubric.list.tooltip.duplicate",show:()=>e.permissions&&e.permissions.edit&&!this.windowSize.isSmallBreakpoint(),onClick:this.copyRubric.bind(this,e),ariaLabel:()=>this.bbLocalize.translateSync({locale:this.course.getLocale()||this.bbLocalize.getAppLocale(),key:"components.directives.rubric.list.copyRubric",params:{title:e.title},noWrap:!0})}]}getDeleteMenuOption(e){const t=(e.readOnly||e.associated)&&e.canDelete(),n=t?"components.directives.rubric.list.deleteInUseRubric.title":"components.directives.rubric.list.deleteRubric.title",s=t?"components.directives.rubric.list.deleteInUseRubric.instructions":"components.directives.rubric.list.deleteRubric.instructions",i=t?"components.directives.rubric.list.deleteInUseRubric.label":"components.directives.rubric.list.deleteRubric.label";return{show:()=>e.canDelete(),onClick:this.deleteRubric.bind(this,e,t),confirmationOptions:{titleKey:n,instructionsKey:s},ariaLabel:()=>this.bbLocalize.translateSync({locale:this.course.getLocale()||this.bbLocalize.getAppLocale(),key:i,params:{title:e.title},noWrap:!0})}}setShouldShowBadge(){const e=this.element.closest(".bb-offcanvas-panel").attr("data-base-state-name"),t=Object(m.a)("NEW_BADGE_COMPONENT_KEY",h.a);this.firstTimeHelper.shouldShow(t,e,!1).then(e=>{this.shouldShowNewBadge=e})}pointsCheckboxTrigger(e,t){t?this.rubricIdList.push(e):this.rubricIdList.splice(this.rubricIdList.indexOf(e),1)}associateRubric(e){if(this.rubricAssociationHandler&&this.rubricIdList.includes(e.id)){const t=this.getPointsRubricMaxScore(e),n=Math.min(C.Utils.GRADE_MAX_POINTS,t);this.rubricAssociationHandler({rubric:e,maxPoints:n})}else this.rubricAssociationHandler&&this.rubricAssociationHandler({rubric:e})}toggleDescription(){this.showCompleteDescription=!this.showCompleteDescription}getPointsRubricMaxScore(e){if(null==e.rows||this._rubricService.isPercentageOrPercentageRangeRubric(e))return 0;const t=e.rubricType===b.RubricType.POINTS?b.RubricType.POINTS:b.RubricType.POINTS_RANGE;e.rows.forEach((e,n)=>{this.setMaxRowPoints(e,t)});const n=e.rows.filter(e=>i.isFinite(e.rowPoints)).reduce((e,t)=>e+t.rowPoints,0);return parseFloat(C.Utils.parseGradeValue(n))}setMaxRowPoints(e,t){if(i.isFinite(e.rowPoints)||null==e.cells)return;let n=0;e.cells.forEach(e=>{const s=t===b.RubricType.POINTS?e.numericPoints:e.endPointRange;void 0!==s&&!Number.isNaN(s)&&s>n&&(n=s)}),e.rowPoints=n}copyRubric(e){this.ultraState.goPeekState("rubric.mode",{rubricId:e.id,mode:r.a.COPY.toString()})}deleteRubric(e,t){t?e.withParams({cascade:!0}).$destroy():e.$destroy()}};I=Object(s.__decorate)([Object(y.a)({moduleName:S,componentName:"bbRubricList",template:w,bindings:{course:"<",enableRubricAssociation:"<?",rubricAssociationHandler:"&?",editable:"<?"},requireModules:[d.b,u.a,v.a,f.a,p.f]}),Object(s.__param)(0,Object(g.b)("$element")),Object(s.__param)(1,Object(g.b)("$rootScope")),Object(s.__param)(2,Object(g.b)("$scope")),Object(s.__param)(3,Object(g.b)(c.m.serviceName)),Object(s.__param)(4,Object(g.b)(l.serviceName)),Object(s.__param)(5,Object(g.b)(d.d)),Object(s.__param)(6,Object(g.b)(u.b)),Object(s.__param)(7,Object(g.b)(a.b)),Object(s.__param)(8,Object(g.b)(h.c)),Object(s.__param)(9,Object(g.b)(p.g))],I)},X8JP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var s=n("Vsv2"),i=n("pjml");const o="ultraUi.components.services.cloudDrive.rteCloudStorageIntegrationModal",a="RteCloudStorageIntegrationService",r=e=>e.account+"|"+e.id;class c{constructor(e,t,n){this.$q=e,this.cloudDriveService=t,this.CloudDriveModel=n}initialize(){return this.cloudDriveService.isCloudServiceAvailable().then(e=>this.isCloudServiceAvailable=e)}openFilePicker(e){return this.cloudDriveService.cloudDriveStorage.openFilePicker(e,!0).then(e=>{if(e){const t=[];return e.forEach(n=>{const s=r(n),i=this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(s).$fetch({accessToken:e[0].bearer_token.key}).$asPromise();t.push(i)}),this.$q.all(t).then(t=>t.map(t=>({id:t.id,cloudStorageIntegrationAccessToken:e[0].bearer_token.key,name:t.name,size:t.size,type:t.type,updatedTime:t.updatedTime,webLocation:t.webLocation})))}return this.$q.reject()})}getModalCallback(e){return()=>this.cloudDriveService.cloudDriveStorage?this.openFilePicker(e):this.cloudDriveService.initializeCloudDrive().then(()=>this.openFilePicker(e))}}c.$inject=["$q",s.b,i.h.serviceName],angular.module(o,[s.a]).service(a,c)},XPgl:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-arrow-down",use:"icon-small-arrow-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-arrow-down"><path d="M1 4l7 7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},XSys:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-accommodations",use:"icon-small-accommodations-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-accommodations"><path d="M2 1h12v14l-6-2-6 2V1zM5 4h6M5 7h6M5 10h6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},YHe3:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return w}));var s=n("D57K"),i=n("Llzl"),o=n("pjml"),a=n("TnpK"),r=n("Q/M7"),c=n("12mu"),l=n("0JpG"),d=n("nYZ0"),u=n("Qbdf"),h=n("vhkR"),p=n("zJP2"),m=n("JfV0"),b=n("zGdY"),g=n("CY5M"),v=n("nmzr"),f=n("DU7P"),C=n("aHpC");n("TuNX");const y="ultra.components.services.proctoring",w="proctoring",S={Respondus:"respondus"};let I=class{constructor(e,t,n,s,i,o,a,r,c,l,d,u,h){this.$q=e,this.$rootScope=t,this.$sce=n,this.$window=s,this.CourseModel=i,this.CourseContentModel=o,this.ProctoringServicesModel=a,this.modal=r,this.contentService=c,this.contextCourse=l,this.localize=d,this.ultraState=u,this.ltiService=h}getBooksAndToolsDescription(e){return"components.services.proctoring.booksAndTools."+S[e.vendor]+".description"}getProctoringServices(){const e=this.$q.defer();return this.ProctoringServicesModel.$search({"availability.available":"Yes"}).$allow(["400-599"]).$asPromise().then(t=>{t.$response&&t.$response.status>=400?e.resolve([]):e.resolve(t)},()=>e.resolve([])),e.promise}getProctoringAssessmentSettingsText(e){return"components.services.proctoring.settings."+S[e]+".toolLink"}getProctoringAssessmentSettingsRequirementsText(e){const t="components.services.proctoring.settings.";return e.getProctoringServiceHandle()&&e.isSecureBrowserRequiredToTake()?e.isWebcamRequired()?t+S[e.getProctoringServiceVendor()]+".secureBrowserAndWebcamRequired":t+S[e.getProctoringServiceVendor()]+".secureBrowserRequired":null}getProctoringOverviewBrowserText(e){return e.isSecureBrowserRequiredToTake()?"components.services.proctoring.overview."+S[e.getProctoringServiceVendor()]+".browser":null}getProctoringOverviewRequirementsText(e){const t="components.services.proctoring.overview.";return e.isSecureBrowserRequiredToTake()?e.isWebcamRequired()?t+S[e.getProctoringServiceVendor()]+".secureBrowserAndWebcamRequired":t+S[e.getProctoringServiceVendor()]+".secureBrowserRequired":null}getProctoringOverviewDownloadText(e){return e.getProctoringDownloadUrl()?"components.services.proctoring.overview."+S[e.getProctoringServiceVendor()]+".downloadBrowser":null}openProctoringLTITool(e,t){let n="/webapps/assessment/controller/proctoring/launchProctoringSettings?proctoring_svc_id="+e.id+"&course_id="+this.contextCourse.courseId;t&&(n+="&content_id="+t.id);const s={toolHref:r.c(n)};t&&t.title&&t.title.length>0&&(s.toolSubtitle=t.title),this.ultraState.goPeekState("proctoring-lti-tool",s)}getProctoringReviewButtonText(e){return"components.services.proctoring.delivery.review."+S[e]+".reviewResults"}getProctoringReviewDownloadText(e){return"components.services.proctoring.delivery.review."+S[e]+".download"}getProctoringPageRequirementsText(e){return"components.services.proctoring.page."+S[e]+".requirements"}getProctoringPageDownloadText(e){return"components.services.proctoring.page."+S[e]+".download"}getProctoringPageBrowserText(e){return"components.services.proctoring.page."+S[e]+".browser"}getSecureBbEditorOptions(e){return this.ultraState.current.name===v.BaseRoutes.BASE_PROCTORING_ATTEMPT&&(e.attachment=!1,e.image=!1,e.youtubeVideo=!1,e.video=!1,e.contentMarket=!1),e}handleProctoredAssessmentClose(e,t){if("Respondus"===e.getProctoringServiceVendor())r.p(r.c("/ultra/proctoring/close?rldbsm=1&rldbxb=1"));else if(t){const t={handle:e.getProctoringServiceHandle(),linkType:m.ContentHandler.LtiPlacement};let n=Object(g.getLaunchLinkFromLinkRef)(t);n=r.a(n,"custom_proctoring_end_assessment_return","true"),n=r.a(n,"course_id",e.courseId),n=r.a(n,"content_id",e.id),n=r.a(n,"from_ultra","true"),this.ultraState.leavePeekState().then(()=>{this.ltiService.launch(n)})}else this.ultraState.goPeekState(v.AssessmentRoutes.ASSESSMENT_OVERVIEW,{contentId:e.id})}getProctoringServiceByHandle(e){return this.$q.resolve(p.a.loadProctoringService(e))}fetchProctoringServices(){return this.$q.resolve(p.a.loadAvailableProctoringServices())}fetchProctoringServiceIntegrations(){return this.$q.resolve(p.a.loadAvailableProctoringServicesWithIntegration())}getCurrentProctoringProviderType(e){return e?e===f.b?f.a.Respondus:f.a.IMS:f.a.None}isRespondusProctoringServiceProvider(e){return this.getCurrentProctoringProviderType(e.handle)===f.a.Respondus}isIMSProctoringServiceProvider(e){return this.getCurrentProctoringProviderType(e.handle)===f.a.IMS}isProctoringServiceUnavailable(e,t){return this.isProctoringPlacementUnavailable(e,t)||this.isProctoringUEFUnavailable(e,t)}isProctoringPlacementUnavailable(e,t){return!!e&&(null==t||t.availability.available===b.PublicAvailability.No)}isProctoringUEFUnavailable(e,t){if(!!e){return!this.isRespondusProctoringServiceProvider(t)&&!this.getProctoringServiceIntegrationId(t)}return!1}getProctoringServiceIntegrationId(e){var t;if(e)return null===(t=p.a.getProctoringIntegration(e.handle))||void 0===t?void 0:t.integrationId}promptIntegrationToSave(e,t,n,s){return this.$q.resolve(p.a.promptIntegrationToSaveSettings(e,t,n,s))}openRespondusProctoringLaunchLink(t){if(e("#respondus-iframe").remove(),t.startsWith("data:text/plain,")){const e=`<iframe src="data://text/plain,${t.substring("data:text/plain,".length)}" id="respondus-iframe" style="display:none"></iframe>`;this.createRespondusIFrameAndSetLocation(e)}else this.setRespondusWindowLocation(t)}createRespondusIFrameAndSetLocation(t){document.body.appendChild(e(t)[0])}setRespondusWindowLocation(e){this.$window.location.assign(e)}};I=Object(s.__decorate)([Object(s.__param)(0,Object(C.b)("$q")),Object(s.__param)(1,Object(C.b)("$rootScope")),Object(s.__param)(2,Object(C.b)("$sce")),Object(s.__param)(3,Object(C.b)("$window")),Object(s.__param)(4,Object(C.b)(o.m.serviceName)),Object(s.__param)(5,Object(C.b)(o.p.serviceName)),Object(s.__param)(6,Object(C.b)(o.kb.serviceName)),Object(s.__param)(7,Object(C.b)(c.b)),Object(s.__param)(8,Object(C.b)(d.f)),Object(s.__param)(9,Object(C.b)(u.e)),Object(s.__param)(10,Object(C.b)(l.serviceName)),Object(s.__param)(11,Object(C.b)(a.d)),Object(s.__param)(12,Object(C.b)(h.b))],I);class O extends I{}i.module(y,["ngSanitize",d.d,l.moduleName,c.a,a.b,u.b,h.a]).service(w,I)}).call(this,n("5iHu"))},Ybms:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-duplicate",use:"icon-small-duplicate-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-duplicate"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 4h11v11H1z" /><path d="M12 12h3V1H4v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},Youf:function(e,t){e.exports='<a class="content-title"\n   aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n   ng-click="contentItemLtiLaunch.ltiLaunch()"\n   href="javascript:void(0);"\n   analytics-id="content.item.ltilaunch.link"><span>{{ content.title }}</span></a>\n<div ng-if="contentItemBase.isExcludedOrDeletedLtiToolProvider() && !contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()">\n      <span class="broken-lti-link" ng-if="!contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.excluded-lti-provider.instructor</span>\n      <span class="broken-lti-link" ng-if="contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.excluded-lti-provider.admin</span>\n</div>\n<div ng-if="contentItemBase.isUnlaunchableLtiLink() && !contentItemBase.isExcludedOrDeletedLtiToolProvider() && !contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()">\n      <span class="broken-lti-link" ng-if="!contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.deleted-placement.instructor</span>\n      <span class="broken-lti-link" ng-if="contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.deleted-placement.admin</span>\n</div>\n<span class="broken-lti-link" ng-if="contentItemBase.isUnlaunchableLtiLink() && contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()"\n      bb-translate>components.directives.content-item-base.approval-required</span>\n'},a2qY:function(e,t){e.exports='<div bb-load-bundle="components/directives/content-item-base" ng-class="::contentItemBase.getRootClassName()" bb-cache-compilation="content-item-base">\n  <div class="content-item-base-container guidance-overflow-fix js-content-item-base" bb-click-to-invoke-child=".content-title">\n    <div ng-switch on="content.ui.importPlaceholder" class="content-item-row-container">\n      <div ng-switch-when="true" class="placeholder-container" bb-focus>\n        <div class="placeholder-text" bb-translate>components.directives.content-item-base.copy-placeholder</div>\n        <div class="sr-only" bb-translate>components.directives.content-item-base.please-wait</div>\n      </div>\n      <bb-review-state-icon\n        ng-if="contentItemBase.shouldShowReviewStateIcon()"\n        content-id="content.id"\n        course-id="contentItemBase.courseId"\n        on-review-state-icon-click="contentItemBase.onReviewStateIconClick"\n        has-automatic-review-state-transition="!content.canUpdateReviewState()"\n        before-item-state="contentItemBase.getNeighborReviewState(itemBefore)"\n        after-item-state="contentItemBase.getNeighborReviewState(itemAfter)"\n      ></bb-review-state-icon>\n\n      <div ng-switch-default class="row drag-element-row" ng-class="{\n        \'is-restricted\': content.canViewAsInstructor() && content.isHiddenFromStudents(),\n        \'hidden-from-student-cr\': content.canViewAsInstructor() && content.isConditionalReleaseWithHiddenFromStudent(),\n        \'isNotClickable\': content.isConditionalReleaseLocked() || content.isRestricted() && !content.canViewAsInstructor()}">\n        <div class="content-item-row">\n          <div class="content-item-details" ng-class="{\'is-uploading\':content.ui.isUploading}">\n            <div class="element-card outline-item">\n              <ng-switch on="content.ui.isUploading">\n                <div ng-switch-when="true" class="upload-file">\n                  <bb-progress displayResults="false" id="{{content.ui.fileUploadId}}" class="bb-progress"></bb-progress>\n                </div>\n\n                <div class="outline-item-inner" ng-switch-default>\n                  <div class="element-image" ng-if="contentItemBase.isGradeLoaded" bb-content-item-icon="content" show-alert-icon="contentItemBase.shouldShowAlertIcon()">\n                  </div>\n                  <div class="element-details">\n                    <div ng-if="shouldShowContent">\n                      <bb-content-item-course-outline ng-if="!contentItemBase.isEngagementOutline()"></bb-content-item-course-outline>\n                      <bb-content-item-engagement-outline ng-if="contentItemBase.isEngagementOutline()"></bb-content-item-engagement-outline>\n                    </div>\n                    <div ng-if="!contentItemBase.shouldShowContent">\n                      {{contentItemBase.overrideMessage}}\n                    </div>\n                  </div>\n                </div>\n              </ng-switch>\n            </div>\n          </div>\n          <div ng-if="content.id" class="item-controls">\n            \x3c!-- Show this if the user has edit permissions on the content and it is movable //--\x3e\n            <button bb-drag-handle\n                    drag-item-id="{{content.id}}"\n                    drag-item-name="{{content.title}}"\n                    drag-item-type="{{contentItemBase.contentHandler}}"\n                    drag-item-context="{{contextArea}}"\n                    class="super-clear small button icon js-drag-handle"\n                    ng-if="canMove && content.canEdit()"\n                    translate-attrs-values="{contentTitle: content.title}"\n                    bb-translate-attrs="{\'title\': \'components.directives.content-item-base.move\', \'aria-label\': \'components.directives.content-item-base.aria-label.move\'}"\n                    analytics-id="content.item.base.move.button"\n                    >\n\n              <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n            </button>\n            <bb-ally-content-ref\n                ng-if="contentItemBase.canShowAlly"\n                content-id="{{content.id}}"\n                file-id="{{::contentItemBase.allyService.getXythosIdFromContentItem(content)}}"\n                file-preview-url="{{::content.getContentDisplay().contentUrl()}}"\n            ></bb-ally-content-ref>\n            <bb-ally-show\n              ng-if="contentItemBase.canShowAlly"\n              content-id="{{content.id}}"\n              show-view-score-link="true"\n              show-icon="true"\n              class="ally-icon"\n            ></bb-ally-show>\n            <bb-ally-show\n              ng-if="contentItemBase.canShowAlly"\n              content-id="{{content.id}}"\n              show-alternative-formats-link="true"\n              show-icon="true"\n              class="ally-icon"\n            ></bb-ally-show>\n            \x3c!-- Show this if the user has edit or delete permissions //--\x3e\n            <div class="right" bb-foundation-defer>\n              <bb-overflow-menu ng-show="contentItemBase.showOverflowMenu()"\n                                element-id="{{content.id}}"\n                                element-name="{{content.title}}"\n                                menu-items="contentItemBase.getOverflowMenu()"\n                                on-menu-toggle="contentItemBase.updateAlly()"\n                                analytics-id-tag-prefix="components.directives.content-item-base.overflowMenu">\n              </bb-overflow-menu>\n            </div>\n          </div>\n        </div>\n        <div ng-if="contentItemBase.getDescription()" class="content-item-description">\n          <p class="js-description" ng-bind="contentItemBase.getDescription()"></p>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},aPUy:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));const s="peer-review-assigned";function i(e,t){return e.$broadcast(s,t.listIndex,t.reviewableAttempt)}function o(e,t){return e.$on(s,t)}},aTRN:function(e,t,n){"use strict";var s=n("D57K"),i=n("pjml"),o=n("aHpC"),a=n("4GL6"),r=n("0JpG"),c=n("oi1r"),l=n("TnpK"),d=n("Qbdf"),u=n("X455"),h=n("zGdY"),p=n("JfV0"),m=n("nsO7");const b="performance",g="date";let v=class{constructor(e,t,n,s,i,o,a){this.localizeService=e,this.schemaService=t,this.courseModel=n,this.contextCourse=s,this.contextCourseMembership=i,this.scope=a,this.isPerformanceConditionInvalid=!1,this.role=Object(m.memoize)(()=>this.contextCourseMembership.courseMembership&&this.contextCourseMembership.courseMembership.isStudentMembership()?"student":"instructor"),this.courseId=s.courseId?s.courseId:o.params.courseId}getConditions(e,t,n){var s,i;this.content=e;const o=null===(s=e.adaptiveReleaseRules)||void 0===s?void 0:s.rules;if((null==o?void 0:o.length)||e.isForcedSequenceModule())if((null===(i=null==o?void 0:o[0])||void 0===i?void 0:i.criteria)&&(this.allCriteria=o[0].criteria),this.getACLCriteria()?this.setACLCondition():this.aclToolTips=null,this.getPerformanceCriteria()?this.setPerformanceCondition(t,n):this.performanceToolTips=null,this.getDateCriteria()?this.setDateCondition():this.dateToolTips=null,this.contextCourseMembership.courseMembership.isStudentMembership()&&e.isForcedSequenceItem()){const t=0===e.position?"components.directives.content-item-base.conditionalRelease.student-forced-sequence-first-item-tooltip":"components.directives.content-item-base.conditionalRelease.student-forced-sequence-item-tooltip";this.forcedSequenceTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,noWrap:!0,noEscape:!0}),this.updateTooltipScope()}else this.forcedSequenceTips=null}getConditionDescription(){const e=!!this.getACLCriteria(),t=!!this.getPerformanceCriteria(),n=!!this.getDateCriteria(),s=[[e,this.contextCourse.course.isOrganization?"organization-membership":"course-membership"],[n,g],[t,b]].filter(e=>!!e[0]).map(e=>`components.directives.content-item-base.conditionalRelease.conditionDescriptions.${e[1]}`);if(0===s.length)return;const i=this.localizeService.getLocale(this.scope),o=s.map((e,t)=>this.localizeService.translateSync({locale:i,key:`${e}${0===t?"-capitalized":""}`}));return this.localizeService.formatItemsSync(o,o.length,null,this.scope,!1,{noWrap:!0})}getPerformanceCriteria(){return this.getCriteriaByType(p.AdaptiveReleaseCriteriaType.Grade.toString())||this.getCriteriaByType(p.AdaptiveReleaseCriteriaType.GradePercentage.toString())}getDateCriteria(){return this.getCriteriaByType(p.AdaptiveReleaseCriteriaType.Date.toString())}getACLCriteria(){return this.getCriteriaByType(p.AdaptiveReleaseCriteriaType.ACL.toString())}getCriteriaByType(e){return this.allCriteria&&this.allCriteria.find(t=>t.type===e)}setPerformanceCondition(e,t){this.gradeCriteria=this.getPerformanceCriteria();let n=this.gradeCriteria&&this.gradeCriteria.minScore;const s=this.gradeCriteria&&this.gradeCriteria.maxScore,i=this.gradeCriteria&&this.gradeCriteria.gradeColumnId;let o="",a="";if(!i||t){const e=`components.directives.content-item-base.conditionalRelease.${this.role()}-missing-column-error`;return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope()}this.courseModel.$new(this.courseId||this.content.courseId).gradebook.columns.$find(i).$allow([403]).$then(t=>{if(t.$response&&403===t.$response.status)return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.student-missing-column-error",noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope();let i=`components.directives.content-item-base.conditionalRelease.${this.role()}-lock-tooltip`;i+=void 0===s?"-common":n===s?"-equal":"-custom";const r=e||t&&t.columnName;this.schemaService.loadSchemas(this.courseId).then(e=>{const c=e&&e.find(e=>e.id===t.gradingSchemaId)||{};this.gradeCriteria&&"Grade_Range"===this.gradeCriteria.type&&(void 0===s&&c.scaleType!==h.SchemaScaleType.Score&&c.scaleType!==h.SchemaScaleType.Complete||(o=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:n||0},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}),a=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:s||t.possible},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}))),this.gradeCriteria&&"Grade_Range_Percentage"===this.gradeCriteria.type&&(void 0!==s||c.scaleType===h.SchemaScaleType.Percent?(o=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:n||0},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0}),a=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:s||t.possible},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0})):c.scaleType===h.SchemaScaleType.Tabular&&(c.symbols.sort((e,t)=>e.absoluteTranslation-t.absoluteTranslation),c.symbols.forEach(e=>{e.absoluteTranslation>=n&&(n=e.symbol,o=n)}))),this.getPerformanceToolTips(i,o,a,r)})})}setDateCondition(){if(this.dateCriteria=this.getDateCriteria(),this.dateCriteria){let e=null;this.dateCriteria.start&&this.dateCriteria.end?e="both":this.dateCriteria.start?e="showon":this.dateCriteria.end&&(e="hideafter");const t=`components.directives.content-item-base.conditionalRelease.${this.role()}-${e}-date-tooltip`;this.dateToolTips=e&&this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,params:{showon:new Date(this.dateCriteria.start),hideafter:new Date(this.dateCriteria.end)},noWrap:!0,noEscape:!0}),this.updateTooltipScope()}}setACLCondition(){this.aclCriteria=this.getACLCriteria(),this.aclCriteria&&(this.aclToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.acl-tooltip",noWrap:!0,noEscape:!0}),this.updateTooltipScope())}getPerformanceToolTips(e,t,n,s,i=""){this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,params:{minScore:t,maxScore:n,title:s},noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!1,this.updateTooltipScope()}updateTooltipScope(){angular.isUndefined(this.tooltipScope)&&(this.tooltipScope=this.scope.$new(!0)),this.tooltipScope.items=[],this.aclToolTips&&this.tooltipScope.items.push(this.aclToolTips),this.performanceToolTips&&(this.tooltipScope.items.push(this.performanceToolTips),this.isPerformanceConditionInvalid)?this.tooltips=this.performanceToolTips:(this.dateToolTips&&this.tooltipScope.items.push(this.dateToolTips),this.forcedSequenceTips&&this.tooltipScope.items.push(this.forcedSequenceTips),this.tooltips=this.tooltipScope.items.join(" "))}getConditionalReleaseComplexTooltipTemplate(){return a.a("conditional-release-tooltip")}};v=Object(s.__decorate)([Object(s.__param)(0,Object(o.b)(r.serviceName)),Object(s.__param)(1,Object(o.b)(c.b)),Object(s.__param)(2,Object(o.b)(i.m.serviceName)),Object(s.__param)(3,Object(o.b)(d.e)),Object(s.__param)(4,Object(o.b)(u.d)),Object(s.__param)(5,Object(o.b)(l.d)),Object(s.__param)(6,Object(o.b)("scope"))],v),t.a=v},aY38:function(e,t,n){var s=n("Jygx");e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(s(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return s(t)}}},agzH:function(e,t,n){"use strict";var s=n("Llzl"),i=n("0JpG"),o=n("1ZbL"),a=n("/5AG");n.d(t,"a",(function(){return r}));const r="ultra.features.course.outline.review-state-icon",c={Class:a.ReviewStateIconButtonWrapper,bindingNames:["afterItemState","beforeItemState","contentId","courseId","hasAutomaticReviewStateTransition","onReviewStateIconClick"],renderLocalized:!0,withProvider:!0};s.module(r,[i.moduleName]).component("bbReviewStateIcon",Object(o.a)(c))},ap1t:function(e,t,n){"use strict";var s=n("D57K"),i=n("Llzl"),o=n("en1n"),a=n("0JpG"),r=n("Fvsw"),c=n("X/qj"),l=n("yMoE"),d=n("pjml"),u=n("TnpK"),h=n("g66W"),p=n("fYJU"),m=n("ooAF"),b=n("nmzr"),g=n("zGdY"),v=n("aHpC");n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return y}));const f="ultra.components.directives.grade.displayGradePill",C="--",y="na";let w=class{constructor(e,t,n,s,i,a,r,c,d){this.$injector=e,this.$sce=t,this.scope=n,this.element=s,this.bbLocalize=i,this.context=a,this.ultraState=r,this.gradebookPermissionService=c,this.contextUser=d,this.colorCss="";const u=this.scope.column()&&this.scope.column().courseId;this.bundlePromise=i.loadBundle("components/directives/grade/display-grade"),this.canViewGradebook=this.hasViewGradebook(u),this.isStudent=d.userModel.isStudent(),this.canViewGrades=this.hasViewGrades(u),this.canViewGrades?(this.scope.$watch("::column()",e=>{if(e){this.scope.$watchGroup(["attempt()","grade()"],()=>{const e=this.scope.attempt&&this.scope.attempt(),t=this.scope.grade&&this.scope.grade(),n=this.gradeDisplayItem=this.$injector.instantiate(l.a,{gradeDetail:t,scope:this.scope});n.init(this.scope.column()).then(()=>{let s;this.schema=n.schema,this.schema&&(this.scaleType=n.schema.scaleType),e?s=e.displayGrade:t&&this.schema&&(s=t.displayGrade),n.displayGrade=s,this.setFullDisplayValue()})})}}),this.scope.$watch(()=>o.g(),()=>{this.displayValue&&this.setFullDisplayValue()})):(this.displayValue=C,this.colorCss=y)}hasViewGradebook(e){return this.gradebookPermissionService.canView(e)}hasViewGrades(e){return this.isStudent||this.gradebookPermissionService.canViewGrades(e)}shouldShowPendingForGrade(){const e=this.scope.grade;return e&&e()&&!e().isPosted()&&e().hasAttempts()}shouldShowPendingForAttempt(){const e=this.scope.attempt;return e&&e()&&e().isNeedsGrading()}shouldRenderInlineRubric(){const e=this.scope.grade;return this.rubricEvaluationIsComplete()||this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()||e().isPastDueZero()}setNoSubmitView(){this.schema&&this.scaleType&&(this.scaleType===g.SchemaScaleType.Percent?this.displayValue=C+" %":this.scaleType===g.SchemaScaleType.Score?this.bundlePromise.then(()=>{this.displayValue=C+this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.total",params:{total:this.scope.grade&&this.scope.grade()&&this.scope.grade().pointsPossible||this.scope.column().possible},noWrap:!0})}):this.displayValue=C)}setFullDisplayValue(){this.displayValue=this.gradeDisplayItem&&this.gradeDisplayItem.displayValue,this.gradeDisplayItem.displayValue?(this.shouldShowPossiblePoints()?this.bundlePromise.then(()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.score",params:{grade:this.gradeDisplayItem.displayValue,possible:this.scope.grade&&this.scope.grade().pointsPossible||this.scope.column().possible},noWrap:!0,noEscape:!0})}):this.displayValue=this.gradeDisplayItem.displayValue,this.colorCss=this.gradeDisplayItem.getGradeColor()):this.isStudent&&(this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt())?(this.colorCss=`${y} pending`,this.bundlePromise.then(()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.pending-grade",noWrap:!0})})):(this.colorCss=this.isStudent?`${y} no-attempt`:"",this.setNoSubmitView())}get cursorClass(){return this.scope.cursor?`cursor-${this.scope.cursor}`:""}shouldShowPossiblePoints(){return!this.isSmallBP()&&this.gradeDisplayItem&&this.gradeDisplayItem.shouldShowTotalPoints()}isSmallBP(){return o.a.Small.isEqualTo(o.f())}shouldShowRubricButton(){var e,t,n;return!(this.scope.hideRubricIcon||!this.scope.column()||!this.scope.column().hasRubricAssociation())&&(!(!this.scope.column().isDiscussion()&&!this.scope.column().isJournal())||(null!=this.scope.attempt||!(!this.scope.column().isSingleAttempt()||g.AttemptStatus.InProgress===(null===(n=null===(t=null===(e=this.scope.grade())||void 0===e?void 0:e.ui)||void 0===t?void 0:t.attempt)||void 0===n?void 0:n.status))))}rubricEvaluationIsComplete(){const e=this.scope.column();if(e&&e.hasRubricAssociation()){const t=this.scope.attempt?this.scope.attempt():this.scope.grade().ui.attempt;return e.getRubricAssociation().isWithEvaluations&&(t&&t.isCompleted()||e.isDiscussion()||e.isJournal())}return!1}openRubricEvaluation(e){if(this.scope.disableRubricEvalClick&&this.scope.disableRubricEvalClick())return;e.stopPropagation();const t=this.getRubricStateRef();this.ultraState.current.name.endsWith("peek.assessment-submission-feedback")&&this.ultraState.leavePeekState(this.ultraState.current.name),this.ultraState.goPeekState(t.state,t.args)}getRubricStateRef(){var e;let t,n;(this.scope.grade||this.scope.attempt)&&(this.scope.attempt&&(t=null!==(e=this.scope.attempt().groupAttemptId)&&void 0!==e?e:this.scope.attempt().id),this.scope.grade&&this.scope.grade().ui&&this.scope.grade().ui.attempt&&this.scope.grade().ui.attempt.id&&(t=this.scope.grade().ui.attempt.id||this.scope.grade().ui.attempt.groupAttemptId),n=this.scope.attempt?this.scope.attempt().groupId:null,this.scope.grade&&this.scope.grade().ui.groupAttempt&&(n=this.scope.grade().ui.groupAttempt.groupId));const s={state:"",args:{attemptId:t||null,columnId:this.scope.column().id||null,contentId:this.scope.column().contentId||null,courseId:this.scope.column().courseId}};let i="inline-rubric";if(this.scope.isManualStatusPosted||this.gradeDisplayItem.displayValue&&"0"!==this.gradeDisplayItem.displayValue||this.scope.isExternalSubmission||this.scope.column().isCollectExternalSubmissions()||(i=this.shouldRenderInlineRubric()?"inline-rubric":"peek.rubric-view"),this.canViewGradebook||this.scope.column().isDiscussion()||this.scope.column().isJournal()){const e=this.rubricEvaluationIsComplete()?"rubric-evaluation":"rubric-view";s.args.groupId=n||null,s.args.userId=this.scope.grade&&this.scope.grade().user&&(this.scope.grade().user.$pk||this.scope.grade().user.id)||null,s.state=e,this.scope.column().isJournal()&&(s.state=this.rubricEvaluationIsComplete()?b.JournalRoutes.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_EVALUATION:b.JournalRoutes.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_VIEW)}else s.args.groupId=n||null,s.state=`${b.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW}.${i}`;return h.e(this.ultraState.current.name,".peek.course.grades")&&(this.scope.column().isCollectExternalSubmissions()?(s.state=`${b.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW}.inline-rubric`,s.args.skipTransitionEvents=!0):s.state="assessment.overview"),s}};w=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$injector")),Object(s.__param)(1,Object(v.b)("$sce")),Object(s.__param)(2,Object(v.b)("scope")),Object(s.__param)(3,Object(v.b)("element")),Object(s.__param)(4,Object(v.b)(a.serviceName)),Object(s.__param)(5,Object(v.b)(r.b)),Object(s.__param)(6,Object(v.b)(u.d)),Object(s.__param)(7,Object(v.b)(c.b)),Object(s.__param)(8,Object(v.b)(p.b))],w);class S{constructor(e){this.$injector=e,this.restrict="E",this.template=m,this.scope={attempt:"&?",column:"&",disableRubricEvalClick:"&?",grade:"&?",isManualStatusPosted:"<?",cursor:"@?",hideRubricIcon:"=?",isExternalSubmission:"=?",rubricStateOverride:"@?"},this.link=(e,t)=>{if(!e.attempt&&!e.grade)throw new Error("An attempt or grade must be included on scope");if(e.attempt&&e.grade)throw new Error("An attempt or grade should be included on scope, not both");if(!e.column)throw new Error("A column must be included on scope");e.displayGradePill=this.$injector.instantiate(w,{scope:e,element:t})}}}S.$inject=["$injector"],i.module(f,[d.N,c.a]).directive("bbDisplayGradePill",["$injector",e=>e.instantiate(S)])},bhWV:function(e,t,n){"use strict";var s=n("D57K"),i=(n("Sq3Z"),n("1NX5"),n("uAJz"),n("66CI"),n("Llzl")),o=n("YHe3"),a=n("TnpK"),r=n("Qbdf"),c=n("jhBu"),l=n("wy9x"),d=n("ga7A"),u=n("Is+C"),h=n("yV5t");const p="ultra.components.directives.content.contentItem.contentItemType.contentItemScormlaunch";class m{constructor(e,t){this.scope=e,this.scormService=t}scormLaunch(){if(!this.scope.content.isScorm())throw new Error("Attempted to launch a non-SCORM content item. "+this.scope.content.contentHandler.toString());this.scormService.scormLaunch({courseId:this.scope.content.courseId,contentId:this.scope.content.id,content:this.scope.content,showPreLaunchPanel:!0})}}m.$inject=["scope",u.c];class b{constructor(e){this.$injector=e,this.restrict="E",this.template=h,this.scope=!1,this.link=(e,t,n)=>{e.contentItemScormLaunch=this.$injector.instantiate(m,{scope:e,element:t,attrs:n})}}}b.$inject=["$injector"],i.module(p,[u.b]).directive("bbContentItemScormlaunch",["$injector",e=>e.instantiate(b)]);var g=n("z+6U"),v=n("Sa5G"),f=n("aHpC"),C=n("nmzr"),y=n("pjml"),w=n("/R3n"),S=n("DU7P"),I=n("zYa8"),O=n("l2+p");Object(I.a)(O.ProctorShield,"ultra.components.directives.bbUiIcon.small.ProctorShield","bbUiIconSmallProctorShield");var E=n("zGdY");n.d(t,"a",(function(){return D}));const D="ultra.components.directives.content.contentItem.contentItemCourseOutline";let k=class{constructor(e,t,n,s,i){this.scope=e,this.entitlementService=t,this.proctoringService=n,this.ultraState=s,this.currentCourseService=i,this.customCategory="",this.entitlementService.hasCourseEntitlement(v.e.ModifyContent,this.scope.content.courseId).then(e=>{this.entitledToModifyContent=e})}get canOpenConditionalRelease(){var e,t,n;return!!(null===(n=null===(t=null===(e=this.scope.content)||void 0===e?void 0:e.permissions)||void 0===t?void 0:t.adaptiveRelease)||void 0===n?void 0:n.view)}shouldAlignMiddle(){const e=this.scope.content;return!e.canViewAsInstructor()&&(!e.description&&(!e.isVisible()||!e.adaptiveReleaseRules))}openConditionalRelease(){if(this.isCourseCompletedAndInInstructorView())return;let e=this.scope.content.id;this.scope.content&&this.scope.content.contentHandler&&this.scope.content.contentDetail&&y.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.getLinkContentSource().$then(t=>{e=t.id}),this.ultraState.goPeekState(C.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:e})}isCourseCompletedAndInInstructorView(){var e;return(null===(e=this.currentCourseService.course)||void 0===e?void 0:e.isComplete())&&this.scope.content.canViewAsInstructor()}displayProctoredTag(){const e=this.scope.content.getProctoringServiceHandle(),t=this.scope.content.isSecureBrowserRequiredToTake(),n=e&&e!==S.b;return t||n}};k=Object(s.__decorate)([Object(s.__param)(0,Object(f.b)("scope")),Object(s.__param)(1,Object(f.b)(c.b)),Object(s.__param)(2,Object(f.b)(o.b)),Object(s.__param)(3,Object(f.b)(a.d)),Object(s.__param)(4,Object(f.b)(r.e))],k);class ${constructor(e){this.$injector=e,this.restrict="E",this.template=w,this.scope=!1,this.link=e=>{if(e.contentItemCourseOutline=this.$injector.instantiate(k,{scope:e}),e.content.getAssociatedGradingColumn()){const t=e.content.getAssociatedGradingColumn().gradebookCategory;t&&!t.isUserDefined?(e.contentItemCourseOutline.groupAssessmentFtueKey="components.directives.content-item-base.group-assessment-description."+t.title,e.contentItemCourseOutline.groupAssessmentFtueTitleKey="components.directives.content-item-base.group-assessment-title."+t.title):(e.contentItemCourseOutline.customCategory=t&&t.title,e.contentItemCourseOutline.groupAssessmentFtueKey="components.directives.content-item-base.group-assessment-description.custom",e.contentItemCourseOutline.groupAssessmentFtueTitleKey="components.directives.content-item-base.group-assessment-title.custom")}else e.contentItemBase.courseLinkContentHandler.isEqualTo(e.content.contentHandler)&&(e.contentItemCourseOutline.groupAssessmentFtueKey=`components.directives.content-item-base.group-assessment-description.${E.KnownGradebookCategoryTitle.Discussion}`,e.contentItemCourseOutline.groupAssessmentFtueTitleKey=`components.directives.content-item-base.group-assessment-title.${E.KnownGradebookCategoryTitle.Discussion}`)}}}$.$inject=["$injector"],i.module(D,[l.a,d.a,g.a,p,o.a,a.b,r.b,"ultra.components.directives.bbUiIcon.small.ProctorShield"]).directive("bbContentItemCourseOutline",["$injector",e=>e.instantiate($)])},c2Z8:function(e,t){e.exports='<div class="bb-statistics">\n  <ul class="statistics-list total-items-{{::statistics.total}} small-per-row-{{::statistics.smallPerRow}} large-per-row-{{::statistics.largePerRow}}">\n    <li ng-repeat="item in statistics.config">\n      <div class="statistics-item-container" ng-class="{\'no-default-padding\': item.noDefaultPadding, \'full-height\': !item.complexScope}">\n        <div class="stat-title" ng-attr-title="{{ item.hover ? item.hover : undefined }}" bb-translate>{{::item.title}}</div>\n        <div ng-if="::!item.complexScope" bb-simple-statistic item="::item"></div>\n        <div ng-if="::item.complexScope" bb-complex-statistic item="::item"></div>\n      </div>\n    </li>\n  </ul>\n</div>'},"c7N/":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var s=n("D57K"),i=n("Fvsw"),o=n("jhBu"),a=n("aHpC"),r=n("Sa5G");const c="ultra.components.services.unsafe-html",l="unsafe-html";let d=class{constructor(e,t){this.contextService=e,this.entitlementService=t}hasEditUnsafeHtmlPermission(){return this.entitlementService.hasCourseEntitlement(r.x.Modify)}isAlternateDomainConfigured(){return this.contextService.getSystemInfo().alternateDomainConfigured}canEditUnsafeHtml(){return this.hasEditUnsafeHtmlPermission().then(e=>e&&this.isAlternateDomainConfigured())}};d=Object(s.__decorate)([Object(s.__param)(0,Object(a.b)(i.b)),Object(s.__param)(1,Object(a.b)(o.b))],d);class u extends d{}angular.module(c,[i.a,o.a]).service(l,d)},cbVV:function(e,t,n){"use strict";(function(e){n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return w})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return I})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return E})),n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return k})),n.d(t,"g",(function(){return $})),n.d(t,"h",(function(){return L})),n.d(t,"f",(function(){return R})),n.d(t,"e",(function(){return j}));var s=n("D57K"),i=n("nsO7"),o=n("yC9S"),a=n("Sa5G"),r=n("jhBu"),c=n("o5Lu"),l=n("X/qj"),d=n("vhkR"),u=n("Is+C"),h=n("Mc6f"),p=n("8jzW"),m=n("hkqm"),b=n("TnpK"),g=n("dF44"),v=n("aHpC"),f=n("nmzr");let C=class{constructor(e,t,n,s,i,o,r,c,l,d,u,h,p,m,b,g,v){this.rootScope=e,this.gridData=t,this.data=n,this.headerTemplate=s,this.cellTemplate=i,this.columnWidth=o,this.position=r,this.border=c,this.ltiService=d,this.entitlementService=u,this.gradeService=h,this.gradebookPermissionService=p,this.scormService=m,this.scoreProviderHelper=b,this.toast=g,this.ultraState=v,this.openDownloadTestResultsPanel=()=>{this.ultraState.goPeekState(f.Routes.Grade.DOWNLOAD_TEST_RESULTS,{columnId:this.id})},this.order=null!=l?l:0,this.id=n.id;const C=this.getCourse().id;this.entitlementService.hasCourseEntitlement(a.i.DeleteAssessment,C).then(e=>{this.canDeleteAssessment=e}),this.entitlementService.hasCourseEntitlement(a.e.DeleteContent,C).then(e=>{this.canDeleteContent=e}),this.entitlementService.hasCourseEntitlement(a.i.ModifyAssessment,C).then(e=>{this.canModifyAssessment=e}),this.entitlementService.hasCourseEntitlement(a.e.ModifyContent,C).then(e=>{this.canModifyContent=e}),this.entitlementService.hasCourseEntitlement(a.i.ViewAssessment,C).then(e=>{this.canViewAssessment=e}),this.entitlementService.hasCourseEntitlement(a.e.ViewAsDesigner,C).then(e=>{this.canViewContentDesigner=e})}getCourse(){return this.gridData.course}hasContextMenuOptions(){return this.isScorm()||this.canView()||this.gradeService.canPostGrades(this.gridData.course,this.data)||this.data.isQuestionAnalysisAvailable()&&this.canViewQuestionAnalysis()||this.canDelete()}isAssessment(){return a.r.Test.isEqualTo(this.data.scoreProviderHandle)}canView(){return!this.data.scoreProviderHandle||(this.isAssessment()?this.canViewAssessment:this.canViewContentDesigner)}canEdit(){return!this.gridData.course.isComplete()&&(this.data.scoreProviderHandle?this.isAssessment()?this.canModifyAssessment:this.canModifyContent:this.gradebookPermissionService.canModify())}canDelete(){return!this.gridData.course.isComplete()&&(this.data.scoreProviderHandle?this.isAssessment()?this.canDeleteAssessment:this.canDeleteContent:this.gradebookPermissionService.canModify())}deleteColumn(){throw new Error("Unsupported operation exception")}deleteColumnFromGridData(){this.gridData.deleteColumn(this)}getConfirmationMessage(){throw new Error("Unsupported operation exception")}viewOrEdit(){if(a.r.PartnerCloud.isEqualTo(this.data.scoreProviderHandle))this.ltiService.ltiLaunch({courseId:this.data.courseId,contentId:this.data.contentId,linkType:a.f.PartnerCloud,linkRefId:this.data.linkId});else{const e=this.data.scoreProviderHandle;e&&!this.scoreProviderHelper.supportsOverall(e)||(this.scoreProviderHelper.supportsExternalEdit(e)?this.ltiService.ltiEditColumn(this.data):this.openEditState())}}canViewQuestionAnalysis(){return this.gradebookPermissionService.canViewGrades()}openQuestionAnalysisOverview(){throw new Error("Unsupported operation exception")}showDownloadResults(){return this.gridData.canViewGrades&&this.isAssessment()&&this.data.summary.numSubmissionsTotal>0}hasDownloads(){return a.r.Test.isEqualTo(this.data.scoreProviderHandle)}canDownloadAll(){return!1}openDownloadAll(){this.ultraState.goPeekState("grades-bulk-download",{columnId:this.id})}previewScorm(){this.isScorm()&&this.scormService.scormLaunch({courseId:this.data.courseId,contentId:this.data.contentId,showPreLaunchPanel:!1})}openEditState(){throw new Error("Unsupported operation exception")}postGrades(){this.data.postReadyGrades().then(()=>(this.toast.show({messageKey:"components.directives.grade.grid.gradesPosted",icon:"icon-check",toastStatus:"success"}),this.data.anonymousGrading?this.data.$fetch().$asPromise().then(()=>this.data.summary.$fetch().$asPromise()):this.data.summary.$fetch().$asPromise())).then(()=>{this.gridData.updateColumnByMetadata(this.data)&&this.rootScope.$broadcast(g.b.COLUMN)})}isShowSummary(){return!0}isScorm(){return this.data&&this.data.isScorm()}onClick(){}triggerDelete(t){t.target===t.currentTarget&&(e(t.target).find("a").click(),t.preventDefault(),t.stopPropagation())}getMetadata(){return this.data}filterByColumId(e){return e.indexOf(this.id)>-1}filterByCategoryId(e){return!!this.data.gradebookCategory&&e.indexOf(this.data.gradebookCategoryId)>-1}};C=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$rootScope")),Object(s.__param)(1,Object(v.b)("gridData")),Object(s.__param)(2,Object(v.b)("data")),Object(s.__param)(3,Object(v.b)("headerTemplate")),Object(s.__param)(4,Object(v.b)("cellTemplate")),Object(s.__param)(5,Object(v.b)("columnWidth")),Object(s.__param)(6,Object(v.b)("position")),Object(s.__param)(7,Object(v.b)("border")),Object(s.__param)(8,Object(v.b)("order")),Object(s.__param)(9,Object(v.b)(d.b)),Object(s.__param)(10,Object(v.b)(r.b)),Object(s.__param)(11,Object(v.b)(c.i)),Object(s.__param)(12,Object(v.b)(l.b)),Object(s.__param)(13,Object(v.b)(u.c)),Object(s.__param)(14,Object(v.b)(p.c)),Object(s.__param)(15,Object(v.b)(m.b)),Object(s.__param)(16,Object(v.b)(b.d))],C);class y extends C{addBorder(){this.border=!0}deleteBorder(){this.border=!1}filterByColumId(e){return!0}filterByCategoryId(e){return!0}}let w=class extends C{constructor(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g,v){super(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g),this.notationService=v,this.gradeNotations=[],this.loadNotation()}loadNotation(){this.notationService.getGradeNotationsMap(this.gridData.course.id,!0).then(e=>{this.gradeNotations=e})}openEditState(){this.ultraState.goPeekState("gradebook-item.overall-grade",{columnId:this.id,gradeitemView:"details"})}deleteColumn(){this.data.forceDelete()}getConfirmationMessage(){return"x-bb-grade-calculation"}filterByColumId(e){return!0}filterByCategoryId(e){return!0}};w.$inject=[],w=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$rootScope")),Object(s.__param)(1,Object(v.b)("gridData")),Object(s.__param)(2,Object(v.b)("data")),Object(s.__param)(3,Object(v.b)("headerTemplate")),Object(s.__param)(4,Object(v.b)("cellTemplate")),Object(s.__param)(5,Object(v.b)("columnWidth")),Object(s.__param)(6,Object(v.b)("position")),Object(s.__param)(7,Object(v.b)("border")),Object(s.__param)(8,Object(v.b)("order")),Object(s.__param)(9,Object(v.b)(d.b)),Object(s.__param)(10,Object(v.b)(r.b)),Object(s.__param)(11,Object(v.b)(c.i)),Object(s.__param)(12,Object(v.b)(l.b)),Object(s.__param)(13,Object(v.b)(u.c)),Object(s.__param)(14,Object(v.b)(p.c)),Object(s.__param)(15,Object(v.b)(m.b)),Object(s.__param)(16,Object(v.b)(b.d)),Object(s.__param)(17,Object(v.b)(h.b))],w);class S extends C{refreshAffectedColumns(){this.findAffectedColumns().forEach(e=>this.gridData.updateColumnByMetadata(e.data))}findAffectedColumns(e=[]){const t=i.differenceBy(this.gridData.getColumns().filter(e=>e instanceof S&&e.isAffected(this)),e,"id");let n=i.unionBy([],t,"id");return e=i.unionBy(t,e,"id"),t.forEach(t=>{n=i.unionBy(n,t.findAffectedColumns(e),"id")}),n}}class I extends S{isAffected(e){const t=this.data.calculatedFormula&&this.data.calculatedFormula.aliases;return!i.isUndefined(t)&&(!i.isUndefined(i.findKey(t,t=>t===e.id))||!i.isUndefined(i.findKey(t,t=>e.data.gradebookCategory&&t===e.data.gradebookCategory.id)))}openEditState(){this.ultraState.goPeekState("gradebook-item.calculation",{columnId:this.id,gradeitemView:"details"})}deleteColumn(){this.data.forceDelete()}getConfirmationMessage(){return"x-bb-grade-calculation"}}let O=class extends S{constructor(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g){super(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g),this._affectedColumnsBeforeEdit=[]}getConfirmationMessage(){return"x-bb-grade-column"}stashAffectedColumnsBeforeEdit(){this._affectedColumnsBeforeEdit=this.findAffectedColumns()}get affectedColumnsBeforeEdit(){return this._affectedColumnsBeforeEdit}isAffected(e){return!1}};O.$inject=[],O=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$rootScope")),Object(s.__param)(1,Object(v.b)("gridData")),Object(s.__param)(2,Object(v.b)("data")),Object(s.__param)(3,Object(v.b)("headerTemplate")),Object(s.__param)(4,Object(v.b)("cellTemplate")),Object(s.__param)(5,Object(v.b)("columnWidth")),Object(s.__param)(6,Object(v.b)("position")),Object(s.__param)(7,Object(v.b)("border")),Object(s.__param)(8,Object(v.b)("order")),Object(s.__param)(9,Object(v.b)(d.b)),Object(s.__param)(10,Object(v.b)(r.b)),Object(s.__param)(11,Object(v.b)(c.i)),Object(s.__param)(12,Object(v.b)(l.b)),Object(s.__param)(13,Object(v.b)(u.c)),Object(s.__param)(14,Object(v.b)(p.c)),Object(s.__param)(15,Object(v.b)(m.b)),Object(s.__param)(16,Object(v.b)(b.d))],O);class E extends O{openEditState(){this.stashAffectedColumnsBeforeEdit(),this.ultraState.goPeekState("grade-item.edit",{id:this.id})}deleteColumn(){this.data.forceDelete()}}let D=class extends O{constructor(e,t,n,s,i,a,r,c,l,d,u,h,p,m,b,g,v){super(e,t,n,s,i,a,r,c,l,d,u,h,p,m,b,g,v),this.checkIfAttendanceRecordsExist(),o.b.OnRootScope(e,"$stateChangeSuccess",(e,t,n,s)=>{s.name.indexOf("attendance")>=0&&this.checkIfAttendanceRecordsExist()})}canDelete(){return super.canDelete()&&this.showAttendanceDeleteOption}get canBePost(){return!1}openEditState(){this.stashAffectedColumnsBeforeEdit();const e={courseId:this.data.courseId,contentId:this.data.contentId};this.scoreProviderHelper.editStateRef(this.data.scoreProviderHandle,e,p.a.GoToState)}deleteColumn(){this.data.forceDelete()}checkIfAttendanceIsAvailable(){if(this.gridData.course.tools){const e=this.gridData.course.tools.getToolById("bb-attendance");if(e&&e.toolEnabledSetting.isAvailable)return!0}return!1}checkIfAttendanceRecordsExist(){this.showAttendanceDeleteOption=!1,this.checkIfAttendanceIsAvailable()&&this.gridData.course.attendanceRecordsExist().then(e=>{this.showAttendanceDeleteOption=!e})}};D.$inject=[],D=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$rootScope")),Object(s.__param)(1,Object(v.b)("gridData")),Object(s.__param)(2,Object(v.b)("data")),Object(s.__param)(3,Object(v.b)("headerTemplate")),Object(s.__param)(4,Object(v.b)("cellTemplate")),Object(s.__param)(5,Object(v.b)("columnWidth")),Object(s.__param)(6,Object(v.b)("position")),Object(s.__param)(7,Object(v.b)("border")),Object(s.__param)(8,Object(v.b)("order")),Object(s.__param)(9,Object(v.b)(d.b)),Object(s.__param)(10,Object(v.b)(r.b)),Object(s.__param)(11,Object(v.b)(c.i)),Object(s.__param)(12,Object(v.b)(l.b)),Object(s.__param)(13,Object(v.b)(u.c)),Object(s.__param)(14,Object(v.b)(p.c)),Object(s.__param)(15,Object(v.b)(m.b)),Object(s.__param)(16,Object(v.b)(b.d))],D);class k extends O{canDownloadAll(){return(!this.data||!this.data.anonymousGrading)&&this.gradebookPermissionService.canViewBulkDownload()}showDownloadResults(){return(!this.data||!this.data.anonymousGrading)&&super.showDownloadResults()}openEditState(){this.stashAffectedColumnsBeforeEdit();const e={courseId:this.data.courseId,contentId:this.data.contentId};this.scoreProviderHelper.editStateRef(this.data.scoreProviderHandle,e,p.a.GoToState)}deleteColumn(){this.rootScope.$broadcast("bb-delete-column",this.data)}openQuestionAnalysisOverview(){this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.data.contentId})}}let $=class extends k{constructor(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g,v){super(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m,b,g),this.groups=v,this._userIdGroupIdMap={},this.initializeUserIdGroupIdMap()}initializeUserIdGroupIdMap(){const e=this.gridData.getColumnIdGroupsMap()[this.id];i.isEmpty(e)||e.forEach(e=>{const t=this.gridData.getGroupIdUserIdMap()[e.groupId];i.isEmpty(t)||t.forEach(t=>{this._userIdGroupIdMap[t]=e.groupId})})}canDownloadAll(){return!1}get userIdGroupIdMap(){return this._userIdGroupIdMap}getGroupById(e){return i.find(this.groups,t=>t.groupId===e)}};$.$inject=[],$=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$rootScope")),Object(s.__param)(1,Object(v.b)("gridData")),Object(s.__param)(2,Object(v.b)("data")),Object(s.__param)(3,Object(v.b)("headerTemplate")),Object(s.__param)(4,Object(v.b)("cellTemplate")),Object(s.__param)(5,Object(v.b)("columnWidth")),Object(s.__param)(6,Object(v.b)("position")),Object(s.__param)(7,Object(v.b)("border")),Object(s.__param)(8,Object(v.b)("order")),Object(s.__param)(9,Object(v.b)(d.b)),Object(s.__param)(10,Object(v.b)(r.b)),Object(s.__param)(11,Object(v.b)(c.i)),Object(s.__param)(12,Object(v.b)(l.b)),Object(s.__param)(13,Object(v.b)(u.c)),Object(s.__param)(14,Object(v.b)(p.c)),Object(s.__param)(15,Object(v.b)(m.b)),Object(s.__param)(16,Object(v.b)(b.d)),Object(s.__param)(17,Object(v.b)("groups"))],$);class L extends ${}class R extends ${}class j extends k{}}).call(this,n("5iHu"))},cpZm:function(e,t,n){"use strict";var s=n("D57K"),i=n("Llzl"),o=n("ERkP"),a=n("SToD"),r=n("1ZbL"),c=n("tN4z"),l=n("TUnR"),d=n("MC1S"),u=n("uDfI"),h=n("JfV0");const p="ultra.components.services.gradebookListViewTabs",m=e=>{const{onChange:t,value:n,tabs:s,localize:i,analyticsId:a,ftue:r}=e,[p,m]=o.useState(),b=Object(u.useDispatch)(),[g]=Object(l.useShowGuidance)(null==r?void 0:r.componentKey);return o.createElement("div",{className:"gradebook-list-view-tabs"},o.createElement(c.AnalyticsTabs,{onChange:t,value:n,analyticsId:`${a}.gradebook.listViewTabs`},s&&s.map(e=>{const t={analyticsId:`${a}.gradebook.listViewTab.${e.id}`,className:`js-gradebook-tab-${e.id}`,key:e.id,value:e.id,label:i.translate(e.displayKey)};return e.id===(null==r?void 0:r.targetId)&&(t.innerRef=m),o.createElement(c.AnalyticsTab,{...t})})),g&&p&&o.createElement(l.GuidanceTeachingBubble,{componentKey:r.componentKey,onDismiss:()=>{b(h.actions.userPreference.persistUserPreference({key:r.componentKey,value:"1"}))},targetElement:p,headline:i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceHeader"),calloutProps:{directionalHint:d.DirectionalHint.bottomAutoEdge},analyticsId:`${a}.ftue`},i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceBody"),o.createElement(c.AnalyticsPrimaryButton,{analyticsId:`${a}.gradebook.PrimaryButton`,className:"ftue-action",onClick:()=>{b(h.actions.userPreference.persistUserPreference({key:r.componentKey,value:"1"})),r.action()}},i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceTry"))))};class b extends o.Component{render(){return o.createElement(m,{...this.props})}}const g={Class:Object(a.a)(b),attributes:["analyticsId"],bindingNames:["value","onChange","tabs","ftue"],renderLocalized:!0,withProvider:!0};i.module(p,[]).component("bbUiGradebookListViewTabs",Object(r.a)(g));var v=n("aHpC"),f=n("Y+9S");n.d(t,"c",(function(){return C})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return w}));const C="ultra.components.directives.gradebookListViewTabs",y={id:"assignments",ariaLabel:"components.directives.grade.course-grades-grader.views.gradableItemsListView",displayKey:"components.directives.grade.course-grades-grader.views.gradableItemsListViewTabLabel"},w={id:"students",ariaLabel:"components.directives.grade.course-grades-grader.views.studentListView",displayKey:"components.directives.grade.course-grades-grader.views.studentListViewTabLabel"},S=[y,w];let I=class{constructor(e){this.scope=e,this.onTabChange=(e,t)=>{const n=this.tabs.find(e=>e.id===t);Object(f.notifyMobileApp)(t===w.id?f.MessageType.StudentsTabOpened:f.MessageType.GradableItemTabOpened),this.scope.onTabChanged&&this.scope.onTabChanged(n.id),this.scope.$apply()},this.tabs=S,this.ftue={componentKey:"ftue.grades.grader.studentlistview",targetId:"students",action:()=>{this.scope.onTabChanged("students")}}}};I=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("scope"))],I);let O=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-ui-gradebook-list-view-tabs\n                            value="gradebookListViewTabs.scope.selectedTab"\n                            on-change="gradebookListViewTabs.onTabChange"\n                            tabs="gradebookListViewTabs.tabs"\n                            ftue="gradebookListViewTabs.ftue">\n                      </bb-ui-gradebook-list-view-tabs>',this.scope={onTabChanged:"<?",selectedTab:"="},this.link=e=>{e.gradebookListViewTabs=this.$injector.instantiate(I,{scope:e})}}};O=Object(s.__decorate)([Object(s.__param)(0,Object(v.b)("$injector"))],O),angular.module(C,[p]).directive("bbGradebookListViewTabs",["$injector",e=>e.instantiate(O)])},dF44:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return r}));const s={CELL_FOCUSED:"rb_grid_cell_focused",COLUMN:"rb_grid_column",DATA_UPDATE:"rb_grid_data_update",ENTER_CELL:"rb_grid_enter_cell",ENTER_NEXT_CELL:"rb_grid_enter_next_cell",FOCUS_CELL:"rb_grid_focus_cell",LEAVE_CELL:"rb_grid_leave_cell",LEAVE_GRID:"rb_grid_leave_grid",ROW:"rb_grid_row",SCROLL_H:"rb_grid_scroll_h",SCROLL_V:"rb_grid_scroll_v"},i=2,o=2,a=50,r=50},"dL5/":function(e,t){e.exports='<span class="group-count-directive" bb-load-bundle="components/directives/group/group-count">\n  <bb-translate translate-values="{number: $ctrl.content.assignedGroups.length}"\n                ng-if="!$ctrl.isSelfEnrollment()">components.directives.group-count.groups.plural</bb-translate>\n  <bb-translate translate-values="{number: $ctrl.content.assignedGroups.length}"\n                ng-if="$ctrl.isSelfEnrollment()">components.directives.group-count.groups.selfEnroll.plural</bb-translate>\n</span>\n'},dd1C:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));n("zAxy"),n("10QP");var s=n("Llzl"),i=n("0JpG"),o=n("e6jQ"),a=n("GbAM"),r=n("3mUc");const c="ultra.components.directives.grade.inlineValidation",l="bb-inline-validation-check";class d{constructor(t,n,s,i,a){this.scope=t,this.element=n,this.attrs=s,this.$compile=i,this.bbLocalize=a,this.scope.$on("$destroy",()=>{this.element.off(),this.element=null,e(`#${this.scope.tooltipId}`).remove()});const r=o.a();t.tooltipId=`inline-validation-tooltip-${r}`,t.alertTextId=`inline-validation-alert-text-${r}`,this.updateErrorMessage(),this.scope.focusableElement=this.element.find(":tabbable, input:enabled"),this.setupEventHandlers(),t.$watch(()=>this.scope.focusableElement.val(),e=>{null!=e&&this.checkErrors()}),t.$watch(()=>this.scope.showError(),e=>{this.checkErrors()}),t.$watch("errorMessage",e=>this.updateErrorMessage())}tooltipExists(){return 0!==e(`#${this.scope.tooltipId}`).length}updateErrorMessage(){this.scope.errorMessage?this.scope.errorMessageRefined=this.scope.errorMessage:this.bbLocalize.loadBundle("components/directives/grade/inline-validation").then(()=>{this.scope.errorMessageRefined=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.inline-validation.default"})})}checkErrors(){this.scope.showError()?this.showErrorTip():this.hideErrorTip()}setupEventHandlers(){this.scope.focusableElement.on("focus",()=>{this.checkErrors()}).on("blur",()=>{this.hideErrorTip()}),this.scope.$on(l,()=>{this.checkErrors()})}showErrorTip(){if(this.scope.focusableElement[0]===document.activeElement){this.tooltipExists()||e("body").append(this.$compile(`\n          <div id="${this.scope.tooltipId}"\n            class="tooltip inline-validation f-dropdown content inline-validation-tooltip">\n            <span class="validation-message" ng-bind="errorMessageRefined" aria-role="text"></span>\n            <span class="nub"></span>\n          </div>\n        `)(this.scope));const t=this.element.children().first(),n=e(`#${this.scope.tooltipId}`);window.Foundation.libs.tooltip.reposition(t,n,t.attr("class")),n.show(),this.scope.$root.$broadcast(a.a,this.scope.errorMessageRefined)}}hideErrorTip(){e(`#${this.scope.tooltipId}`).hide()}}d.$inject=["scope","element","attrs","$compile",i.serviceName];class u{constructor(e){this.$injector=e,this.restrict="E",this.transclude=!0,this.template=r,this.scope={showError:"&",errorMessage:"@"},this.link=(e,t,n,s)=>{e.inlineValidation=this.$injector.instantiate(d,{scope:e,element:t,attrs:n})}}}u.$inject=["$injector"],s.module(c,[i.moduleName]).directive("bbInlineValidation",["$injector",e=>e.instantiate(u)])}).call(this,n("5iHu"))},e7Kn:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return D}));var s=n("D57K"),i=(n("1/hr"),n("Llzl")),o=n("lx16"),a=n("0JpG"),r=n("kC07"),c=n("RPq7"),l=n("nYZ0"),d=n("LdA1"),u=n("sLTT"),h=n("M8+u"),p=n("D8d/"),m=n("L+81"),b=n("lr7J"),g=n("aHpC"),v=n("pjml"),f=n("rtZE"),C=n("tfx2"),y=n("lEL+"),w=n("gkef"),S=n("oQrK"),I=n("fN3Q"),O=n("hDL0"),E=n("W6wm");const D="ultra.directives.contentOutline";let k=class{constructor(t,n,s,i,o,a,r,c){this.scope=t,this.element=n,this.ContentService=i,this.CourseContentModel=o,this.timeout=a,this.windowService=r,this.localizeService=c,this.cloudUploadInProgress={},this.showContentImportProgress=!1,this.LARGE_CONTAINER_SELECTOR=".bb-offcanvas-panel-wrap .panel-wrap",this.SMALL_CONTAINER_SELECTOR=".bb-offcanvas-panel-wrap .panel-wrap .panel-content",this.getContentTrackingId=e=>null!=e.id?e.id:(e.ui.tempId||(e.ui.tempId=this.getTempId()),e.ui.tempId),this.contextArea=t.contextArea,this.addContentButtonLocation=null,this.loadMoreChildren=t.loadMoreChildren,this.parentFolder=t.parentFolder,this.onFileDropHandler=t.onFileDropHandler,this.onMoveHandler=t.onMoveHandler,this.onMoveIntoFolderHandler=t.onMoveIntoFolderHandler,this.canMove=t.canMove&&(!t.contents.permissions||t.contents.permissions.move),this.showMenuOverride=!1,null!=t.contents&&"function"==typeof t.contents.$asPromise&&t.contents.$asPromise().then(()=>{this.showMenuOverride=0===t.contents.length}),this.placeholderContent=this.CourseContentModel.$buildRaw({id:this.parentFolder&&this.parentFolder.id&&this.parentFolder.id+"_placeholder",parentId:this.parentFolder&&this.parentFolder.id,contentHandler:v.p.ContentHandler.Unknown.toString(),depth:this.parentFolder&&this.parentFolder.depth&&this.parentFolder.depth+1}),t.$watch("contents.length",(s,i)=>{this.showMenuOverride=0===s,this.placeholderContent.id=this.parentFolder&&this.parentFolder.id&&this.parentFolder.id+"_placeholder",this.placeholderContent.parentId=this.parentFolder&&this.parentFolder.id,this.resetMovableAddContentButton(n),s<i&&(t.$emit("content-outline-infinite-scroll-check"),e(`#add-button${this.scope.parentFolder.id}`).appendTo(e(`#add-button-container${this.scope.parentFolder.id}`)))}),t.$eval(s.showContentImportProgress)&&this.addImportPlaceholder(),t.$on("bb-drag-start",()=>{this.resetMovableAddContentButton(n)}),t.$on("keyboard-drag-start",()=>{this.resetMovableAddContentButton(n)}),t.$on("showContentImportProgress",(e,t,n)=>{"-1"!==n&&this.parentFolder.id!==n||this.addImportPlaceholder()}),t.$on(C.c,(e,t)=>{this.cloudUploadInProgress[t]||(this.cloudUploadInProgress[t]=!0)})}resetMovableAddContentButton(e){this.addContentButtonLocation=null,e.append(this.getMovableAddContentButton())}addImportPlaceholder(){this.ContentService.getOrMakeContentInContentTree(this.parentFolder,this.parentFolder.courseId,void 0,this.parentFolder.id,"start").then(t=>{t.content.ui.importPlaceholder=!0,this.timeout(()=>{e(".placeholder-container").closest(".js-content-div").scrollintoview({duration:300})},this.scope,0,!1)})}getScrollContainerSelector(){return this.windowService.isLargeBreakpoint()?this.LARGE_CONTAINER_SELECTOR:this.SMALL_CONTAINER_SELECTOR}getScrollForceShowSelector(){return`.${r.a}`}isAllContentsLoaded(){return!!(this.scope.contents&&this.scope.contents.paging&&this.scope.contents.paging.count)&&this.scope.contents.length>=this.scope.contents.paging.count}isAddContentButtonUnattached(e){return!!e&&(!this.addContentButtonLocation||e!==this.addContentButtonLocation.id)}placeAddButton(t,n=!1){const s=this.parentFolder?`.movable-add-content-button-folder${this.parentFolder.id}`:"";if(!this.isAddContentButtonUnattached(t.id)||this.contextArea===E.a.Discussions||void 0===t.id)return;const i=!!document.querySelector(".ms-ContextualMenu-list.is-open");!n&&i||(this.getMovableAddContentButton().appendTo(e(`#add-button-placeholder${t.id}`)),this.addContentButtonLocation=t,this.scope.$broadcast("change-add-content-button-position",{reopen:i}),n&&this.element.find(`.movable-add-content-button.movable-add-content-button${s} .button-add-content.js-show-add-options`).focus())}getMovableAddContentButton(){const e=this.parentFolder?`.movable-add-content-button-folder${this.parentFolder.id}`:"";return this.element.find(`.movable-add-content-button${e}`)}getAddButtonLineLabel(e){return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.add-content-button.aria-label.content.add-button-label-item-name-after",params:{itemName:e},noWrap:!0,noEscape:!0})}isMobileDevice(){return S.a.detect().mobile()}shouldShowMenuOverride(){return(!this.parentFolder||0!==this.parentFolder.depth)&&this.showMenuOverride}shouldShowAddButton(){return this.scope.isFirst||this.scope.contents&&0===this.scope.contents.length}hasId(e){return this.scope.contents.some(t=>t.ui.tempId===e||t.id===e)}getTempId(){let e,t=!1;for(;!t;)e=Object(I.v4)(),t=!this.hasId(e);return e}isProgressTrackingStateShown(e){var t;return null===(t=e.permissions)||void 0===t?void 0:t.canViewReviewState}};k=Object(s.__decorate)([Object(s.__param)(0,Object(g.b)("scope")),Object(s.__param)(1,Object(g.b)("element")),Object(s.__param)(2,Object(g.b)("attrs")),Object(s.__param)(3,Object(g.b)(l.f)),Object(s.__param)(4,Object(g.b)(v.p.serviceName)),Object(s.__param)(5,Object(g.b)(y.b)),Object(s.__param)(6,Object(g.b)(w.b)),Object(s.__param)(7,Object(g.b)(a.serviceName))],k);class ${constructor(e,t){this.link=e,this.recursionHelper=t,this.replace=!0,this.restrict="E",this.scope={canCreate:"=",contents:"=",contextArea:"=",loadMoreChildren:"=",isFirst:"=",parentFolder:"=",onFileDropHandler:"=?",onMoveHandler:"=",onMoveIntoFolderHandler:"=?",canMove:"=",canCreateAllContents:"=?",canCopyImport:"=?",hideAddMenuOverride:"=?"},this.compile=e=>this.recursionHelper.compile("content-outline-directive",e,this.link),this.template=O}}$.$inject=["link",f.b],i.module(D,[o.a,r.b,u.a,h.a,d.a,c.b,l.d,p.a,m.a,b.b,f.a,w.a,a.moduleName]).directive("bbContentOutline",["$injector",l.f,e=>{return e.instantiate($,{link:(t,n,s)=>{t.contentOutline=e.instantiate(k,{scope:t,element:n,attrs:s})}})}])}).call(this,n("5iHu"))},eAkB:function(e,t){e.exports='<div class="guidance-wrapper gradebook-panel" bb-cache-compilation="course-grades">\n  <div class="grader-view" bb-course-entitlement="course.gradebook-metadata.VIEW" course-id="courseGrades.course.id">\n    <bb-course-grades-grader></bb-course-grades-grader>\n  </div>\n  <div class="student-view" bb-course-entitlement="course.gradebook-metadata.VIEW" course-id="courseGrades.course.id" entitlement-action="hide">\n    <bb-course-grades-student course="courseGrades.course.model" course-grades="courseGrades" is-user-student="true"/>\n  </div>\n\n  <div ui-view="grades-panel-base"></div>\n</div>\n'},eWdw:function(e,t,n){},fGDP:function(e,t,n){"use strict";var s=n("D57K"),i=(n("HwkA"),n("CG4K"),n("8wib"),n("6ZXc"),n("3Lzw"),n("5m/6"),n("nsO7")),o=n("Llzl"),a=n("en1n"),r=(n("s4xR"),n("lx16")),c=n("RPq7"),l=n("D8d/"),d=n("pKNj"),u=n("X/qj"),h=n("o5Lu"),p=n("P2dS"),m=n("ujI6"),b=n("0JpG"),g=n("lEL+"),v=n("JfV0"),f=n("Efpj"),C=n("ZQFV"),y=n("aHpC");const w="ultra.components.directives.grade.courseGradesGraderList";let S=class{constructor(e,t,n,s,i,o){this.scope=e,this.attrs=t,this.gradebookPermissionService=n,this.$ngRedux=s,this.grade=i,this.categoryService=o,this.categoryMap={},this.onMoveGraderItem=e=>{const t=this.findGraderItemById(e.dragContentId),n=t.positionBeforeId?t.positionBeforeId:null,s=t.positionAfterId?t.positionAfterId:null,i=this.columns.indexOfItemById(e.dragContentId);let o=null;return e.positionBeforeId?(-1!==(o=this.columns.indexOfItemById(e.positionBeforeId))&&-1!==i&&i<o&&o--,t.positionBeforeId=e.positionBeforeId):e.positionAfterId&&(-1!==(o=this.columns.indexOfItemById(e.positionAfterId))&&-1!==i&&i>o&&o++,t.positionAfterId=e.positionAfterId),null==o||i===o||-1===i||-1===o?(t.positionBeforeId=n,void(t.positionAfterId=s)):(this.columns.splice(o,0,this.columns.splice(i,1)[0]),t.$patch())},this.canModify=this.gradebookPermissionService.canModify(),this.contextArea="grades",this.columns=e.columns,this.course=e.course(),this.hasColumns=!0,this.subscribeToReduxChanges(),this.categoryService.getOrLoadCategoriesForCourse(this.scope.course().id).then(e=>{e.forEach(e=>{this.categoryMap[e.id]=e})}),this.scope.showSetupOverallColumn&&this.loadSetupOverallGradeMessageIsHiddenPreference&&!this.setupOverallGradeMessageIsHiddenPreference&&this.loadSetupOverallGradeMessageIsHiddenPreference(C.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key).then(()=>{var e;const t="true"===(null===(e=this.setupOverallGradeMessageIsHiddenPreference)||void 0===e?void 0:e.value);this.showSetupOverallGradeMessage=!t}),e.$watchCollection("columns",t=>{t&&(this.columns=t,this.hasColumns=0!==t.length,this.attendanceColumnExists=this.columns.some(e=>e.isAttendance()),e.$broadcast("update-content-menu"))}),e.$on("content-item-mouseover",(t,n)=>{e.$apply(()=>{e.$broadcast("content-item-hover",n)})}),e.$on("course-gradebook-mouse-leave",()=>{e.$broadcast("content-outline-hover-end")}),e.$on("attempt-base-content-update",(e,t)=>{const n=this.columns.filter(e=>t.id===e.contentId);n.length>0&&n.forEach(e=>{e.$fetch()})}),e.$on("bb-change-overall-panel-visibility",(e,t,n)=>{var s;if(this.course.id!==t&&this.course.isComplete())return;const i="true"===(null===(s=this.setupOverallGradeMessageIsHiddenPreference)||void 0===s?void 0:s.value);this.showSetupOverallGradeMessage=i?!i:n})}subscribeToReduxChanges(){const e=this.$ngRedux.connect(e=>({setupOverallGradeMessageIsHiddenPreference:v.select.coursePreference.getCoursePreferenceByKeyAndCourseId(e,C.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key,this.course.id)}),e=>({loadSetupOverallGradeMessageIsHiddenPreference:t=>e(v.actions.coursePreference.loadCoursePreference({key:t,courseId:this.course.id}))}))(this);this.scope.$on("$destroy",e)}findGraderItemById(e){return i.find(this.columns,t=>t.id===e)}setupOverallGradeHideMessageCallback(){this.scope.$apply(()=>this.showSetupOverallGradeMessage=!1)}};S=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("scope")),Object(s.__param)(1,Object(y.b)("attrs")),Object(s.__param)(2,Object(y.b)(u.b)),Object(s.__param)(3,Object(y.b)("$ngRedux")),Object(s.__param)(4,Object(y.b)(h.i)),Object(s.__param)(5,Object(y.b)(p.b))],S);class I{constructor(e,t){this.$injector=e,this.timeout=t,this.restrict="E",this.template=f,this.scope={course:"&",columns:"=",showSetupOverallColumn:"=",isFirst:"=",attendanceIsAvailable:"&"},this.link=(e,t,n)=>{this.timeout(()=>{e.courseGradesGraderList=this.$injector.instantiate(S,{scope:e,element:t,attrs:n})},e)}}}I.$inject=["$injector",g.b],o.module(w,[d.a,m.c,r.a,c.b,l.a]).directive("bbCourseGradesGraderList",["$injector",b.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/course-grades-grader-list"),e.instantiate(I))]);var O=n("jhBu"),E=n("cbVV");var D;!function(e){e.USER="user",e.COLUMN="column",e.CATEGORY="category",e.NO_RESULT="noResult"}(D||(D={}));let k=class e{constructor(e,t,n){this.$rootScope=e,this.$q=t,this.bbLocalize=n}typeAheadSearch(t,n,s){const i=new RegExp("^.*"+t.replace(e.REGULAR_EXPRESSION_TOKENS,"\\$&")+".*$","i"),o=[];return this.searchUsersResults(i,t,s).forEach(e=>{o.push({type:D.USER,data:e})}),this.searchColumnResults(i,t,n).forEach(e=>{o.push({type:D.COLUMN,data:e})}),this.searchCategoryResults(i,t,n).forEach(e=>{o.push({type:D.CATEGORY,data:e,id:e.data.gradebookCategory.id})}),0===o.length&&o.push({type:D.NO_RESULT,data:null}),o}searchUsersResults(e,t,n){const s=[(()=>n=>{const s=(n,s)=>e.test(n)&&0===n.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())&&t.length>s;return s(`${n.user.givenName} ${n.user.familyName}`,n.user.givenName.length)||s(`${n.user.familyName} ${n.user.givenName}`,n.user.familyName.length)})(),(()=>t=>e.test(`${t.user.givenName}`))(),(()=>t=>e.test(`${t.user.familyName}`))(),(()=>t=>t.user.userName&&e.test(t.user.userName))(),(()=>t=>t.user.studentId&&e.test(t.user.studentId))()];return Object(i.orderBy)(n.filter(e=>{let n=0;const i=s.findIndex(t=>t(e));switch(i){case 1:n=e.user.givenName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());break;case 2:n=e.user.familyName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+.5;break;case 3:n=e.user.userName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+100;break;case 4:n=e.user.studentId.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+1e3}return e.ui._weight=n,i>=0}),["ui._weight","user.givenName","user.familyName"],["asc","asc","asc"])}searchColumnResults(e,t,n){const s=[(()=>t=>e.test(`${t.data.columnName}`))()],o=n.filter(e=>!(e instanceof E.l||e instanceof E.k));return Object(i.orderBy)(o.filter(e=>{let n=0;const i=s.findIndex(t=>t(e));return-1!==i&&(n=e.data.effectiveColumnName&&e.data.effectiveColumnName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())),e.weight=n,i>=0}),["weight","data.columnName"],["asc","asc"])}searchCategoryResults(e,t,n){const s=[(()=>t=>{const n=this.getCategoryTitle(t.data.gradebookCategory);return e.test(`${n}`)})()],o=n.filter(e=>!!e.data.gradebookCategory),a=Object(i.uniqBy)(o,e=>e.data.gradebookCategory.id);return Object(i.orderBy)(a.filter(e=>{let n=0;const i=s.findIndex(t=>t(e)),o=this.getCategoryTitle(e.data.gradebookCategory);return-1!==i&&(n=o.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())),e.weight=n,i>=0}),["weight","data.categoryTitle"],["asc","asc"])}getCategoryTitle(e){return e.isUserDefined?e.title:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$rootScope),key:e.localizableTitle.languageKey})}};k.REGULAR_EXPRESSION_TOKENS=/[-\/\\^$*+?.()|[\]{}]/g,k=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("$rootScope")),Object(s.__param)(1,Object(y.b)("$q")),Object(s.__param)(2,Object(y.b)(b.serviceName))],k);class $ extends k{}o.module("ultra.components.services.gradebookSearchbox",[b.moduleName]).service("gradebookSearchbox",k);var L=n("lr7J"),R=n("12mu"),j=n("pjml"),T=n("TnpK"),x=n("yC9S"),G=n("oQrK"),A=n("LN5R"),_=n("qH3X"),M=n("2o5C"),P=n("kp/p"),B=n("ERkP"),N=n("1ZbL"),F=n("SToD");class z extends B.Component{render(){const{analyticsId:e,courseId:t,currentUserId:n}=this.props;return B.createElement(C.StudentListView,{analyticsId:e,courseId:t,currentUserId:n})}}const U={Class:Object(F.a)(z),attributes:["analyticsId"],bindingNames:["courseId","currentUserId"],renderLocalized:!0,withProvider:!0};o.module("ultra.directives.grade.studentListViewTable",[]).component("bbStudentListViewTable",Object(N.a)(U));var V=n("fYJU");let H=class{constructor(e,t){this.scope=e,this.currentUserId=t.userId}};H=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("scope")),Object(s.__param)(1,Object(y.b)(V.b))],H);let q=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-student-list-view-table\n                        analytics-id="components.directives.grades.studentListView"\n                        course-id="studentListView.scope.courseId"\n                        current-user-id="studentListView.currentUserId"\n                      ></bb-student-list-view-table>',this.scope={courseId:"<"},this.link=e=>{e.studentListView=this.$injector.instantiate(H,{scope:e})}}};q=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("$injector"))],q),angular.module("ultra.components.directives.studentListView",["ultra.directives.grade.studentListViewTable"]).directive("bbStudentListView",["$injector",e=>e.instantiate(q)]);const K={Class:({showFixedView:e,courseId:t,analyticsId:n,setupOverallGradeHideMessageCallback:s})=>B.createElement(C.OverallGradeSetup,{analyticsId:n,showFixedView:e,courseId:t,setupOverallGradeHideMessageCallback:s}),attributes:["analyticsId"],bindingNames:["showFixedView","courseId","setupOverallGradeHideMessageCallback"],renderLocalized:!0,withProvider:!0,withThemeProvider:!0};o.module("ultra.directives.grade.overallGradeSetup",[]).component("bbOverallGradeSetup",Object(N.a)(K));let W=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-overall-grade-setup\n                        analytics-id="components.directives.grade.overall-panel"\n                        show-fixed-view="showFixedView"\n                        course-id="courseId"\n                        setup-overall-grade-hide-message-callback="setupOverallGradeHideMessageCallback">\n                      </bb-overall-grade-setup>',this.scope={showFixedView:"<",courseId:"<",setupOverallGradeHideMessageCallback:"&"}}};W=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("$injector"))],W),angular.module("ultra.components.directives.setupOverallGrade",["ultra.directives.grade.overallGradeSetup"]).directive("bbSetupOverallGrade",["$injector",e=>e.instantiate(W)]);var J=n("cpZm"),Z=n("zYa8"),Y=n("93oC");Object(Z.a)(Y.a,"ultra.components.directives.bbUiIcon.small.FilterOptions","bbUiIconSmallFilterOptions");var X=n("KvMR"),Q=n("884J"),ee=n("Y2MI");Object(Z.a)(ee.Settings,"ultra.components.directives.bbUiIcon.medium.Settings","bbUiIconMediumSettings");var te=n("3+vU"),ne=n("Pq3J");let se=class{constructor(e,t,n){this.$scope=e,this.$q=t,this.localizeService=n,this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.buttonAriaLabel").then(e=>this.buttonAriaLabel=e),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.title").then(e=>this.announcementTitle=e),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.content").then(e=>this.content=e),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.doneButtonText").then(e=>this.doneButtonText=e),this.translate("global.close").then(e=>this.closeLabel=e),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.moreInfoLinkText").then(e=>this.linkText=e),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.moreInfoLinkUrl").then(e=>this.linkHref=e)}translate(e){return this.localizeService.translate({locale:this.localizeService.getLocale(this.$scope),key:e,noWrap:!0,noEscape:!0})}};se=Object(s.__decorate)([Object(x.a)({moduleName:"ultra.components.directives.grade.gradebook-advanced-filters-ftue",componentName:"bbGradebookAdvancedFiltersFtue",template:ne,bindings:{},requireModules:[te.a]}),Object(s.__param)(0,Object(y.b)("$scope")),Object(s.__param)(1,Object(y.b)("$q")),Object(s.__param)(2,Object(y.b)(b.serviceName))],se);var ie=n("PxC7");Object(Z.a)(ie.a,"ultra.components.directives.bbUiIcon.medium.ContentView","bbUiIconMediumContentView");var oe=n("Sa5G"),ae=n("po/h"),re=n("dF44"),ce=n("ZzR9"),le=n("Y+9S"),de=n("ewIX");n.d(t,"c",(function(){return ue})),n.d(t,"a",(function(){return he})),n.d(t,"b",(function(){return pe}));const ue="ultra.directives.grade.courseGradesGrader",he="after-update-grades";var pe;!function(e){e.List="list",e.Grid="grid"}(pe||(pe={}));const me=new Set([pe.List,pe.Grid]),be=pe.List,ge=new Set([J.a.id,J.b.id]),ve=J.a.id;let fe=class{constructor(e,t,n,s,i,o,a,r,c,l,d,u){this.$modal=e,this.$location=t,this.scope=n,this.$q=s,this.entitlementService=i,this.grade=o,this.gradebookPermissionService=a,this.categoryService=r,this.ultraState=c,this.timeout=l,this.gradeSearchBox=d,this.bbLocalize=u,this.GRADE_COLUMN_LOAD_LIMIT=1e3,this.GRADE_COLUMN_RENDER_LIMIT=50,this.currentlyLoading=!1,this.categoryTitleMap={},this.allCategoriesLoaded=!1,this.isDesktop=!1,this.firstRender=!0,this.canDownloadGradebook=!1,this.canUploadGradebook=!1,this.showFilterCriteriaSettings=!1,this.mergedCourses=[],this.filteredColumns=[],this.filteredRows=[],this.advancedFiltersEmptyResults=!1,this.checkForURLFilters=()=>{const e=this.$location.search();this.hasUrlFilters=!!(e.memberId||e.gradebookColumnId||e.gradebookCategoryId||e.courseGroupId||e.childCourseId)},this.changeListViewType=e=>{ge.has(e)&&(this.currentTabId=e)},this.handleLocationChanged=()=>{var e;const t=null===(e=this.$location.search())||void 0===e?void 0:e.gradebookView;me.has(t)&&(this.view=t)};const p=c.params.gradebookView,m=c.params.listViewType;me.has(p)?this.view=p:this.view=be,ge.has(m)?this.currentTabId=m:this.currentTabId=ve,this.checkForURLFilters(),n.$on(ce.a.$locationChangeSuccess,this.checkForURLFilters),this.setupColumnUpdateResponder(),this.setupColumnDeleteResponder(),this.setupViewChange(),this.setupBreakpointChange(),this.setupListViewTypeChange(),this.isDesktop=G.a.detect().desktop(),this.userHasViewGradebookPermission=this.gradebookPermissionService.canView(),n.$on("bb-update-category-icon",(e,t,n)=>{t.categoryTitle=this.categoryTitleMap[n]}),n.$on(M.b,()=>{this.expandColumnSummaries(this.visibleColumns)}),n.$on(_.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,e=>{this.updateFilteredCount()}),n.$on(_.a.ADVANCED_FILTERS_COLUMNS,(e,t)=>{var n,s;this.filteredColumns=t,D.CATEGORY!==(null===(n=this.selectedItem)||void 0===n?void 0:n.type)&&D.COLUMN!==(null===(s=this.selectedItem)||void 0===s?void 0:s.type)||this.itemSelected(this.selectedItem)}),n.$on(_.a.ADVANCED_FILTERS_ROWS,(e,t)=>{var n;this.filteredRows=t,D.USER===(null===(n=this.selectedItem)||void 0===n?void 0:n.type)&&this.itemSelected(this.selectedItem)}),x.b.OnRootScope(n,h.b,(e,t)=>{const n=this.visibleColumns.find(e=>e.id===t.columnId);n&&(n.summary.$fetch(),this.scope.$root.$broadcast("bb-update-summary"),this.scope.$root.$broadcast("bb-update-category-icon",n),this.replaceOrInsertColumnWrapper(n),n.$fetch())}),this.canUploadGradebook=a.canModify(),this.scope.courseGrades.course.$then(e=>{e.isToolAvailable("bb-attendance").then(e=>{this.attendanceIsAvailable=e}),this.loadColumns(),this.course=e,this.loadMergedCourse(),this.canDownloadGradebook=a.canViewGrades()&&this.entitlementService.isEntitled("course.gradebook-data.export.EXECUTE",this.course.id),this.notifyMobileApp()})}notifyMobileApp(){if(Object(le.isInMobileApp)()){const e={showDownload:this.canDownloadGradebook,showSettings:this.userHasViewGradebookPermission},t={type:le.MessageType.CourseGradeOpened,status:le.MessageStatus.Success,permission:e},n=Object(le.registerMobileEventHandler)(t);n.response.subscribe(e=>this.mobileEventHandlerSubscriber(e)),this.scope.$on("$destroy",()=>{Object(le.clearMobileEventHandler)(n.correlationId)})}}mobileEventHandlerSubscriber(e){e.event===le.EventType.GotoSettings?this.ultraState.goPeekState(de.GradeRoutes.GRADE_SETTING):e.event===le.EventType.GotoDownload&&this.ultraState.goPeekState(de.GradeRoutes.GRADE_DOWNLOAD_SETTINGS)}get squareToggleValue(){return this.isGridView?pe.Grid:pe.List}set squareToggleValue(e){this.view=e}get areFilterResultsEmpty(){const e=this.filteredColumns.filter(e=>!(e instanceof E.k||e instanceof E.l));return this.hasUrlFilters&&(0===e.length||0===this.filteredRows.length||this.selectionNotAvailable)}clearSelection(){var e,t,n;D.USER===(null===(e=this.selectedItem)||void 0===e?void 0:e.type)?this.scope.$broadcast(re.b.ROW,this.filteredRows):D.CATEGORY!==(null===(t=this.selectedItem)||void 0===t?void 0:t.type)&&D.COLUMN!==(null===(n=this.selectedItem)||void 0===n?void 0:n.type)||this.scope.$broadcast(re.b.COLUMN,this.filteredColumns),this.selectedItem=void 0,this.selectionNotAvailable=!1}itemSelected(e){switch(this.clearSelection(),this.selectedItem=e,e.type){case D.USER:return this.selectUser(e);case D.COLUMN:return this.selectColumn(e);case D.CATEGORY:return this.selectCategory(e)}}selectUser(e){const t=e.data.user.id,n=this.filteredRows.findIndex(e=>e.userId===t);return this.selectionNotAvailable=-1===n,-1!==n&&this.scope.$broadcast(_.a.GRADEBOOK_USER_SELECTED,[t]),this.bbLocalize.formatUsernameSync(e.data.user,b.ILocaleUsernameFormat.Short,this.scope,{noWrap:!0,noEscape:!0})}selectColumn(e){const t=e.data.id,n=this.filteredColumns.findIndex(e=>e.id===t);return this.selectionNotAvailable=-1===n,-1!==n&&this.scope.$broadcast(_.a.GRADEBOOK_COLUMN_SELECTED,[t]),e.data.getMetadata().columnName}selectCategory(e){const t=e.id,n=this.filteredColumns.findIndex(e=>e.data.gradebookCategoryId===t);return this.selectionNotAvailable=-1===n,-1!==n&&this.scope.$broadcast(_.a.GRADEBOOK_CATEGORY_SELECTED,[t]),this.gradeSearchBox.getCategoryTitle(e.data.getMetadata().gradebookCategory)}typeAheadSearch(e){const t=this.gradeSearchBox.typeAheadSearch(e,this.filteredColumns,this.filteredRows);return this.$q.resolve(t)}renderMoreColumns(){if(this.currentlyLoading||this.firstRender)this.firstRender=!1;else if(this.columns.length<this.visibleColumns.length){const e=this.addColumns();this.scope.$root.$broadcast(L.a,"course-grades-grader",e)}}addColumns(){const e=this.$q.defer();return this.timeout(()=>{const t=this.columns.length;this.visibleColumns.length-t>this.GRADE_COLUMN_RENDER_LIMIT?this.columns.push(...this.visibleColumns.$slice(t,t+this.GRADE_COLUMN_RENDER_LIMIT)):this.columns=this.visibleColumns,e.resolve()},this.scope,1e3),e.promise}showGradeListContainer(){return this.allCategoriesLoaded&&(this.columns.length>0&&!this.hasUrlFilters||this.hasUrlFilters)}updateFilteredCount(){this.filteredCount=this.mergedCourses.filter(e=>!0===e.ui.checked).length}calculateCanAddOverallGrade(e,t){if(!this.gradebookPermissionService.canModify())return void(this.showSetupOverallColumn=!1);(!t||this.course.id===t)&&!this.course.isComplete()?this.showSetupOverallColumn=e:this.showSetupOverallColumn=!1}loadColumns(){this.currentlyLoading=!0;const e=this.grade.loadColumns(this.scope.courseGrades.course,!0,{expand:"collectExternalSubmissions",limit:this.GRADE_COLUMN_LOAD_LIMIT,offset:this.visibleColumns?this.visibleColumns.length:0});this.scope.$root.$broadcast(L.a,"course-grades-grader",e),e.then(e=>e.attachRelatedContentsByScoreProviderHandle(oe.r.Scorm)).then(e=>{this.removeNotVisibleColumns(e),this.visibleColumns&&this.visibleColumns.length>0?this.visibleColumns.concat(e):this.visibleColumns=e,this.totalColumnCount=e.paging.count,e.paging.nextPage?this.loadColumns():(this.currentlyLoading=!1,this.loadCategories(),this.grade.needsToSetupOverall(this.visibleColumns,this.course.id).then(e=>{this.calculateCanAddOverallGrade(e)}),this.visibleColumns.length>this.GRADE_COLUMN_RENDER_LIMIT?this.columns=this.visibleColumns.$slice(0,this.GRADE_COLUMN_RENDER_LIMIT):this.columns=this.visibleColumns,this.expandColumnSummaries(this.visibleColumns))})}expandColumnSummaries(e){const t=e.paging&&e.paging.count||1e3,n=this.course.gradebook.summaries.expandingColumns(e);return this.$q.all(i.range(0,t,1e3).map(e=>n.$fetch({limit:1e3,offset:e,excludeCalculations:!0}).$asPromise())).then(()=>e)}loadCategories(){this.categoryService.getOrLoadCategoriesForCourse(this.scope.courseGrades.course.id).then(e=>{e.forEach(e=>{this.categoryTitleMap[e.id]=e.title}),this.visibleColumns&&this.visibleColumns.forEach(e=>{e.gradebookCategoryId&&(e.categoryTitle=this.categoryTitleMap[e.gradebookCategoryId])}),this.allCategoriesLoaded=!0})}loadMergedCourse(){this.entitlementService.isEntitled(oe.i.ViewChildCourse,this.course.id)&&this.course.getChildrenCourses().then(e=>{const t=i.sortBy(e,e=>e.childCourse.name);this.mergedCourses.push(...t),this.mergedCourses.forEach(e=>{e.ui={checked:!1,hidden:!1}})})}setupColumnUpdateResponder(){this.scope.$on(h.c,(e,t)=>{this.replaceOrInsertColumnWrapper(t),t.summary.$fetch()}),this.scope.$on("content-update",(e,t)=>{if(t.isScorm()){t.getScormGradebookItems().forEach(e=>{const n=this.course.gradebook.columns.$buildRaw(e.gradingColumn);n.ui={content:t},this.replaceOrInsertColumnWrapper(n),n.summary.$fetch()})}}),this.scope.$on("bb-change-overall-panel-visibility",(e,t,n)=>{this.calculateCanAddOverallGrade(n,t)}),this.scope.$on("$stateChangeStart",(e,t,n,s)=>{if(s.name.indexOf("attendance")>-1){const e=this.visibleColumns.find(e=>e.isAttendance());e?e.$fetch().$asPromise().then(()=>this.removeNotVisibleColumns(this.columns)):this.loadColumns()}}),this.scope.$on(P.b,(e,t)=>{this.grade.loadColumns(this.scope.courseGrades.course,!0).then(e=>{this.visibleColumns=e,this.visibleColumns.forEach(e=>e.summary.$fetch()),this.scope.$broadcast(he,t)})})}replaceOrInsertColumnWrapper(e){const t=this.replaceOrInsertColumn(this.visibleColumns,e);this.columns!==this.visibleColumns&&t<this.columns.length&&this.replaceOrInsertColumn(this.columns,e)}replaceOrInsertColumn(e,t){let n=i.findIndex(e,e=>e.id===t.id);return n>-1?e[n]=t:(t.positionBeforeId?n="start"===t.positionBeforeId.toLowerCase()?0:i.findIndex(e,e=>t.positionBeforeId===e.id):t.positionAfterId&&("start"===t.positionAfterId.toLowerCase()?n=0:"end"===t.positionAfterId.toLowerCase()?n=e.length:(n=i.findIndex(e,e=>t.positionAfterId===e.id))>=0&&n++),n>=e.length||n<0?e.push(t):e.splice(n,0,t),this.totalColumnCount++),n>-1?n:0}_removeColumn(e,t){const n=i.findIndex(e,e=>e.id===t.id);n>-1&&e.splice(n,1)}removeNotVisibleColumns(e){let t=0;e.forEach((n,s)=>{!1===n.visibleInBook&&(e.splice(s,1),t++,n.isAttendance()&&(this.scope.$broadcast("bb-delete-column",n),this.scope.$root.$broadcast("bb-reload-grid-view"),this.attendanceIsAvailable=!1))}),e.paging.count=e.paging.count-t}setupColumnDeleteResponder(){this.scope.$on("bb-delete-column",(e,t)=>{this.removeColumn(t),t.externalGrade&&(this.scope.$root.$broadcast("bb-reload-grid-view"),this.scope.$root.$broadcast("bb-change-overall-panel-visibility",t.courseId,!0))})}removeColumn(e){if(this._removeColumn(this.visibleColumns,e),this.columns!==this.visibleColumns&&this._removeColumn(this.columns,e),this.totalColumnCount--,e&&e.contentId){const t=this.visibleColumns&&this.visibleColumns.find(t=>t.contentId===e.contentId);t&&this.removeColumn(t)}}setupViewChange(){this.scope.$watch("courseGradesGrader.view",()=>{var e;const t=!(null===(e=this.$location.search())||void 0===e?void 0:e.gradebookView);this.ultraState.search("gradebookView",this.view,{location:!t||"replace",notify:!1}),this.scope.$root.$broadcast(_.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,!0)}),this.scope.$on(ce.a.$locationChangeSuccess,this.handleLocationChanged)}setupListViewTypeChange(){this.scope.$watch("courseGradesGrader.currentTabId",()=>{this.ultraState.search("listViewType",this.currentTabId)})}setupBreakpointChange(){x.b.OnWindow("resize",i.debounce(()=>{a.k()&&this.isGridView&&(this.view=pe.List)},100),this.scope)}get isSmallScreen(){return a.k()}get isGridView(){return this.view===pe.Grid}get isGradableItemsListView(){return this.view===pe.List&&this.currentTabId===J.a.id}get isStudentListView(){return this.view===pe.List&&this.currentTabId===J.b.id}};fe=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("$modal")),Object(s.__param)(1,Object(y.b)("$location")),Object(s.__param)(2,Object(y.b)("scope")),Object(s.__param)(3,Object(y.b)("$q")),Object(s.__param)(4,Object(y.b)(O.b)),Object(s.__param)(5,Object(y.b)(h.i)),Object(s.__param)(6,Object(y.b)(u.b)),Object(s.__param)(7,Object(y.b)(p.b)),Object(s.__param)(8,Object(y.b)(T.d)),Object(s.__param)(9,Object(y.b)(g.b)),Object(s.__param)(10,Object(y.b)("gradebookSearchbox")),Object(s.__param)(11,Object(y.b)(b.serviceName))],fe);let Ce=class{constructor(e){this.$injector=e,this.restrict="E",this.template=ae,this.scope=!0,this.link=e=>{e.courseGradesGrader=this.$injector.instantiate(fe,{scope:e})}}};Ce=Object(s.__decorate)([Object(s.__param)(0,Object(y.b)("$injector"))],Ce),o.module(ue,[R.a,w,m.c,h.h,u.a,b.moduleName,L.b,j.N,A.b,J.c,"ultra.components.directives.studentListView","ultra.components.directives.setupOverallGrade","ultra.components.directives.bbUiIcon.medium.Settings",X.a,"ultra.components.directives.bbUiIcon.small.FilterOptions",Q.a,"ultra.components.services.gradebookSearchbox","ultra.components.directives.grade.gradebook-advanced-filters-ftue","ultra.components.directives.bbUiIcon.medium.ContentView"]).directive("bbCourseGradesGrader",["$injector",b.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/course-grades-grader"),e.instantiate(Ce))])},"gK/k":function(e,t,n){"use strict";var s=n("D57K"),i=n("nsO7"),o=n("Llzl"),a=n("9Fiv"),r=n("L2Kv"),c=n("TmUJ"),l=n("yC9S"),d=n("5Dl8"),u=n("dF44"),h=n("TML7"),p=n("kjyA"),m=n("aHpC");n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g}));const b="ultra.components.directives.gridReborn",g="bbGridReborn";let v=class{constructor(e,t,n,s,o,a){this.$scope=e,this.$element=t,this.$attrs=n,this.$injector=s,this.$q=o,this.debounce=a,this.containers=Object.create(null),this.afterCellDataUpdatedHooks=[],this.onColumnEvent=(e,t)=>{this.initializedWithOptions.then(()=>{t&&(this.options.columns=t),this.setDefaultValues(),this.afterCellDataUpdated(()=>{this.initStyles(),i.forEach(this.containers,e=>e.initColumnsPosition())}),i.forEach(this.splitColumns(),(e,t)=>{this.containers[t].resetColumns(e)})})},this.onRowEvent=(e,t)=>{this.initializedWithOptions.then(()=>{t&&(this.options.memberships=t),this.setDefaultValues(),this.initStyles(),this.initRowsPosition(),i.forEach(this.containers,e=>e.resetRows(t))})},this.onDataUpdate=()=>{this.debounceRefresh()},this.notifyScrollHorizontally=i.throttle(this.$scope.$broadcast.bind(this.$scope.$root,u.b.SCROLL_H),u.d),this.notifyScrollVertically=i.throttle(this.$scope.$broadcast.bind(this.$scope.$root,u.b.SCROLL_V),u.d),this.id="rb-grid-"+n.id,t.addClass(this.id),this.scrollbarWidth=Object(c.a)(),this.deferredInitWithOptions=o.defer(),this.initializedWithOptions=this.deferredInitWithOptions.promise;const r=e.$watch(n[g],e=>{e&&(this.initialize(e),r())});this.debounceRefresh=this.debounce.asDebounced(this.refreshImpl.bind(this),this.$scope,u.d),this.onWindowResize=this.debounce.asDebounced(this.onWindowResizeImpl.bind(this),this.$scope,u.d),l.b.OnWindow("resize",this.onWindowResize,e),e.$on(u.b.COLUMN,this.onColumnEvent),e.$on(u.b.ROW,this.onRowEvent),e.$on(u.b.DATA_UPDATE,this.onDataUpdate)}onWindowResizeImpl(){i.forEach(this.containers,e=>{e.adjustRows(),e.adjustColumns()})}initialize(e){this.options=e,this.setDefaultValues(),this.initStyles(),this.createContainers(),this.initRowsPosition(),this.initColumnsPosition(),this.deferredInitWithOptions.resolve(e)}initStyles(){const e=[],t=this.$element.find("style#rb-grid");e.push(`.${this.id} .rb-header-row {height: ${Object(d.b)(this.options.headerHeight)};}`),e.push(`.${this.id} .column-header-button-wrapper, .${this.id} .rb-add-column-placeholder {height: ${Object(d.b)(this.options.headerContentHeight)};}`),e.push(`.${this.id} .rb-cell-row {height: ${Object(d.b)(this.options.rowHeight)};}`),Array.prototype.push.apply(e,this.options.columns.map(e=>`.${this.id} .rb-col-${e.id} {width: ${Object(d.b)(e.columnWidth)};}`)),e.push(`.${this.id} .rb-grid-scrollbar-placeholder-x {height: ${Object(d.b)(this.scrollbarWidth)};}`),e.push(`.${this.id} .rb-grid-scrollbar-placeholder-y {width: ${Object(d.b)(this.scrollbarWidth)};}`),t.text(e.join("\n"))}initRowsPosition(){const e=this.options.memberships,t=[],n=this.$element.find("style#rb-grid-rows-initial-position");for(let n=0;n<e.length;n++)t.push(`.${this.id} .rb-row-position-${e[n].id} {top: ${Object(d.b)(n*this.options.rowHeight)};}`);n.text(t.join("\n"))}initColumnsPosition(){i.values(this.containers).forEach(e=>e.initColumnsPosition())}createContainers(){i.forEach(this.splitColumns(),(e,t)=>this.containers[t]=this.$injector.instantiate(a.a,{position:t,columns:e,grid:this})),this.containers.center.hasHScrollbar=!0,(this.containers.right||this.containers.center).hasVScrollbar=!0}setDefaultValues(e=this.options){e.headerContentHeight=e.headerContentHeight||e.headerHeight,e.headerBorder=!1!==e.headerBorder,e.rowBorder=!1!==e.rowBorder,e.columns.forEach(e=>{e.position=e.position||"center",e.border=!1!==e.border,e.focusable=!1!==e.focusable})}getFocusableColumns(){const e=this.containers.left,t=this.containers.right;return(e&&e.columns||[]).concat(this.containers.center.columns,t&&t.columns||[]).filter(e=>e.focusable)}splitColumns(e=this.options.columns){const t=i.groupBy(e,e=>e.position);return t.center=t.center||[],t}scrollContainers({scrollTop:e=-1,scrollLeft:t}){e>=0&&(this.notifyScrollVertically(e),i.forEach(this.containers,t=>{t.scrollVertically(e)})),null!=t&&(this.notifyScrollHorizontally(t),this.containers.center.scrollHorizontally(t))}scrollToLeft(e){this.scroll({scrollLeft:0},e)}scrollToRight(e){this.scroll({scrollLeft:this.containers.center.getMaxScrollLeft()},e)}scrollToRightWithTop(e,t){this.scroll({scrollLeft:this.containers.center.getMaxScrollLeft(),scrollTop:e},t)}scrollToTop(e){this.scroll({scrollTop:0},e)}scrollToBottom(e){this.scroll({scrollTop:this.containers.center.getMaxScrollTop()},e)}scroll(e,t){t&&this.afterCellDataUpdated(t),this.scrollContainers(e)}canAddColumn(){return!!this.options.callbacks.column}afterCellDataUpdated(e){this.afterCellDataUpdatedHooks.push(e)}applyAfterCellUpdatedOnce(){for(let e=0;e<this.afterCellDataUpdatedHooks.length;e++)try{this.afterCellDataUpdatedHooks[e]()}catch(e){console.error(e)}this.afterCellDataUpdatedHooks.length=0}refreshImpl(){i.forEach(this.containers,e=>e.applyData());const e=i.values(this.containers).reduce((e,t)=>e.concat(t.renderedColumns),[]);(this.options.callbacks.data||o.noop)(this.containers.center.renderedRows,e),this.$scope.$apply(),this.applyAfterCellUpdatedOnce()}};v=Object(s.__decorate)([Object(s.__param)(0,Object(m.b)("$scope")),Object(s.__param)(1,Object(m.b)("$element")),Object(s.__param)(2,Object(m.b)("$attrs")),Object(s.__param)(3,Object(m.b)("$injector")),Object(s.__param)(4,Object(m.b)("$q")),Object(s.__param)(5,Object(m.b)(p.b))],v);class f{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=h,this.transclude=!0,this.controller=v,this.controllerAs="grid",this.scope=!0}}f.$inject=["$injector"],o.module(b,[p.a]).directive(g,["$injector",e=>e.instantiate(f)]).directive(a.c,["$injector",e=>e.instantiate(a.b)]).directive(r.b,["$injector",e=>e.instantiate(r.a)])},gORw:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-move-item-up-down",use:"icon-small-move-item-up-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-move-item-up-down"><path d="M5 11V3M7 4L5 2 3 4M11 5v8M9 12l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},ga7A:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var s=n("Llzl"),i=n("pjml"),o=n("vhkR"),a=n("X455"),r=n("Youf"),c=n("Y+9S");const l="ultra.components.directives.content.contentItem.contentItemType.contentItemLtilaunch";class d{constructor(e,t,n){this.scope=e,this.ltiService=t,this.contextCourseMembership=n}ltiLaunch(){if(!this.scope.content.getContentDisplay().isLtiLink())throw new Error("Attempted to LTI launch a non-LTI content item. "+this.scope.content.contentHandler.toString());this.notifyMobileAppOnItemClick(),this.ltiService.ltiLaunch({courseId:this.scope.content.courseId,contentId:this.scope.content.id,content:this.scope.content,showPreLaunchPanel:!0})}notifyMobileAppOnItemClick(){const e={type:c.MessageType.LTILaunched,status:c.MessageStatus.Success,contentId:this.scope.content.id,contentTitle:this.scope.content.title,contentType:c.MobileContentType.LTIConnection};Object(c.sendMessageToMobile)(e)}ltiLinkNeedsApproval(){const e=this.ltiService.getDomainConfigStatusType(this.scope.content);return i.K.LTIStatusType.NeedsApproval.isEqualTo(e)}}d.$inject=["scope",o.b,a.d];class u{constructor(e){this.$injector=e,this.restrict="E",this.template=r,this.scope=!1,this.link=(e,t,n)=>{e.contentItemLtiLaunch=this.$injector.instantiate(d,{scope:e,element:t,attrs:n})}}}u.$inject=["$injector"],s.module(l,[o.a,a.a]).directive("bbContentItemLtilaunch",["$injector",e=>e.instantiate(u)])},h3DF:function(e,t,n){},h7qX:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c}));var s=n("Llzl"),i=n("nsO7");const o="ultra.components.directives.intersectionObserverRoot",a="intersection-observer-target-id",r="intersectionObserverTargetId";class c{constructor(e,t=s.noop,n=s.noop){this.element=e,this.inCallback=t,this.outCallback=n}getId(){return this.element.attr(a)}in(){this.inCallback()}out(){this.outCallback()}toElement(){return this.element.get(0)}}class l{constructor(t){this.targets=new Map,this.intersectionObserver=new IntersectionObserver(t=>{t.forEach(t=>{const n=this.targets.get(e(t.target).attr(a));n&&(t.isIntersecting?n.in():n.out())})},t)}observe(e){const t=e.getId();i.isEmpty(t)||(this.unobserve(t),this.targets.set(t,e),this.intersectionObserver.observe(e.toElement()))}unobserve(e){if(i.isEmpty(e))return;const t=this.targets.get(e);t&&(this.intersectionObserver.unobserve(t.toElement()),this.targets.delete(e))}disconnect(){this.intersectionObserver.disconnect(),this.targets.clear()}}class d{constructor(e,t){this.$scope=e,this.$element=t;const n=(e.rootOptions||(()=>({root:t.get(0),rootMargin:"0px 0px 0px 0px"})))();this.observer=new l(n),e.$on("$destroy",()=>this.unregisterAll())}registerTarget(e){this.observer.observe(e)}unregisterTarget(e){this.observer.unobserve(e.getId())}unregisterAll(){this.observer.disconnect()}}d.$inject=["$scope","$element"];class u{constructor(){this.restrict="A",this.scope={rootOptions:"&?"},this.controller=d}}s.module(o,[]).directive("bbIntersectionObserverRoot",["$injector",e=>e.instantiate(u)])}).call(this,n("5iHu"))},hDL0:function(e,t){e.exports='<div class="content-outline" bb-load-bundle="components/directives/content/content-outline">\n  <bb-add-content-button ng-if="!hideAddMenuOverride && canCreate"\n                         can-create-all-contents="canCreateAllContents"\n                         is-render-by-default="contentOutline.parentFolder.depth === 0"\n                         show-menu-override="contentOutline.shouldShowMenuOverride()"\n                         parent-id="contentOutline.parentFolder.id" root-content="contentOutline.parentFolder"\n                         position-before="\'start\'" item-name="contents[0].title"\n                         depth="(contentOutline.parentFolder.depth + 1)"\n                         always-show="contentOutline.shouldShowAddButton()" context-area="contentOutline.contextArea"\n                         can-copy-import="canCopyImport">\n  </bb-add-content-button>\n  <div class="add-element" ng-if="hideAddMenuOverride && !canCreate"> </div>\n  <div ng-if="contents">\n    <div class="content-outline-scroll-container"\n         bb-infinite-scroll="contentOutline.loadMoreChildren(contentOutline.parentFolder)"\n         infinite-scroll-immediate-check="true" infinite-scroll-disabled="contentOutline.isAllContentsLoaded()"\n         infinite-scroll-container="contentOutline.getScrollContainerSelector()"\n         infinite-scroll-listen-for-event="content-outline-infinite-scroll-check"\n         infinite-scroll-current-count="contents.length" infinite-scroll-total-count="contents.paging.count"\n         infinite-scroll-load-limit="contents.paging.limit"\n         infinite-scroll-tray-id="content-outline-{{::contentOutline.parentFolder.id}}"\n         infinite-scroll-focusable-children-selector=".content-title"\n         infinite-scroll-localization-keys-prefix="components.directives.content.content-outline.infiniteScroll.{{::contentOutline.contextArea === \'discussions\' ? \'discussions\' : \'content\'}}"\n         infinite-scroll-force-show-ancestor-selector="{{::contentOutline.getScrollForceShowSelector()}}"\n         sortable-parent>\n      <div class="content-outline-scroll-list" data-parent-id="{{::contentOutline.parentFolder.id}}">\n        <div class="js-content-div drag-element"\n             ng-class="{\'last\': $last, \'has-conversation-indicator\': content.ui.hasIndicator}"\n             ng-repeat="content in contents track by contentOutline.getContentTrackingId(content)" data-content-id="{{content.id}}"\n             ng-mouseenter="contentOutline.placeAddButton(content)">\n          <ng-switch on="(content.isFolder() && !content.isBbPage()) || content.isLearningModule()">\n            <div ng-switch-when="true">\n              <bb-folder root-content="contentOutline.parentFolder"\n                         on-file-drop-handler="contentOutline.onFileDropHandler"\n                         on-move-handler="contentOutline.onMoveHandler"\n                         on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler" contents="contents"\n                         content="content" next-content-id="contents[$index + 1].id"\n                         previous-content-id="contents[$index - 1].id"\n                         load-more-children="contentOutline.loadMoreChildren" can-create="canCreate"\n                         can-move="contentOutline.canMove" context-area="contentOutline.contextArea"\n                         can-copy-import="canCopyImport"></bb-folder>\n            </div>\n            <div ng-switch-when="false" bb-drag drag-item="::content.id" can-move="contentOutline.canMove">\n              <div ng-if="!content.isGroupContent || content.assignedGroups.length >= 0 || contentOutline.canMove">\n                <div bb-drop-handler on-file-drop-handler="contentOutline.onFileDropHandler"\n                     on-move-handler="contentOutline.onMoveHandler"\n                     on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler" content="content"\n                     root-content="contentOutline.parentFolder" next-content-id="contents[$index + 1].id"\n                     previous-content-id="contents[$index - 1].id">\n                  <div class="row collapse element-list-row js-course-skip-link-target" can-create="canCreate"\n                       can-move="contentOutline.canMove" bb-content-item-mouseover\n                       ng-class="{ \'element-list-row-extra-icon\': contentOutline.isProgressTrackingStateShown(content) }">\n                    <bb-content-item-base contents="contents" content="content" context-area="contentOutline.contextArea"\n                                          can-move="contentOutline.canMove"\n                                          item-before="contents[$index - 1]"\n                                          item-after="contents[$index + 1]"\n                                          ></bb-content-item-base>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </ng-switch>\n          <div id="add-button-placeholder{{content.id}}"\n               class="add-element-container"\n               ng-if="::canCreate">\n            <div ng-if="contentOutline.isAddContentButtonUnattached(content.id)"\n                 id="add-button-line{{content.id}}" class="add-element" tabindex="0" role="button"\n                 ng-class="{\'mobile-center-content-button\': contentOutline.isMobileDevice()}"\n                 aria-label="{{::contentOutline.getAddButtonLineLabel(content.title)}}"\n                 ng-focus="contentOutline.placeAddButton(content, true)">\n              <bb-svg-icon size="small" icon="add" class="mobile-add-content-icon" ng-if="contentOutline.isMobileDevice()"></bb-svg-icon>\n            </div>\n          </div>\n          <bb-progress\n              ng-if="contentOutline.cloudUploadInProgress[content.id]"\n              target-div="#progress{{content.id}}"\n              primary-key="\'progress\' + content.id"\n              display-results="false"\n          >\n          </bb-progress>\n        </div>\n        <div class="drag-element">\n          <div drag-item-id="{{contentOutline.placeholderContent.id}}"></div>\n          <div class="drop-placeholder" bb-drop-handler content="contentOutline.placeholderContent"\n               on-move-handler="contentOutline.onMoveHandler"\n               on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  \x3c!-- LRN-123904: For file upload content items `positionAfter` is set to `content.id` in course-outline.html. But when file upload is\n  in progress, `content.id` stays undefined. As a result `positionAfter` receives undefined.\n  `positionAfter` value is not used when `content.id` is not available. i.e.: When upload-in-progress file is very first item - `positionAfter` value is not\n  available, therefore `positionBefore` is used instead. --\x3e\n  <bb-add-content-button\n    class="movable-add-content-button movable-add-content-button-folder{{::contentOutline.parentFolder.id}}"\n    ng-hide="!contentOutline.addContentButtonLocation"\n    ng-if="::canCreate && !content.ui.importPlaceholder"\n    can-create-all-contents="canCreateAllContents"\n    content="contentOutline.addContentButtonLocation"\n    root-content="contentOutline.parentFolder"\n    is-button-location-changable="true"\n    parent-id="contentOutline.parentFolder.id"\n    position-after="contentOutline.addContentButtonLocation.id || contentOutline.addContentButtonLocation.positionAfter"\n    position-before="(contentOutline.addContentButtonLocation.id || contentOutline.addContentButtonLocation.positionAfter) ? null : contentOutline.addContentButtonLocation.positionBefore"\n    item-name="contentOutline.addContentButtonLocation.title"\n    depth="contentOutline.addContentButtonLocation.depth"\n    context-area="contentOutline.contextArea"\n    can-copy-import="canCopyImport">\n  </bb-add-content-button>\n</div>\n'},hFzC:function(e,t){e.exports='<div class="spinner bb-secondary-color-2" ng-if="!courseGradesStudent.gradesLoaded" aria-hidden="true"></div>\n\n<div class="base-grades course-grades-instructor" bb-load-bundle="components/directives/grade/course-grades-student" ng-if="courseGradesStudent.gradesLoaded">\n  <div class="is-empty-page" ng-if="!(courseGradesStudent.hasGrades || courseGradesStudent.externalGrade)">\n    <div class="is-empty-wrapper js-course-skip-link-target" tabindex="-1">\n      <div class="is-empty-explanation">\n        <img src="./static/images/ftue/ftuMMicon_StudentNoGrades.png" alt=""/>\n        <h1 bb-translate>components.directives.grade.course-grades-student.emptyCourseGradesHeader</h1>\n        <p bb-translate>components.directives.grade.course-grades-student.emptyCourseGradesContent</p>\n      </div>\n    </div>\n  </div>\n  <div class="grades-list" ng-if="courseGradesStudent.hasGrades || courseGradesStudent.externalGrade">\n    <aside role="complementary" class="student-grade-overview {{course.membership.getCourseColorClass()}}">\n      <div class="student-grade__header">\n        <div class="student-grade__header__name" ng-class="{\'show-for-large-up\': isUserStudent}">\n          <div class="element-card">\n            <bb-avatar user="courseGradesStudent.currentUser" class="left"></bb-avatar>\n            <div class="element-details left">\n              <bb-username class="name ellipse" user="courseGradesStudent.currentUser" show-pronouns="true" show-pronunciation="true"></bb-username>\n            </div>\n          </div>\n          <div bb-foundation-defer>\n            <bb-overflow-menu\n              ng-if="::!courseGradesStudent.isUserStudent"\n              element-id="{{::\'context-menu-open-button_\' + courseGradesStudent.currentUser.id}}"\n              element-name="{{::courseGradesStudent.getShortFormatUsername(courseGradesStudent.currentUser)}}"\n              menu-items="::courseGradesStudent.getOverflowMenuItems()"\n              analytics-id-tag-prefix="components.directives.grade.studentGrade.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n        </div>\n        <div class="student-grade__header__overallGrade overall-grade-running-total-wrapper">\n          <button\n            class="overall-grade-running-total-wrapper__visibility-icon"\n            ng-if="courseGradesStudent.showOverallGradeVisibilityInformation()"\n            analytics-id="components.directives.grade.studentGrade.overallGrade.visibilityInformationTooltip.button"\n            bb-tooltip\n            enhanced-tooltip="true"\n            tooltip-class-names="student-grade__header__overallGrade__tooltip"\n            tooltip-center-content="false"\n            tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n            tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n            tooltip-position="top"\n            bb-translate-attrs="{\'title\': \'course.grades.gradeVisibilityTooltip\',\n                                 \'aria-label\': \'course.grades.gradeVisibilityIcon\'}">\n            <bb-svg-icon size="small" icon="invisible"></bb-svg-icon>\n          </button>\n          <div class="overall-grade-running-total-wrapper__overall-label"\n               ng-if="!!courseGradesStudent.externalGrade && !courseGradesStudent.windowSizeService.isSmallBreakpoint()"\n               id="overall-grade-heading"\n               bb-translate>\n            components.directives.grade.course-grades-student.grade.currentGrade\n          </div>\n          <div bb-feature-toggle="feature.gradebook.calculate.running.total.or.not" delay-initial-load="false" class="overall-tooltip">\n            <button\n              bb-tooltip enhanced-tooltip="true" tooltip-position="top" tooltip-center-content="true"\n              tooltip-enable-on-mouse-over-for-all-breakpoints="true" tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n              analytics-id="components.directives.grade.studentGrade.pastDueZero.tooltip.button"\n              bb-translate-attrs="{\n                \'title\': \'components.directives.grade.course-grades-student.grade.tooltip.description\',\n                \'aria-label\': \'components.directives.grade.course-grades-student.grade.tooltip.ariaLabel\',\n              }"\n              translate-attrs-values="{ calculationPointsType: courseGradesStudent.isRunningTotal ? \'graded\' : \'possible\' }">\n              <bb-ui-icon-small-attention></bb-ui-icon-small-attention>\n            </button>\n          </div>\n          <div class="right" ng-if="!!courseGradesStudent.externalGrade" bb-guidance-target component-key="components.directives.grade.course-grades-student.grade.ftue">\n            <div>\n              <a\n                ng-if="::courseGradesStudent.isUserStudent"\n                bb-peek-sref="overall-grade-student({courseName: \'{{courseGradesStudent.getCourseName()}}\'})"\n                tabbable="true"\n                class="no-underline js-overall-grade-link"\n                aria-describedby="overall-grade-heading"\n                analytics-id="components.directives.grade.studentGrade.externalGrade.link">\n                <bb-display-grade-pill class="final-grade" cursor="pointer" column="courseGradesStudent.externalGrade.column" grade="courseGradesStudent.externalGrade" disable-rubric-eval-click="courseGradesStudent.disableRubricEvalClick()"></bb-display-grade-pill>\n              </a>\n              <bb-display-grade-pill ng-if="::!courseGradesStudent.isUserStudent" class="final-grade" column="courseGradesStudent.externalGrade.column" grade="courseGradesStudent.externalGrade" disable-rubric-eval-click="courseGradesStudent.disableRubricEvalClick()"></bb-display-grade-pill>\n              <bb-guidance alwaysShow="true" component-key="components.directives.grade.course-grades-student.grade.ftue"\n                           class="guidance-element-overlay push-right overall-grade-ftue">\n                <span bb-translate>components.directives.grade.course-grades-student.grade.ftue</span>\n              </bb-guidance>\n            </div>\n          </div>\n        </div>\n      </div>\n    </aside>\n\n    <div class="hide-for-small-only right send-msg-btn" ng-if="::!courseGradesStudent.isUserStudent && courseGradesStudent.targetMembership.isAvailable">\n      <bb-send-message-button-component\n        analytics-id-tag-prefix="components.directive.grade.studentGrade"\n        course-id="courseGradesStudent.scope.course.model.id"\n        recipient-ids="courseGradesStudent.currentUser.id"\n      ></bb-send-message-button-component>\n    </div>\n\n    <div class="row tabular-list-header course-grades-column-headers js-course-skip-link-target">\n      <div class="columns small-8 medium-4 tabular-list-header-offset text-left" bb-translate>components.directives.grade.course-grades-student.headings.assignment-name</div>\n      <div class="columns hide-for-small-only medium-2" bb-translate>components.directives.grade.course-grades-student.headings.due-date</div>\n      <div class="columns hide-for-small-only medium-2" bb-translate>components.directives.grade.course-grades-student.headings.status</div>\n      <div class="columns medium-4 large-2" bb-translate>components.directives.grade.course-grades-student.headings.grade</div>\n      <div class="columns hide-for-small-only medium-2" bb-translate>components.directives.grade.course-grades-student.headings.feedback</div>\n    </div>\n\n    <div class="row tabular-row js-row"\n         ng-class="{\'is-restricted-without-slash restricted-for-students\': grade.column.restricted, \'last-tabular-row-container\': $last}"\n         ng-repeat="grade in courseGradesStudent.userGrades"\n         ng-attr-bb-click-to-invoke-child="{{courseGradesStudent.isActionable(grade) && \'a.bb-click-target\' || undefined}}">\n      \x3c!--item name--\x3e\n      <div class="columns medium-4" ng-class="{\'is-restricted-without-slash\': grade.column.restricted, \'is-restricted\': !courseGradesStudent.isUserStudent && grade.column.isHidden()}">\n        <div class="element-card">\n          <div class="js-content-icon element-image" bb-content-item-icon content-column="grade.column" show-alert-icon="courseGradesStudent.isLate(grade)"></div>\n          <div class="element-details">\n            <div class="name ellipsis">\n              <a\n                ng-if="courseGradesStudent.isActionable(grade)"\n                class="bb-click-target"\n                ng-click="courseGradesStudent.openItem(grade)"\n                href="javascript:void(0);"\n                tabindex="0"\n                analytics-id="components.directives.grade.studentGrade.details.link">{{grade.column.columnName}}</a>\n              <span ng-if="!courseGradesStudent.isActionable(grade)">{{grade.column.columnName}}</span>\n              <span bb-translate ng-if="!courseGradesStudent.isActionable(grade)">\n                components.directives.grade.course-grades-student.disabledContent</span>\n            </div>\n            \x3c!--item description label--\x3e\n            <div class="name-controls" ng-if="courseGradesStudent.itemDescriptionLabelMap[grade.column.id]">\n              <span class="js-item-description-label wrap-text" ng-class="{\'text-alert-ax\': courseGradesStudent.isLate(grade)}">\n                {{courseGradesStudent.itemDescriptionLabelMap[grade.column.id]}}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      \x3c!--due date--\x3e\n      <div class="js-due-date date columns hide-for-small-only medium-2" ng-class="{late: courseGradesStudent.isLate(grade)}">\n        <div class="js-bb-student-assessment-duedate">\n          <bb-date ng-if="!grade.column.isAttendance()" format="Short">grade.column.dueDate</bb-date>\n          <span ng-if="grade.column.isAttendance()" bb-translate>components.directives.grade.course-grades-student.dueDate.ongoing</span>\n        </div>\n      </div>\n      \x3c!--status column--\x3e\n      <div class="js-status-column columns hide-for-small-only medium-2">\n        <div class="js-bb-student-status-column">\n          <span class="js-status-label"\n                bb-translate\n                translate-values="{gradeCount: grade.attempts.getNumAttemptsToReconcile() || 0, postCount: grade.attempts.getNumAttemptsToPost() || 1 }"\n                ng-class="{\'alert\': grade.isPastDueZero() && courseGradesStudent.isUserStudent}"\n          >{{courseGradesStudent.getStatusKey(grade)}}</span>\n        </div>\n      </div>\n      \x3c!--grade--\x3e\n      <div class="columns medium-4 large-2 grade-value">\n        <bb-display-grade-pill ng-if="courseGradesStudent.isActionable(grade)" column="grade.column" grade="grade" cursor="pointer" disable-rubric-eval-click="courseGradesStudent.disableRubricEvalClick(grade)"></bb-display-grade-pill>\n        <bb-display-grade-pill ng-if="!courseGradesStudent.isActionable(grade)" column="grade.column" grade="grade" cursor="default" disable-rubric-eval-click="true"></bb-display-grade-pill>\n        <button\n          class="alert-icon-wrapper"\n          ng-if="grade.isPastDueZero() && grade.attempts.getNumAttemptsSubmitted() == 0 && courseGradesStudent.isUserStudent"\n          bb-tooltip\n          enhanced-tooltip="true"\n          tooltip-position="top"\n          tooltip-center-content="true"\n          tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n          tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n          bb-translate-attrs="{\n            \'title\': !courseGradesStudent.isAttemptSubmittableAfterDueDate(grade) ?\n              \'components.directives.grade.course-grades-student.grade.noNewAttempts.pastDueZeroTooltip\' :\n              \'components.directives.grade.course-grades-student.grade.pastDueZeroTooltip\',\n            \'aria-label\': \'components.directives.grade.course-grades-student.grade.pastDueZeroIcon\'\n            }"\n          analytics-id="components.directives.grade.studentGrade.pastDueZero.tooltip.button"\n        >\n          <bb-svg-icon icon="attention" size="small" status="alert"></bb-svg-icon>\n        </button>\n      </div>\n      \x3c!--feedback indicator--\x3e\n      <div class="columns hide-for-small-only medium-2">\n        <div class="js-instructor-comments feedback-comment">\n          \x3c!--non interactive indicator that the instructor has left comments for this item (if attempt based, the latest attempt)--\x3e\n          <bb-svg-icon ng-if="grade.hasInstructorComments()" size="medium" icon="feedback" status="active"></bb-svg-icon>\n          <span class="sr-only" bb-translate ng-if="grade.hasInstructorComments()">components.directives.grade.course-grades-student.comment.aria-label</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},hKQ4:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-discussion",use:"icon-small-discussion-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-discussion"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="5" cy="8" r=".5" /><circle cx="8" cy="8" r=".5" /><circle cx="11" cy="8" r=".5" /></symbol>'});i.add(o);e.exports=o},ho2F:function(e,t){e.exports='<ul id="performanceCodes-{{gradeInput.id}}" class="f-dropdown performance-code-options bb-foundation-dropdown-close-esc-override" data-dropdown-content>\n  <li class="performance-option-header" bb-translate>components.directives.grade.grade-input.selectPerformanceCode</li>\n  <li ng-repeat="perfCode in gradeNotations()" bb-click-to-invoke-child="a.performance-code-option">\n    <a href="javascript:void(0);"\n       tabindex="0"\n       role="menuitem"\n       ng-click="gradeInput.clickGradeNotation(perfCode,$event)"\n       class="performance-code-option"\n       analytics-id="directives.gradeInput.selectPerformanceCode.item.link">\n      <span class="code" title="{{perfCode.code}}">{{perfCode.code}}</span>\n      <span class="description" title="{{perfCode.description}}">{{perfCode.description}}</span>\n    </a>\n  </li>\n  <li ng-if="gradeDetail.displayGrade.isOverride" class="undo-override" bb-click-to-invoke-child="button.js-undo-override">\n    <a href="javascript:void(0);"\n       tabindex="0"\n       role="menuitem"\n       class="js-undo-override performance-code-option"\n       ng-click="gradeInput.undoOverride()"\n       analytics-id="directives.grade-input.undoOverride.link">\n      <bb-svg-icon size="small" icon="undo"></bb-svg-icon>\n      <span bb-translate>components.directives.grade.grade-input.undoOverride</span>\n    </a>\n  </li>\n</ul>\n\n'},iViV:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var s=n("Llzl"),i=n("nsO7"),o=n("o5Lu"),a=n("3l3z"),r=n("LN5R"),c=n("TmUJ"),l=n("qH3X"),d=n("+4Px"),u=n("lEL+"),h=n("dF44"),p=n("lEWr");const m="ultra.components.directives.gradeGridCellEditorReborn";class b{constructor(e,t,n,s,i,o,a,r){this.$compile=e,this.window=t,this.scope=n,this.element=s,this.attrs=i,this.gradeGridRebornController=o,this.gradeService=a,this.timeout=r,this.initialize(),n.$on(l.a.REFRESH_CELL_EDITOR,()=>{this.initialize(),this.scope.gradeGridColumnReborn.getIsOtherGroupMemberGraded()}),n.$on("$destroy",()=>{this.removeErrorMessage()})}initialize(){this.score=this.scope.gradeGridColumnReborn.score,this.element.find("input").focus(),this.element.addClass("purple-outline"),this.timeout(()=>{this.element.find("input").select()},this.scope,0,!1),this.userName=this.scope.gradeGridColumnReborn.userName,this.checkValue(this.score).then(e=>{this.isValidated=e})}removeErrorMessage(){this.element.removeClass("validation-alert"),i.isUndefined(this.messageElement)||(this.messageElement.remove(),this.messageElement=void 0),i.isUndefined(this.messageScope)||(this.messageScope.$destroy(),this.messageScope=void 0)}createErrorMessage(){if(this.messageElement&&this.removeErrorMessage(),i.isUndefined(this.messageElement)){this.element.addClass("validation-alert");const e=this.element.parent(".grade-grid-cell").offset();e.top+=80,this.messageScope=this.scope.$new(!1,this.scope),this.messageScope.adjustPosition=t=>{const n=e.left+t.width(),s=e.top+t.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight();s>this.gradeGridRebornController.getGradeGridContainerElementBottom()&&(e.top-=t.height()+80),n>i&&(e.left-=n-i+Object(c.a)()),this.messageElement.offset(e)},this.$compile(b.CELL_MESSAGE_TEMPLATE)(this.messageScope,e=>{this.messageElement=e,this.element.parents("bb-grade-grid-reborn").append(this.messageElement)})}}get isValidated(){return this._isValidated}set isValidated(e){this._isValidated=e,this.isValidated?this.removeErrorMessage():this.createErrorMessage(),this.scope.gradeGridColumnReborn.isReadyToPost=this.score&&this.isValidated}stopPropagation(e){e.preventDefault(),e.stopPropagation()}mousedown(){e(this.window).trigger("click")}onChange(){this.checkValue(this.score).then(e=>{this.isValidated=e})}onInputBlur(e){this.scope.gradeGridColumnReborn.isPastDueZero&&""===this.score&&(this.score=this.scope.gradeGridColumnReborn.score),this.scope.gradeGridColumnReborn.onInputBlur(e,this.isValidated,this.score)}checkValue(e){const t=this.gradeGridRebornController.getGridData().getSchema()[this.scope.col.data.gradingSchemaId],n=this.gradeService.createGradeSubmission(this.scope.col.data,e,t);return this.gradeService.validateGrade(n,this.scope)}onKeydown(t){d.y(t)?(this.scope.gradeGridColumnReborn.gotoNextCell(),e(t.target).blur(),this.mousedown(),t.preventDefault(),t.stopPropagation()):t.keyCode===d.g?(e(t.target).blur(),this.mousedown(),this.scope.$emit(h.b.LEAVE_CELL)):d.x(t)&&(!this.score||t.keyCode!==d.j&&t.keyCode!==d.s?this.mousedown():t.stopPropagation())}}b.$inject=["$compile","$window","scope","element","attrs","gradeGridRebornController",o.i,u.b],b.CELL_MESSAGE_TEMPLATE='<div bb-grade-grid-message-reborn class="grade-grid-reborn-message" ng-mousedown="gradeGridMessageReborn.mousedown()"></div>';class g{constructor(e){this.$injector=e,this.restrict="A",this.template=p,this.require=`^${r.a}`,this.link=(e,t,n,s)=>{e.gradeGridCellEditorReborn=this.$injector.instantiate(b,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}g.$inject=["$injector"],s.module(m,[a.a]).directive("bbGradeGridCellEditorReborn",["$injector",e=>e.instantiate(g)])}).call(this,n("5iHu"))},j3m2:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-chat",use:"icon-small-chat-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-chat"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},jSqS:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("0JpG"),o=n("1ZbL"),a=n("ZQFV");const r="ultra.components.directives.grade.filterChips",c={Class:a.ConnectedFilterChips,renderLocalized:!0,withProvider:!0,attributes:["analyticsId"]};s.module(r,[i.moduleName]).component("bbFilterChips",Object(o.a)(c))},jbaE:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var s=n("D57K"),i=(n("ph44"),n("vhkR")),o=n("cs5G"),a=n("Llzl"),r=n("Fvsw"),c=n("Qbdf"),l=n("0JpG"),d=n("X8JP"),u=n("TnpK"),h=n("jx5I"),p=n("5MwF"),m=n("kBJj"),b=n("Q/M7"),g=n("pjml"),v=n("Y+9S"),f=n("aHpC"),C=n("6PRJ");const y="ultraUi.components.directives.editor.richTextEditor";let w=class{constructor(e,t,n,s,i,o,a,r,c,l,d,u,h,p,m){this.$q=e,this.$scope=t,this.element=n,this.attrs=s,this.controllers=i,this.bbEditorFactory=o,this.bbLocalize=a,this.bbContext=r,this.ltiService=c,this.CloudStorageIntegrationModalService=l,this.AnnotationsModel=d,this.contextCourse=u,this.allyService=h,this.ultraState=p,this.fileUploadSettingsService=m;const b=this.$scope.$watch("pluginOptions",e=>{e&&(b(),this.initEditor())});this.reactAllyService=this.allyService.getReactService(this.$scope),t.$on("$destroy",()=>{t.editor&&t.editor.destroy()})}initEditor(){let e=null,t=!1,n=null;const s=this.controllers.ngModel,i=s.$setPristine.bind(s);s.$viewChangeListeners.push(()=>{t||i()}),s.$setPristine=()=>{i(),n&&n(s.$modelValue)};const o=e=>{this.$scope.editor&&this.$scope.editor.update(e)};this.$scope.$watch(()=>s.$modelValue,t=>{t!==e&&o({bbml:t})}),this.$scope.$watchGroup(["isDisabled","isReadOnly","isToolbarHidden","allyIndexMap"],([e,t,n,s])=>{this.$scope.editor&&o({isDisabled:e,isReadOnly:t,isToolbarHidden:n,ally:{service:this.reactAllyService,indexMap:s}})});const a=(e,t)=>void 0!==e?e:t,r=e=>{this.$scope.fileLocation=e.data?e.data.fileLocation:e.fileLocation,this.$scope.webLocation=e.data?e.data.webLocation:e.webLocation},c=i=>{var o,a;t=i.isDirty,n=i.setPristine;const r=i.toBbML();e=r,s.$setViewValue(r),null===(a=(o=this.$scope).onChange)||void 0===a||a.call(o)},l={placeholderText:this.bbLocalize.translate({locale:this.bbLocalize.getLocale(this.$scope),key:this.$scope.placeholder})};this.$scope.pluginOptions&&this.$scope.pluginOptions.attachment&&(l.cloudStorageIntegration=this.CloudStorageIntegrationModalService.initialize()),this.$q.all(l).then(e=>{const t=[Object(m.customClass)()],{locale:n,babelfishInstance:i,babelfishFormatter:o,isRtl:l}=this.bbLocalize.getReactBabelfishParams(this.$scope);if(this.$scope.pluginOptions){!1!==this.$scope.pluginOptions.link&&t.push(Object(m.link)()),!1!==this.$scope.pluginOptions.image&&t.push(Object(m.image)()),!1!==this.$scope.pluginOptions.video&&t.push(Object(m.video)()),this.$scope.pluginOptions.math&&t.push(Object(m.math)({apiBasePath:Object(b.c)(p.a.apiBasePath),courseId:this.contextCourse.courseId,xsrfToken:this.bbContext.xsrfToken})),this.$scope.pluginOptions.attachment&&t.push(Object(m.insertLocalFile)({apiBasePath:Object(b.c)(p.a.apiBasePath),xsrfToken:this.bbContext.xsrfToken,webLocation:this.$scope.webLocation||"",fileLocation:this.$scope.fileLocation||"",onUploadSuccess:r,buttonId:Object(v.isInMobileApp)()?"insertFile":"",supportsInlineDocumentRender:this.$scope.supportsInlineDocumentRender,fileUploadSettings:this.fileUploadSettingsService.getSettings()}));let e=!0;!1===this.$scope.pluginOptions.youtubeVideo&&(e=!1),e&&t.push(Object(m.insertYoutubeVideo)({apiBasePath:Object(b.c)(p.a.apiBasePath),getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService),xsrfToken:this.bbContext.xsrfToken,courseId:this.contextCourse.courseId})),this.$scope.pluginOptions.demoMashup&&t.push(Object(m.demoMashup)()),this.$scope.pluginOptions.attachment&&this.CloudStorageIntegrationModalService.isCloudServiceAvailable&&!Object(v.isInMobileApp)()&&t.push(Object(m.insertCloudStorageIntegrationFile)({openCloudStorageIntegrationModal:this.CloudStorageIntegrationModalService.getModalCallback(this.$scope),apiBasePath:Object(b.c)(p.a.apiBasePath),xsrfToken:this.bbContext.xsrfToken,webLocation:this.$scope.webLocation||"",fileLocation:this.$scope.fileLocation||"",fileUploadSettings:this.fileUploadSettingsService.getSettings()})),this.$scope.pluginOptions.contentMarket&&t.push(Object(m.contentMarket)({apiBasePath:Object(b.c)(p.a.apiBasePath),getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService),noInsert:this.$scope.contentMarketIsReadOnly,openContentMarket:this.ltiService.getOpenContentMarketConf(this.$scope),xsrfToken:this.bbContext.xsrfToken}))}let d=this.$scope.rootContentId;!d&&this.ultraState&&this.ultraState.getCurrentResolvedValues&&this.ultraState.getCurrentResolvedValues().currentContent&&(d=this.ultraState.getCurrentResolvedValues().currentContent.id);const u={bbml:s.$modelValue||"",isDisabled:a(this.$scope.isDisabled,!1),isReadOnly:a(this.$scope.isReadOnly,!1),isToolbarHidden:a(this.$scope.isToolbarHidden,!1),isRtl:l,locale:n,expandInlineFilesOnLoad:this.$scope.expandInlineFilesOnLoad,supportsInlineDocumentRender:this.$scope.supportsInlineDocumentRender,babelfishInstance:i,babelfishFormatInstance:o,onChange:c,placeholder:e.placeholderText,plugins:t,editorId:this.$scope.editorId,ariaLabelledBy:this.$scope.editorAriaLabelledBy,ariaDescribedBy:this.$scope.editorAriaDescribedBy,showWordCount:this.$scope.showWordCount,ally:{service:this.reactAllyService,indexMap:this.$scope.allyIndexMap||new Map},rootContentId:d,...this.$scope.onFocus?{onFocus:()=>this.$scope.$applyAsync(this.$scope.onFocus)}:null,...this.$scope.onBlur?{onBlur:()=>this.$scope.$applyAsync(this.$scope.onBlur)}:null,...p.a.unitTesting?{mockLocalize:Object(C.a)()}:null};this.$scope.onBlur&&s.$setTouched(),this.$scope.editor=this.bbEditorFactory(this.element[0],u)})}getOnDownloadWithAnnotations(){return t=>{const n=!!t.groupAttemptFileId,s=t.attemptFileId||t.groupAttemptFileId,i={systemInfo:this.bbContext.getSystemInfo().$asPromise(),annotations:this.AnnotationsModel.downloadWithAnnotations(s,n,this.contextCourse.courseId).$asPromise()};return this.$q.all(i).then(t=>{const n=t.systemInfo.annotationRendererUrl;if(!(n&&n.length>0))throw new Error("Annotation Service url is not defined.");{const s=e("#annotationIframe");null!==s&&s.remove();const i=e("#annotationForm");null!==i&&i.remove();const o=e(document.createElement("iframe"));o.attr("src","about:blank"),o.attr("id","annotationIframe"),o.attr("name","annotationIframe"),o.css("display","none");const a=e(document.createElement("form"));a.attr("target","annotationIframe"),a.attr("method","POST"),a.attr("action",n+"/annotation/token"),a.attr("id","annotationForm"),a.attr("name","annotationForm");const r=e(document.createElement("input"));r.attr("type","hidden"),r.attr("name","jwt"),r.attr("value",t.annotations.jwt),r.appendTo(a);const c=e("body");a.appendTo(c),o.appendTo(c),a.submit()}})}}};w=Object(s.__decorate)([Object(s.__param)(0,Object(f.b)("$q")),Object(s.__param)(1,Object(f.b)("scope")),Object(s.__param)(2,Object(f.b)("element")),Object(s.__param)(3,Object(f.b)("attrs")),Object(s.__param)(4,Object(f.b)("controllers")),Object(s.__param)(5,Object(f.b)("BbEditorFactory")),Object(s.__param)(6,Object(f.b)(l.serviceName)),Object(s.__param)(7,Object(f.b)(r.b)),Object(s.__param)(8,Object(f.b)(i.b)),Object(s.__param)(9,Object(f.b)(d.b)),Object(s.__param)(10,Object(f.b)(g.c.serviceName)),Object(s.__param)(11,Object(f.b)(c.e)),Object(s.__param)(12,Object(f.b)(o.b)),Object(s.__param)(13,Object(f.b)(u.d)),Object(s.__param)(14,Object(f.b)(h.b))],w);class S{constructor(e){this.$injector=e,this.link=(e,t,n,s)=>{t.addClass("rich-text-editor"),e.richTextEditor=this.$injector.instantiate(w,{scope:e,element:t,attrs:n,controllers:s})},this.require={ngModel:"ngModel"},this.restrict="E",this.scope={contentMarketIsReadOnly:"<?",fileLocation:"=?",isDisabled:"<?",isReadOnly:"<?",isToolbarHidden:"<?",onChange:"<?",onBlur:"&?",onFocus:"&?",placeholder:"@?editorPlaceholderKey",pluginOptions:"<?",webLocation:"=?",editorId:"@?",editorAriaLabelledBy:"@?",editorAriaDescribedBy:"@?",showWordCount:"<?",allyIndexMap:"=?",rootContentId:"@?",expandInlineFilesOnLoad:"<?",supportsInlineDocumentRender:"<?"}}}S.$inject=["$injector"],a.module(y,[l.moduleName,r.a,d.a,i.a,o.a,h.a]).value("BbEditorFactory",m.BbEditorFactory).directive("bbRichTextEditor",["$injector",e=>e.instantiate(S)])}).call(this,n("5iHu"))},jlIo:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-code",use:"icon-small-code-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-code"><path d="M4 3L1 8l3 5M12 3l3 5-3 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},jmkQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n("Llzl"),i=n("nsO7"),o=n("h7qX");const a="ultra.components.directives.intersectionObserverTarget";class r{constructor(){this.require="^^bbIntersectionObserverRoot",this.restrict="A",this.scope={[o.b]:"@",inCallback:"&?",outCallback:"&?"},this.link=(e,t,n,s)=>{i.isEmpty(e[o.b])||(t.attr(o.a,e[o.b]),e.target=new o.c(t,e.inCallback,e.outCallback),s.registerTarget(e.target),e.$on("$destroy",()=>{s.unregisterTarget(e.target)}))}}}s.module(a,[]).directive("bbIntersectionObserverTarget",["$injector",e=>e.instantiate(r)])},k6nO:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-trash",use:"icon-medium-trash-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-trash"><path d="M3.5 7h17M3 4l2 19h14l2-19M8 4V1h8v3M2 4h20M8 10l1 10M12 10v10M16 10l-1 10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},kC07:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return ae})),n.d(t,"a",(function(){return re}));var s=n("D57K"),i=(n("DXZ4"),n("Ne7M"),n("yiTm"),n("UEFj"),n("j3m2"),n("ueuW"),n("85nY"),n("hKQ4"),n("/9iQ"),n("7XaY"),n("Mnbc"),n("NEyJ"),n("p/lC"),n("nsO7")),o=n("Llzl"),a=n("yC9S"),r=n("+O05"),c=n("FpRh"),l=n("laCM"),d=n("cs5G"),u=n("nYZ0"),h=n("bhWV"),p=n("xAaQ"),m=n("ga7A"),b=n("z+6U"),g=n("LFd7"),v=n("Fvsw"),f=n("Et3n"),C=n("5Tom"),y=n("Qbdf"),w=n("X455"),S=n("bF8R"),I=n("UioO"),O=n("jhBu"),E=n("Oyr+"),D=n("ujI6"),k=n("0JpG"),$=n("vhkR"),L=n("w9Zy"),R=n("r6lH"),j=n("lEL+"),T=n("Tn43"),x=n("lmMM"),G=n("4nF1"),A=n("IWgv"),_=n("LecS"),M=n("UGfE"),P=n("Ocaa"),B=n("Sa5G"),N=n("oi1r"),F=n("pjml"),z=n("JNtI"),U=n("0rzL"),V=n("nmzr"),H=n("TnpK"),q=n("a2qY"),K=n("aTRN"),W=n("+4Px"),J=n("agzH"),Z=n("BLb8"),Y=n("aHpC"),X=n("/5AG"),Q=n("Htol"),ee=n("JfV0"),te=n("zGdY"),ne=n("kcGO"),se=n("9OUN"),ie=n("CY5M"),oe=n("Y+9S");const ae="ultra.directives.contentItemBase",re="base-content-item";let ce=class{constructor(e,t,n,s,o,r,c,l,d,u,h,p,m,b,g,v,f,C,y,w){this.$q=t,this.$rootScope=n,this.$ngRedux=s,this.element=o,this.scope=r,this.CourseModel=c,this.schemaService=l,this.contentService=d,this.contextService=u,this.contextCourse=h,this.contextCourseMembership=p,this.courseContentService=m,this.entitlementService=b,this.localizeService=g,this.ltiService=v,this.telemetryService=f,this.timeoutService=C,this.ultraState=y,this.allyService=w,this.courseLinkContentHandler=F.p.ContentHandler.CourseLink,this.disableRestricted=!1,this.displayTelemetryUserActivity=!1,this.displayTelemetryDiscussionActivity=!1,this.entitledToDesignAssessment=!1,this.isModifyPermissionLoaded=!1,this.isGettingConfirmationOptions=!1,this.getNextReviewState=()=>te.ContentReviewState.Started===this.contentReviewState?te.ContentReviewState.Completed:te.ContentReviewState.Completed===this.contentReviewState?te.ContentReviewState.Started:null,this.onReviewStateIconClick=()=>{const e=this.getNextReviewState();if(!this.scope.content.canUpdateReviewState()||this.scope.content.inSequence||!e||!this.scope.content.courseId||!this.scope.content.id)return this.$q.resolve();const t=this.updateContentReviewState(this.scope.content.courseId,this.scope.content.id,e);return this.$q.when(t).then(()=>{})},this.showEditButtonFromLTILink=()=>!this.isExcludedOrDeletedLtiToolProvider()&&!!this.ltiService.placementExists(this.scope.content),this.displayGradeInfo=!1,this.isLate=!1,this.scope.shouldShowContent=!0,this.canViewGroups=this.entitlementService.isEntitled(B.o.ViewGroups),this.hasViewGroupsAsAdmin=this.entitlementService.isEntitled(B.o.ViewGroupsAsAdmin),this.courseId=h.courseId?h.courseId:this.ultraState.params.courseId,this.conditionalRelease=e.instantiate(K.a,{scope:r}),this.subscribeToReduxChanges(),!this.courseProgressConfiguration&&this.retrieveCourseProgressConfiguration&&this.retrieveCourseProgressConfiguration({courseId:this.courseId}),this.scope.content.$then(e=>{this.entitlementService.hasAnyCourseEntitlement([B.i.ModifyAssessment,B.i.ViewAssessment],e.courseId).then(t=>{if(this.entitledToDesignAssessment=t,this.isModifyPermissionLoaded=!0,e.canHaveAttempts()&&!this.entitledToDesignAssessment&&e.contentDetail){const t=e.getAssociatedGradingColumn(),n=c.$new(e.courseId).gradebook.columns.$buildRaw(t);let s;this.scope.gradingColumn=n,(s=this.displayGradeInfo?this.courseContentService.loadContentAndGrades({course:this.CourseModel.$buildRaw({id:e.courseId}),content:e,column:n}):this.$q.when({courseContent:e,gradingColumn:n})).then(e=>{this.displayGradeInfo&&this.scope.gradingColumn.isLate()&&(!e.gradeDetail||e.gradeDetail.ui.attempt.isInProgress())&&(this.isLate=!0),this.isGradeLoaded=!0,e.gradeDetail&&e.gradeDetail.column.id===n.id&&(this.scope.gradeDetail=e.gradeDetail)})}else this.isLate=!1,this.isGradeLoaded=!0}),this.entitlementService.hasAnyCourseEntitlement([B.n.ViewGrades],e.courseId).then(e=>{this.canViewQuestionAnalysis=e}),this.contextService.getSystemInfo().$asPromise().then(e=>{e.telemetryEnabled&&(this.telemetryService.determineContentSupportsActivityData(this.scope.content).then(e=>{this.displayTelemetryUserActivity=e&&!this.contextCourseMembership.isStudentMembership()}),this.displayTelemetryDiscussionActivity=this.shouldShowDiscussionAnalytics()&&!this.contextCourseMembership.isStudentMembership())}),this.allyService.isAvailable().then(e=>{e&&this.allyService.isAllySupportedContentItem(this.scope.content)?(this.canShowAlly=!0,this.updateAlly()):this.canShowAlly=!1}),r.content.title||F.p.ContentHandler.UltraAssignment.isEqualTo(this.scope.content.contentHandler)||F.p.ContentHandler.TestLink.isEqualTo(this.scope.content.contentHandler)||this.localizeService.loadBundle("features/course/content/course-content").then(()=>{r.content.title=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"course.content.contentTitlePlaceholder"})});const t=e=>{e.getLinkContentSource().$then(e=>{this.targetContent=e,this.contentHandler=e.contentHandler&&e.contentHandler.toString()},t=>{403===t.$response.status&&i.remove(this.scope.contents,t=>t.$pk===e.$pk)})};this.scope.$watch("::content.id",()=>{if(F.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler))if(this.scope.content.contentDetail)t(this.scope.content);else{const e=this.scope.$watch("content.isConditionalReleaseUnlocked()",n=>{n&&(t(this.scope.content),e())})}}),Object(Z.b)(this.scope,(e,t)=>{this.scope.content.isConditionalReleaseLocked()&&this.scope.content.containsCriteriaWithGradeColumnId(t)&&Object(Z.c)(this.scope,t)}),Object(Z.a)(this.scope,()=>{this.scope.content.isConditionalReleaseLocked()&&Object(Z.c)(this.scope)}),a.b.OnRootScope(this.scope,"grade-attempt",(e,t,n)=>{this.scope.content.id===t&&(this.scope.gradeDetail=n)}),r.content.contentHandler?r.content.isBbPage()?this.contentHandler=F.p.ContentHandler.Document.toString():this.contentHandler=r.content.contentHandler.toString():this.contentHandler=F.p.ContentHandler.Document.toString(),this.disableRestricted=F.p.ContentHandler.PartnerCloud.isEqualTo(this.contentHandler),this.conditionalRelease.getConditions(this.scope.content),this.hasViewB2Entitlement()}),this.scope.$on("refresh-conditional-release-rules",(e,t)=>{this.scope.content.id===t.id&&this.conditionalRelease.getConditions(t)}),this.scope.$on("content-update",(e,t)=>{this.scope.content.id!==t.id||this.scope.content.ui.linkSource||(this.scope.content=t),this.scope.content.ui.linkSource&&this.scope.content.ui.linkSource.id===t.id&&(this.scope.content.ui.linkSource=t);const n=this.scope.content.getDueDate();this.scope.dueDate=n&&new Date(n)}),this.scope.$on("bb-update-CR-tooltip",(e,t,n,s)=>{t&&(this.conditionalRelease.gradeCriteria&&this.conditionalRelease.gradeCriteria.gradeColumnId)===t.id&&this.conditionalRelease.getConditions(this.scope.content,n,s)}),this.scope.$on("show-override-message",(e,t,n)=>{this.scope.content&&this.scope.content.id===n&&(t?(this.scope.shouldShowContent=!1,this.overrideMessage=t):this.scope.shouldShowContent=!0)});const S=i.once(()=>{this.scope.$watch(()=>this.scope.content.getDueDate(),e=>{this.scope.dueDate=e&&new Date(e)})});this.scope.$watch("content.contentHandler",()=>{r.content.ui.importPlaceholder||S()}),this.scope.$on("discussion-group-content-update",(e,t)=>{this.scope.content&&F.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.contentDetail&&this.scope.content.getLinkContentSource().$then(e=>{e.id===t.id&&this.scope.content.applyGroupSettings(t)})})}get contentReviewState(){return this.scope.content.state}set contentReviewState(e){e&&this.scope.content&&(this.scope.content.state=e)}subscribeToReduxChanges(){const e=this.$ngRedux.connect(e=>({contentReviewState:ee.select.contentReviewState.getContentReviewStateForContextUser(e,this.scope.content.id),courseProgressConfiguration:ee.select.courseProgress.getCourseProgressConfiguration(e,this.courseId)}),e=>Object(se.bindActionCreators)({updateContentReviewState:ee.actions.contentReviewState.persistContentReviewState,retrieveCourseProgressConfiguration:ee.actions.courseProgress.loadCourseProgressConfiguration},e))(this);this.scope.$on("$destroy",e)}isEngagementOutline(){return"discussions"===this.scope.contextArea}getDescription(){return this.scope.content.systemGeneratedLocalizableDescription?this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:this.scope.content.systemGeneratedLocalizableDescription.languageKey}):this.scope.content.description}getAriaDescribedBy(){let e="content-item-icon-"+this.scope.content.id;return this.scope.content.ui.hasIndicator&&(e+=" activity-indicator-"+this.scope.content.id),e}getDeleteConfirmationKeyAndShowType(){return this.contentService.generateDeleteConfirmationKey(this.scope.content,this.scope.contextArea).then(e=>({confirmationKey:this.scope.content.ui.deleteConfirmationKey,showType:this.scope.content.ui.modalShowType}))}deleteContent(){F.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)?this.scope.content.getLinkContentSource().$then(e=>{this._deleteContent(e)}):(this._deleteContent(this.scope.content),this.$rootScope.$broadcast("bb-update-CR-tooltip",this.scope.content.getAssociatedGradingColumn(),"",!0))}_deleteContent(t){F.p.ContentHandler.Discussion.isEqualTo(t.contentHandler)?t.getSoftLinks().$asPromise().then(e=>{e.length?this.$q.all(e.map(e=>this.CourseModel.$new(t.courseId).contents.$new(e.courseContent).$fetch().$asPromise().then(e=>{this.$rootScope.$broadcast("deleteContent",e,!1)}))).then(()=>{this.$rootScope.$broadcast("deleteContent",t)}):this.$rootScope.$broadcast("deleteContent",t)}):this.$rootScope.$broadcast("deleteContent",t);const n=this.element.closest(".js-content-div"),s=n.next(".js-content-div");if(s.length>0)s.find(".js-content-item-base").first().find(".content-title").focus();else{const t=n.prev(".js-content-div");if(t.length>0)t.find(".js-content-item-base").first().find(".content-title").focus();else{const t=n.closest(".folder");t.length>0?t.find(".js-content-item-base").first().find(".content-title").focus():this.timeoutService(()=>{e(".js-create").focus()},this.scope.$root,0,!1)}}}hasSupportedConversation(){return!!this.scope.content.hasConversation()&&G.a.create(this.scope.content).supportsConversations()}shouldShowAlertIcon(){return this.isLate||this.scope.content.canViewAsInstructor()&&this.isUnlaunchableLtiLink()}shouldShowDiscussionAnalytics(){return this.scope.content.contentHandler&&B.f.Discussion.isEqualTo(G.a.create(this.scope.content).viewHandler())}shouldShowScormAnalysisReport(){return this.scope.content&&this.entitlementService.isEntitled(B.n.FullGradebookAccess,this.scope.content.courseId||this.courseId)&&this.scope.content.isScorm()&&this.scope.content.hasReport()}isUnlaunchableLtiLink(){return this.scope.content.id&&this.scope.content.getContentDisplay().isLtiLink()&&(!this.scope.content.getContentDisplay().isXplorLtiLink()&&!this.ltiService.getLaunchLinkFromContent(this.scope.content)||void 0!==this.ltiService.placementExists(this.scope.content)&&!this.ltiService.placementExists(this.scope.content))}hasViewB2Entitlement(){this.entitlementService.hasSystemEntitlement(B.u.ViewBuildingBlock).then(e=>this.canViewB2=e)}hasLTIToolConfigurationEntitlement(){return this.canViewB2}isExcludedOrDeletedLtiToolProvider(){const e=this.ltiService.getDomainConfigStatusType(this.scope.content);return this.scope.content.id&&this.scope.content.getContentDisplay().isLtiLink()&&(void 0!==this.ltiService.ltiToolProviderExists(this.scope.content)&&!this.ltiService.ltiToolProviderExists(this.scope.content)||F.K.LTIStatusType.Excluded.isEqualTo(e))}showVisibility(){return!this.isUnlaunchableLtiLink()}usesEditButton(){const e=this.scope.content.getContentDisplay();return e.usesEditButton()&&e.canUseEditButton()}openEditContentPanel(){this.ultraState.goPeekState(this.scope.content.getContentDisplay().getEditState(),this.scope.content.getContentDisplay().getEditStateParams())}updateContentVisibility(){return this.targetContent&&this.scope.content?(this.targetContent.applyAvailabilitySettings(this.scope.content),this.updateVisibilityImpl(this.targetContent).then(()=>this.updateVisibilityImpl(this.scope.content))):this.scope.content?this.updateVisibilityImpl(this.scope.content):this.$q.resolve()}updateVisibilityImpl(e){e.visibility=this.contentService.determineVisibility(e.isAvailable);const t=["isAvailable","isPartiallyVisible","adaptiveReleaseRules"],n=e.getAssociatedGradingColumn();return n&&(n.visible=e.isAvailable,t.push("contentDetail")),e.withParams({fields:"id"}).$save(t).$asPromise().then(()=>{this.$rootScope.$broadcast("content-update",e)})}updateAlly(){this.canShowAlly&&this.allyService.update(this.scope,this.scope.content.id,this.allyService.getXythosIdFromContentItem(this.scope.content))}getOverflowMenu(){return[{icon:"draw",labelKey:"global.edit",show:()=>{var e,t;let n=this.isGettingConfirmationOptions?this.lastIsEditButtonShow:this.usesEditButton();return this.scope.content.isLtiLink()&&(null===(t=null===(e=this.scope.content.contentDetail)||void 0===e?void 0:e[this.contentHandler])||void 0===t?void 0:t.itemOrigin)===ie.LtiItemOrigin.CloudDocument&&(n=this.showEditButtonFromLTILink()),this.lastIsEditButtonShow=n,n},onClick:this.openEditContentPanel.bind(this)},{icon:"conversation",labelKey:"components.directives.content-item-base.overflow-menu.open-conversation",show:this.hasSupportedConversation.bind(this),onClick:()=>{this.ultraState.goPeekState("conversations",{courseId:this.scope.content.courseId,contentId:this.scope.content.id})}},{icon:"beast-analytics",labelKey:"components.directives.content-item-base.overflow-menu.student-activity",show:()=>this.displayTelemetryUserActivity&&!this.isAnonymouslyGraded(),onClick:()=>{this.ultraState.goPeekState(V.TelemetryRoutes.CONTENT_ACTIVITY_IN_DETAIL,{contentId:this.scope.content.id})}},{icon:"beast-analytics",uniqueId:"scorm-analytics-report",labelKey:"components.directives.content-item-base.overflow-menu.view-analytics",show:()=>this.shouldShowScormAnalysisReport()&&!this.contextCourseMembership.isStudentMembership(),onClick:()=>{this.ultraState.goPeekState("scorm-analytics-report",{courseId:this.scope.content.courseId,contentId:this.scope.content.id})}},{icon:"beast-analytics",uniqueId:"discussion-insights",labelKey:"components.directives.content-item-base.overflow-menu.view-analytics",show:()=>this.displayTelemetryDiscussionActivity,onClick:()=>{const e=this.scope.content.contentDetail["resource/x-bb-courselink"]?this.scope.content.contentDetail["resource/x-bb-courselink"].linkSourceId:this.scope.content.id;this.ultraState.goPeekState(V.TelemetryRoutes.DISCUSSION_FORUM_INSIGHTS,{contentId:e,forumContentId:this.scope.content.id})}},{icon:"question-analysis",labelKey:"components.directives.content-item-base.overflow-menu.question-analysis",show:()=>this.canViewQuestionAnalysis&&this.scope.content.isQuestionAnalysisAvailable(),onClick:()=>{this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.scope.content.id})}},{icon:"trash",labelKey:"global.delete",show:()=>this.scope.content.canDelete(),onClick:this.deleteContent.bind(this),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>(this.isGettingConfirmationOptions=!0,this.getDeleteConfirmationKeyAndShowType().then(e=>{const t=e.confirmationKey.replace(/^resource\//,"");return this.isGettingConfirmationOptions=!1,this.$q.when(z.a(t))}))}},{icon:"download",labelKey:"ally.context_menu.download_original_file",show:()=>this.canShowAlly,onClick:()=>{window.open(this.scope.content.getContentDisplay().contentUrl(),"_blank")}},{labelKey:"ally.context_menu.view_accessibility_score",icon:"ally-indicator-unscored",show:()=>this.canShowAlly,onClick:()=>{},additionalAttributes:{"data-ally-show":"instructorfeedback","data-ally-content-ref":this.scope.content.id,"data-ally-invoke":"instructorfeedback",style:"display:none;",onkeydown:`(function(e) {\n              if (e.keyCode === ${W.f} || e.keyCode === ${W.t}) {\n                $(e.target).closest("li").click();\n              }\n              })(event)`}},{icon:"ally-alt-formats",labelKey:"ally.context_menu.download_alternative_formats",show:()=>this.canShowAlly,onClick:()=>{},additionalAttributes:{"data-ally-show":"alternativeformats","data-ally-content-ref":this.scope.content.id,"data-ally-invoke":"alternativeformats",style:"display:none;",onkeydown:`(function(e) {\n                if (e.keyCode === ${W.f} || e.keyCode === ${W.t}) {\n                 $(e.target).closest("li").click();\n                }\n              })(event)`}}]}get deployedAssessment(){return this.scope.content&&this.scope.content.getDeployedAssessment()}isAnonymouslyGraded(){const e=this.scope.content.getAssociatedGradingColumn();return e&&e.anonymousGrading}async editGroups(){let e,t=this.scope.content.id;if(this.scope.content.isAssignment()||this.scope.content.isTest())e=this.deployedAssessment.gradingColumn.id;else if(e=this.scope.gradeColumn&&this.scope.gradeColumn.id,F.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.contentDetail){t=(await this.scope.content.getLinkContentSource().$asPromise()).id}this.ultraState.goPeekState("course-group",{groupCourseId:this.scope.content.courseId||this.ultraState.params.courseId,groupContentId:t,groupColumnId:e})}showOverflowMenu(){const e=this.scope.content;return e.canDelete()||e.canViewAsInstructor()||this.usesEditButton()||e.hasConversation()||this.canShowAlly&&!e.isConditionalReleaseLocked()}openAssessmentItem(){r.a.isExternalSubmissionsAssessment(this.scope.content)?this.ultraState.goPeekState(V.AssessmentRoutes.ASSESSMENT_EXTERNAL_OVERVIEW,{contentId:this.scope.content.id}):this.ultraState.goPeekState(V.AssessmentRoutes.ASSESSMENT_OVERVIEW,{contentId:this.scope.content.id})}onExternalLinkClick(){var e;if(this.notifyMobileAppOnItemClick(),!(null===(e=this.scope.content.permissions)||void 0===e?void 0:e.canHaveReviewState))return;const t=Object(ne.getAutomaticReviewStateForContentLaunched)(this.scope.content);t&&this.updateContentReviewState(this.scope.content.courseId,this.scope.content.id,t).then(()=>{this.$rootScope.$broadcast(Q.b,this.scope.content,t)})}notifyMobileAppOnItemClick(){let e,t;if(F.p.ContentHandler.File.isEqualTo(this.scope.content.contentHandler)?(e=oe.MessageType.FileOpened,t=oe.MobileContentType.Document):F.p.ContentHandler.ExternalLink.isEqualTo(this.scope.content.contentHandler)&&(e=oe.MessageType.LinkOpened,t=oe.MobileContentType.Link),F.p.ContentHandler.File.isEqualTo(this.scope.content.contentHandler)||F.p.ContentHandler.ExternalLink.isEqualTo(this.scope.content.contentHandler)){const n={type:e,status:oe.MessageStatus.Success,contentId:this.scope.content.id,contentTitle:this.scope.content.title,contentType:t};Object(oe.sendMessageToMobile)(n)}}getRootClassName(){return re}shouldShowReviewStateIcon(){var e,t;const n=null===(e=this.scope.showReviewStateIcon)||void 0===e||e,s=!!(null===(t=this.courseProgressConfiguration)||void 0===t?void 0:t.progressTrackingEnabled)||this.scope.content.inSequence;return n&&s&&this.contextCourseMembership.isStudentMembership()}getNeighborReviewState(e){return this.scope.content.inSequence&&e&&!e.isUiFolder()?e.state===te.ContentReviewState.Completed?X.NeighborContentReviewState.Completed:X.NeighborContentReviewState.Incomplete:X.NeighborContentReviewState.None}setForcedSequenceLearningModuleAttributes(){return ee.ContentHelper.isNotAccessibleButVisibleForcedSequenceItem(this.scope.content)}};ce=Object(s.__decorate)([Object(s.__param)(0,Object(Y.b)("$injector")),Object(s.__param)(1,Object(Y.b)("$q")),Object(s.__param)(2,Object(Y.b)("$rootScope")),Object(s.__param)(3,Object(Y.b)("$ngRedux")),Object(s.__param)(4,Object(Y.b)("element")),Object(s.__param)(5,Object(Y.b)("scope")),Object(s.__param)(6,Object(Y.b)(F.m.serviceName)),Object(s.__param)(7,Object(Y.b)(N.b)),Object(s.__param)(8,Object(Y.b)(u.f)),Object(s.__param)(9,Object(Y.b)(v.b)),Object(s.__param)(10,Object(Y.b)(y.e)),Object(s.__param)(11,Object(Y.b)(w.d)),Object(s.__param)(12,Object(Y.b)(S.b)),Object(s.__param)(13,Object(Y.b)(O.b)),Object(s.__param)(14,Object(Y.b)(k.serviceName)),Object(s.__param)(15,Object(Y.b)($.b)),Object(s.__param)(16,Object(Y.b)(R.b)),Object(s.__param)(17,Object(Y.b)(j.b)),Object(s.__param)(18,Object(Y.b)(H.d)),Object(s.__param)(19,Object(Y.b)(d.b))],ce);class le{constructor(e){this.$injector=e,this.restrict="E",this.scope={content:"=",contents:"=",contextArea:"=",canMove:"=",itemBefore:"<",itemAfter:"<",showReviewStateIcon:"<?"},this.template=q,this.link=(e,t)=>{e.contentItemBase=this.$injector.instantiate(ce,{scope:e,element:t}),e.$on(E.e,(n,s,i,o)=>{o===E.c.FileDrop&&e.content===i.content&&(i.targetElement=t.find(".bb-progress"),e.$root.$broadcast(E.e,s,i,e.content.ui.fileUploadId,i.targetElement,E.c.LinkProgress))})}}}le.$inject=["$injector"],o.module(ae,[h.a,p.a,m.a,b.a,g.a,I.a,f.a,C.b,$.a,L.d,J.a,x.d,A.a,M.a,_.a,P.a,D.c,k.moduleName,u.d,S.a,N.a,z.b,U.a,T.a,c.a,l.a]).directive("bbContentItemBase",["$injector",e=>e.instantiate(le)])}).call(this,n("5iHu"))},kN1T:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));var s=n("D57K"),i=n("Llzl"),o=n("nsO7"),a=n("0JpG"),r=n("LN5R"),c=n("BMpZ"),l=n("o5Lu"),d=n("lEL+"),u=n("jhBu"),h=n("dF44"),p=n("+4Px"),m=n("qH3X"),b=n("s1u2"),g=n("6PP7"),v=n("cbVV"),f=n("TmUJ"),C=n("LTOG"),y=n("aHpC"),w=n("Sa5G");const S="ultra.components.directives.gradeGridColumnHeaderReborn";class I extends C.a{constructor(t,n,s,i,a,r,c,l,d,u){super(n,l),this.rootScope=t,this.element=s,this.attrs=i,this.$compile=a,this.gradeGridRebornController=r,this.grade=c,this.bbLocalize=d,this.entitlementService=u,this.initializeEventHandler(),this.toolAvailable=!0,this.menuScope=n.$new(!0),Object.defineProperty(n,"possible",{get:()=>this.possible}),n.$watch("col",e=>{n.columnMetadata=e.data,this.col=e,o.debounce(()=>this.highlight(this.col),1e3)(),this.element.data("col",this.col),n.isGroupTest=this.col instanceof v.h,n.showAlertIcon=()=>n.columnMetadata.getNumMissingIfLate()>0,this.element.find(".content").removeClass("is-active"),r.activeColumnId===e.id&&this.element.find(".content").addClass("is-active"),n.columnMetadata.isAttendance()&&!r.attendanceIsAvailable&&(this.toolAvailable=!1)}),n.$on(m.a.FOCUSIN_CELL,(e,t)=>{t.columnId===this.col.id&&(this.gradeGridRebornController.getElement().find(".is-active").removeClass("is-active"),this.toolAvailable&&this.element.find(".content").addClass("is-active"))}),n.$on(m.a.FOCUSOUT_CELL,(e,t)=>{t.columnId===this.col.id&&this.element.find(".content").removeClass("is-active")}),n.$on(h.b.CELL_FOCUSED,()=>{s.find(".content").focus()}),s.find(".content").on("keydown",t=>{if(t.keyCode===p.g)this.scope.$emit(h.b.LEAVE_GRID);else{if(!p.y(t))return;e(t.target).click()}t.preventDefault(),t.stopPropagation()}),s.find(".content").on("keyup",e=>{p.y(e)&&(e.preventDefault(),e.stopPropagation())})}initializeEventHandler(){this.element.find(".content-header-bg").focusin(()=>{this.focusin()}).focusout(()=>{this.focusout()})}focusin(){this.rootScope.$broadcast(m.a.FOCUSIN_CELL,{columnId:this.col.id})}focusout(){this.rootScope.$broadcast(m.a.FOCUSOUT_CELL,{columnId:this.col.id})}get possible(){if(this.scope.columnMetadata&&!o.isUndefined(this.scope.columnMetadata.possible))return Math.round(100*this.scope.columnMetadata.possible)/100}popupMenu(t){const n=`grade-grid-column-header-menu-reborn-${this.col.id}`,s=this.grade.canPostGrades(this.col.gridData.course,this.col.data);if((!this.isGroupContent()||this.hasEntitlementsToViewGroups())&&!this.gradeGridRebornController.isMenuExisting(n)&&this.toolAvailable){const i=e(t.target).closest(".grade-grid-header-cell").offset();i.top+=87,this.menuScope.col=this.col,this.menuScope.grade=this.grade,this.menuScope.canPostGrades=s,this.menuScope.autoDestroy=!1,this.menuScope.adjustPosition=e=>{const t=i.left+e.width(),n=this.gradeGridRebornController.getGradeGridContainerElementRight();t>n&&(i.left-=t-n+Object(f.a)()),e.offset(i)},this.gradeGridRebornController.popupMenu(n,g,this.menuScope),this.timeout(()=>{const e=this.gradeGridRebornController.getPopupMenu();e.on("keydown",t=>{t.keyCode===p.g||t.keyCode===p.u?(e.data("destroy")(),this.scope.$emit(h.b.CELL_FOCUSED),t.preventDefault(),t.stopPropagation()):p.y(t)&&this.scope.$emit(h.b.CELL_FOCUSED)}),this.gradeGridRebornController.getMenuitems().first().focus()},this.menuScope,0,!1),t.preventDefault(),t.stopPropagation()}}hasEntitlementsToViewGroups(){return this.col&&this.entitlementService.isEntitled(w.o.ViewGroups,this.col.getCourse().id)}isGroupContent(){return this.col&&this.col instanceof v.g&&null!==this.col.groups||this.col.data&&this.col.data.groupContent}isRestricted(){return!!this.isGroupContent()&&!this.hasEntitlementsToViewGroups()}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}getSchemaText(){let e="components.directives.grade.grid.points.plural";if(this.scope.columnMetadata&&this.scope.columnMetadata.isScorm()){const t=this.scope.columnMetadata.ui&&this.scope.columnMetadata.ui.content||null,n=t&&t.getScormGradebookItems()||[],s=n&&n.find(e=>e.columnId===this.scope.columnMetadata.id);e=`course.content.scorm.settings.gradeSchema.${s&&s.scoringMethod&&s.scoringMethod.toString().toLowerCase()||"score"}Overview.plural`}return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:e,params:{point:this.possible,count:this.possible},noWrap:!0})}}I.$inject=["$rootScope","scope","element","attrs","$compile","gradeGridRebornController",l.i,d.b,a.serviceName,u.b],Object(s.__decorate)([Object(y.d)("possible","locale","columnMetadata.scoreProviderHandle")],I.prototype,"getSchemaText",null);class O{constructor(e){this.$injector=e,this.restrict="E",this.template=b,this.scope=!0,this.require=`^${r.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnHeaderReborn=this.$injector.instantiate(I,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}O.$inject=["$injector"],i.module(S,[c.a]).directive("bbGradeGridColumnHeaderReborn",["$injector",e=>e.instantiate(O)])}).call(this,n("5iHu"))},kjyA:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var s=n("D57K"),i=(n("Llzl"),n("aHpC")),o=n("lEL+");const a="debounceServiceModule",r="debounceService";let c=class{constructor(e){this.$timeout=e}asDebounced(e,t,n){let s;return(...i)=>{s&&this.$timeout.cancel(s),s=this.$timeout(()=>{s=null,e(...i)},t,n)}}};c=Object(s.__decorate)([Object(s.__param)(0,Object(i.b)(o.b))],c);class l extends c{}angular.module(a,[o.a]).service(r,class extends c{})},kkz3:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu student-card" tabindex="-1">\n  <div class="student-info">\n    <bb-user-avatar class="avatar" user="user"></bb-user-avatar>\n    <div class="info">\n      <bb-username class="ellipse username" user="user" auto-update="true" title="{{fullName}}" ng-class="{ inactive: !isUserCourseAvailable }"></bb-username>\n      <div class="profile ellipse" ng-if="user.userName && !user.studentId" title="{{user.userName}}">{{user.userName}}</div>\n      <div class="profile ellipse" ng-if="!user.userName && user.studentId" title="{{user.studentId}}" bb-translate translate-values="{ studentId: user.studentId }">components.directives.usercard.studentId</div>\n      <div class="profile ellipse" ng-if="user.userName && user.studentId" title="{{user.studentId}}" bb-translate translate-values="{ username: user.userName, studentId: user.studentId }">components.directives.usercard.usernameAndId</div>\n      <div class="profile" ng-bind="courseRole"></div>\n    </div>\n  </div>\n</div>\n'},kmeh:function(e,t){e.exports='<bb-modal id="anonymously-graded-item-error-modal" class="notification"\n          modal-title-key="components.directives.grade.course-grades-student.modal.anonymouslyGradedItemError.title"\n          analytics-id-tag-prefix="components.directives.grade.studentGrade.anonymouslyGradedItemError">\n  <div name="modal-contents">\n    <p bb-translate="components.directives.grade.course-grades-student.modal.anonymouslyGradedItemError.body"></p>\n  </div>\n  <button name="modal-footer-button-primary"\n          class="button confirm-ok js-primary-button"\n          ng-click="$parent.$close()"\n          bb-translate\n          course-org-token-resolver\n          analytics-id="components.directives.grade.studentGrade.anonymouslyGradedItemErrorModal.close.button">\n    global.close\n  </button>\n</bb-modal>\n'},"kp/p":function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return C}));var s=n("Llzl"),i=n("0JpG"),o=n("TnpK"),a=n("hkqm"),r=n("sgjL"),c=n("lEL+"),l=n("g66W"),d=n("12mu"),u=n("Oyr+"),h=n("o5Lu"),p=n("WAgA"),m=n("o9hD"),b=n("NZ4S"),g=n("0BVo");const v="ultra.features.course.grades.gradesUploadSettings.controller",f="refresh-after-upload";class C{constructor(t,n,s,i,o,a,r,c,d,h,p){this.$scope=t,this.$rootScope=n,this.postMessageDispatcher=s,this.timeoutService=i,this.course=o,this.ultraState=a,this.toast=r,this.modalService=c,this.contentCollectionAvailability=d,this.bbLocalize=h,this.grade=p,this.confirmedToClose=!1,this.fileName="",this.hasDroppedClass=!1,this.selectAll=!1,this.showErrorDetail=!1,this.afterImported=!1,this.showContentCollection=!1,this.uploadErrorFileTypeTemplate=b,this.invalidUserNames="",this.invalidUserNamesCount=0,this.failedItems="",this.failedItemsCount=0,t.gradesUploadSettings=this,this.showContentCollection=this.contentCollectionAvailability.toolEnabledSetting.isAvailable,this.modalScope=this.$rootScope.$new(),t.$on(u.e,(t,n,s,i)=>{if(i===u.c.Uploaded){this.source="LOCAL";const t={source:this.source,name:s.fileName,location:s.fileLocation};this.parseUploadGradebook(t),e(".upload-gradebook-panel .help-link").focus()}}),this.postMessageDispatcher.registerEventHandler("classic-picker-submit",e=>{const t=e.items[0];if(!/(\.xls|\.csv)$/i.exec(t.linkTitle))return this.showErrorModal(b),!1;this.source="CONTENT_COLLECTION";const n=t&&t.url||"",s=n.substr(n.lastIndexOf("/")),i={source:this.source,name:t.linkTitle||"",location:s};this.parseUploadGradebook(i)},this.$scope),this.postMessageDispatcher.registerEventHandler("classic-picker-cancel",(e,t)=>{this.timeoutService(()=>{l.e(this.ultraState.current.name,"peek.content-collection-picker")&&this.closePanel(),window!==t&&t.close()},this.$scope,0)},this.$scope),this.uploadAction=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.grades.grades-upload-settings.upload"}),this.completedModalTitleKey=`${this.course.isOrganization?"course":"organization"}.grades.grades-upload-settings.courseComplete.title`,this.registerStateChangeListener()}parseUploadGradebook(e){this.course.gradebook.parseUploadedGradebook(e).then(t=>{if(400===t.$response.status)return this.showErrorModal(p),!1;this.timeoutService(()=>{l.e(this.ultraState.current.name,"peek.content-collection-picker")&&this.closePanel()},this.$scope,0),this.hasDroppedClass=!0,this.invalidUserNames=t.invalidUserNames,this.invalidUserNamesCount=this.invalidUserNames&&this.invalidUserNames.split(",").filter(e=>e.trim()).length,this.fileName=e.name,this.changedList=t.changedList,this.selectAll=!0,this.checkAll(!0)})}checkAll(e){this.columnList=[],this.errorColumnList=[],s.forEach(this.changedList,t=>{if(!t.columnTitle)return!1;t.isError?(t.message.languageKey=t.message.languageKey.replace(/\./g,"_"),t.message.params&&this.getColumnErrorMessage(t.message),t.message.translatedLanguageKey=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:t.message.languageKey,params:{data:t.message.detailErrorMessageKey},noWrap:!0,noEscape:!0}),this.errorColumnList.push(t)):(t.checked=e,t.clearGradeOption=t.needOverrideAndAttemptsChoices?"OVERRIDE":"DO_NOTHING",this.updateColumnList(t,t.checked))})}updateColumnList(e,t){t?this.columnList.push(e):this.columnList.splice(this.columnList.indexOf(e),1)}validate(){return this.columnList&&this.columnList.length>0}cancelClicked(){this.closePanel()}chooseDestination(){this.ultraState.goPeekState("content-collection-picker",{pickerType:"File",multi:"false"})}closePanel(){this.ultraState.leavePeekState(this.ultraState.current.name)}deleteFile(){this.hasDroppedClass=!1,this.columnList=[],this.changedList=[],this.errorColumnList=[],this.selectAll=!1}showErrorModal(e){this.modalService.open({scope:this.modalScope,template:e})}confirmToClose(){this.confirmedToClose=!0,this.ultraState.leavePeekState(this.ultraState.current.name)}registerStateChangeListener(){this.stateChangeListener=this.$scope.$on("$stateChangeStart",(e,t,n,s,i)=>{t.name.indexOf("grade-upload-setting")<0&&this.hasDroppedClass&&!this.afterImported&&(this.confirmedToClose||(e.preventDefault(),this.$scope.$broadcast("show-confirmation","grades-upload-setting")))})}importGradebook(e){if(this.invalidUserNames&&!e)return this.$scope.$broadcast("show-confirmation","grades-upload-continue-with-errors"),!1;const t={changedList:this.columnList};this.course.gradebook.importGradebook(t).then(e=>{if(this.afterImported=!0,"bb-rest-course-is-closed"===e.$response.data.code)return this.showErrorModal(m),!1;e.errorItem?(this.modalScope.failedItems=e.errorItem,this.modalScope.failedItemsCount=e.errorItem&&e.errorItem.split(",").filter(e=>e.trim()).length,this.showErrorModal(g),this.ultraState.leavePeekState(this.ultraState.current.name)):(this.$rootScope.$broadcast(f,e.savedItemsIds),this.ultraState.leavePeekState(this.ultraState.current.name),this.toast.show({messageKey:"course.grades.grades-upload-settings.complete",icon:"icon-check",toastStatus:"success"}))})}getColumnErrorMessage(e){e.params[0].rawValue?e.detailErrorMessageKey=e.params[0].rawValue:e.params.forEach(t=>{e.languageKey===t.localizableMessage.languageKey.replace(/\./g,"_")&&(e.detailErrorMessageKey=t.localizableMessage.params?t.localizableMessage.params[0].rawValue:"")})}}C.$inject=["$scope","$rootScope",r.b,c.b,"currentCourse",o.d,a.b,d.b,"contentCollectionAvailability",i.serviceName,h.i];class y extends C{}}).call(this,n("5iHu"))},lEWr:function(e,t){e.exports='<div class="input-wrapper">\n  <input translate-attrs-values="{userName: gradeGridCellEditorReborn.userName}"\n        bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grid.scoreInputAriaLabel\'}"\n        ng-blur="gradeGridCellEditorReborn.onInputBlur($event)" \n        placeholder="--" ng-model="gradeGridCellEditorReborn.score"\n        ng-click="gradeGridCellEditorReborn.stopPropagation($event)"\n        ng-change="gradeGridCellEditorReborn.onChange()"\n        aria-describedby="totalPoints"\n        ng-keydown="gradeGridCellEditorReborn.onKeydown($event)" spellcheck="false" autocomplete="off"\n        analytics-id="components.directives.grade.gradeGridCellEditorReborn.input.text" />\n</div>\n<div class="possible-wrapper" ng-mousedown="gradeGridCellEditorReborn.mousedown()">\n  <span class="slash"></span><span id="totalPoints" class="possible" ng-bind="col.data.possible"></span>\n</div>'},lwNT:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-lock",use:"icon-small-lock-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-lock"><path d="M3 8h10v7H3V8zM5 8V4c0-1.5 1-3 3-3m0 0c.5 0-.5 0 0 0zm0 0c2 0 3 1.5 3 3v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},lx16:function(e,t,n){"use strict";n("zhNR"),n("JzsJ"),n("VCKY"),n("BiyI"),n("jlIo"),n("qzMN"),n("2i58"),n("Ybms"),n("wKTs"),n("vgq2");var s=n("Llzl"),i=n("dCrD");class o extends i.a{}class a extends i.a{}var r=n("D57K"),c=n("ERkP"),l=n("Sa5G"),d=n("aHpC"),u=n("c7N/"),h=n("0x+l");let p=class extends i.a{constructor(e,t,n){super(e,t,n),this.canEditUnsafeHtml=!1,this.isCloudServiceAvailable=!1,this.initializeItems=()=>{this.items=[{key:"addText",className:"js-add-content",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addContent"}),icon:c.createElement(h.Notes,null),onClick:this.addTextBlock}],this.canEditUnsafeHtml&&this.items.push({key:"addHtml",className:"js-add-html",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addHtml"}),icon:c.createElement(h.Editor,null),onClick:this.addHtmlBlock}),this.items.push({key:"addLocalFile",className:"js-add-local-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:`components.directives.add-content-button.${this.isMobile?"uploadFromDevice":"uploadFromComputer"}`}),icon:c.createElement(h.UploadFile,null),onClick:this.uploadLocalFile}),this.isCloudServiceAvailable&&this.items.push({key:"addCloudFile",className:"js-add-cloud-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.uploadFromCloudStorage"}),icon:c.createElement(h.UploadCloud,null),onClick:this.uploadCloudFile})},this.addTextBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Text,this.getInsertLocationData())},this.addHtmlBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Html,this.getInsertLocationData())},this.uploadLocalFile=()=>{this.element.find(".file-upload-button").click()},this.uploadCloudFile=()=>{this.element.find(".js-upload-from-cloud-storage-integration").click()},this.focusAddButton=()=>{this.element.find("button").focus()},this.$q=e.get("$q"),this.unsafeHtmlService=e.get(u.b),this.initialize()}initialize(){return this.$q.all({canEditUnsafeHtml:this.unsafeHtmlService.canEditUnsafeHtml(),isCloudServiceAvailable:this.isCloudServiceAvailablePromise}).then(({canEditUnsafeHtml:e,isCloudServiceAvailable:t})=>{this.canEditUnsafeHtml=e,this.isCloudServiceAvailable=t}).finally(this.initializeItems)}};p.$inject=[],p=Object(r.__decorate)([Object(r.__param)(0,Object(d.b)("$injector")),Object(r.__param)(1,Object(d.b)("scope")),Object(r.__param)(2,Object(d.b)("element"))],p);var m=n("HjsN");class b extends i.a{addGroup(){this.toggleMenu();const e=this.scope.positionBefore?this.scope.positionBefore():this.scope.positionAfter()+1;this.scope.createFunction(e),this.closeMenu()}}var g=n("tfx2");let v=class extends i.a{constructor(e,t,n){super(e,t,n),this.scope=t,this.element=n;const s=n.closest("[data-base-state-name]").data("baseStateName");this.$q.all([this.ultraState.peekHref("grade-item.create",this.getInsertLocationData(),s),this.ultraState.peekHref("gradebook-item.calculation",this.getInsertLocationData(),s),this.ultraState.peekHref("attendance",null,s)]).then(e=>{this.attendanceHref=e[2],this.items=[{key:"addGradebookItem",href:e[0],className:"doc-add-grade",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addItem"}),icon:c.createElement(h.Add,null)},{key:"addCalculation",href:e[1],className:"doc-add-calc",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addCalculation"}),icon:c.createElement(h.Calculation,null)}],this.addOrRemoveAddAttendanceMenuItem()}),t.$on("always-show-time-expires",()=>{t.addContentButton.alwaysShow=!1}),t.$on("update-content-menu",()=>{this.items&&this.addOrRemoveAddAttendanceMenuItem()})}addOrRemoveAddAttendanceMenuItem(){const e=null==this.scope.showAddAttendance||!this.scope.showAddAttendance(),t=this.doesMenuItemExistByKey("addAttendance");e?this.removeMenuItemByKey("addAttendance"):t||this.addAttendanceMenuItem()}doesMenuItemExistByKey(e){return this.items.some(t=>t.key===e)}removeMenuItemByKey(e){this.items=this.items.filter(t=>t.key!==e)}addAttendanceMenuItem(){this.items.push({key:"addAttendance",href:this.attendanceHref,className:"doc-add-attendance",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addAttendance"}),icon:c.createElement(h.Attendance,null)})}};v.$inject=[],v=Object(r.__decorate)([Object(r.__param)(0,Object(d.b)("$injector")),Object(r.__param)(1,Object(d.b)("scope")),Object(r.__param)(2,Object(d.b)("element"))],v);var f=n("J8YL"),C=n("tTiy"),y=n("1Niw"),w=n("UeHE"),S=n("9hp7"),I=n("SE1T"),O=n("6xt4"),E=n("07HN");class D{constructor(e){this.$injector=e,this.handlersAndTemplateTexts={assignment:{handler:o,templateText:f},attempts:{handler:a,templateText:C},"bbml-editor":{handler:p,templateText:y},"cloud-upload":{handler:m.b,templateText:w},"course-group":{handler:b,templateText:I},"course-outline":{handler:g.a,templateText:O},grades:{handler:v,templateText:E}}}getTemplateText(e){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");if(null==this.handlersAndTemplateTexts[e].templateText)throw new Error("No template for context area: "+e);return S.replace("<template></template>",this.handlersAndTemplateTexts[e].templateText)}getHandler(e,t,n){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");return this.$injector.instantiate(this.handlersAndTemplateTexts[e].handler,{scope:t,element:n})}}D.$inject=["$injector"];var k=n("2E9T"),$=n("+e2k");const L="ultra.components.directives.content.buttonAddContent";class R{constructor(){this.restrict="C",this.template=k}}R.$inject=["$injector"],s.module(L,[$.a]).directive("buttonAddContent",["$injector",e=>e.instantiate(R)]);var j=n("0JpG"),T=n("/z4E"),x=n("H/mg"),G=n("nYZ0"),A=n("jx5I"),_=n("3Jgm"),M=n("TnpK"),P=n("vhkR"),B=n("zYa8"),N=n("unjq");Object(B.a)(N.a,"ultra.components.directives.bbUiIcon.small.OneDrive","bbUiIconSmallOneDrive");var F=n("wtdm");Object(B.a)(F.ContentMarket,"ultra.components.directives.bbUiIcon.small.ContentMarket","bbUiIconSmallContentMarket"),n.d(t,"a",(function(){return z}));const z="ultra.directives.addContentButton";class U{constructor(e,t,n){this.$injector=e,this.$rootScope=t,this.ultraState=n,this.compiled=Object.create(null),this.restrict="E",this.scope={attachHandler:"=?",disableDrag:"&?",content:"=",createFunction:"=?",hideDividerLines:"&?",rootContent:"&?",contextArea:"=",alwaysShow:"=",showAddAttendance:"&?",showBothButtons:"&?",showMenuOverride:"=",positionBefore:"&?",positionAfter:"&?",parentId:"&",depth:"&",canCreateAllContents:"=?",canCopyImport:"=?",folderNestedButton:"&?",fileLocation:"@?",webLocation:"@?",initialUpload:"&?",primaryKey:"&?",ignoredStates:"&?",itemName:"&?",itemType:"&?",itemIndex:"&?",isButtonLocationChangable:"<?",isRenderByDefault:"&?"},this.compile=()=>(e,t)=>{let n;n=e.contextArea?e.contextArea:e.$parent.contextArea?e.$parent.contextArea:"course-outline";const s=this.$injector.instantiate(D,{});null==this.compiled[n]&&(this.compiled[n]=this.$injector.get("$compile")(s.getTemplateText(n))),e.addContentButton=s.getHandler(n,e,t),e.fileListViewId="fileListView-"+Math.floor(1e4*Math.random())+"-"+Math.floor(1e4*Math.random()),e.fileListViewLocalId=e.fileListViewId+"Local",this.compiled[n](e,(function(e,n){t.append(e)})),this.$rootScope.$broadcast("add-content-button-ready")}}}U.$inject=["$injector","$rootScope",M.d,G.f],s.module(z,["ngAnimate",L,T.a,j.moduleName,x.a,G.d,A.a,_.a,M.b,u.a,P.a,"ultra.components.directives.bbUiIcon.small.OneDrive","ultra.components.directives.bbUiIcon.small.ContentMarket"]).directive("bbAddContentButton",["$injector",e=>e.instantiate(U)])},m2KQ:function(e,t){e.exports='<div class="grade-input-wrapper" ng-class="{\'has-validation-error\': !!gradeInput.form[gradeInput.id].$invalid}">\n  <div ng-attr-id="{{hasRubricClearConfirmationCallout ? \'grade-input-container-callout\' : \'\'}}" ng-class="{\'grade-input-align\': gradeInput.shouldShowPastDueZeroIndicator(), \'left\': !gradeInput.shouldShowPastDueZeroIndicator()}">\n    <bb-inline-validation\n      show-error="!!gradeInput.form[gradeInput.id].$invalid"\n      bb-translate-attrs="{ \'error-message\': errorMessageKey }"\n      ng-show="gradeInput.shouldShowInput()">\n      <div ng-class="{\'show-total\': gradeInput.shouldShowTotalPoints(), \'is-multiple\': gradeInput.isMultipleShown(), \'is-in-progress\': gradeInput.isInProgressShown(), \'group-grade-input\': !!forGroup}"\n           class="wrapping-input-style" data-dropdown="performanceCodes-{{gradeInput.id}}">\n        <div bb-foundation-defer>\n          <div class="wrapping-editable-input">\n            <bb-svg-icon size="small" icon="rubric" ng-if="gradeInput.isRubricEvalMode() && gradeInput.shouldShowInput()"></bb-svg-icon>\n\n            <input name="{{gradeInput.id}}" autocomplete="off" ng-class="{\'group-multiple\': gradeInput.isMultipleShown(), \'group-in-progress\': gradeInput.isInProgressShown()}"\n                pu-elastic-input pu-elastic-input-minwidth="10px" pu-elastic-input-maxwidth="180px"  pu-elastic-input-width-delta="8"\n                type="text" placeholder="--"\n                bb-translate-attrs="{ \'aria-label\': gradeInput.getGradeInputAriaLabelKey() }"\n                translate-attrs-values="{ user: forUser, group_name: forGroup && forGroup.title, grade: gradeInput.gradeDisplayItem.displayValue, total: gradeDetail.pointsPossible || (column.isCalculated() ? 100 : column.possible)}"\n                ng-model="gradeInput.gradeDisplayItem.displayValue" ng-readonly="gradeInput.isReadOnly()"\n                title="{{gradeInput.gradeDisplayItem.perfCodeDesc}}"\n                ng-blur="gradeInput.onBlur($event)" ng-change="gradeInput.gradeValueOnChange()" ng-focus="gradeInput.onFocus()"\n                class="js-grade-input" analytics-id="directives.grade-input.grade.display.item.input"\n                aria-invalid="{{!!gradeInput.form[gradeInput.id].$invalid ? \'true\' : \'false\'}}"\n                aria-describedby="{{!!gradeInput.form[gradeInput.id].$invalid ? gradeInput.getAriaDescribeById(): undefined}}">\n\n            <bb-confirmation-callout-dialog\n              ng-if="hasRubricClearConfirmationCallout"\n              analytics-id="directives.grade-input.grade.clearRubricConfirmation"\n              target="\'#grade-input-container-callout\'"\n              is-visible="gradeInput.gradeDialog.isVisible"\n              text-content="gradeInput.gradeDialog.textContent"\n              on-dismiss="gradeInput.gradeDialog.onDismiss"\n              on-success="gradeInput.gradeDialog.onSuccess"\n            >\n            </bb-confirmation-callout-dialog>\n         </div>\n\n        </div>\n\n        \x3c!--TOTAL POINTS--\x3e\n        \x3c!-- Fix ULTRA-15280.\n        If there is gradeDetail, we should use its pointsPossible as the total.\n        If there is no gradeDetail, which means it is not graded yet, there are tow cases:\n         for overall grade (and calculations), we use the default value 100,\n         for common column, assignment, etc. we use column.possible. --\x3e\n        <span ng-if="gradeInput.shouldShowTotalPoints()" class="points-text" bb-translate\n              translate-values="{total: gradeDetail.pointsPossible || (column.isCalculated() ? 100 : column.possible)}">\n          components.directives.grade.grade-input.points\n        </span>\n      </div>\n      <div class="alert-icon" ng-if="!!gradeInput.form[gradeInput.id].$invalid">\n        <bb-svg-icon size="small" icon="attention" status="alert"></bb-svg-icon>\n      </div>\n    </bb-inline-validation>\n    <a ng-show="!gradeInput.shouldShowInput()" class="button super-clear has-rubric wrapping-input-style"\n       ng-class="{\'show-total\': gradeInput.shouldShowTotalPoints(), \'is-multiple\': gradeInput.isMultipleShown(), \'is-in-progress\': gradeInput.isInProgressShown(), \'group-grade-input\': !!forGroup, \'disable-click\': disableRubricEvalClick()}"\n       ng-click="gradeInput.openRubricEvaluation()"\n       aria-disabled="{{disableRubricEvalClick()}}"\n       href="javascript:void(0);" analytics-id="directives.grade-input.rubric.evaluation.link">\n      <span class="sr-only" bb-translate translate-values="{user: forUser}">components.directives.grade.grade-input.rubricButtonAlt</span>\n      <bb-svg-icon size="small" icon="rubric"></bb-svg-icon>\n      <span name="{{gradeInput.id}}" class="grade-point-value" ng-class="{\'group-multiple\': gradeInput.isMultipleShown(), \'group-in-progress\': gradeInput.isInProgressShown()}">\n        {{gradeInput.gradeDisplayItem.displayValue || \'--\'}}&nbsp;\n      </span>\n\n      \x3c!--TOTAL POINTS--\x3e\n      <span ng-if="gradeInput.shouldShowTotalPoints()" class="points-text" bb-translate\n            translate-values="{total: gradeDetail.pointsPossible || (column.isCalculated() ? 100 : column.possible)}">\n        components.directives.grade.grade-input.points\n      </span>\n    </a>\n  </div>\n\n  <div ng-if="gradeInput.shouldShowOverrideIndicator()" class="left">\n    <span class="override-indicator" bb-translate>components.directives.grade.grade-input.overrideIndicator</span>\n  </div>\n\n  <div ng-if="gradeInput.shouldShowPastDueZeroIndicator()" ng-class="{\'grade-input-align left\': gradeInput.shouldShowPastDueZeroIndicator(), \'left\': !gradeInput.shouldShowPastDueZeroIndicator()}">\n    <span class="override-indicator" bb-translate>components.directives.grade.grade-input.pastDueZero</span>\n  </div>\n\n  <div ng-if="gradeInput.alertScreenReaderNewGrade"\n        bb-ax-alert\n        id="gradeInput.getAriaDescribeById()"\n        class="sr-only"\n        bb-translate translate-values="{grade: gradeInput.gradeDisplayItem.displayValue}">\n    components.directives.grade.grade-input.screenReaderEnteredGrade\n  </div>\n</div>\n'},mWXo:function(e,t){e.exports='\n<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul ng-if="gradeGridColumnOverallReborn.gradeDetail.displayGrade.isOverride || col.gradeNotations.length" class="f-dropdown f-dropdown-overflow-menu reborn-dropdown performance-code-options show notation-no-border notation-max-height " role="menu">\n\n    <li ng-if="col.gradeNotations.length" class="performance-option-header">\n        <span bb-translate>components.directives.grade.grade-input.selectPerformanceCode</span>\n    </li>\n    <li ng-repeat="notation in col.gradeNotations" class="performance-code-option">\n      <a role="menuitem"\n         ng-click="gradeGridColumnOverallReborn.selectNotation(notation)"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.notation.link">\n        <span class="code" aria-label="{{notation.code}}">{{notation.code}}</span>\n        <span class="description notation-description-max-width" aria-label="{{notation.description}}">{{notation.description}}</span>\n      </a>\n    </li>\n    <li ng-if="gradeGridColumnOverallReborn.gradeDetail.displayGrade.isOverride" class="undo-override">\n      <a role="menuitem"\n         ng-click="gradeGridColumnOverallReborn.undoOverride()"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grade-input.undoOverride">\n        <bb-svg-icon size="small" icon="undo"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grade-input.undoOverride</bb-translate>\n      </a>\n    </li>\n  </ul>\n</div>\n'},moHC:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("Llzl"),i=n("0JpG"),o=n("1ZbL"),a=n("ZQFV");const r="ultra.components.directives.group.filteredUsersGroups",c={Class:a.FilteredUsersGroups,withProvider:!0,renderLocalized:!0,bindingNames:["userId"]};s.module(r,[i.moduleName]).component("bbFilteredUsersGroups",Object(o.a)(c))},o9hD:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': {{::gradesUploadSettings.completedModalTitleKey}}}"\n          modal-title-key="{{::gradesUploadSettings.completedModalTitleKey}}" aria-describedby="course-is-complete"\n          analytics-id-tag-prefix="course.grades.grades-upload-settings">\n    <div name="modal-contents">\n        <p id="course-is-complete" bb-translate="course.grades.grades-upload-settings.courseComplete.content" course-org-token-resolver></p>\n    </div>\n    <a name="modal-footer-help-link" \n       href="" \n       bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkCourseComplete\'}" \n       target="_blank" \n       bb-translate="course.grades.grades-upload-settings.helpButton" \n       rel="noopener noreferrer"\n       analytics-id="course.grades.grades-upload-settings.helpButton">\n    </a>\n    <button name="modal-footer-button-primary" \n            class="button js-discard-changes js-primary-button" \n            ng-click="$dismiss()"\n            analytics-id="course.grades.gradesUploadSettings.closeButton.button">\n        <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n    </button>\n</bb-modal>'},ol3u:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.authorizationRequiredTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration.authorizationRequired">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.authorizationRequiredMessage</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="global.close">\n    <bb-translate>global.close</bb-translate>\n  </button>\n</bb-modal>\n'},ooAF:function(e,t){e.exports='<div class="grade-color">\n    <div class="wrapping-input-style readonly pill-style {{displayGradePill.colorCss}} {{displayGradePill.cursorClass}}">\n      <div ng-if="!displayGradePill.shouldShowRubricButton()">\n        <span class="grade-input-display grade-ellipsis"><bdi>{{displayGradePill.displayValue}}</bdi></span>\n      </div>\n      <div ng-if="displayGradePill.shouldShowRubricButton()">\n        <a ng-click="displayGradePill.openRubricEvaluation($event)"\n           ng-class="{\'disable-click\': !!disableRubricEvalClick()}"\n           class="grade-rubric-detail"\n           aria-disabled="{{!!disableRubricEvalClick()}}"\n           href=""\n           analytics-id="components.directives.grade.gradePill.showRubric.link">\n          <bb-svg-icon size="small" icon="rubric"></bb-svg-icon>\n          <span class="grade-input-display ready grade-ellipsis">{{displayGradePill.displayValue}}</span>\n        </a>\n      </div>\n    </div>\n</div>\n'},"p/lC":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-question-analysis",use:"icon-small-question-analysis-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-question-analysis"><path d="M11 1H5l1 2v4l-5 8h14l-5-8V3l1-2zM4.125 10h7.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},pF15:function(e,t){e.exports='\n<div class="filter-list-content">\n  <div class="filter-panel-container">\n    <div class="filter-panel-header">\n      <div class="filter-panel-title-wrapper">\n        <h3 class="filter-panel-title" bb-translate>components.directives.grade.filter-panel.title</h3>\n        <button type="button"\n          class="filter-panel-close-button"\n          data-is-visible="true"\n          bb-translate-attrs="{\'aria-label\': \'components.directives.grade.filter-panel.closeFilterPanel\'}"\n          ng-click="gradeGridSearchFilterReborn.closeFilterCriteria()"\n          analytics-id="components.directives.grade.filterPanel.close.button"\n        >\n          <div>\n            <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n          </div>\n        </button>\n      </div>\n      <button class="filter-panel-clear-all is-disabled"\n              ng-disabled= "!gradeGridSearchFilterReborn.getCheckedMergedCourse() > 0"\n              ng-class="{\'filter-panel-clear-all-active\': gradeGridSearchFilterReborn.getCheckedMergedCourse() > 0}"\n              ng-click="gradeGridSearchFilterReborn.clearAll()"\n              analytics-id="components.directives.grade.filter-panel.clearAll"\n              bb-translate>\n              components.directives.grade.filter-panel.clearAll\n      </button>\n    </div>\n    \x3c!-- TODO Container(style protoType) for search-box, enable in furture\n    <div class="filter-panel-block" id="keyword-block">\n        <div class="filter-panel-block-header">\n          <h4 class="filter-panel-block-title">Keyword Search</h4>\n          <button type="button filter-panel-toggle-button">\n            <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n          </button>\n        </div>\n        <div class="filter-panel-search-box">\n            <bb-typeahead-search-box id="student-search-box"\n                                     input-placeholder="components.directives.grade.search-box.placeholder"\n                                     sr-empty-results="components.directives.grade.search-box.emptyResults"\n                                     sr-results-found="components.directives.grade.search-box.resultsFound"\n                                     sr-no-results-found="components.directives.grade.search-box.noResultsFound"\n                                     sr-label="components.directives.grade.search-box.placeholder"\n                                     clear-aria-label="components.directives.grade.search-box.clear"\n                                     icon="search">\n            </bb-typeahead-search-box>\n        </div>\n    </div>\n    --\x3e\n    <div class="filter-panel-block" id="sources-block" ng-repeat="criteriaBlock in gradeGridSearchFilterReborn.criteriaBlocks ">\n        <div class="filter-panel-block-header" id ={{::criteriaBlock.id}}>\n            <h4 class="filter-panel-block-title" course-org-token-resolver bb-translate>components.directives.grade.filter-panel.mergedCourseTitle</h4>\n            <button type="button" class="filter-panel-toggle-button"\n                    ng-class="{\'filter-panel-block-toggle-close\': !criteriaBlock.expanded }"\n                    ng-click="gradeGridSearchFilterReborn.collapseMergedCourse(criteriaBlock)"\n                    aria-label="{{gradeGridSearchFilterReborn.getToggleButtonLabel(criteriaBlock)}}"\n                    analytics-id="components.directives.grade.filterPanel.mergedCourse.collapse.button"\n            >\n            <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n            </button>\n          </div>\n        <div class="filter-panel-groups" ng-show="criteriaBlock.expanded">\n          <div class="filter-panel-group">\n            <div class="filter-panel-item" ng-repeat="criteriaDetail in criteriaBlock.criteriaDetails track by $index" >\n              <div class="is-enabled filter-panel-item-checkbox" ng-show="!criteriaDetail.ui.hidden">\n                <input type="checkbox" id={{::criteriaDetail.id}}\n                  class="bb-Checkbox-checkboxInput foundation-overrides"\n                  ng-model="criteriaDetail.ui.checked"\n                  ng-change="gradeGridSearchFilterReborn.filterMergedCourse(criteriaDetail)"\n                  analytics-id="components.directives.grade.filterPanel.mergedCourse.input.checkbox">\n                  <label class="foundation-overrides" for={{::criteriaDetail.id}}>\n                    <div class="check-box-label">\n                      <span>{{::criteriaDetail.childCourse.name}}</span>\n                      <bb-svg-icon icon="check" size="inline"></bb-svg-icon>\n                    </div>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n  </div>\n</div>'},pKNj:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return T}));n("towz"),n("zAxy"),n("s4xR"),n("KXuk"),n("gORw"),n("TOu5");var s=n("Llzl"),i=n("yC9S"),o=n("9zo4"),a=n("vhkR"),r=n("tqR7"),c=n("ZzN+"),l=n("lmMM"),d=n("e7Kn"),u=n("nYZ0"),h=n("dJ97"),p=n("Ocaa"),m=n("r133"),b=n("BMpZ"),g=n("Sa5G"),v=n("ujI6"),f=n("jhBu"),C=n("X/qj"),y=n("o5Lu"),w=n("0JpG"),S=n("pjml"),I=n("JNtI"),O=n("u4ux"),E=n("e6jQ"),D=n("8jzW"),k=n("hkqm"),$=n("TnpK"),L=n("W6wm"),R=n("EGJL"),j=n("nmzr");const T="ultra.directives.grade.graderColumn";class x{constructor(e,t,n,s,o,a,r,c,l,d,u,h,p,m){this.scope=e,this.$q=t,this.ContentService=n,this.courseConversionService=s,this.CourseModel=o,this.entitlementService=a,this.grade=r,this.gradebookPermissionService=c,this.bbLocalize=l,this.ultraState=d,this.accessibility=u,this.scoreProviderHelper=h,this.ltiService=p,this.toast=m,this.hasDesignerViewEntitlement=!1,this.hasViewAssessmentEntitlement=!1,this.hasViewAttendanceEntitlement=!1,this.isRestrictedGroupContent=!1,this.numMissingStudents=0,this.showConversionMessage=!1,this.attendanceAriaLabel=void 0,this.canModify=this.gradebookPermissionService.canModify(e.course().id),this.canPostGrades=this.gradebookPermissionService.canPostGrades(e.course().id),this.canViewAttempts=this.gradebookPermissionService.canViewAttempts(e.course().id),this.canViewGrades=this.gradebookPermissionService.canViewGrades(e.course().id),this.column=e.column,this.course=e.course(),this.isCourseView=e.isCourseView,this.contextArea="grades",this.index=e.$parent.$index+1,this.column.isGroupContent()&&(this.isRestrictedGroupContent=!this.entitlementService.isEntitled(g.o.ViewGroups,this.course.id)),this.bbLocalize.loadBundle("components/directives/grade/grader-column").then(()=>{this.column.externalGrade&&(e.column.columnName=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.overall.label"}))}),this.entitlementService.hasAnyCourseEntitlement([g.i.ViewAssessment,g.i.ModifyAssessment],this.course.id).then(e=>{this.hasViewAssessmentEntitlement=e}),this.entitlementService.hasCourseEntitlement(g.i.ViewAttendance,this.course.id).then(e=>{this.hasViewAttendanceEntitlement=e}),this.entitlementService.hasCourseEntitlement(g.e.ViewAsDesigner,this.course.id).then(e=>{this.hasDesignerViewEntitlement=e}),this.column.$resolve().$then(e=>{this.grade.setDeleteConfirmationHandle(this.column),this.overflowMenuId="grader-column-open-button-"+E.a(),this.checkIfAttendanceRecordsExist()});const b=e.$watch("column.summary.$resolved",()=>{this.column.summary&&this.column.summary.$resolved&&(this.updateNumMissingStudents(),b(),this.isRestrictedGroupContent&&(this.column.summary.restricted=!0,this.column.restricted=!0))});i.b.OnRootScope(e,"bb-grade-input-save",(e,t,n,s)=>{this.column.id===s&&this.column.summary.$fetch()}),i.b.OnRootScope(e,"bb-update-category-icon",(e,t)=>{this.column.id===t.id&&(this.scope.categoryMap&&t.gradebookCategoryId&&(this.column.gradebookCategory=this.scope.categoryMap[t.gradebookCategoryId],this.column.categoryTitle=this.column.gradebookCategory&&this.column.gradebookCategory.title),(null===t.dueDate||t.dueDate&&t.dueDate instanceof Date)&&(this.column.dueDate=t.dueDate),this.column.visible=t.visible,this.updateNumMissingStudents())}),"Attendance"===this.column.effectiveColumnName&&(this.attendanceAriaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.attendance.course-attendance",params:{courseName:this.course.name},noWrap:!0,noEscape:!0})),this.scope.column.isAttendance()&&i.b.OnRootScope(e,"$stateChangeSuccess",(e,t,n,s)=>{s.name.indexOf("attendance")>=0&&this.checkIfAttendanceRecordsExist()}),e.$watch("column",e=>{this.column=e}),this.registerPostGradesWatchers()}updateNumMissingStudents(){this.numMissingStudents=this.column.getNumMissingIfLate()}openAddItemPanel(t){this.whichAddItemPanelOpen=t,e(t).addClass("is-active").find(".element-list-add-menu").slideToggle(300)}closeAddItemPanel(t){this.whichAddItemPanelOpen===t&&(this.whichAddItemPanelOpen=null),e(t).removeClass("is-active").find(".element-list-add-menu").slideUp(300)}toggleAddItemPanel(e){this.whichAddItemPanelOpen===e?this.closeAddItemPanel(e):this.openAddItemPanel(e)}registerPostGradesWatchers(){this.scope.$watchGroup([()=>this.column.summary.hasGradesToPost(),()=>this.course.isComplete()],()=>{this.canPostGrades=this.grade.canPostGrades(this.course,this.column)})}postGrades(){this.column.postReadyGrades().then(e=>{this.toast.show({messageKey:"components.directives.grade.grader-column.actions.gradesPosted",icon:"icon-check",toastStatus:"success"}),this.column.summary.$fetch().$asPromise().then(e=>{this.scope.$emit(y.c,this.column),this.scope.$root.$broadcast("bb-update-summary")})})}deleteColumn(){return this.column.forceDelete()}deleteContent(){this.column.courseId&&this.column.contentId&&this.CourseModel.$new(this.column.courseId).contents.$new(this.column.contentId).$fetch().$asPromise().then(e=>{this.ContentService.deleteContent(e).then(()=>{this.deleteContentCallback()})})}deleteContentCallback(){this.scope.$root.$broadcast("bb-delete-column",this.column)}viewEditColumn(){this.accessibility.setFocusOverrideOnPanel("#"+this.overflowMenuId,".grades-list");const e=this.column.scoreProviderHandle;e&&!this.scoreProviderHelper.supportsOverall(e)||(S.p.ContentHandler.PartnerCloud.isEqualTo(e)||S.p.ContentHandler.LtiLink.isEqualTo(e)?this.ltiService.ltiEditColumn(this.column):this.openViewEditState())}openViewEditState(){const{contentId:e,courseId:t,externalGrade:n,id:s,linkId:i,scoreProviderHandle:o}=this.column,a=!this.column.isAssignment()&&!this.column.isTest();if(n)this.ultraState.goPeekState("gradebook-item.overall-grade",{columnId:s,gradeitemView:"details"});else if(this.column.isCalculated())this.ultraState.goPeekState("gradebook-item.calculation",{columnId:s,gradeitemView:"details"});else if(o&&this.column.seemsAttemptBased()&&(this.hasViewAssessmentEntitlement||a)){const n={courseId:t,contentId:e,linkRefId:i};this.scoreProviderHelper.editStateRef(o,n,D.a.GoToState)}else if(o&&this.column.isAttendance()){const n={courseId:t,contentId:e};this.scoreProviderHelper.editStateRef(o,n,D.a.GoToState)}else this.ultraState.goPeekState("grade-item.edit",{id:this.column.id})}_openColumn(){let e,t;const{contentId:n,courseId:i,id:o,linkId:a,scoreProviderHandle:r}=this.column;if(this.course.isUltra()){const c=this.hasViewAssessmentEntitlement&&(this.column.isTest()||this.column.isAssignment());if(this.isLTILink())return void this.launchLti();if(this.column.isAttendance()){const c={contentId:n,courseId:i,columnId:o,linkRefId:a};({state:e,args:t}=s.fromJson(this.scoreProviderHelper.getSubmissionListStateRef(r,c,D.a.GenerateStateParams)))}else if(this.column.externalGrade)e="gradebook-item.overall-grade",t={columnId:o};else if(this.column.isCalculated())e="gradebook-item.calculation",t={columnId:o,courseId:i};else if(r&&!this.column.isOffline()&&(this.canViewGrades||this.canViewAttempts)){const r={contentId:n,courseId:i,columnId:o,linkRefId:a};({state:e,args:t}=s.fromJson(this.scoreProviderHelper.getSubmissionListStateRef(this.column.scoreProviderHandle,r,D.a.GenerateStateParams)))}else if(r&&(this.column.isDiscussion()||this.column.isScorm()||this.column.isScormSCO()||c)){const o={courseId:i,contentId:n,linkRefId:a};({state:e,args:t}=s.fromJson(this.scoreProviderHelper.editStateRef(this.column.scoreProviderHandle,o,D.a.GenerateStateParams)))}else this.canViewGrades?(e="gradebook-item.offline",t={columnId:o,courseId:i,gradeitemView:"students"}):(e="grade-item.edit",t={id:o})}else e="course.outline",t={courseId:i,legacyUrl:this.getLegacyUrl()};this.ultraState.goPeekState(e,t)}handleColumnClick(){this.itemLinkIsClickable&&!this.isRestrictedGroupContent&&(this.isCourseView?this._openColumn():this.course.refreshConvertToUltraStatus().then(()=>{this.courseConversionService.isConversionComplete(this.course.ui.convertToUltraTaskStatus)?this._openColumn():this.showConversionTooltip()}))}showConversionTooltip(){this.showConversionMessage=!0}closeConversionTooltip(){this.showConversionMessage=!1}getAlertType(){return g.h.ConversionInProgress}launchLti(){this.ltiService.ltiLaunch({courseId:this.column.courseId,contentId:this.column.contentId,linkType:g.f.parse(this.column.scoreProviderHandle.toString()),linkRefId:this.column.linkId})}showAlertIcon(){return this.column.getNumMissingIfLate()>0}getLegacyUrl(){return"/webapps/gradebook/do/instructor/enterGradeCenter?course_id="+this.column.courseId}isLTILink(){return this.ltiService.isLTILink(this.column)}showMarkAttendance(){return this.column.isAttendance()&&this.hasViewAttendanceEntitlement}showDelete(){return this.column.isAttendance()?this.canModify&&this.showAttendanceDeleteOption:this.canModify}openAttendance(){this.ultraState.goPeekState("attendance")}showQuestionAnalysis(){return this.column.isQuestionAnalysisAvailable()&&this.canViewGrades}showDownloadTestResults(){return!this.column.isAnonymousGrading()&&(this.canViewGrades&&this.column.isTest()&&this.column.summary.numSubmissionsTotal>0)}showViewEdit(){return!(!this.column.isOffline()&&null!=this.column.scoreProviderHandle&&!this.scoreProviderHelper.supportsEdit(this.column.scoreProviderHandle))&&(!(!this.column.isOffline()&&!this.column.isCalculated())||(this.hasDesignerViewEntitlement||this.canModify))}hasContentId(){return!!this.column.contentId}getConfirmationKeyAndShowType(){let e;return this.ultraState.includes("**.outline.**")?e=L.a.CourseOutline:this.ultraState.includes("**.engagement.**")&&(e=L.a.Discussions),this.CourseModel.$new(this.column.courseId).contents.$new(this.column.contentId).$fetch().$asPromise().then(t=>this.ContentService.generateDeleteConfirmationKey(t,e).then(e=>({confirmationKey:e.ui.deleteConfirmationKey,showType:e.ui.modalShowType})))}getOverflowMenuItems(){return[{icon:this.canModify?"draw":"visible",labelKey:this.canModify?"global.edit":"global.view",show:()=>this.showViewEdit(),onClick:()=>this.viewEditColumn()},{icon:"attendance",labelKey:"components.directives.grade.grader-column.attendance.markAttendance",show:()=>this.showMarkAttendance(),onClick:()=>this.openAttendance()},{icon:"question-analysis",labelKey:"components.directives.grade.grader-column.questionAnalysisOverflowMenuLabel",show:()=>this.showQuestionAnalysis(),onClick:()=>{this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.column.contentId})}},{icon:"download",labelKey:"components.directives.grade.grader-column.downloadResults.overflowMenuLabel",show:()=>this.showDownloadTestResults(),onClick:()=>{this.ultraState.goPeekState(j.Routes.Grade.DOWNLOAD_TEST_RESULTS,{columnId:this.column.id})}},{icon:"trash",labelKey:"global.delete",onClick:()=>{this.hasContentId()?this.deleteContent():this.deleteColumn()},show:()=>this.showDelete(),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>{let e;return this.hasContentId()?this.getConfirmationKeyAndShowType().then(t=>(e=t.confirmationKey.replace(/^resource\//,""),this.$q.when(I.a(e)))):this.column&&this.column.ui&&this.column.ui.deleteConfirmationHandle?(e=this.column.ui.deleteConfirmationHandle.replace(/^resource\//,""),this.$q.when(I.a(e))):(e="generic-content",this.$q.when(I.a(e)))}}}]}get itemLinkIsClickable(){return this.isActionable&&(!this.column.isAttendance()||this.hasViewAttendanceEntitlement)&&(!this.isLTILink()||this.hasDesignerViewEntitlement)&&!this.isRestrictedGroupContent}get isActionable(){return!this.column.isAttendance()||this.scope.attendanceIsAvailable()}get showOverflowMenu(){return this.isCourseView&&!this.course.isComplete()&&this.isActionable&&(this.showViewEdit()||this.showDelete()||this.showMarkAttendance()||this.showQuestionAnalysis()||this.showDownloadTestResults())}get showDragControls(){return this.isCourseView&&!this.course.isComplete()&&this.isActionable&&this.canModify}checkIfAttendanceIsAvailable(){return!(!this.scope.attendanceIsAvailable||!this.scope.attendanceIsAvailable())}checkIfAttendanceRecordsExist(){this.showAttendanceDeleteOption=!1,this.column.isAttendance()&&this.checkIfAttendanceIsAvailable()&&this.CourseModel.$new(this.column.courseId).attendanceRecordsExist().then(e=>{this.showAttendanceDeleteOption=!e})}getNumberEligibleToBeGradedExternalSubmissions(){return s.isUndefined(this.column.summary.numGroupsNeedsGrading)?this.column.summary.numStudentsEligibleToBeGradedExternalSubmission:this.column.summary.numGroupsEligibleToBeGradedExternalSubmission}getNumberOfSubmissionsNeedsGrading(){return null==this.column.summary.numSubmissionsNeedsGrading?this.column.summary.numSubmissionsNeedsReconciling:this.column.summary.numSubmissionsNeedsGrading}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}}x.$inject=["scope","$q",u.f,c.b,S.m.serviceName,f.b,y.i,C.b,w.serviceName,$.d,o.c,D.c,a.b,k.b];class G{constructor(e){this.$injector=e,this.restrict="E",this.template=R,this.scope={assessment:"<?",column:"=",course:"&",isCourseView:"=",categoryMap:"=?",attendanceColumnExists:"&?",attendanceIsAvailable:"&"},this.link=(e,t,n)=>{e.graderColumn=this.$injector.instantiate(x,{scope:e})}}}G.$inject=["$injector"],s.module(T,[r.a,u.d,d.a,l.d,c.a,h.a,m.a,p.a,v.c,w.moduleName,D.b,$.b,O.b,a.a,I.b,k.a,b.a]).directive("bbGraderColumn",["$injector",w.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/grader-column"),e.instantiate(G))])}).call(this,n("5iHu"))},pSe1:function(e,t){e.exports='<bb-usercard usercard-show="avatar"\n  user="::message.user"\n  course-id="{{::courseId}}"\n  can-send-message="::messageControl.canSendMessageInUserCard()"\n  course-role="::messageControl.scope.courseRole"\n  auto-update="false"\n  inactive="!messageControl.isAvailable()">\n</bb-usercard>\n'},ph44:function(e,t,n){},"po/h":function(e,t){e.exports='<div class="base-grades course-grades-instructor" ng-class="{\'grades-list-view\': courseGradesGrader.isGradableItemsListView}">\n  <div ng-if="courseGradesGrader.isDesktop && !courseGradesGrader.isSmallScreen" class="guidance-wrapper"\n    aria-describedby="guidance-moment-grade-settings">\n\n    <div class="row collapse course-grades-header-buttons-wrapper js-course-skip-link-target" tabindex="-1">\n      <div class="gradebook-toolbar group-filters">\n        <bb-square-toggle one-icon-class="toggle-table"\n                          one-aria-label="components.directives.grade.course-grades-grader.views.list-button"\n                          one-view-value="list"\n                          two-icon-class="toggle-grid"\n                          two-aria-label="components.directives.grade.course-grades-grader.views.grid-button"\n                          two-view-value="grid"\n                          property="courseGradesGrader.squareToggleValue"\n                          analytics-id-tag-prefix="components.directives.grade.view.courseGrader"\n                          class="toggle-group-filters-enabled">\n        </bb-square-toggle>\n\n        <div class="gradebook-options">\n          <div class="grade-grid-search-box group-filters" ng-if="courseGradesGrader.isGridView">\n            <bb-typeahead-search-box id="student-search-box"\n                                    item-selected="courseGradesGrader.itemSelected(item)"\n                                    type-ahead-search="courseGradesGrader.typeAheadSearch(searchText)"\n                                    clear-search="courseGradesGrader.clearSelection()"\n                                    input-placeholder="components.directives.grade.search-box.placeholder"\n                                    sr-empty-results="components.directives.grade.search-box.emptyResults"\n                                    sr-results-found="components.directives.grade.search-box.resultsFound"\n                                    sr-no-results-found="components.directives.grade.search-box.noResultsFound"\n                                    sr-label="components.directives.grade.search-box.placeholder"\n                                    clear-aria-label="components.directives.grade.search-box.clear"\n                                    icon="search">\n\n                  <ng-switch on="item.type">\n                    <div ng-switch-when="user" class="element-card">\n                      <bb-user-avatar class="typeahead-user-avatar" user="::item.data.user"></bb-user-avatar>\n                      <div class="typeahead-student-name-id">\n                        <bb-username class="typeahead-name ellipse" user="item.data.user" has-title-attr="true"></bb-username>\n                        <div class="typeahead-id ellipse">{{::item.data.user.userName}}</div>\n                      </div>\n                    </div>\n                    <div ng-switch-when="column" class="element-card">\n                      <div bb-content-item-icon content-column="item.data.getMetadata()" show-alert-icon="item.data.getMetadata().getNumMissingIfLate() > 0" class="element-image" ng-if="item.data.getMetadata()"></div>\n                      <div class="typehead-title column-title ellipse">\n                        <div class="ellipse grade-title">{{::item.data.getMetadata().columnName}}</div>\n                        <div class="ellipse grade-type" bb-translate>components.directives.grade.search-box.columnName</div>\n                      </div>\n                    </div>\n                    <div ng-switch-when="category" class="element-card">\n                        <bb-ui-icon-large-document-multiple color="primary"></bb-ui-icon-large-document-multiple>\n                        <div class="typehead-title category-title ellipse">\n                          <div bb-translate class="ellipse grade-title" ng-if="::!item.data.getMetadata().gradebookCategory.isUserDefined">{{::item.data.getMetadata().gradebookCategory.localizableTitle.languageKey}}</div>\n                          <div bb-translate class="ellipse grade-title" ng-if="::item.data.getMetadata().gradebookCategory.isUserDefined">{{::item.data.getMetadata().gradebookCategory.title.split(\'.\')[0]}}</div>\n                          <div class="ellipse grade-type" bb-translate>components.directives.grade.search-box.category</div>\n                        </div>\n                    </div>\n                    <div ng-switch-default="noResult" class="element-card">\n                      <div class="no-result" bb-translate>components.directives.grade.search-box.noResultsFound</div>\n                  </div>\n                </ng-switch>\n            </bb-typeahead-search-box>\n          </div>\n          <bb-gradebook-advanced-filters-ftue ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n          </bb-gradebook-advanced-filters-ftue>\n          <div ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n            <a class="filter-panel-button super-clear button" bb-guidance-target component-key="grades.grader.search.filter"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.openAdvancedFilters\'}"\n              bb-peek-sref="gradebook-grid-advanced-filters" analytics-id="components.directives.grade.search.filter.button">\n              <bb-ui-icon-small-filter-options class="group-filters-icon"></bb-ui-icon-small-filter-options>\n              <span bb-translate>components.directives.grade.course-grades-grader.actions.filter</span>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.userHasViewGradebookPermission">\n            <a class="open-attempt-receipt-search button super-clear" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.attemptReceiptSearch\'}"\n              bb-peek-sref="attempt-receipt-search" analytics-id="components.directives.grade.actions.openAttemptReceiptSearch.link">\n              <bb-ui-icon-medium-content-view></bb-ui-icon-medium-content-view>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.canUploadGradebook">\n            <a class="open-upload-settings button super-clear" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.upload\'}"\n              bb-peek-sref="grade-upload-setting" ng-if="!courseGradesGrader.course.isComplete()" analytics-id="components.directives.grade.actions.upload.link">\n              <bb-ui-icon-small-upload></bb-ui-icon-small-upload>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.canDownloadGradebook">\n            <a class="open-downLoad-settings button super-clear" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.download\'}"\n              bb-peek-sref="grade-download-setting" ng-if="!courseGradesGrader.course.isComplete()" analytics-id="components.directives.grade.actions.download.link">\n              <bb-ui-icon-small-download></bb-ui-icon-small-download>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.userHasViewGradebookPermission" course-id="course.model.id">\n            <a class="open-gradebook-settings button super-clear js-open-settings" bb-guidance-target component-key="grades.grader.course.settings"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.openSettings\'}"\n              bb-peek-sref="grade-setting" analytics-id="components.directives.grade.actions.openSettings.link">\n              <bb-ui-icon-medium-settings></bb-ui-icon-medium-settings>\n            </a>\n          </div>\n        </div>\n      </div>\n      <bb-filter-chips\n        ng-if="courseGradesGrader.isGridView && courseGradesGrader.hasUrlFilters"\n        analytics-id="gradebook.grid.filters">\n      </bb-filter-chips>\n    </div>\n    <bb-guidance id="guidance-moment-grade-settings" component-key="grades.grader.course.settings" class="guidance-element-overlay push-bottom"\n      role="tooltip">\n      <p>\n        <bb-translate>components.directives.grade.course-grades-grader.ftue.setting</bb-translate>\n      </p>\n    </bb-guidance>\n\n  </div>\n  <bb-gradebook-list-view-tabs\n    on-tab-changed="courseGradesGrader.changeListViewType"\n    selected-tab="courseGradesGrader.currentTabId"\n    ng-if="!courseGradesGrader.isGridView"\n  ></bb-gradebook-list-view-tabs>\n\n  <div ng-if="courseGradesGrader.isGridView || courseGradesGrader.isGradableItemsListView">\n    \x3c!-- Empty state template: this section of the page will be displayed when there is no content, and will invite users to create content --\x3e\n    <div class="is-empty-page js-course-skip-link-target"\n         ng-if="courseGradesGrader.columns.$resolved && courseGradesGrader.columns.length === 0 && !courseGradesGrader.hasUrlFilters">\n      <div class="is-empty-wrapper">\n        <div class="is-empty-explanation">\n          <img src="./static/images/ftue/course-grades-instructor.svg" bb-translate-attrs="{alt: \'components.directives.grade.course-grades-grader.empty.addItems\'}" />\n          <h1 class="is-empty-heading" bb-translate>components.directives.grade.course-grades-grader.empty.header</h1>\n          <p bb-translate>components.directives.grade.course-grades-grader.empty.description</p>\n        </div>\n        <div class="add-element">\n          <ul role="menu" class="element-list-add-menu small-block-grid-1 medium-block-grid-3 large-block-grid-4">\n            <li>\n              <a role="menuitem" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addCalculation\'}"\n                 bb-peek-sref="gradebook-item.calculation" analytics-id="components.directives.grade.addCalculation.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addCalculation</span>\n                </div>\n              </a>\n            </li>\n            <li>\n              <a role="menuitem" class="js-empty-add-item" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addItem\'}"\n                 bb-peek-sref="grade-item.create" analytics-id="components.directives.addItem.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addItem</span>\n                </div>\n              </a>\n            </li>\n            <li ng-if="courseGradesGrader.attendanceIsAvailable">\n              <a role="menuitem" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addAttendance\'}"\n                 bb-peek-sref="attendance" analytics-id="components.directives.grade.addAttendance.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addAttendance</span>\n                </div>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n\n    <div class="grade-list-container"\n         ng-if="courseGradesGrader.isGradableItemsListView && courseGradesGrader.showGradeListContainer()">\n      <div class="spinner bb-secondary-color-2" ng-if="!courseGradesGrader.columns" aria-hidden="true"></div>\n      <div bb-infinite-scroll="courseGradesGrader.renderMoreColumns()"\n           infinite-scroll-container="\'.bb-offcanvas-panel-wrap .panel-wrap\'"\n           infinite-scroll-current-count="courseGradesGrader.columns.length"\n           infinite-scroll-focusable-children-selector=".grader-column .name a, .floating-headers .item-headers .grade-grid-header-content-wrapper"\n           infinite-scroll-load-limit="courseGradesGrader.GRADE_COLUMN_LOAD_LIMIT"\n           infinite-scroll-localization-keys-prefix="components.directives.grade.course-grades-grader.infiniteScroll"\n           infinite-scroll-total-count="courseGradesGrader.totalColumnCount"\n           infinite-scroll-tray-id="course-grades-grader">\n        <bb-course-grades-grader-list course="courseGrades.course"\n                                      is-first="true"\n                                      columns="courseGradesGrader.columns"\n                                      show-setup-overall-column="courseGradesGrader.showSetupOverallColumn"\n                                      attendance-is-available="courseGradesGrader.attendanceIsAvailable">\n        </bb-course-grades-grader-list>\n      </div>\n    </div>\n\n    <div class="grade-grid-content"\n         ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n      <div>\n        <bb-grade-grid-reborn course="courseGrades.course"\n                              columns="courseGradesGrader.visibleColumns"\n                              attendance-is-available="courseGradesGrader.attendanceIsAvailable"\n                              merged-courses="courseGradesGrader.mergedCourses"\n                              ng-show="!courseGradesGrader.areFilterResultsEmpty">\n        </bb-grade-grid-reborn>\n        <div class="is-empty-page advanced-filters"\n            ng-if="courseGradesGrader.areFilterResultsEmpty">\n          <div class="is-empty-wrapper">\n            <div class="is-empty-explanation">\n              <h1 class="is-empty-heading" bb-translate>components.directives.grade.course-grades-grader.empty.advancedFilters.header</h1>\n              <p bb-translate>components.directives.grade.course-grades-grader.empty.advancedFilters.description</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- Student List View handles its own loading indicator and empty state --\x3e\n  <div ng-if="courseGradesGrader.isStudentListView" class="student-list-view-container">\n    <bb-student-list-view course-id="courseGrades.course.id"></bb-student-list-view>\n  </div>\n</div>\n'},px9Z:function(e,t,n){},q1bP:function(e,t,n){n("Llzl");n("SY8P"),e.exports="dibari.angular-ellipsis"},qH3X:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const s="rb_grade_grid_",i={REFRESH_OVERALL_EDITOR:`${s}refresh_overall_editor`,REFRESH_CELL_EDITOR:`${s}refresh_cell_editor`,SELECT_GROUP:`${s}select_group`,REFRESH:`${s}refresh`,FOCUSIN_CELL:`${s}focusin`,FOCUSOUT_CELL:`${s}focusout`,ENTER_EDITOR:`${s}enter_editor`,CLOSE_EDITOR:`${s}close_editor`,ADVANCED_FILTERS_COLUMNS:`${s}advanced-filter-columns`,ADVANCED_FILTERS_ROWS:`${s}advanced-filter-rows`,GRADEBOOK_CLEAR_SEARCHBOX_SELECTION:`${s}gradebook-clear-searchbox-selection`,GRADEBOOK_USER_SELECTED:`${s}gradebook-user-selected`,GRADEBOOK_COLUMN_SELECTED:`${s}gradebook-column-selected`,GRADEBOOK_CATEGORY_SELECTED:`${s}gradebook-category-selected`}},qzMN:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-content-collection",use:"icon-small-content-collection-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-collection"><path d="M14 15H2V9h3v1h6V9h3v6zM13 9V4H3v5M4 4V1h8v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},r133:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var s=n("Llzl"),i=n("Fvsw"),o=n("0JpG"),a=n("0+Qs"),r=n("BXQP");const c="ultra.directives.bbDuration",l="refresh.relative.dates";class d{constructor(e,t,n,s){this.scope=e,this.bbContext=t,this.bbLocalize=n,this.interval=s,this.date="",this.time="",this.lessThanOneDay=!1;const i=e.$watch("date",()=>{this._localizeRelativeDate(),e.autoUpdate&&!e.autoUpdate()&&e.date&&i()});e.$on(l,()=>{this._localizeRelativeDate()}),this.interval(()=>{this._localizeRelativeDate()},this.scope,d.DEFAULT_REFRESH_INTERVAL)}needAgo(){return!!(this.scope.hasAgo&&this.scope.hasAgo()&&this.lessThanOneDay)}separateDatetime(){return!(!this.scope.separateDatetime||!this.scope.separateDatetime())}_localizeRelativeDate(){if(this.scope.date){let e={},t=new Date;const n=this.scope.isRelativeToServerDate&&this.scope.isRelativeToServerDate();(null==n||n)&&(e={relativeTo:this.bbContext.getServerTime()},t=this.bbContext.getServerTime());const s=t.getTime()-this.scope.date.getTime();if(s>=6e4&&this.scope.date.setSeconds(30),this.lessThanOneDay=s<=864e5,this.needAgo()||this.separateDatetime()){const t=this.bbLocalize.getFormatEnum(o.ILocaleDateFormat,this.scope.dateFormat)||o.ILocaleDateFormat.Short;this.bbLocalize.formatDuration(this.scope.date,this.scope,e,t).then(e=>{this.date=e.date||"",this.time=e.time||""})}}}}d.DEFAULT_REFRESH_INTERVAL=18e4,d.$inject=["scope",i.b,o.serviceName,a.b];class u{constructor(e){this.$injector=e,this.restrict="E",this.replace=!0,this.template=r,this.scope={date:"=",autoUpdate:"&?",isRelativeToServerDate:"&?",dateFormat:"@?",hasAgo:"&?",separateDatetime:"&?"},this.link=e=>{e.duration=this.$injector.instantiate(d,{scope:e})}}}u.$inject=["$injector"],s.module(c,[i.a,o.moduleName,a.a]).directive("bbDuration",["$injector",e=>e.instantiate(u)])},rtZE:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var s=n("nsO7"),i=n("Llzl");
/*
 * An Angular service which helps with creating recursive directives.
 * @author Mark Lagendijk
 * @license MIT
 */
const o="ultra.service.RecursionHelper",a="recursionHelper";
/**
 * An Angular service which helps with creating recursive directives.
 * @author Mark Lagendijk
 * @license MIT
 *
 * Sample usage:
 * ```typescript
 *
 * var link = (scope: IScope, element: JQuery) => {
 *   // do stuff
 * };
 *
 * var compile = (element: JQuery) => {
 *   return recursiveHelper.compile(element, link);
 * };
 *
 * ```
 *
 */
class r{constructor(e){this.$compile=e,this.compileContents=s.memoize(this.compileContents)}compileContents(e,t){return this.$compile(t)}compile(e,t,n){i.isFunction(n)&&(n={post:n});const s=t.contents();return t.empty(),{pre:n&&n.pre?n.pre:null,post:(t,i,...o)=>{this.compileContents(e,s)(t,(function(e){i.append(e)})),n&&n.post&&n.post.apply(null,[t,i,...o])}}}}r.$inject=["$compile"];class c extends r{}i.module(o,[]).service(a,r)},"s+Z7":function(e,t,n){"use strict";n("st/R");var s=n("5iHu"),i=n("Llzl"),o=n("+wu9");n.d(t,"a",(function(){return a}));const a="ultra.components.directives.typeahead-selected-options";class r{constructor(e){this.scope=e}removeOption(e){this.scope.removeOption({item:e}),this.scope.focusElementId&&s("#typeahead-search-box-"+this.scope.focusElementId).focus()}}r.$inject=["scope"];class c{constructor(e){this.$injector=e,this.restrict="E",this.replace=!0,this.template=o,this.scope={selectedOptions:"=",removeOption:"&",selectedOptionsListLabel:"@",focusElementId:"@?"},this.link=e=>{e.typeaheadSelectedOptions=this.$injector.instantiate(r,{scope:e})}}}c.$inject=["$injector"],i.module(a,[]).directive("bbTypeaheadSelectedOptions",["$injector",e=>e.instantiate(c)])},s1u2:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content content-header-bg" tabindex="0" role="columnheader"\n       ng-class="{\'is-restricted\': columnMetadata.isHiddenFromStudents(), \'is-unavailable\': !gradeGridColumnHeaderReborn.toolAvailable || !col.hasContextMenuOptions()}"\n       ng-click="gradeGridColumnHeaderReborn.popupMenu($event)"\n       analytics-id="components.directives.grade.grid.gradeGridColumnHeaderReborn.popupMenu">\n    <div bb-content-item-icon content-column="columnMetadata" show-alert-icon="showAlertIcon()" class="element-image" role="presentation"></div>\n    <div class="ellipse grade-name" title="{{columnMetadata.columnName}}" aria-labelledby="summary-info-{{columnMetadata.id}}">{{columnMetadata.columnName}}</div>\n  </div>\n\n  <div class="grade-grid-header-summary" tabindex="0" id="summary-points-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse points" title="{{gradeGridColumnHeaderReborn.getSchemaText()}}">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && !columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse grade-count"\n            bb-translate-attrs="{\'title\': \'components.directives.grade.grid.gradedTip\'}" translate-attrs-values="{count: isGroupTest ? columnMetadata.summary.numStudentsGradedNeedsPosting + columnMetadata.summary.numStudentsPosted + columnMetadata.summary.numberOfStudentsOverriddenGradesToPost : columnMetadata.summary.numStudentsGraded()}"\n            bb-translate translate-values="{count: isGroupTest ? columnMetadata.summary.numStudentsGradedNeedsPosting + columnMetadata.summary.numStudentsPosted + columnMetadata.summary.numberOfStudentsOverriddenGradesToPost : columnMetadata.summary.numStudentsGraded()}">components.directives.grade.grid.graded</span>\n      <span class="grade-pipe"></span>\n      <span class="ellipse grade-posted-count"\n            bb-translate-attrs="{\'title\': \'components.directives.grade.grid.postedTip\'}" translate-attrs-values="{count: isGroupTest ? columnMetadata.summary.numStudentsPosted : columnMetadata.summary.numPosted}"\n            bb-translate translate-values="{count: isGroupTest ? columnMetadata.summary.numStudentsPosted : columnMetadata.summary.numPosted}">components.directives.grade.grid.posted</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    ng-class="{\'grade-complete-status\': !gradeGridColumnHeaderReborn.isRestricted()}"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grader-column.statuses.restricted\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()" class="grade-grid-header-summary"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grader-column.statuses.restricted\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grid.completeLabel\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="(!col.isShowSummary() || !columnMetadata.isVisibleToStudents()) && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse grade-status"></span>\n    </div>\n  </div>\n\n  <div ng-if="columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse items-count" ng-if="columnMetadata.itemsCount !== undefined"\n        bb-translate-attrs="{\'title\': \'components.directives.grade.grid.itemsTip\'}"\n        translate-attrs-values="{count: columnMetadata.itemsCount}" bb-translate\n        translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n    </div>\n  </div>\n</div>\n'},s4xR:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-attendance",use:"icon-small-attendance-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-attendance"><path d="M15 15V2H1v13h14zM4.5 1v1h7V1h-7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 9l2 2 4-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},s52B:function(e,t){e.exports='<div class="rb-grid-container" ng-style="container.getContainerStyle()" role="grid">\n  <div class="rb-ax-focus-placeholder sr-only" tabindex="-1"></div>\n  <div class="rb-grid-header-wrapper">\n    <div class="rb-grid-header">\n      <div class="rb-grid-canvas" ng-style="container.getHeaderCanvasStyle()" role="rowgroup">\n        <div class="rb-row rb-header-row" ng-class="::container && {\'rb-row-border\': container.headerBorder} || undefined" role="row">\n          <div rb-grid-cell="col.headerTemplate"\n               class="rb-cell rb-header-cell"\n               ng-class="[\'rb-col-\' + col.id, \'rb-column-position-\' + col.id, {\'rb-cell-border\': col.border}]"\n               role="columnheader"\n               ng-repeat="col in container.renderedColumns track by $index"\n               ng-click="container.callbacks.header($event)"\n               analytics-id="components.directives.gridContainer.header.{{::col.id}}.button">\n            <div class="rb-add-column-placeholder" ng-if="::container.canAddColumn()" ng-mouseenter="container.columnAdder.enter($event, col)"></div>\n          </div>\n          <div class="rb-add-column-placeholder first" ng-if="::container.canAddColumn()" ng-mouseenter="container.columnAdder.enter($event)"></div>\n        </div>\n      </div>\n    </div>\n    <div ng-if="container.hasVScrollbar" class="rb-grid-scrollbar-placeholder-y"></div>\n  </div>\n  <div class="rb-grid-body" ng-style="container.getBodyStyle()">\n    <div class="rb-grid-canvas" ng-style="container.getBodyCanvasStyle()" role="rowgroup">\n      <div class="rb-row rb-cell-row" ng-repeat="row in container.renderedRows track by $index" role="row"\n          ng-class="[\'rb-row-position-\' + row.id, container && {\'rb-row-border\': container.rowBorder} || undefined]">\n        <div rb-grid-cell="col.cellTemplate"\n             class="rb-cell"\n             ng-class="[\'rb-col-\' + col.id, \'rb-row-\' + row.id, \'rb-column-position-\' + col.id, {\'rb-cell-border\': col.border}]"\n             role="gridcell"\n             ng-repeat="col in container.renderedColumns track by $index"\n             ng-click="container.callbacks.cell($event)"\n             analytics-id="components.directives.gridContainer.callback"\n        ></div>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!container.hasHScrollbar" class="rb-grid-scrollbar-placeholder-x"></div>\n  <div class="rb-add-column" ng-if="::container && container.canAddColumn()">\n    <div class="column-header-button-wrapper" ng-mouseleave="container.columnAdder.leave()">\n      <a class="small button clear icon button-add-content hide"\n         href="javascript:void(0);"\n         ng-click="container.columnAdder.onClick($event)"\n         role="button"\n         aria-haspopup="true"\n         analytics-id="components.directives.grade.grid.addBtuAriaLabel.link">\n        <span class="sr-only" bb-translate>components.directives.grade.grid.addBtuAriaLabel</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},sB2Z:function(e,t){e.exports='<div class="content-wrapper" ng-class="{\'nocontent\': !content.canViewAsInstructor()}">\n  <div class="name">\n    <ng-switch on="content.getContentDisplay().viewHandler()" ng-class="{\'has-indicator\': content.ui.hasIndicator}">\n      <div ng-switch-when="resource/x-bb-folder" class="engagement-folder">\n        <bb-content-item-folder></bb-content-item-folder>\n      </div>\n      <a ng-switch-when="resource/x-bb-forumlink"\n         bb-peek-sref="discussion.view.with-grading({contentId:content.id})"\n         bb-prevent-click-if="content.isConditionalReleaseLocked()"\n         ng-attr-tabindex="{{ content.isConditionalReleaseLocked() ? -1 : 0 }}"\n         class="content-title"\n         analytics-id="content.item.engagement.outline.forumLink.link"\n         aria-describedby="activity-indicator-{{::content.id}}"\n      >\n        <span>{{ content.title }}</span>\n      </a>\n      <div ng-switch-default class="content-title">{{ content.title }}</div>\n      <bb-svg-icon role="img" aria-hidden="false" bb-translate-attrs="::{\'aria-label\':\'components.directives.content-item-base.aria-label.indicator\'}" ng-if="content.ui.hasIndicator" id="activity-indicator-{{::content.id}}" class="indicator" size="small" icon="activity-indicator" status="active"></bb-svg-icon>\n    </ng-switch>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date">\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-if="!dueDate" class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-if="dueDate && !gradeDetail" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-if="dueDate && !gradeDetail" class="content-due-date"></bb-datetime>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date"\n       ng-class="{\'is-late\': contentItemBase.isLate}" ng-switch="dueDate != null">\n    \x3c!-- submission card --\x3e\n    \x3c!--  TODO: submissionCard is disabled until LRN-101279 is fixed --\x3e\n    \x3c!-- <bb-submission-card ng-if="gradeDetail"  grade-detail="gradeDetail" inline="true"></bb-submission-card>\n    <bb-submission-card ng-if="!gradeDetail" grading-column="gradingColumn" inline="true"></bb-submission-card> --\x3e\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-switch-default class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-switch-when="true" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-switch-when="true" class="content-due-date"></bb-datetime>\n  </div>\n  <div ng-if="contentItemBase.isModifyPermissionLoaded && content.canHaveAttempts() && content.isGroupContent" class="group-info">\n    <div class="group-name">\n      <span><bb-svg-icon size="small" icon="groups"></bb-svg-icon></span>\n      <a href="javascript:void(0);"\n         ng-if="contentItemBase.hasViewGroupsAsAdmin"\n         ng-click="contentItemBase.editGroups()"\n         analytics-id="content.item.engagement.outline.contentItemBase.editGroups.link"\n      >\n        <bb-group-count content="content"></bb-group-count>\n      </a>\n      <span ng-if="contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin">\n        <bb-group-count content="content"></bb-group-count>\n      </span>\n      <div ng-if="!contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin" class="title">\n        <bb-group-student-enrollment content="content"></bb-group-student-enrollment>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.isConditionalReleaseLocked()"\n    role="tooltip"\n    class="lock-info"\n    tabindex="0"\n    bb-complex-tooltip\n    enhanced-tooltip="true"\n    tooltip-position="bottom"\n    tooltip-open-on-activation="true"\n    tooltip-disable-on-mouse-over="true"\n    tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n    tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n    <span bb-translate="components.directives.content-item-base.conditionalRelease.lock-info"></span>\n    <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n  </div>\n  <div class="student-created-info" ng-if="::contentItemEngagementOutline.isDiscussionCreatedByStudent()">\n    <span bb-translate="components.directives.content-item-base.content.discussionAuthorship.student"></span>\n  </div>\n  <div class="name-controls stop-click-propagation"\n    ng-class="{\n      \'name-conditional-release\': !content.canViewAsInstructor() && content.isConditionalReleaseLocked(),\n      \'selector-disabled\': content.isInForcedSequenceModule()\n    }"\n    ng-if="contentItemBase.showVisibility()">\n    <bb-content-visibility-selector content="content"\n                                    link-content="contentItemBase.targetContent"\n                                    onchange-func="contentItemBase.updateContentVisibility()"\n                                    disable-restricted="contentItemBase.disableRestricted"\n                                    open-panel-on-restricted="true"\n                                    verbose-restricted-label="true"></bb-content-visibility-selector>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.isConditionalRelease()" class="conditional-release-control">\n    <div class="rules">\n      <a href="javascript:void(0);"\n        ng-click="contentItemEngagementOutline.openConditionalRelease()"\n        bb-complex-tooltip\n        enhanced-tooltip="true"\n        tooltip-position="bottom"\n        tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n        tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n        tooltip-auto-update="true"\n        tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n        tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n        analytics-id="components.directives.content-item-base.conditionalRelease.link">\n        <span>{{contentItemBase.conditionalRelease.getConditionDescription()}}</span>\n        <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},sa5q:function(e,t){e.exports='<div ng-switch on="content.canViewAsInstructor() || !content.shouldRestrict()">\n  \x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n  <a class="content-title"\n     bb-peek-sref="content-manage.edit.document({id:content.id})"\n     ng-switch-when="true"\n     ng-class="{\'name-middle\': contentItemBase.shouldAlignMiddle()}"\n     aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n     analytics-id="content.item.page.edit.document.link"\n     aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n     tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n     <span>{{ content.title }}</span>\n  </a>\n  <span class="content-title"\n        ng-switch-default\n        ng-class="{\'name-middle\': contentItemBase.shouldAlignMiddle()}"\n        aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n        tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">{{ content.title }}</span>\n</div>\n'},smDF:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-add-circle",use:"icon-medium-add-circle-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-add-circle"><circle cx="12" cy="12" r="11" stroke-width="2" /><path d="M12 7v10M7 12h10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"st/R":function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-clear",use:"icon-small-clear-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-clear"><path d="M1 8c0-3.866 3.134-7 7-7v0c3.866 0 7 3.134 7 7v0c0 3.866-3.134 7-7 7v0c-3.866 0-7-3.134-7-7v0zM10 6l-4 4M6 6l4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},suMx:function(e,t,n){"use strict";n("q1bP");var s=n("Llzl"),i=n("Nyb7");const o="ultra.components.directives.statistics.complexStatistic";class a{constructor(e,t,n){this.scope=e,this.element=t,this.$compile=n;const s=this.$compile(this.scope.item().complexTemplate)(this.scope.item().complexScope);t.append(s)}}a.$inject=["scope","element","$compile"];class r{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=i,this.scope={item:"&"},this.link=(e,t)=>{e.complexStatistic=this.$injector.instantiate(a,{scope:e,element:t})}}}r.$inject=["$injector"],s.module(o,[]).directive("bbComplexStatistic",["$injector",e=>e.instantiate(r)]);var c=n("zphb");class l{constructor(e,t){this.scope=e,this.$sce=t,this.scope.item().trusted=t.trustAsHtml(this.scope.item().data)}}l.$inject=["scope","$sce"];class d{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=c,this.scope={item:"&"},this.link=e=>{e.simpleStatistic=this.$injector.instantiate(l,{scope:e})}}}d.$inject=["$injector"],s.module("ultra.components.directives.statistics.simpleStatistic",[]).directive("bbSimpleStatistic",["$injector",e=>e.instantiate(d)]);var u=n("c2Z8");n.d(t,"a",(function(){return h}));const h="ultra.components.directives.statistics";class p{constructor(e){this.scope=e,this.smallPerRow=e.smallPerRow()||1,this.largePerRow=e.largePerRow()||4,this.scope.$watch("config()",e=>{e&&(this.config=e.length>10?e.slice(0,10):e,this.total=this.config.length)})}}p.$inject=["scope"];class m{constructor(e){this.$injector=e,this.replace=!0,this.restrict="AE",this.template=u,this.scope={config:"&",smallPerRow:"&",largePerRow:"&"},this.link=e=>{e.statistics=this.$injector.instantiate(p,{scope:e})}}}m.$inject=["$injector"],s.module(h,["dibari.angular-ellipsis",o,"ultra.components.directives.statistics.simpleStatistic"]).directive("bbStatistics",["$injector",e=>e.instantiate(m)])},tTiy:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options"\n          data-show-add-options ng-click="addContentButton.toggleMenu()"\n          ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n          aria-expanded="{{addContentButton.isMenuVisible}}"\n          aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n          aria-label="{{addContentButton.addButtonAriaLabel}}"\n          ng-focus="addContentButton.showButton()"\n          ng-blur="addContentButton.hideButton()"\n          analytics-id="components.directives.add-content-button.attempts.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        monitor-leave="true"\n        allow-multiple="true"\n        target-div="{{\'#\' + fileListViewId}}"\n        disable-drag="disableDrag && disableDrag()"\n        hide-transclude-during-upload="false"  is-third-party-upload="false"\n        third-party-download-handler="addContentButton.downloadFile"\n        skip-zip-file-check="true">\n        <div class="columns medium-12" ng-class="{\'medium-center\': attempt.isMobile}">\n          <a href="javascript:void(0);"\n             role="menuitem"\n             bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n             ng-click="addContentButton.toggleMenu()"\n             analytics-id="components.directives.add-content-button.attempts.fileUpload.link">\n            <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n            <span bb-translate>course.content.fileUpload.addFiles</span>\n          </a>\n        </div>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},tZxt:function(e,t){e.exports='<div bb-load-bundle="components/directives/discussion"\n  bb-intersection-observer-target intersection-observer-target-id="{{::messageMode === \'view\' ? \'message\' + message.id : \'\'}}"\n                                  in-callback="inCallback()"\n                                  out-callback="outCallback()">\n  <div class="reply-form comments"\n      in-view="messageControl.updateMessageStatus($inview, message)"\n      in-view-options="{ debounce: 2000 }"\n      tabindex="-1"\n      message-id="{{messageMode === \'view\' ? message.id : \'\'}}">\n    <div class="clearfix">\n      <div ng-if="::messageControl.isUserCardShown()" class="element-card discussion-item nocontent">\n        <div class="element-details message-avatar-container"></div>\n        <div class="user-info {{::\'message_user\'+message.user.id}}">\n          <div class="username-wrapper">\n            <span class="user-role-label" bb-translate course-org-token-resolver>course.engagement.conversationView.instructorLabel</span>\n            <h3 ng-class="{ inactive: !messageControl.isAvailable() }">\n              <bb-username user="message.user" show-pronouns="true" show-pronunciation="true"></bb-username>\n            </h3>\n            <span ng-if="messageControl.isMessageDrafted()" class="is-draft-label" bb-translate>components.directives.discussion.message.draftLabel</span>\n          </div>\n          <bb-duration date="message.postDate" auto-update="true" has-ago="true"></bb-duration>\n          <i ng-if="messageControl.scope.showDueDate" class="overdue-tip" bb-translate>components.directives.discussion.message.overdue</i>\n          <span ng-if="::messageControl.shouldShowUnreadInfo() && !message.states.readStateInd" class="is-new-label" bb-translate>components.directives.discussion.message.newLabel</span>\n        </div>\n      </div>\n    </div>\n    <div ng-if="::messageControl.isAvatarShown()">\n      <bb-avatar user="::loginUser"></bb-avatar>\n    </div>\n\n    <form name="editorForm">\n      <bb-rich-text-editor\n        ng-if="message.id"\n        name="responseEditor"\n        ng-model="messageControl.messageBody.rawText"\n        editor-placeholder-key="{{placeholderKey}}"\n        is-toolbar-hidden="!isEditorActive"\n        is-disabled="messageMode === \'new\' && isDiscussionEdit && !messageControl.isEditing"\n        is-read-only="messageMode !== \'new\' && !isEditorActive"\n        ng-click="messageControl.onEditorClick()"\n        ng-change="messageControl.onMessageChange()"\n        on-blur="messageControl.onEditorBlur()"\n        on-focus="messageControl.setEditorActive()"\n        content-market-is-read-only="messageControl.hideContentMarketInEditor()"\n        show-word-count="showWordCount"\n        plugin-options="{attachment: true, contentMarket: true, math: true}"\n        analytics-id="components.directives.discussion.message.onEditorClick">\n      </bb-rich-text-editor>\n    </form>\n    <div class="error-message" role="alert" ng-if="messageControl.inputTooLong">\n      <bb-svg-icon icon="attention" size="small" status="alert"></bb-svg-icon>\n      <span bb-translate>components.directives.message.tooLargeMessage</span>\n    </div>\n    <div\n      class="panel-editor-controls"\n      ng-show="isEditorActive"\n    >\n      <button class="button button--text draft-button"\n          ng-click="messageControl.onSave(true)"\n          ng-blur="messageControl.onEditorBlur()"\n          ng-if="messageControl.isMessageDrafted()"\n          ng-disabled="messageControl.disableSaveDraftButton"\n          bb-translate\n          analytics-id="components.directives.discussion.saveDraftLabel">\n          components.directives.discussion.saveDraftLabel\n      </button>\n      <button class="button button--secondary js-secondary-button js-text-editor-cancel"\n          ng-click="messageControl.onCancel()"\n          ng-blur="messageControl.onEditorBlur()"\n          bb-translate\n          analytics-id="components.directives.discussion.cancelLabel">\n        components.directives.discussion.cancelLabel\n      </button>\n      <button class="button js-primary-button js-text-editor-save"\n          ng-click="messageControl.onSave()"\n          ng-blur="messageControl.onEditorBlur()"\n          ng-disabled="messageControl.disableSaveButton"\n          bb-translate\n          analytics-id="{{ messageControl.saveButtonLabelKey }}">\n        {{ messageControl.saveButtonLabelKey }}\n      </button>\n    </div>\n\n    <div ng-show="messageControl.shouldShowOverflowMenu()" class="content-item-controls overflow-menu-container" bb-foundation-defer>\n      <bb-overflow-menu ng-if="messageControl.overflowMenus"\n                        ng-hide="messageControl.isReadOnly()"\n                        element-id="{{\'comment-field\' + message.id}}"\n                        menu-items="messageControl.overflowMenus"\n                        element-name="{{messageControl.getMoreOptionsLabel(message.user.givenName, message.user.familyName, message.postDate)}}"\n                        analytics-id-tag-prefix="{{analyticsIdTagPrefix}}.message">\n      </bb-overflow-menu>\n    </div>\n\n    <div ng-if="messageControl.isContentFixed()" class="content">\n      <div class="controls">\n        <button class="button icon medium super-clear text-editor-delete" ng-if="messageControl.showDeleteButton()"\n                type="button"\n                ng-click="messageControl.onDelete()"\n                bb-confirmation-needed="{{ deleteConfirmHandler }}"\n                choices="{{ messageControl.getChoices() }}"\n                show-type="{{modalShowType}}"\n                aria-label="{{messageControl.getDeleteLabel()}}"\n                analytics-id="components.directives.discussion.message.delete.button">\n          <bb-svg-icon icon="trash" size="medium"></bb-svg-icon>\n        </button>\n      </div>\n    </div>\n    <div class="edited-by" ng-if="!messageControl.isMessageDrafted() && (message.lastUpdateUser && message.editDate && messageMode !== \'new\')"\n         ng-switch="message.lifecycle.toString() !== \'DELETED\'">\n      <div ng-switch-when="true" class="edit-info" bb-translate translate-values="{user: messageControl.lastUpdateUsername, editDate: message.editDate}">\n        components.directives.discussion.message.lastUpdateInfo\n      </div>\n      <div ng-switch-when="false" class="edit-info" bb-translate translate-values="{user: messageControl.lastUpdateUsername, editDate: message.editDate}">\n        components.directives.discussion.message.lastDeleteInfo\n      </div>\n    </div>\n  </div>\n</div>\n'},tecA:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));var s=n("D57K"),i=n("Llzl"),o=n("0JpG"),a=n("TnpK"),r=n("+4Px"),c=n("g66W"),l=n("aHpC");const d="text-editor-update-original-value";let u=class{constructor(e,t,n,s,i){this.scope=e,this.element=t,this.ctrl=n,this.bbLocalize=s,this.bbUltraState=i,this.focusOnAuthorControls=!1,this.isTextTouched=!1,this.myDirection="down",this.preventBlur=!1,this.currentStateName=i.current.name,e.disableInlineEditing=null!=e.disableInlineEditing&&e.disableInlineEditing,this.scope.$stopDigestPropagation=!0,this.originalNgModel=this.scope.ngModel,e.direction&&null!=e.direction()&&(this.myDirection=e.direction());const o=!(this.scope.ngModel&&this.scope.ngModel.length);e.$emit("text-editor-empty",{textEditor:this,isEmpty:o}),e.$root.$on("bb-bbml-editor-bbml-pre-redraw",()=>{this.updateOriginalValues()}),e.$on("text-editor-set-pristine",()=>{this.isTextTouched=!1}),e.$on("text-editor-viewValue-initialized",()=>{this.truncatedViewValue=this.ctrl.$viewValue}),e.$on("text-editor-reset-to-original-value",()=>{this.isDirty()&&this.updateOriginalValues(),this.resetEditor(!1)}),e.$on(d,()=>{this.updateOriginalValues(),this.isTextTouched=!1}),e.$on("$destroy",()=>{this.isTextTouched=!1})}isEditorDirty(){return this.isTextTouched}getContentLabel(){const e=this.getPlaceholderKey();return this.truncatedViewValue||e}getPlaceholderKey(){return this.scope.placeholderAttrsValues===this.originalPlaceholderAttrValues&&null!=this.placeholderText||(this.placeholderText=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.scope.placeholderKey,params:this.scope.$eval(this.scope.placeholderAttrsValues)}),this.originalPlaceholderAttrValues=this.scope.placeholderAttrsValues),this.placeholderText}get truncatedViewValue(){return this._truncatedViewValue}set truncatedViewValue(e){const t=this.element.find(".editor-element"),n=t.length?t.text():void 0;this._truncatedViewValue=c.h(n,100)}onChange(e){e&&e.keyCode===r.u||this.scope.hasFocus&&(this.isTextTouched=!0,this.scope.onchangeFunc&&this.scope.onchangeFunc({event:e}))}onKeydown(e){}isUploadProgressModalOpen(){const e=i.element(".progress-indicator-modal");return e&&e.length>0}isAddContentSelectorOpened(){return this.bbUltraState.current.name.length>this.currentStateName.length&&c.k(this.bbUltraState.current.name,this.currentStateName)}onBeforeBlur(){return!this.preventBlur&&!this.scope.disableInlineEditing}onBlur(){return this.scope.hasFocus=!1,this.ctrl.$focused=!1,this.scope.onblurFunc&&this.scope.onblurFunc(),!0}onFocus(){this.focusOnAuthorControls=!1,this.scope.readonly()||this.scope.hasFocus||(this.scope.hasFocus=!0,this.ctrl.$focused=!0,this.scope.onFocusFunc&&this.scope.onFocusFunc(),this.scope.$emit("entering-edit-state"))}isDirty(){return!(this.originalText||this.isTextTouched)}updateOriginalValues(){this.scope.ngModel===this.originalNgModel&&(this.originalText=this.scope.ngModel,this.originalPlainText=this.scope.plainText)}restoreFromOriginalValues(){this.originalText||(this.originalText="",this.originalPlainText=""),this.scope.ngModel=this.originalText,this.scope.plainText=this.originalPlainText}resetEditor(e){this.restoreFromOriginalValues()}isValidInputLength(){let e=null;if(null!=this.scope.getInputMaxLength&&(e=this.scope.getInputMaxLength()),null==e)return!0;if(e){const t=this.scope.plainText;return!!t&&t.trim().length<=e}return!0}};u=Object(s.__decorate)([Object(s.__param)(0,Object(l.b)("scope")),Object(s.__param)(1,Object(l.b)("element")),Object(s.__param)(2,Object(l.b)("ctrl")),Object(s.__param)(3,Object(l.b)(o.serviceName)),Object(s.__param)(4,Object(l.b)(a.d))],u)},tfx2:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return p}));var s=n("D57K"),i=n("ERkP"),o=(n("FwJ5"),n("nsO7")),a=n("dCrD"),r=n("Oyr+"),c=n("0x+l"),l=n("nmzr"),d=n("aHpC");const u="show-cloud-upload-progress",h="launch-one-drive-file-picker";let p=class extends a.a{constructor(e,t,n){if(super(e,t,n),this.scope=t,this.element=n,this.uploadFile=()=>{this.saveLocationForFileUpload(),this.element.find(".file-upload").click()},this.uploadCloudFile=()=>{this.saveLocationForFileUpload(),this.scope.isButtonLocationChangable&&this.scope.$emit(u,this.positionForFiles.positionAfter),this.element.find(".doc-add-media").click()},this.openContentMarket=()=>this.getLocationData().then(e=>{this.ultraState.goPeekState(l.ContentMarketRoutes.CONTENT_MARKET,e)}),this.openOneDriveFilePicker=()=>this.getLocationData().then(e=>{this.scope.$emit(h,e,this.element)}),this.initContextMenuItems(),t.$on("always-show-time-expires",()=>{this.turnOffAlwaysShow()}),t.isButtonLocationChangable&&t.$on("change-add-content-button-position",(e,t)=>{t.reopen&&!this.isMenuVisible&&this.toggleOverflowMenu()}),t.$on(r.e,(e,n,s)=>{if(s===r.c.OutlineAddContentButtonFileSelected&&n===t.fileListViewLocalId){const e=this.positionForFiles||this.getInsertLocationData();this.closeMenu(),t.$emit(r.e,e.parentId,e.positionBefore,e.positionAfter,e.depth,n,t.content,r.c.AssignDropTarget),this.assignPosition()}}),this.scope.isRenderByDefault&&this.scope.isRenderByDefault()){const e=this.scope.$watch("addContentButton.isMenuVisible",t=>{t&&(this.scope.addContentButton.removeDefaultRenderClass=!0,e())})}this.scope.$watch("parentId()",(e,t)=>{e!==t&&this.initContextMenuItems()})}toggleOverflowMenu(){this.initContextMenuItems().then(()=>{this.toggleMenu()}).catch(()=>{})}initContextMenuItems(){const e=this.element.closest("[data-base-state-name]").data("baseStateName"),t=this.getInsertLocationData();return this.$q.all({isCloudServiceAvailable:this.isCloudServiceAvailablePromise,createHref:this.ultraState.peekHref(l.ContentRoutes.CREATE_CONTENT_PEEK_PANEL,t,e),copyHref:this.ultraState.peekHref("content-manage.copy",t,e),contentCollectionHref:this.ultraState.peekHref("content-collection",t,e),isOneDriveAvailable:this.isOneDriveAvailablePromise}).then(e=>{const t=this.bbLocalize.getLocale(this.scope);this.items=[{key:"create",className:"js-create",href:e.createHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.create"}),icon:i.createElement(c.Add,null)},{key:"copy",className:"js-copy",href:e.copyHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.copy"}),icon:i.createElement(c.Duplicate,null)},{key:"upload-file",className:"js-upload-file",onClick:this.uploadFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.upload"}),icon:i.createElement(c.Upload,null)},{key:"upload-cloud-file",className:"js-upload-cloud-file",onClick:this.uploadCloudFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.importContentFromCloudStorage.title"}),icon:i.createElement(c.UploadCloud,null)},{key:"one-drive-link",className:"js-one-drive-link",onClick:this.openOneDriveFilePicker,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.openFromOneDrive"}),icon:i.createElement(c.OneDrive,null)},{key:"content-market",className:"js-content-market",onClick:this.openContentMarket,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentMarket"}),icon:i.createElement(c.ContentMarket,null)},{key:"content-collection",className:"js-content-collection",href:e.contentCollectionHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentCollection"}),icon:i.createElement(c.ContentCollection,null)}],this.isCloudServiceAvailable||Object(o.remove)(this.items,e=>"upload-cloud-file"===e.key),this.currentCourse.canCopy()||Object(o.remove)(this.items,e=>"copy"===e.key),this.isOneDriveAvailable||Object(o.remove)(this.items,e=>"one-drive-link"===e.key)})}saveLocationForFileUpload(){this.scope.isButtonLocationChangable&&(this.positionForFiles=this.getInsertLocationData())}getLocationData(){const e=this.scope.rootContent(),t=this.getInsertLocationData();return this.contentSvc.getParentFolder(t.parentId,this.contextCourse.courseId,e).$asPromise().then(e=>{if(e.children){return{position:""+e.children.getInsertionIndex(t.positionBefore,t.positionAfter,!0,e.hasMoreChildren),parentId:t.parentId,positionBefore:t.positionBefore,positionAfter:t.positionAfter,depth:t.depth}}})}};p.$inject=[],p=Object(s.__decorate)([Object(s.__param)(0,Object(d.b)("$injector")),Object(s.__param)(1,Object(d.b)("scope")),Object(s.__param)(2,Object(d.b)("element"))],p)},towz:function(e,t,n){},tqR7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("Llzl"),i=n("lEL+");const o="ultra.components.directives.clickOutside";class a{constructor(e,t,n,s,i){this.scope=e,this.element=t,this.attrs=n,this.$document=s,this.timeout=i;const o=e=>this.applyExpression(e),a=this.getContainer()||s;this.scope.$watch(this.attrs.isActive,(e,t)=>{e?this.timeout(()=>{a.on("click",o)},this.scope,0,!1):a.off("click",o)}),this.scope.$on("$destroy",()=>{a.off("click",o)})}applyExpression(e){const t=this.element.is(e.target),n=this.element.has(e.target).length>0;t||n||this.scope.$apply(this.attrs.bbClickOutside)}getContainer(){if("currentPanelOnly"in this.attrs){let e=this.element;for(;e.parent().length;)if((e=e.parent()).is(".bb-offcanvas-panel,#main-content-inner"))return e}}}a.$inject=["scope","element","attrs","$document",i.b];class r{constructor(e){this.$injector=e,this.priority=100,this.restrict="A",this.compile=(e,t)=>({pre:(e,t,n)=>this.$injector.instantiate(a,{scope:e,element:t,attrs:n})})}}r.$inject=["$injector"],s.module(o,[]).directive("bbClickOutside",["$injector",e=>e.instantiate(r)])},trPQ:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown cell-dropdown" role="menu">\n    <li ng-if="cell.canBeView" \n        role="presentation">\n        <button role="menuitem" \n                class="js-view-submission button clear"  \n                ng-click="cell.view()"\n                analytics-id="components.directives.grade.grid.viewItem">\n          <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n          <bb-translate  class="ellipse">components.directives.grade.grid.viewItem</bb-translate>\n        </button>\n    </li>\n    <li ng-class="{disable: !isReadyToPost()}"\n        ng-if="cell.canPost()"\n        role="presentation">\n        <button role="menuitem" \n                class="js-post-grade button clear" \n                ng-click="post()" \n                ng-disabled="!isReadyToPost()"\n                analytics-id="components.directives.grade.grid.post">\n          <bb-svg-icon size="small" icon="post"></bb-svg-icon>\n          <bb-translate class="ellipse" bb-translate>components.directives.grade.grid.post</bb-translate>\n        </button>\n    </li>\n  </ul>\n</div>'},uAJz:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-peer-review",use:"icon-small-peer-review-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-peer-review"><path d="M6.5 10C7.8807 10 9 8.8807 9 7.5S7.8807 5 6.5 5 4 6.1193 4 7.5 5.1193 10 6.5 10zM6.5 10C3.2288 10 1 12.5 1 15M11.5 6C12.8807 6 14 4.8807 14 3.5S12.8807 1 11.5 1 9 2.1193 9 3.5 10.1193 6 11.5 6zM12 6c.7226 0 1.4451.464 2 1.0569M10 13l2 2 3-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},uFkY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l}));const s="assessment:reload-on-attempt-feedback-save",i="single-attempt-grading-list:reload-on-feedback-save",o="grade-comment-update";function a(e,t,n){return e.$broadcast(s,t,n)}function r(e,t){return e.$on(s,t)}function c(e,t){return e.$broadcast(i,t)}function l(e,t){return e.$on(i,t)}},ujI6:function(e,t,n){"use strict";n("RB+a");var s=n("Llzl"),i=n("5iHu"),o=n("tqR7"),a=n("H8CZ"),r=n("lEL+"),c=n("+4Px"),l=n("ytQ2");n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));const d="ultra.components.directives.foundationOffcanvas",u="OFFCANVASE-TOGGLE-CLOSE",h="OFFCANVAS-TOGGLE-OPEN";class p{constructor(e,t,n,s,o,a,r){this.scope=e,this.element=t,this.attrs=n,this.$compile=s,this.$parse=o,this.$q=a,this.timeout=r,this.overrideButtonClass=!1,this.isPanelOpen=!1,this.justOpenedPanel=!1,this.isFromKeyBoard=!1,this.wiredup=!1,this.position="right",this.dialogModel=!1,this.initialProperties(),r(()=>{if(this.openButtonElement=i("#"+this.attrs.bbFoundationOffcanvasOpenButton),0===this.openButtonElement.length)throw new Error('The bbFoundationOffcanvas directive couldn\'t find an "Open Menu" button with an ID of '+this.attrs.bbFoundationOffcanvasOpenButton);this.openButtonElement.on("click.bbFoundationOffcanvas",()=>{this.scope.$apply(()=>{this.togglePanel()})}),this.openButtonElement.on("keydown.bbFoundationOffcanvas",e=>{e.keyCode===c.f&&(this.isFromKeyBoard=!0)})},e,0,!1)}initialProperties(){this.attrs.bbFoundationOffcanvasPosition&&(this.position=this.attrs.bbFoundationOffcanvasPosition),this.attrs.bbFoundationOffcanvasEventDelegate&&(this.scope.$on(h,()=>{this.openPanel()}),this.scope.$on(u,()=>{this.closePanel()})),this.attrs.bbFoundationOffcanvasDialogModel&&(this.dialogModel=this.attrs.bbFoundationOffcanvasDialogModel)}wireup(){return this.wiredup=!0,this.timeout(()=>{if(this.closeButtonElement=i("#"+this.attrs.bbFoundationOffcanvasCloseButton),0===this.closeButtonElement.length)throw new Error('The bbFoundationOffcanvas directive couldn\'t find a "Close Menu" button with an ID of '+this.attrs.bbFoundationOffcanvasCloseButton);if(this.wrapperElement=this.element,this.offcanvasPanelElement=this.element.children().children(),1!==this.offcanvasPanelElement.length)throw new Error("bbFoundationOffcanvas directive must have exactly one child element. Fix the usage in the html template.");if(this.offcanvasPanelElement.addClass(this.position+"-off-canvas-menu"),this.attrs.bbFoundationOffcanvasOverrideButtonClass&&(this.overrideButtonClass=this.$parse(this.attrs.bbFoundationOffcanvasOverrideButtonClass)(this.scope)),this.offcanvasPanelElement.find("a, button").attr("tabindex","-1"),this.closeButtonElement.addClass("exit-off-canvas-overlay").on("click.bbFoundationOffcanvas",()=>{this.scope.$apply(()=>{this.closePanel()})}),this.offcanvasPanelElement.find("a, button").last().on("keydown.bbFoundationOffcanvas",e=>{e.keyCode!==c.u||e.shiftKey||(e.preventDefault(),this.scope.$apply(()=>{this.closePanel()}))}),this.offcanvasPanelElement.find("a, button").first().on("keydown.bbFoundationOffcanvas",e=>{e.keyCode===c.u&&e.shiftKey&&(e.preventDefault(),this.scope.$apply(()=>{this.closePanel()}))}),this.scope.$on("foundation-offcanvas-close-panel",()=>{this.closePanel()}),null!=this.attrs.bbFoundationOffcanvasCommonParent){if(this.commonParent=i("#"+this.attrs.bbFoundationOffcanvasCommonParent),0===this.commonParent.length)throw new Error("The bbFoundationOffcanvas directive couldn't find a common parent element with an ID of "+this.attrs.bbFoundationOffcanvasCommonParent)}else this.commonParent=i(this.wrapperElement).parents().has(this.closeButtonElement).first();if(this.commonParent.hasClass("group-list")||this.commonParent.addClass("off-canvas-wrap off-canvas-overlay"),!this.overrideButtonClass){const e=this.offcanvasPanelElement.find("li").not(".ng-hide").length;this.commonParent.addClass("buttons-"+e)}a.b(this.commonParent,e=>(this.isPanelOpen&&(e.data.noTransitions||"right"===e.originalEvent.propertyName)&&(this.isFromKeyBoard?this.offcanvasPanelElement.find("a, button").first().focus():(this.offcanvasPanelElement.parent().attr("tabindex",0),this.offcanvasPanelElement.parent().focus())),!1)),this.element.foundation(),this.scope.$on("$destroy",()=>{this.element.off("click.bbFoundationOffcanvas"),this.closeButtonElement.off("click.bbFoundationOffcanvas"),this.offcanvasPanelElement.find("a, button").last().off("keydown.bbFoundationOffcanvas"),this.offcanvasPanelElement.find("a, button").first().off("keydown.bbFoundationOffcanvas"),this.commonParent.removeClass("off-canvas-wrap off-canvas-overlay")})},this.scope,0,!1)}getPosition(){switch(this.position){case"right":return"left";case"top":return"bottom";case"bottom":return"top";case"left":default:return"right"}}_openPanel(){this.offcanvasPanelElement.css("display","block"),this.justOpenedPanel=!0,this.timeout(()=>{this.offcanvasPanelElement.foundation("offcanvas","show","move-"+this.getPosition()),this.isPanelOpen=!0,this.offcanvasPanelElement.find("a, button").attr("tabindex","0"),this.justOpenedPanel=!1},this.scope,0,!1)}openPanel(){if(this.wiredup)this._openPanel();else{const e=this.$q.defer();this.scope.$watch("::foundationOffcanvas.wiredup",t=>{t&&e.resolve()}),this.$q.all([this.wireup(),e.promise]).then(()=>{this._openPanel()})}}closePanel(){this.offcanvasPanelElement.foundation("offcanvas","hide","move-"+this.getPosition()),this.isPanelOpen=!1,this.isFromKeyBoard=!1,this.offcanvasPanelElement.parent().removeAttr("tabindex"),this.offcanvasPanelElement.find("a, button").attr("tabindex","-1"),this.openButtonElement.focus(),this.timeout(()=>{this.isPanelOpen||this.offcanvasPanelElement.css("display","none")},this.scope,300,!1)}handleClickOutside(){this.dialogModel||i("body").hasClass("modal-open")||this.justOpenedPanel||this.closePanel()}togglePanel(){this.isPanelOpen?this.closePanel():this.openPanel()}}p.$inject=["scope","element","attrs","$compile","$parse","$q",r.b];class m{constructor(e){this.$injector=e,this.transclude=!0,this.restrict="E",this.link=(e,t,n)=>{if(null==n.bbFoundationOffcanvasOpenButton||null==n.bbFoundationOffcanvasCloseButton)throw new Error('Please provide jQuery selectors for both the "Open Menu" and "Close Menu" buttons');const s=n.$observe("bbFoundationOffcanvasCloseButton",i=>{i&&(e.foundationOffcanvas=this.$injector.instantiate(p,{scope:e,element:t,attrs:n}),s())})},this.template=l}}m.$inject=["$injector"],s.module(d,[o.a,r.a]).directive("bbFoundationOffcanvas",["$injector",e=>e.instantiate(m)])},vcLy:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-started",use:"icon-small-started-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-started"><circle cx="8" cy="8" r="7" transform="rotate(-90 8 8)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M12 8H4s0 4 4 4 4-4 4-4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M10.8247 9a3.594 3.594 0 01-.2191.5528c-.1907.3814-.461.7323-.8478.9901C9.3773 10.7966 8.825 11 8 11c-.825 0-1.3773-.2034-1.7578-.4571-.3868-.2578-.657-.6087-.8478-.9901A3.5857 3.5857 0 015.1754 9h5.6493z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},viYV:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown cell-dropdown" role="menu">\n    <li role=“presentation”>\n        <button role="menuitem" \n                class="js-view-submission button clear" \n                ng-click="cell.view()" \n                ng-disabled="!cell.canBeView"\n                analytics-id="components.directives.grade.grid.viewItemRecord" >\n          <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n          <bb-translate  course-org-token-resolver class="ellipse">components.directives.grade.grid.viewItemRecord</bb-translate>\n        </button>\n    </li>\n  </ul>\n</div>'},wAzH:function(e,t,n){},wJOA:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell"\n     tabindex="0"\n     ng-click="gradeGridColumnOverallReborn.enterEditor($event)"\n     analytics-id="components.directives.grade.grid.gradeGridColumnOverallReborn.enterEdit"\n>\n  <div class="overall-display-grade" ng-class="{\'editor-disable\': gradeGridColumnOverallReborn.disabledEditor}"\n       aria-label="{{gradeGridColumnOverallReborn.ariaLabelContent}}">\n    \x3c!--<bb-display-grade column="col.data" display-type="GradeColor" grade-detail="gradeGridColumnOverallReborn.gradeDetail"></bb-display-grade>--\x3e\n    <bb-display-grade-pill column="col.data" grade="gradeGridColumnOverallReborn.gradeDetail"></bb-display-grade-pill>\n  </div>\n</div>'},wKTs:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-upload",use:"icon-small-upload-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-upload"><path d="M14 5h1v9H1V5h1M6 4l2-2 2 2M8 10V2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},wy9x:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n("Llzl"),i=n("Jwnl"),o=n("Y+9S");const a="ultra.components.directives.content.contentItem.contentItemType.contentItemFolder";class r{constructor(e,t,n){this.scope=e,this.element=t,this.attrs=n}toggleFolder(){if(!this.scope.content.ui.isOpen){const e={type:o.MessageType.FolderOpened,status:o.MessageStatus.Success,contentId:this.scope.content.id};Object(o.sendMessageToMobile)(e)}this.scope.$emit("toggle-folder",this.scope.content)}shouldAlignMiddle(){const e=this.scope.content;return!e.canViewAsInstructor()&&(!e.description&&(!e.isVisible()||!e.adaptiveReleaseRules))}}r.$inject=["scope","element","attrs"];class c{constructor(e){this.$injector=e,this.restrict="E",this.template=i,this.scope=!1,this.link=(e,t,n)=>{e.contentItemFolder=this.$injector.instantiate(r,{scope:e,element:t,attrs:n})}}}c.$inject=["$injector"],s.module(a,[]).directive("bbContentItemFolder",["$injector",e=>e.instantiate(c)])},x8kk:function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return L})),n.d(t,"e",(function(){return R})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return G}));var s=n("D57K"),i=(n("k6nO"),n("nsO7")),o=n("Llzl"),a=n("oVrE"),r=n("nbDY"),c=n.n(r),l=n("jbaE"),d=n("Fvsw"),u=n("Sgjf"),h=n("lmMM"),p=n("r133"),m=n("0JpG"),b=n("pjml"),g=n("JNtI"),v=n("lEL+"),f=n("gCXj"),C=n("jmkQ"),y=n("OsJo"),w=n("ZzYr"),S=n("kBJj"),I=n("TnpK"),O=n("Qbdf"),E=n("tZxt"),D=n("pSe1"),k=n("ZzR9"),$=n("aHpC");const L="ultra.directives.discussion.message",R="update-discussion-message",j="add-discussion-message",T="delete-discussion-message",x="update-grade-status",G="update-indicator-status";class A extends c.a{}A.NewMode=new A("new"),A.ViewMode=new A("view");let _=class{constructor(e,t,n,s,o,a,r,c,l,d,u){var p;this.scope=e,this.$q=n,this.element=s,this.bbContext=o,this.bbLocalize=a,this.timeout=r,this.UserModel=c,this.$sce=u,this.isEditing=!1,this.requestIsLoading=!1,this.inputTooLong=!1,this.groupIdParam={},this.readOnlyState=!0,this.keepEditorActive=!1,this.hideContentMarketInEditor=()=>!1,this.getMoreOptionsLabel=i.memoize((e,t,n)=>this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.moreOptionsLabel",params:{postDate:n,user:{givenName:e,familyName:t}},noWrap:!0,noEscape:!0}),(e,t,n)=>String(e)+String(t)+String(n)),this.scope.courseId=null!==(p=d.courseId)&&void 0!==p?p:l.params.courseId,this.originalText="",e.inputText&&(this.originalText=e.inputText,this.inputTextSafe=u.trustAsHtml(e.inputText.replace(/(.|\s*)(<a )(.|\s*)/g,'$1<a target="_blank" rel="noopener noreferrer" $3'))),A.NewMode.isEqualTo(this.scope.messageMode)?this.messageBody={rawText:"",displayText:""}:this.messageBody=this.scope.message&&this.scope.message.body||{rawText:"",displayText:""},this.choices=[],!this.scope.message.lastUpdateUser&&this.isAnonymousContentEdited()&&(this.scope.message.lastUpdateUser=this.scope.message.user),this.updateLocalizedLastUpdateUserName(),this.overflowMenus=this.getOverflowMenus(),e.$watch("isDeleteAllDisabled",()=>{e.showDeleteAll&&(this.choices.splice(0),this.choices.push({key:"delete-all-replies",value:e.isDeleteAllDisabled,localizedKey:h.c(e.deleteConfirmHandler.replace(/^resource\//,""),"delete-all-replies"),isDisable:e.isDeleteAllDisabled}))}),e.$watch("message.lastUpdateUser",()=>{this.updateLocalizedLastUpdateUserName()}),e.$on(k.b.$stateChangeStart,(e,t)=>{this.keepEditorActive&&(this.keepEditorActive=!1),t.name.includes("peek.content-market")&&(this.keepEditorActive=!0)}),e.$watch("message.body.rawText",e=>{e&&(A.ViewMode.isEqualTo(this.scope.messageMode)&&(this.messageBody={rawText:e,displayText:""}),this.inputTextSafe=this.$sce.trustAsHtml(this.scope.message.body.rawText.replace(/(.|\s*)(<a )(.|\s*)/g,'$1<a target="_blank" rel="noopener noreferrer" $3')))}),e.$on("SET_MESSAGE_ACTIVE",(e,t)=>{this.scope.message.id===t&&this.edit()})}isUserCardShown(){return A.ViewMode.isEqualTo(this.scope.messageMode)}canSendMessageInUserCard(){return!a.g(this.scope.message.user)&&this.isCourseActive()&&this.isAvailable()}isAvatarShown(){return A.NewMode.isEqualTo(this.scope.messageMode)&&this.scope.showAvatarOnNew&&this.scope.showAvatarOnNew()}isEditingAreaShown(){return this.isEditing}isDeleteButtonShown(){return this.scope.message&&this.scope.message.permissions&&!b.v.MessageLifeCycleEnum.Deleted.isEqualTo(this.scope.message.lifecycle)&&(this.scope.message.permissions.delete||this.scope.message.permissions.edit)&&!this.isEditing&&!this.scope.isDiscussionEdit}isEditButtonShown(){return!(this.scope.isEditDisabled&&this.scope.isEditDisabled())&&this.scope.message&&this.scope.message.permissions&&!b.v.MessageLifeCycleEnum.Deleted.isEqualTo(this.scope.message.lifecycle)&&this.scope.message.permissions.edit&&(!this.scope.isDiscussionEdit||this.isEditing)}isMessageDrafted(){return!(!this.scope.enableDraft||"new"!==this.scope.messageMode)||this.scope.enableDraft&&this.scope.message&&this.scope.message.id&&!this.scope.message.permissions.reply&&b.v.MessageLifeCycleEnum.Drafted.isEqualTo(this.scope.message.lifecycle)}onMessageChange(){this.scope.enforceLengthLimit&&(this.inputTooLong=Object(S.isMessageTooLong)(this.messageBody.rawText))}get saveButtonLabelKey(){return this.isMessageDrafted()&&this.scope.saveButtonDraftLabelKey?this.scope.saveButtonDraftLabelKey:this.scope.saveButtonLabelKey}get disableSaveButton(){var e;return!(this.isMessageDrafted()&&!A.NewMode.isEqualTo(this.scope.messageMode)&&!this.inputTooLong)&&(A.NewMode.isEqualTo(this.scope.messageMode)&&(null===(e=this.scope.editorForm.responseEditor)||void 0===e?void 0:e.$pristine)||this.inputTooLong)}get disableSaveDraftButton(){var e;return(null===(e=this.scope.editorForm.responseEditor)||void 0===e?void 0:e.$pristine)||this.inputTooLong}isView(){return A.ViewMode.isEqualTo(this.scope.messageMode)}showEditButton(){return!this.scope.hideButtons&&(this.isView()&&this.isEditButtonShown())}showDeleteButton(){return!this.requestIsLoading&&(!this.scope.hideButtons&&(this.isView()&&this.isDeleteButtonShown()))}setEditorActive(){this.scope.isDiscussionEdit||this.scope.isEditorActive||(this.scope.$emit("isCurrentDiscussionEditingChanged",!0),this.isEditing=!0,this.scope.isEditorActive=!0,this.scope.editorForm.responseEditor.$setPristine())}onEditorBlur(){const e=this.element.find("button:focus").length>0;!this.disableSaveButton||e||this.inputTooLong||this.keepEditorActive||this.setEditorInactive()}setEditorInactive(){this.scope.$emit("isCurrentDiscussionEditingChanged",!1),this.isEditing=!1,this.scope.isEditorActive=!1}onCancel(){this.resetEditingFlag(),this.inputTooLong=!1,this.messageBody={rawText:this.originalText,displayText:this.originalText},this.scope.onCancelFunc&&this.scope.onCancelFunc(),this.scope.inputText=this.originalText}resetEditingFlag(){this.setEditorInactive(),this.disableEditState()}onSave(e){this.resetEditingFlag(),this.scope.onSaveFunc&&this.scope.onSaveFunc({value:this.messageBody.rawText}),A.NewMode.isEqualTo(this.scope.messageMode)?(this.onSaveNew(e),this.timeout(()=>{this.messageBody={rawText:"",displayText:""},this.scope.inputText=""},this.scope,0)):this.onSaveEdit(e),this.scope.editorForm.responseEditor.$setPristine()}onSaveNew(e){const t=this.scope.message.replies.$build();return t.parentId=this.scope.message.id,t.courseId=this.scope.message.courseId,t.forumId=this.scope.message.forumId,t.userId=this.scope.loginUser.id,t.lifecycle=e?b.v.MessageLifeCycleEnum.Drafted:b.v.MessageLifeCycleEnum.Published,t.postedName=this.scope.loginUser.givenName+" "+this.scope.loginUser.familyName,t.subject=null,t.body=this.messageBody,t.isDeleted=!1,t.postDate=this.bbContext.getServerTime(),t.editDate=this.bbContext.getServerTime(),this.scope.message.ui.showAllReplies=!0,this.groupIdParam=this.scope.getGroupId&&this.scope.getGroupId()?{groupId:this.scope.getGroupId()}:{},this.scope.message.saveReply(t,this.groupIdParam).$then(t=>{let n;if(t.states.readStateInd=!0,this.scope.message.ui.replies||(this.scope.message.ui.replies=[]),t.user=this.scope.loginUser,t.parent=this.scope.message,t.ui.replies=t.replies,b.v.MessageType.ClassConversation.isEqualTo(this.scope.message.type)?t.type=b.v.MessageType.Comment:t.type=this.scope.message.type.next(),this.scope.isRepliesOrderByDesc){const t=i.findIndex(this.scope.message.ui.replies,e=>!b.v.MessageLifeCycleEnum.Drafted.isEqualTo(e.lifecycle));n=e?0:t>-1?t:this.scope.message.ui.replies.length}else{let t=i.findLastIndex(this.scope.message.ui.replies,e=>!b.v.MessageLifeCycleEnum.Drafted.isEqualTo(e.lifecycle));n=e?this.scope.message.ui.replies.length:t>-1?t+=1:0}this.scope.message.ui.replies.splice(n,0,t),this.scope.message.ui.count++,this.scope.message.messageStatus.numberOfChildren++,this.scope.message.messageStatus.numberOfReadChildren++,this.scope.message.parent&&(this.scope.message.parent.messageStatus.numberOfChildren++,this.scope.message.parent.messageStatus.numberOfReadChildren++),this.scope.$emit(j,b.v.MessageType.Discussion.isEqualTo(this.scope.message.type),t.id,e),this.scope.$root.$broadcast(x)})}onSaveEdit(e){this.groupIdParam=this.scope.getGroupId&&this.scope.getGroupId()?{groupId:this.scope.getGroupId()}:{},this.scope.message.body=this.messageBody;const t=!e&&b.v.MessageLifeCycleEnum.Drafted.isEqualTo(this.scope.message.lifecycle);b.v.MessageLifeCycleEnum.Published.isEqualTo(this.scope.message.lifecycle)&&!e||(this.scope.message.lifecycle=e?b.v.MessageLifeCycleEnum.Drafted:b.v.MessageLifeCycleEnum.Published),this.scope.message.withParams(this.groupIdParam).$patch().$then(()=>{this.scope.inputText=this.scope.message.body.rawText,this.messageBody=this.scope.message.body,this.originalText=this.scope.inputText,this.scope.message.editDate=this.bbContext.getServerTime(),this.scope.message.postAsAnonymous?this.scope.message.lastUpdateUser=this.getAnonymousUpdateUser():this.scope.message.lastUpdateUser=t?null:this.scope.loginUser,this.scope.$emit(R,b.v.MessageType.Comment.isEqualTo(this.scope.message.type),this.scope.message.id,this.scope.message,!1,t)}),this.isEditing=!1}isCascadeDelete(){return this.scope.shouldDeleteAll||this.scope.isDeleteAllDisabled}onDelete(){if(this.requestIsLoading=!0,this.scope.onDeleteFunc)return this.scope.onDeleteFunc();this.groupIdParam=this.scope.getGroupId&&this.scope.getGroupId()?{groupId:this.scope.getGroupId()}:{};const e=b.v.MessageType.Comment.isEqualTo(this.scope.message.type);if(this.isCascadeDelete())return this.scope.message.withParams({cascade:!0,...this.groupIdParam}).$destroy().$asPromise().then(()=>{this.scope.message.parent&&(i.remove(this.scope.message.parent.ui.replies,{id:this.scope.message.id}),this.scope.message.parent.parent&&(this.scope.message.parent.parent.messageStatus.numberOfChildren-=1),this.scope.message.parent.messageStatus.numberOfChildren-=this.scope.message.messageStatus.numberOfChildren+1),this.scope.$root.$broadcast(T,e,this.scope.message.id,this.scope.message),this.scope.$root.$broadcast(x)});const t=this.scope.message.parent?i.findIndex(this.scope.message.parent.ui.replies,{id:this.scope.message.id}):void 0;return this.scope.message.withParams({cascade:!1,...this.groupIdParam}).$destroy().$asPromise().then(()=>{this.scope.message.lifecycle=b.v.MessageLifeCycleEnum.Deleted,this.scope.message.editDate=new Date,this.scope.message.permissions.edit=!1,this.scope.message.lastUpdateUser=this.getAnonymousUpdateUser(),this.updateLocalizedLastUpdateUserName(),this.scope.message.parent&&-1===i.findIndex(this.scope.message.parent.ui.replies,["id",this.scope.message.id])&&this.scope.message.parent.ui.replies.splice(t,0,this.scope.message),this.scope.$emit(R,e,this.scope.message.id,this.scope.message,!0),this.scope.$root.$broadcast(x)})}getAnonymousUpdateUser(){return this.scope.message.lastUpdateUserId===this.scope.loginUser.id?this.scope.loginUser:this.scope.message.user}getDeleteLabel(){const e=this.element.find(".js-bbml-block").find(" .element-list-row").text().trim();return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.message.delete",params:{msg:e},noWrap:!0,noEscape:!0})}generateStringByMessage(){if(this.scope.message)return this.scope.message.id+"-commit-edit"}generateFocusStringByMessage(){if(this.scope.message)return b.v.MessageType.Reply.isEqualTo(this.scope.message.type)?this.scope.message.parent.id+"-commit-edit":this.scope.message.id+"-commit-edit"}isCourseActive(){return!(this.scope.isCourseComplete||this.scope.isCoursePrivate)}getLastUpdateUserName(){if(this.scope.message&&this.scope.message.lastUpdateUser)return this.scope.message.lastUpdateUser.userName}getLastUpdateDate(){if(this.scope.message)return this.scope.message.editDate}isReadOnly(){return this.scope.isEditDisabled&&this.scope.isEditDisabled()||this.scope.hideButtons||!((A.NewMode.isEqualTo(this.scope.messageMode)||A.ViewMode.isEqualTo(this.scope.messageMode)&&this.scope.message&&this.scope.message.permissions&&this.scope.message.permissions.edit)&&(!this.scope.isDiscussionEdit||this.isEditing))}updateLocalizedLastUpdateUserName(){this.scope.message&&this.scope.message.lastUpdateUser&&this.bbLocalize.formatUsername(this.scope.message.lastUpdateUser,m.ILocaleUsernameFormat.Short,this.scope,{noWrap:!0,noEscape:!0}).then(e=>{this.lastUpdateUsername=e})}isAnonymousContentEdited(){return this.scope.message.postAsAnonymous&&null==this.scope.message.lastUpdateUserId&&this.scope.message.postDate&&this.scope.message.editDate&&this.scope.message.postDate.getTime()!==this.scope.message.editDate.getTime()}isContentFixed(){return!!this.requestIsLoading||(!(!this.scope.isEditDisabled||!this.scope.isEditDisabled())||(this.scope.message&&this.scope.message.permissions?A.ViewMode.isEqualTo(this.scope.messageMode)?!1===this.scope.message.permissions.edit:A.NewMode.isEqualTo(this.scope.messageMode)?!1===this.scope.message.permissions.reply:void 0:void 0))}isAvailable(){return!this.scope.isCourseAvailable||this.scope.isCourseAvailable()}shouldShowUnreadInfo(){return!(!this.scope.showUnread||!this.scope.showUnread())}updateMessageStatus(e,t){if(this.shouldShowUnreadInfo()&&e&&t&&!t.states.readStateInd){t.states.readStateInd=!0,this.groupIdParam=this.scope.getGroupId&&this.scope.getGroupId()?{groupId:this.scope.getGroupId()}:{},t.updateMessageStatus(t.states,this.groupIdParam),this.scope.$emit(G);const e=t=>{t&&t.parent!==t&&(t.parent.messageStatus.numberOfReadChildren++,e(t.parent))};e(t)}}getOverflowMenus(){const e=[];e.push({labelKey:"global.edit",icon:"draw",show:()=>this.showEditButton(),onClick:this.edit.bind(this)});const t={labelKey:"global.delete",icon:"trash",show:()=>this.showDeleteButton(),onClick:this.onDelete.bind(this)};return this.scope.deleteConfirmHandler&&(t.confirmationOptions={},t.confirmationOptions.lazyLoadTitleKeyAndInstructionsKey=()=>(this.isMessageDrafted()&&(this.scope.deleteConfirmHandler="resource/x-bb-draft"),this.$q.when(g.a(this.scope.deleteConfirmHandler.replace(/^resource\//,"")))),t.confirmationOptions.choices=this.choices),e.push(t),e}shouldShowOverflowMenu(){return this.showEditButton()||this.showDeleteButton()}clickMessageText(t){if(this.isContentFixed()||!this.readOnlyState||A.NewMode.isEqualTo(this.scope.messageMode))return;const n=e(t.target);n.is("button")||n.parent().is("button")||n.is("a")||n.parent().is("a")||this.edit()}onEditorClick(){A.NewMode.isEqualTo(this.scope.messageMode)&&!this.scope.isEditorActive&&this.edit()}edit(){this.isReadOnly()||(this.readOnlyState=!1,this.setEditorActive(),this._focusTextEditor())}isLoginUserOwnedMessage(){return this.scope.message.user&&this.scope.message.user.id===this.scope.loginUser.id}_focusTextEditor(){this.timeout(()=>{this.element.find(".editor-element").first().focus(),this.element.find(".bb-editor").first().focus()},this.scope,0,!0)}disableEditState(){this.readOnlyState=!0}};_=Object(s.__decorate)([Object(s.__param)(0,Object($.b)("scope")),Object(s.__param)(1,Object($.b)("attrs")),Object(s.__param)(2,Object($.b)("$q")),Object(s.__param)(3,Object($.b)("element")),Object(s.__param)(4,Object($.b)(d.b)),Object(s.__param)(5,Object($.b)(m.serviceName)),Object(s.__param)(6,Object($.b)(v.b)),Object(s.__param)(7,Object($.b)(b.Jb.serviceName)),Object(s.__param)(8,Object($.b)(I.d)),Object(s.__param)(9,Object($.b)(O.e)),Object(s.__param)(10,Object($.b)("$sce"))],_);class M{constructor(e,t){this.$compile=e,this.$injector=t,this.restrict="E",this.template=E,this.scope={placeholderKey:"@",cancelButtonLabelKey:"@?",saveButtonLabelKey:"@?",saveButtonDraftLabelKey:"@?",isLoginUserStudent:"=?",deleteConfirmHandler:"@?",cancelConfirmHandler:"@?",modalShowType:"@?",inputText:"=",loginUser:"=?",messageMode:"@",message:"=",showDeleteAll:"=?",shouldDeleteAll:"=?",isDeleteAllDisabled:"=?",enforceLengthLimit:"<?",focusOn:"@?",focusId:"@?",courseId:"@?",isRepliesOrderByDesc:"@?",isDiscussionEdit:"=?",isCourseComplete:"=?",isCoursePrivate:"=?",isEditDisabled:"&?disableEdit",isConversation:"=?",onDeleteFunc:"&?",onCancelFunc:"&?",onSaveFunc:"&?",plainText:"=?",showAvatarOnNew:"&?",showDueDate:"=?",showUnread:"&?",courseRole:"=?",hideButtons:"=?",getGroupId:"&?groupId",isCourseAvailable:"&?courseAvailable",hideContentMarketButton:"=?",allowEmptyBlock:"=?",enableDraft:"=?",showWordCount:"=?",analyticsIdTagPrefix:"@?"},this.link=(e,t,n)=>{e.messageControl=this.$injector.instantiate(_,{scope:e,element:t,attrs:n}),e.$on("delete-all-replies",(t,n)=>{e.shouldDeleteAll=n}),e.$on("focus",(t,n,s)=>{n.startsWith("comment-reply")&&s===(e.getGroupId&&e.getGroupId())&&A.NewMode.isEqualTo(e.messageMode)&&e.messageControl.edit()});const[s]=["message_avatar"];e.inCallback=()=>{y.a.insertElement(e,s,this.messageAvatarLinkFn,t.find(".message-avatar-container"))},e.outCallback=()=>{y.a.removeElement(e,s)}},this.messageAvatarLinkFn=this.$compile(D)}}M.$inject=["$compile","$injector"],o.module(L,["angular-inview",d.a,u.a,p.a,m.moduleName,b.N,g.b,v.a,l.a,f.a,C.a,w.a,I.b,O.b]).config([f.b+"Provider",function(e){e.onStyleRefresh((function(e,t){e.selector(`bb-message .message_user${t.userId} .overdue-tip`).rule("display",t.isDueDateExcepted()?"none":"inline")}))}]).directive("bbMessage",["$injector",e=>e.instantiate(M)])}).call(this,n("5iHu"))},xAaQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var s=n("Llzl"),i=n("wy9x"),o=n("jhBu"),a=n("Sa5G"),r=n("TnpK"),c=n("sB2Z"),l=n("nmzr");const d="ultra.components.directives.content.contentItem.contentItemEngagementOutline";class u{constructor(e,t,n){this.scope=e,this.entitlementService=t,this.ultraState=n,this.entitlementService.hasCourseEntitlement(a.e.ModifyContent,this.scope.content.courseId).then(e=>{this.entitledToModifyContent=e})}get canOpenConditionalRelease(){return!!(this.scope.content&&this.scope.content.permissions&&this.scope.content.permissions.adaptiveRelease&&this.scope.content.permissions.adaptiveRelease.view)}openConditionalRelease(){this.isCourseCompletedAndInInstructorView()||this.ultraState.goPeekState(l.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:this.scope.content.id})}isCourseCompletedAndInInstructorView(){return!this.scope.content.canEdit()&&this.scope.content.canViewAsInstructor()}isDiscussionCreatedByStudent(){var e;let t=!1;const n=null===(e=this.scope.content.contentDetail)||void 0===e?void 0:e["resource/x-bb-forumlink"];return n&&(t=n.isDiscussionCreatedByStudent),!!t}}u.$inject=["scope",o.b,r.d];class h{constructor(e){this.$injector=e,this.restrict="E",this.template=c,this.scope=!1,this.link=e=>{e.contentItemEngagementOutline=this.$injector.instantiate(u,{scope:e})}}}h.$inject=["$injector"],s.module(d,[i.a,r.b]).directive("bbContentItemEngagementOutline",["$injector",e=>e.instantiate(h)])},xGbf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseBanner=void 0;const s=(0,n("D57K").__importStar)(n("ERkP")),i=n("zTL+"),o=n("FS8K"),a=n("qllV");t.BaseBanner=e=>{const t=e.localize,[n,o]=s.useState(!0);return s.createElement(s.Fragment,null,n&&s.createElement(i.AnalyticsBanner,{severity:"warning",onClose:()=>o(!1),icon:s.createElement(a.AlertError,{color:"primary"}),closeText:t.translate("course.content.forcedSequenceBannerDismiss")},t.translate("course.content.forcedSequenceBannerText")))};const r=(0,o.localizedComponentWrapper)(t.BaseBanner);t.default=r},xcel:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return I}));var s=n("Llzl"),i=n("nsO7"),o=n("LN5R"),a=n("o5Lu"),r=n("lEL+"),c=n("0JpG"),l=n("jhBu"),d=n("iViV"),u=n("pjml"),h=n("+4Px"),p=n("cbVV"),m=n("TmUJ"),b=n("C2vp"),g=n("Sa5G"),v=n("dF44"),f=n("qH3X"),C=n("Ui4O"),y=n("trPQ"),w=n("viYV"),S=n("E7GM");const I="ultra.components.directives.gradeGridColumnReborn";class O{constructor(e,t,n,s,o,a,r,c,l,d,u,h,m){this.rootScope=e,this.window=t,this.$q=n,this.CourseModel=s,this.gradeService=o,this.$compile=a,this.scope=r,this.element=c,this.attrs=l,this.gradeGridRebornController=d,this.timeout=u,this.bbLocalize=h,this.entitlementService=m,this.isRestrictedGroupContent=!1,this.hasEntitlementsToGradeCell=()=>{if(this.isRestrictedGroupContent)return!1;if(!this.cell.canBeEdited)return!1;const e=this.cell;return e.data&&e.data.grade?this.gradeService.canGrade(e.data.grade.gradeScoreDesignation):!(!e.column||!e.column.data)&&this.gradeService.canGrade(e.column.data.gradeScoreDesignation)},this.isCellGradeable=e=>!this.isRestrictedGroupContent&&(!i.isUndefined(e)&&(!this.gridData.course.isComplete()&&(!(i.isUndefined(this.group)&&e.column instanceof p.g)&&e.canBeEdited))),this.canGradeCell=()=>this.isCellGradeable(this.cell)&&this.hasEntitlementsToGradeCell(),this._isUpdating=!1,this.initializeEventHandler(),this.gridData=this.gradeGridRebornController.getGridData(),r.$watchGroup(["row","col"],e=>{const[t,n]=e;this.initializeCell(t.id,n.id),this.initializeState(),this.initializeUI()}),r.$on(f.a.REFRESH,(e,t)=>{this._isUpdating=!1;const n=t.rowId,s=t.columnIds;i.forEach(s,e=>{this.scope.row.id===n&&this.cell.column.id===e&&(this.initializeCell(n,e,!1),this.initializeUI(),this.scope.$broadcast(f.a.REFRESH_CELL_EDITOR))})}),r.$on(v.b.ENTER_CELL,(e,t)=>t.find(".grade-grid-cell").click()),r.$on("$destroy",()=>{}),r.$on(f.a.ENTER_EDITOR,(e,t)=>{i.isUndefined(t.group)||i.isUndefined(this.group)||t.group.groupId!==this.group.groupId||this.cell.column.id!==t.columnId||(this._freezeGroup=!0)}),r.$on(f.a.CLOSE_EDITOR,(e,t)=>{this.group&&this._freezeGroup&&(this._freezeGroup=!1)})}initializeState(){this._isEditing=!1,this.resetGradePost()}initializeCell(e,t,n=!0){this.cell=this.gridData.getCell(e,t),this.setUpScreenReader(this.cell,this.score),this._oldScore=this._score=void 0,this.group&&n&&this.element.children(".grade-grid-cell").removeClass(`group-id-${this.group.groupId} group-grade-cell selected`),this._group=void 0,this._isOtherGroupMemberGraded=void 0,this.cell instanceof b.e&&(this._group=this.cell.group,this.element.children(".grade-grid-cell").addClass(`group-id-${this.group.groupId} group-grade-cell`)),this.setSelectEventListener()}setSelectEventListener(){this.group&&i.isUndefined(this.unbindSelectEvent)&&!this.isRestrictedGroupContent?this.unbindSelectEvent=this.scope.$on(f.a.SELECT_GROUP,(e,t)=>{this.group.groupId===t.groupId&&this.cell.column.id===t.columnId&&t.enter?this.element.children(".group-grade-cell").addClass("selected"):this.element.children(".group-grade-cell").removeClass("selected")}):i.isUndefined(this.group)&&!i.isUndefined(this.unbindSelectEvent)&&(this.unbindSelectEvent(),this.unbindSelectEvent=void 0)}initializeEventHandler(){this.element.parents(".rb-cell").mouseenter(()=>this.mouseEnterHandler()).mouseleave(()=>this.mouseLeaveHandler()).focus(()=>this.keyEnterHandler()).blur(()=>this.keyLeaveHandler()).focusin(()=>{this.focusin(),this.mouseEnterHandler(),this.showPointsPossible()}).focusout(()=>{this.focusout(),this.mouseLeaveHandler(),this.hidePointsPossible()}).click(()=>{this.showPointsPossible()})}focusin(){this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.FOCUSIN_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}focusout(){this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.FOCUSOUT_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}showElement(e){e.removeClass("hide")}hideElement(e){e.addClass("hide")}initializeUI(){const e=this.element.constructor.fn,t=e.show,n=e.hide;e.show=function(){return this.removeClass("hide")},e.hide=function(){return this.addClass("hide")},(this.group||this.cell.column.data&&this.cell.column.data.groupContent)&&(this.isRestrictedGroupContent=!this.entitlementService.isEntitled(g.o.ViewGroups,this.gridData.course.id));const s=this.element.children(".grade-grid-cell");if(this.isLoading)s.removeClass("grade-now-bg").find(".score, .ungraded, .anonymous").hide();else{if(!this.gridData.canViewGrades||this.isRestrictedGroupContent)if(this.cell.data)s.addClass("grade-now-bg"),s.find(".score").show().find("#displayedScore").show().find("#display").text("--").show();else{const e=s.find("#displayedScore");e.children("#display").text("").hide(),e.hide()}else{const e=this.displayedScore;if(this.cell.isAnonymousGrading||e?s.removeClass("grade-now-bg"):s.addClass("grade-now-bg"),this.isEditing||this.cell.isAnonymousGrading?s.children(".score").hide():s.children(".score").show(),e){const t=s.find("#displayedScore");t.children("#display").text(e).show(),t.show()}else{const e=s.find("#displayedScore");e.children("#display").text("").hide(),e.hide()}if(this.isPastDueZero?s.find("#pastDueZero").show():s.find("#pastDueZero").hide(),this.isPosted&&!this.isPastDueZero?s.find("#posted").show():s.find("#posted").hide(),this.canGradeCell()&&!e?s.find("#gradeNow").show():s.find("#gradeNow").hide(),this.hasNewSubmission?s.find("#newSubmission").show():s.find("#newSubmission").hide(),this.canGradeCell()?s.find("#blank").hide():s.find("#blank").show(),this.cell instanceof b.c&&this.ungradedItemCount&&this.ungradedItemCount>0?(this.ungraded=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.ungraded",params:{count:this.ungradedItemCount},noWrap:!0,noEscape:!0}),s.find("#ungraded").show()):s.find("#ungraded").hide(),this.cell instanceof b.c){const e=this.pointsPossible;s.find("#pointsPossible").text(i.isUndefined(e)?"":e.toString())}this.cell.isAnonymousGrading?s.find(".anonymous").show():s.find(".anonymous").hide()}}e.show=t,e.hide=n}showPointsPossible(){if(this.cell instanceof b.c){const e=this.element.children(".grade-grid-cell");e.addClass("purple-outline"),e.find("#displayedScore").children("#display").text(this.score),this.showElement(e.find("#displayedScore")),this.showElement(e.find("#slash")),this.showElement(e.find("#pointsPossible")),this.timeout(()=>{const e=this.scope.$on(v.b.SCROLL_H,()=>{this.hidePointsPossible(),e(),t()}),t=this.scope.$on(v.b.SCROLL_V,()=>{this.hidePointsPossible(),t(),e()})},this.scope,200)}}hidePointsPossible(){if(this.cell instanceof b.c){const e=this.element.children(".grade-grid-cell");e.removeClass("purple-outline"),e.find("#displayedScore").children("#display").text(this.displayedScore),this.hideElement(e.find("#slash")),this.hideElement(e.find("#pointsPossible"))}}resetGradePost(){this._isReadyToPost=void 0}get isReady(){return!i.isUndefined(this.cell)}get isLoading(){return!this.isReady||!this.cell.isLoaded}get isPosted(){return!i.isUndefined(this.cell)&&this.cell.isPosted}get hasNewSubmission(){return!i.isUndefined(this.cell)&&this.cell.hasNewSubmission}get isPastDueZero(){return!i.isUndefined(this.cell)&&this.cell.isPastDueZero}get displayedScore(){if(!this.isLoading)return this.formatScore()}get ungradedItemCount(){if(this.isReady){if(this.cell.data)return this.cell.data.grade.ungradedItemCount;if(this.gridData.getColumnMetadata(this.cell.column.id))return this.gridData.getColumnMetadata(this.cell.column.id).itemsCount}}get pointsPossible(){if(this.isReady&&this.cell.data&&this.displayedScore){const e=this.cell.data.grade.pointsPossible;return i.isUndefined(e)?e:Math.round(100*e)/100}}get score(){if(this.isReady){if(i.isUndefined(this._score)){const e=this.cell.getScore(this.scope);this._oldScore=this._score=e}return this._score}}set score(e){this._score=e}get isReadonly(){if(this.isReady)return!1}get isEditing(){return this._isEditing}get group(){return this._group}mouseEnterHandler(){this.group&&!this.isRestrictedGroupContent&&this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:this.group.groupId,columnId:this.cell.column.id,enter:!0})}mouseLeaveHandler(){!this.group||this._freezeGroup||this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:this.group.groupId,columnId:this.cell.column.id,enter:!1})}keyEnterHandler(){if(!this.cell.isAnonymousGrading)return;const e=this.element.find(".anonymous").children();e&&e.focus()}keyLeaveHandler(){if(!this.cell.isAnonymousGrading)return;const e=this.element.find(".anonymous").children();e&&e.blur()}insertCellEditor(){this.editorScope=this.scope.$new(!1,this.scope),this.$compile(O.CELL_EDITOR_TEMPLATE)(this.editorScope,e=>this.element.children(".grade-grid-body-cell").append(e)),this.timeout(()=>{this.addInputKeyEventListeners();const e=this.scope.$on(v.b.SCROLL_H,()=>{i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),e(),t()}),t=this.scope.$on(v.b.SCROLL_V,()=>{i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),t(),e()})},this.scope,200)}removeCellEditor(){this.element.find("#bb-grade-grid-cell-editor-reborn").remove()}isConfirmDialogExisting(){return!!e(".grade-grid-group-confirm-dialog").length}enterEditor(e){if(!this.isConfirmDialogExisting()&&this.isCellGradeable(this.cell)&&!this.isLoading&&!this._isEditing){if(this.cell.column.data.isAttendance())this.gradeGridRebornController.attendanceIsAvailable&&(this.cell.canBeView&&this.popupMenu(e,!1),this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:void 0,columnId:this.cell.column.id,enter:!1}));else{const t=this.hasEntitlementsToGradeCell();(this.cell.canBeView||this.cell.canPost())&&(t||(this.isReadyToPost=!!this.score),this.popupMenu(e,!0)),t&&(this._isEditing=!0,this.hideElement(this.element.find(".score")),this.element.children(".grade-grid-cell").removeClass("grade-now-bg"),this.insertCellEditor(),this.group?this.rootScope.$broadcast(f.a.ENTER_EDITOR,{group:this.group,columnId:this.cell.column.id}):this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:void 0,columnId:this.cell.column.id,enter:!1}))}this.getIsOtherGroupMemberGraded()}}getIsOtherGroupMemberGraded(){this.group&&this.getGroupGrades(this.cell.column.id).then(()=>{this.isOtherGroupMemberGraded()})}set isReadyToPost(e){this._isReadyToPost=e}get isReadyToPost(){return this._isReadyToPost}post(e,t){return t?this.cell.column.data.postReadyGroupAttempts({groupAssociationId:this.group.groupAssociationId}):this.cell.column.data.grades.$new(e.id).postReadyGrades()}fetchSummary(e){return this.cell.column.data.summary.$fetch(e).$asPromise()}popupMenu(t,n){const s=`grade-grid-cell-menu-reborn-${this.scope.row.id}-${this.scope.col.id}`;if(!this.gradeGridRebornController.isMenuExisting(s)){const i=e(t.target).closest(".grade-grid-cell").offset(),o=80;i.top+=o;const a=this.scope.$new(!0);a.cell=this.cell,a.post=()=>{(this.savePromise||this.$q.when()).then((e=this.cell.getGrade())=>{this.postDefer&&(this.postDefer.resolve(!0),this.timeout.cancel(this.postDeferTimeout)),e&&(this.isGroupAssessment()?this.post(e,!0).then(()=>this.fetchSummary({timestamp:Date.now()})).then(()=>{this.gridData.getGroupIdUserIdMap()[this.group.groupId].forEach(e=>{this.gridData.refreshDataCell(this.gridData.getRowByUserId(e),this.cell.column)}),this.rootScope.$broadcast(v.b.DATA_UPDATE),this.resetGradePost()}):this.post(e,!1).then(()=>this.fetchSummary({timestamp:Date.now()})).then(()=>{this.gridData.refreshDataCell(this.cell.row,this.cell.column),this.rootScope.$broadcast(v.b.DATA_UPDATE),this.resetGradePost()}))})},a.isReadyToPost=()=>!this._isUpdating&&this.cell.isReadyToPost&&this.isReadyToPost&&(!this.isGroupAssessment()||this._isOtherGroupMemberGraded),a.adjustPosition=e=>{i.top+e.height()>this.gradeGridRebornController.getGradeGridContainerElementBottom()&&(i.top-=o+e.height()),e.offset(i)},n?this.gradeGridRebornController.popupMenu(s,y,a):this.gradeGridRebornController.popupMenu(s,w,a),this.addMenuKeyEventListeners(),t.preventDefault(),t.stopPropagation()}}popupConfirmDialog(t){const n=`group-cell-confirm-dialog-reborn-${this.scope.row.id}-${this.scope.col.id}`,s=this.$q.defer();if(!this.gradeGridRebornController.isMenuExisting(n)){const i=this.scope.$new(!0);i.waiting=200,i.onBeforeDestroy=e=>{s.resolve(!0)},i.saveGroup=()=>{s.resolve(!0)},i.saveOne=()=>{s.resolve(!1)},i.isSaveOneDisabled=""===this.score,t.top+=80,i.adjustPosition=e=>{const n=t.left+e.width(),s=t.top+e.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();n>i&&(t.left-=n-i+Object(m.a)()),s>o&&(t.top-=e.height()+80),e.offset(t)},i.$on("$destroy",()=>{this.scope.$emit(v.b.LEAVE_CELL)}),this.gradeGridRebornController.popupMenu(n,S,i),this.timeout(()=>{const t=e(`#${n}`).find("button");t.on("keydown",(function(n){if(h.A(n))t.eq((t.index(this)+1)%t.length).focus();else if(h.z(n))t.eq((t.index(this)-1+t.length)%t.length).focus();else{if(n.keyCode!==h.g)return;e(window).click()}n.preventDefault(),n.stopPropagation()})),t.first().focus()},this.scope,0,!1)}return s.promise}isOtherGroupMemberGraded(){this._isOtherGroupMemberGraded=i.isUndefined(i.findKey(this.studentIdGradeMap,(e,t)=>{const n=e.getScore();return this.cell.row.metadata.user.id!==t&&(""===n||i.isNull(n)||i.isUndefined(n))}))}addInputKeyEventListeners(){this.element.find("#bb-grade-grid-cell-editor-reborn input").on("keydown",e=>{const t=this.gradeGridRebornController.getMenuitems();if(h.A(e))t.first().focus();else{if(!h.z(e))return;t.last().focus()}e.preventDefault(),e.stopPropagation()})}addMenuKeyEventListeners(){this.timeout(()=>{const t=this.gradeGridRebornController.getPopupMenu();t.on("keydown",n=>{const s=this.gradeGridRebornController.getMenuitems();if(h.A(n)){const t=s.index(e(n.target))+1;t<s.length?s.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(h.z(n)){const t=s.index(e(n.target))-1;t>=0?s.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(h.y(n))this.scope.$emit(v.b.LEAVE_CELL);else{if(n.keyCode!==h.g)return;t.data("destroy")(),this.scope.$emit(v.b.LEAVE_CELL)}n.preventDefault(),n.stopPropagation()})},this.scope,0,!1)}gotoNextCell(){this.nextDeferred=this.$q.defer(),this.nextDeferred.promise.then(()=>{this.scope.$emit(v.b.ENTER_NEXT_CELL)})}onInputBlur(t,n,s){if(!this.isLoading&&this._isEditing)if(this.savePromise=this.$q.when(),this.postDefer=this.$q.defer(),this.postPromise=this.postDefer.promise,n){let n;this.score=s,i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.isDirty()?(n=this.$q.defer(),this.savePromise=n.promise):this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0);let o=this.$q.when(!1);this.isGroupAssessment()&&this.isDirty()&&(o=this.popupConfirmDialog(e(t.target).closest(".grade-grid-cell").offset())),o.then(e=>{this.showScoreTemporarily(),this.saveGrade(e,n),this.closeEditor()})}else i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}showScoreTemporarily(){if(this.isDirty()){const e=this.element.find("#display");e.text(this.score);const t=this.element.find("#posted");i.isEmpty(this.score)?(this.hideElement(t),this.hideElement(this.element.find("#displayedScore")),this.showElement(this.element.find("#gradeNow"))):(this.hideElement(this.element.find("#gradeNow")),this.showElement(this.element.find("#displayedScore")),this.showElement(e))}}closeEditor(){!this.isLoading&&this._isEditing&&(this._isEditing=!1,this.removeCellEditor(),this.editorScope.$destroy(),this.showElement(this.element.find(".score")),this.rootScope.$broadcast(f.a.CLOSE_EDITOR,{group:this.group,columnId:this.cell.column.id}))}formatScore(){const e=this.cell.data;let t;return!i.isNull(e)&&e.grade&&e.grade.displayGrade&&(t=this.gradeService.getGradeToDisplay(e.grade.displayGrade,this.scope,this.gridData.getSchema()[this.cell.column.data.gradingSchemaId].scaleType),this.setUpScreenReader(this.cell,t)),t}isDirty(){return i.isUndefined(this._oldScore)&&!i.isEmpty(this.score)||!i.isUndefined(this._oldScore)&&this.bbLocalize.parseNumberSync(this._oldScore,this.scope).toString()!==this.bbLocalize.parseNumberSync(this.score,this.scope).toString()}createGradeSubmission(){const e=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],t=this.gradeService.createGradeSubmission(this.cell.column.data,this.gradeService.parseGrade(this.score,e,this.scope),e);return t.clearGrade=this.gradeService.wasGradeCleared(this._oldScore,this.score),t}getGroupGrades(e){this.studentIdGradeMap={};const t=this.gridData.getGroupIdUserIdMap()[this.group.groupId].map(e=>this.gridData.getRowByUserId(e).metadata.id);return this.CourseModel.$new(this.gridData.course.id).gradebook.bulkView.$fetch({membershipIds:t,columnIds:[e]}).$asPromise().then(e=>{e.bulkViewUsers.forEach(e=>{this.studentIdGradeMap[e.studentId]=e.grades[0].grade})})}prepareSaveGroupGrade(){return this.$q.when().then(()=>{this.gridData.getGroupById(this.group.groupId).memberships.forEach(e=>{e.ui={gradeDetail:this.studentIdGradeMap[e.userId]}})})}saveGrade(e,t){if(this.isDirty()){this._oldScore=this._score,i.isUndefined(t)&&(t=this.$q.defer(),this.savePromise=t.promise);const n=this.createGradeSubmission();let s=this.$q.when();n.clearGrade&&this.cell.isCleanAttemptGrade&&(s=this.CourseModel.$new(this.gridData.course.id).gradebook.columns.$new(this.cell.column.id).grades.$new(this.cell.data.grade.id).attempts.$fetch().$asPromise().then(e=>e[0])),s.then(t=>(e?this.prepareSaveGroupGrade():this.$q.when()).then(()=>this.gradeService.saveGrade(n,this.cell.data&&this.cell.data.grade,t,e?{group:this.gridData.getGroupById(this.group.groupId)}:{userId:this.cell.row.metadata.user.id}))).then(s=>{!n.clearGrade&&this.cell.isPosted&&this.cell.isNeedAutoPost?this.post(s,e):t.resolve(s)}).then(()=>(this.postDeferTimeout=this.timeout(()=>{this.postDefer.resolve(!1)},this.scope,100,!1),this.postPromise.then(e=>e?void 0:this.fetchSummary()))).then(()=>{this.refresh(e),this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)})}}refresh(e){const t=this.getAffectedColumns().concat([this.cell.column]),n=this.getOverallColumn();n&&t.push(n);const s=[this.cell.row];e&&this.gridData.getGroupIdUserIdMap()[this.group.groupId].forEach(e=>{const t=this.gridData.getRowByUserId(e);t!==this.cell.row&&s.push(t)}),i.forEach(s,e=>{i.forEach(t,t=>{this.gridData.refreshDataCell(e,t)})}),this._isUpdating=!0,this.rootScope.$broadcast(v.b.DATA_UPDATE)}getAffectedColumns(){return this.cell.column instanceof p.c?this.cell.column.findAffectedColumns():[]}getOverallColumn(){return i.find(this.gridData.getColumns(),e=>e instanceof p.k)}setUpScreenReader(e,t){this.userName=`${e.row.metadata.user.givenName} ${e.row.metadata.user.familyName}`;const n=e.column.data.columnName;if(this.ariaLabelContent=t?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.canGradeCell()?"components.directives.grade.grid.tableCellAriaLabel":"components.directives.grade.grid.tableCellAriaLabelReadOnly",params:{userName:this.userName,assignmentName:n,grade:t},noWrap:!0,noEscape:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.canGradeCell()?"components.directives.grade.grid.tableCellAriaLabelEmpty":"components.directives.grade.grid.tableCellAriaLabelEmptyReadOnly",params:{userName:this.userName,assignmentName:n},noWrap:!0,noEscape:!0}),this.isPosted){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.postedLabel",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${this.ariaLabelContent} ${e}`}if(this.isPastDueZero){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.pastDueZero",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${this.ariaLabelContent} ${e}`}if(this.group&&(this.ariaLabelContent=`${this.ariaLabelContent} ${this.group.groupTitle}`),this.hasNewSubmission){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.newSubmissionLabel",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${e} ${this.ariaLabelContent}`}}isGroupAssessment(){return this.group&&this.cell instanceof b.e&&!(this.cell instanceof b.f)}}O.CELL_EDITOR_TEMPLATE='<div bb-grade-grid-cell-editor-reborn id="bb-grade-grid-cell-editor-reborn" class="editor"></div>',O.$inject=["$rootScope","$window","$q",u.m.serviceName,a.i,"$compile","scope","element","attrs","gradeGridRebornController",r.b,c.serviceName,l.b];class E{constructor(e){this.$injector=e,this.restrict="E",this.template=C,this.scope=!0,this.require=`^${o.a}`,this.link=(e,t,n,s)=>{e.gradeGridColumnReborn=this.$injector.instantiate(O,{scope:e,element:t,attrs:n,gradeGridRebornController:s})}}}E.$inject=["$injector"],s.module(I,[d.a]).directive("bbGradeGridColumnReborn",["$injector",e=>e.instantiate(E)])}).call(this,n("5iHu"))},xiEu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("fWA+");const o="ultra.components.directives.bbUiIcon.large.DocumentMultiple";Object(s.a)(i.a,o,"bbUiIconLargeDocumentMultiple")},xoIb:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-feedback",use:"icon-medium-feedback-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-feedback"><path d="M1 1h22v19h-8l-3 3-3-3H1V1zM6 6h12M6 9h12M6 12h12M6 15h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"y+vt":function(e,t,n){"use strict";n("67oV");var s=n("Llzl"),i=n("qH3X"),o=n("0JpG"),a=n("pF15");n.d(t,"a",(function(){return r}));const r="ultra.components.directives.gradeSearchFilterReborn";class c{constructor(e,t,n){this.scope=e,this.$rootScope=t,this.bbLocalize=n,this.initial()}initial(){this.getCheckedMergedCourse()||this.clearAll(),this.criteriaBlocks=[{id:"merged_course",expanded:!0,name:"merged_course",criteriaDetails:this.scope.mergedCourses}]}clearAll(){this.$rootScope.$broadcast(i.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,!0)}collapseMergedCourse(e){this.criteriaBlocks.some(t=>t.id===e.id)&&(e.expanded=!e.expanded)}getCheckedMergedCourse(){return this.scope.mergedCourses&&this.scope.mergedCourses.filter(e=>!0===e.ui.checked).length}getToggleButtonLabel(e){return e.expanded?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.filter-panel.collapse"}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.filter-panel.expand"})}}c.$inject=["scope","$rootScope",o.serviceName];class l{constructor(e){this.$injector=e,this.restrict="E",this.template=a,this.scope={mergedCourses:"<"},this.link=(e,t,n)=>{e.gradeGridSearchFilterReborn=this.$injector.instantiate(c,{scope:e,element:t,attrs:n})}}}l.$inject=["$injector"],s.module(r,[]).directive("bbGradeGridSearchFilterReborn",["$injector",e=>e.instantiate(l)])},yV5t:function(e,t){e.exports='<a class="content-title"\n   ng-click="contentItemScormLaunch.scormLaunch()"\n   href="javascript:void(0);"\n   aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n   analytics-id="content.item.scormlaunch.link"\n   aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n   tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n  <span>{{ content.title }}</span>\n</a>\n'},yiTm:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-medium-groups",use:"icon-medium-groups-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-groups"><g clip-path="url(#icon-medium-groups_clip0)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 23.0644C17.3246 21.1155 14.8704 20 12 20s-5.3246 1.1155-7 3.0644M12 20c2.7614 0 5-2.2386 5-5s-2.2386-5-5-5-5 2.2386-5 5 2.2386 5 5 5zM18.5 8C20.433 8 22 6.433 22 4.5S20.433 1 18.5 1 15 2.567 15 4.5 16.567 8 18.5 8z" /><path d="M23 11s-1-3-4.5-3c-2.1456 0-3.3517 1.1274-3.9639 2M5.5 8C3.567 8 2 6.433 2 4.5S3.567 1 5.5 1 9 2.567 9 4.5 7.433 8 5.5 8zM1 11s1-3 4.5-3c2.1456 0 3.3517 1.1274 3.9639 2" /></g><defs><clipPath id="icon-medium-groups_clip0"><path d="M0 0h24v24H0z" /></clipPath></defs></symbol>'});i.add(o);e.exports=o},ytQ2:function(e,t){e.exports='<div ng-if="::foundationOffcanvas.wiredup || undefined"\n      class="bb-foundation-offcanvas"\n      ng-transclude\n      bb-click-outside="foundationOffcanvas.handleClickOutside()"\n      is-active="foundationOffcanvas.isPanelOpen"\n      aria-hidden="{{!foundationOffcanvas.isPanelOpen}}"\n      current-panel-only>\n</div>'},"z+6U":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("Llzl"),i=n("sa5q");const o="ultra.components.directives.content.contentItem.contentItemType.contentItemPage";class a{constructor(e){this.scope=e}shouldAlignMiddle(){return!this.scope.content.canViewAsInstructor()}}a.$inject=["scope"];class r{constructor(e){this.$injector=e,this.restrict="E",this.template=i,this.scope=!1,this.link=(e,t,n)=>{e.contentItemPage=this.$injector.instantiate(a,{scope:e,element:t,attrs:n})}}}r.$inject=["$injector"],s.module(o,[]).directive("bbContentItemPage",["$injector",e=>e.instantiate(r)])},zEHu:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("Llzl"),i=n("jhBu");const o="ultra.components.directives.courseEntitlement";class a{constructor(e,t){this.$entitlementService=e,this.ngIfDirective=t,this.scope={bbCourseEntitlement:"@",courseId:"@",entitlementAction:"@",showContents:"@"},this.restrict=this.ngIfDirective[0].restrict,this.priority=this.ngIfDirective[0].priority,this.transclude=this.ngIfDirective[0].transclude,this.terminal=this.ngIfDirective[0].terminal,this.link=(e,t,n,s,i)=>{n.ngIf="::showContents",this.ngIfDirective[0].compile(t,n,void 0)(e,t,n,s,i);let o,a=!0;if(e.entitlementAction&&"hide"===e.entitlementAction.toLowerCase()&&(a=!1),!e.bbCourseEntitlement)throw e.showContents=!1,new Error("No entitlementUid has been provided");o=e.bbCourseEntitlement;const r=e.$parent.$watch(e.courseId,t=>{t&&(this.$entitlementService.hasCourseEntitlement(o,t).then(t=>{e.showContents=a===t},t=>{e.showContents=!1}),r())})}}}a.$inject=[i.b,"ngIfDirective","$parse"],s.module(o,[i.a]).directive("bbCourseEntitlement",["$injector",e=>e.instantiate(a)])},zexu:function(e,t,n){var s=n("ziER"),i=n("5JeM"),o=new s({id:"icon-small-undo",use:"icon-small-undo-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-undo"><path d="M3 3L1 5l2 2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 5h11c2 0 3 2.0474 3 4s-1 4-3 4H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},zisU:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n("zYa8"),i=n("7NIW");const o="ultra.components.directives.bbUiIcon.small.Attention";Object(s.a)(i.Attention,o,"bbUiIconSmallAttention")},zphb:function(e,t){e.exports='<div class="simple-statistic-contents" ng-class="::item().cssClass">\n  <div bb-tooltip enhanced-tooltip="true" data-tooltip-on-overflow-only="true" title="{{ ::item().data }}">\n    <div class="stat-data"\n         ng-attr-aria-label="{{ item().aria ? item().aria : undefined }}"\n         data-ng-bind-html="::item().trusted"\n         data-ellipsis></div>\n  </div>\n  <div ng-if="::item().subtext" class="stat-sub-text" bb-translate>{{ ::item().subtext }}</div>\n  <div ng-if="::!item().subtext && item().reserveSubtextSpace" class="stat-sub-text" aria-hidden="true">&nbsp;</div>\n</div>'}}]);