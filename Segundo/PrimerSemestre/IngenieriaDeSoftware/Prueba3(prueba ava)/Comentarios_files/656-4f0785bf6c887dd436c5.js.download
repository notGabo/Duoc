(window.webpackJsonp=window.webpackJsonp||[]).push([[656],{X8JP:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}));var i=n("Vsv2"),o=n("pjml");const s="ultraUi.components.services.cloudDrive.rteCloudStorageIntegrationModal",a="RteCloudStorageIntegrationService",r=e=>e.account+"|"+e.id;class c{constructor(e,t,n){this.$q=e,this.cloudDriveService=t,this.CloudDriveModel=n}initialize(){return this.cloudDriveService.isCloudServiceAvailable().then(e=>this.isCloudServiceAvailable=e)}openFilePicker(e){return this.cloudDriveService.cloudDriveStorage.openFilePicker(e,!0).then(e=>{if(e){const t=[];return e.forEach(n=>{const i=r(n),o=this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(i).$fetch({accessToken:e[0].bearer_token.key}).$asPromise();t.push(o)}),this.$q.all(t).then(t=>t.map(t=>({id:t.id,cloudStorageIntegrationAccessToken:e[0].bearer_token.key,name:t.name,size:t.size,type:t.type,updatedTime:t.updatedTime,webLocation:t.webLocation})))}return this.$q.reject()})}getModalCallback(e){return()=>this.cloudDriveService.cloudDriveStorage?this.openFilePicker(e):this.cloudDriveService.initializeCloudDrive().then(()=>this.openFilePicker(e))}}c.$inject=["$q",i.b,o.h.serviceName],angular.module(s,[i.a]).service(a,c)},Y7zS:function(e,t){e.exports='<bb-modal id="close-without-saving-modal" class="notification js-dismiss-modal" role="alertdialog" bb-translate-attrs="{\'aria-label\': \'components.directives.close-without-saving-modal.title\'}"\n          modal-title-key="components.directives.close-without-saving-modal.title"\n          analytics-id-tag-prefix="components.directives.close-without-saving-modal">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.close-without-saving-modal.instructions</p>\n  </div>\n  <button name="modal-footer-button-primary" \n          class="button js-primary-button" \n          ng-click="$parent.$close()" \n          bb-translate\n          analytics-id="global.close">\n    global.close\n  </button>\n  <button name="modal-footer-button-secondary" \n          class="button button--secondary js-secondary-button" \n          ng-click="$parent.$dismiss()" \n          bb-translate\n          analytics-id="global.cancel">\n    global.cancel\n  </button>\n</bb-modal>\n'},Zozd:function(e,t,n){"use strict";n.r(t);var i=n("D57K"),o=n("/C4M"),s=n.n(o),a=n("0JpG"),r=n("Y7zS"),c=n("kxl5"),l=n("vhkR"),u=n("X8JP"),d=n("TnpK"),m=n("yC9S"),b=n("6fZB"),h=n("aHpC");n.d(t,"moduleName",(function(){return p})),n.d(t,"controllerName",(function(){return v})),n.d(t,"componentName",(function(){return g})),n.d(t,"AnnouncementDetail",(function(){return S})),n.d(t,"AnnouncementDetailController",(function(){return $})),n.d(t,"template",(function(){return f})),n.d(t,"templateText",(function(){return r}));const p="ultra.course.announcement-detail",v="ultra.course.announcement-detail.controller",g="announcementDetail",C=angular.module(p,[c.a,l.a,u.a,d.b]);let S=class{constructor(e,t,n,i,o,a,r,c,l,u){this.$element=e,this.$ngRedux=t,this.$scope=n,this.$stateParams=i,this.$modal=o,this.announcementPermissions=a,this._bbLocalize=r,this.bbLtiService=c,this.CloudStorageIntegrationModalService=l,this.ultraState=u,this.confirmCancellation=!1,this.renderPanelWithLoadedPlugins=async()=>{const e={courseId:this.$stateParams.courseId,getEmbedSrc:this.bbLtiService.configureAndInitInlineLaunch.bind(this.bbLtiService)};try{let t;const n=new Promise((e,n)=>{t=setTimeout(n,2e3)});if(await Promise.race([this.CloudStorageIntegrationModalService.initialize(),n]),clearTimeout(t),this.CloudStorageIntegrationModalService.isCloudServiceAvailable){const t=this.CloudStorageIntegrationModalService.getModalCallback(this.$scope);e.openCloudStorageIntegrationModal=()=>Object(b.a)(t())}}catch(e){}finally{s.a.renderAnnouncementDetailPanel(this.$element[0],this.$ngRedux,this._bbLocalize.getLocale(this.$scope),this._bbLocalize.intl,this._bbLocalize.frmt,this._bbLocalize.isRTL(this.$scope),this.$stateParams.courseId,this.$stateParams.announcementId,this.announcementPermissions.getCourseAnnouncementsPermissions(),this.$stateParams.mode,this.closePanel,e)}},this.closePanel=()=>{this.ultraState.leavePeekState()},n.$on("$stateChangeStart",(e,t,n,i,o)=>{const s=this.$ngRedux.getState().announcement.detailPanelState;i.name!==t.name&&t.name.indexOf("course.outline")>-1&&s.isDirty&&!this.confirmCancellation&&(e.preventDefault(),this._showConfirmation())})}$postLink(){this.renderPanelWithLoadedPlugins()}_showConfirmation(){this.$modal.open({template:r,scope:this.$scope,resolve:{translations:[a.serviceName,e=>e.loadBundle("components/directives/close-without-saving-modal")]}}).result.then(()=>{this.confirmCancellation=!0,this.ultraState.leavePeekState()},()=>{})}$onDestroy(){this.$scope.$emit("bb-announcement-panel-close"),s.a.destroyAnnouncementDetailPanel(this.$element[0])}};S=Object(i.__decorate)([Object(m.a)({module:C,componentName:g}),Object(i.__param)(0,Object(h.b)("$element")),Object(i.__param)(1,Object(h.b)("$ngRedux")),Object(i.__param)(2,Object(h.b)("$scope")),Object(i.__param)(3,Object(h.b)("$stateParams")),Object(i.__param)(4,Object(h.b)("$modal")),Object(i.__param)(5,Object(h.b)(c.b)),Object(i.__param)(6,Object(h.b)(a.serviceName)),Object(i.__param)(7,Object(h.b)(l.b)),Object(i.__param)(8,Object(h.b)(u.b)),Object(i.__param)(9,Object(h.b)(d.d))],S);class ${}const f='<div class="announcement-detail">\n  <announcement-detail></announcement-detail>\n  <div ui-view></div>\n</div>';C.controller(v,$)},kxl5:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var i=n("D57K"),o=n("Llzl"),s=n("pjml"),a=n("Sa5G"),r=n("Qbdf"),c=n("jhBu"),l=n("aHpC");const u="ultra.service.announcements.permissions",d="announcementPermissions";let m=class{constructor(e,t){this.currentCourse=e,this.entitlements=t}isCurrentCourseCompleted(){return this.currentCourse.course&&this.currentCourse.course.isComplete()}getCourseAnnouncementsPermissions(){return{create:!this.isCurrentCourseCompleted()&&this.entitlements.isEntitled(a.a.CreateCourseAnnouncement),modify:!this.isCurrentCourseCompleted()&&this.entitlements.isEntitled(a.a.ModifyCourseAnnouncement),delete:!this.isCurrentCourseCompleted()&&this.entitlements.isEntitled(a.a.DeleteCourseAnnouncement),viewPosted:this.entitlements.isEntitled(a.a.ViewPostedCourseAnnouncement),viewUnposted:this.entitlements.isEntitled(a.a.ViewUnpostedCourseAnnouncement)}}getSystemAnnouncementsPermissions(){return{create:this.entitlements.isEntitled(a.a.CreateSystemAnnouncement),modify:this.entitlements.isEntitled(a.a.ModifySystemAnnouncement),delete:this.entitlements.isEntitled(a.a.DeleteSystemAnnouncement),viewPosted:this.entitlements.isEntitled(a.a.ViewPostedSystemAnnouncement),viewUnposted:this.entitlements.isEntitled(a.a.ViewUnpostedSystemAnnouncement)}}};m=Object(i.__decorate)([Object(i.__param)(0,Object(l.b)(r.e)),Object(i.__param)(1,Object(l.b)(c.b))],m);class b extends m{}o.module(u,[s.N]).service(d,m)}}]);